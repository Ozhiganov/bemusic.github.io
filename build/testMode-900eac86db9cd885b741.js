webpackJsonp([3,7],[,,,,,,,function(t,e,n){var r;(function(t,i){(function(){function o(t,e){if(t!==e){var n=t===t,r=e===e;if(t>e||!n||t===A&&r)return 1;if(e>t||!r||e===A&&n)return-1}return 0}function a(t,e,n){for(var r=t.length,i=n?r:-1;n?i--:++i<r;)if(e(t[i],i,t))return i;return-1}function s(t,e,n){if(e!==e)return y(t,n);for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function u(t){return"function"==typeof t||!1}function c(t){return"string"==typeof t?t:null==t?"":t+""}function l(t){return t.charCodeAt(0)}function f(t,e){for(var n=-1,r=t.length;++n<r&&e.indexOf(t.charAt(n))>-1;);return n}function h(t,e){for(var n=t.length;n--&&e.indexOf(t.charAt(n))>-1;);return n}function p(t,e){return o(t.criteria,e.criteria)||t.index-e.index}function d(t,e,n){for(var r=-1,i=t.criteria,a=e.criteria,s=i.length,u=n.length;++r<s;){var c=o(i[r],a[r]);if(c)return r>=u?c:c*(n[r]?1:-1)}return t.index-e.index}function m(t){return Ye[t]}function v(t){return $e[t]}function g(t){return"\\"+Ke[t]}function y(t,e,n){for(var r=t.length,i=e+(n?0:-1);n?i--:++i<r;){var o=t[i];if(o!==o)return i}return-1}function b(t){return!!t&&"object"==typeof t}function _(t){return 160>=t&&t>=9&&13>=t||32==t||160==t||5760==t||6158==t||t>=8192&&(8202>=t||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function w(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;)t[n]===e&&(t[n]=H,o[++i]=n);return o}function x(t,e){for(var n,r=-1,i=t.length,o=-1,a=[];++r<i;){var s=t[r],u=e?e(s,r,t):s;r&&n===u||(n=u,a[++o]=s)}return a}function E(t){for(var e=-1,n=t.length;++e<n&&_(t.charCodeAt(e)););return e}function C(t){for(var e=t.length;e--&&_(t.charCodeAt(e)););return e}function T(t){return Xe[t]}function S(t){function e(t){if(b(t)&&!Eu(t)&&!(t instanceof i)){if(t instanceof r)return t;if(qa.call(t,"__chain__")&&qa.call(t,"__wrapped__"))return ii(t)}return new r(t)}function n(){}function r(t,e,n){this.__wrapped__=t,this.__actions__=n||[],this.__chain__=!!e}function i(t){this.__wrapped__=t,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=_s,this.__views__=null}function _(){var t=this.__actions__,e=this.__iteratees__,n=this.__views__,r=new i(this.__wrapped__);return r.__actions__=t?tn(t):null,r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=e?tn(e):null,r.__takeCount__=this.__takeCount__,r.__views__=n?tn(n):null,r}function Z(){if(this.__filtered__){var t=new i(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function re(){var t=this.__wrapped__.value();if(!Eu(t))return er(t,this.__actions__);var e=this.__dir__,n=0>e,r=Br(0,t.length,this.__views__),i=r.start,o=r.end,a=o-i,s=n?o:i-1,u=ds(a,this.__takeCount__),c=this.__iteratees__,l=c?c.length:0,f=0,h=[];t:for(;a--&&u>f;){s+=e;for(var p=-1,d=t[s];++p<l;){var m=c[p],v=m.iteratee,g=m.type;if(g==V){if(m.done&&(n?s>m.index:s<m.index)&&(m.count=0,m.done=!1),m.index=s,!m.done){var y=m.limit;if(!(m.done=y>-1?m.count++>=y:!v(d)))continue t}}else{var b=v(d);if(g==G)d=b;else if(!b){if(g==W)continue t;break t}}}h[f++]=d}return h}function oe(){this.__data__={}}function Ye(t){return this.has(t)&&delete this.__data__[t]}function $e(t){return"__proto__"==t?A:this.__data__[t]}function Xe(t){return"__proto__"!=t&&qa.call(this.__data__,t)}function Je(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this}function Ke(t){var e=t?t.length:0;for(this.data={hash:ls(null),set:new ns};e--;)this.push(t[e])}function Qe(t,e){var n=t.data,r="string"==typeof e||xo(e)?n.set.has(e):n.hash[e];return r?0:-1}function Ze(t){var e=this.data;"string"==typeof t||xo(t)?e.set.add(t):e.hash[t]=!0}function tn(t,e){var n=-1,r=t.length;for(e||(e=Sa(r));++n<r;)e[n]=t[n];return e}function en(t,e){for(var n=-1,r=t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function nn(t,e){for(var n=t.length;n--&&e(t[n],n,t)!==!1;);return t}function an(t,e){for(var n=-1,r=t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function sn(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[++i]=a)}return o}function un(t,e){for(var n=-1,r=t.length,i=Sa(r);++n<r;)i[n]=e(t[n],n,t);return i}function cn(t){for(var e=-1,n=t.length,r=bs;++e<n;){var i=t[e];i>r&&(r=i)}return r}function ln(t){for(var e=-1,n=t.length,r=_s;++e<n;){var i=t[e];r>i&&(r=i)}return r}function fn(t,e,n,r){var i=-1,o=t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function hn(t,e,n,r){var i=t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function pn(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function dn(t){for(var e=t.length,n=0;e--;)n+=+t[e]||0;return n}function mn(t,e){return t===A?e:t}function vn(t,e,n,r){return t!==A&&qa.call(r,n)?t:e}function gn(t,e,n){var r=Pu(e);Za.apply(r,Us(e));for(var i=-1,o=r.length;++i<o;){var a=r[i],s=t[a],u=n(s,e[a],a,t,e);(u===u?u===s:s!==s)&&(s!==A||a in t)||(t[a]=u)}return t}function yn(t,e){for(var n=-1,r=t.length,i=Yr(r),o=e.length,a=Sa(o);++n<o;){var s=e[n];a[n]=i?Wr(s,r)?t[s]:A:t[s]}return a}function bn(t,e,n){n||(n={});for(var r=-1,i=e.length;++r<i;){var o=e[r];n[o]=t[o]}return n}function _n(t,e,n){var r=typeof t;return"function"==r?e===A?t:ir(t,e,n):null==t?pa:"object"==r?Bn(t):e===A?ba(t):Fn(t,e)}function wn(t,e,n,r,i,o,a){var s;if(n&&(s=i?n(t,r,i):n(t)),s!==A)return s;if(!xo(t))return t;var u=Eu(t);if(u){if(s=Fr(t),!e)return tn(t,s)}else{var c=Wa.call(t),l=c==Q;if(c!=ee&&c!=Y&&(!l||i))return ze[c]?qr(t,c,e):i?t:{};if(s=Ur(l?{}:t),!e)return Os(s,t)}o||(o=[]),a||(a=[]);for(var f=o.length;f--;)if(o[f]==t)return a[f];return o.push(t),a.push(s),(u?en:Mn)(t,function(r,i){s[i]=wn(r,e,n,i,t,o,a)}),s}function xn(t,e,n){if("function"!=typeof t)throw new Pa(z);return rs(function(){t.apply(A,n)},e)}function En(t,e){var n=t?t.length:0,r=[];if(!n)return r;var i=-1,o=Lr(),a=o==s,u=a&&e.length>=200?Ds(e):null,c=e.length;u&&(o=Qe,a=!1,e=u);t:for(;++i<n;){var l=t[i];if(a&&l===l){for(var f=c;f--;)if(e[f]===l)continue t;r.push(l)}else o(e,l,0)<0&&r.push(l)}return r}function Cn(t,e){var n=!0;return js(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Tn(t,e,n,r){var i=t.length;for(n=null==n?0:+n||0,0>n&&(n=-n>i?0:i+n),r=r===A||r>i?i:+r||0,0>r&&(r+=i),i=n>r?0:r>>>0,n>>>=0;i>n;)t[n++]=e;return t}function Sn(t,e){var n=[];return js(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function An(t,e,n,r){var i;return n(t,function(t,n,o){return e(t,n,o)?(i=r?n:t,!1):void 0}),i}function kn(t,e,n){for(var r=-1,i=t.length,o=-1,a=[];++r<i;){var s=t[r];if(b(s)&&Yr(s.length)&&(Eu(s)||mo(s))){e&&(s=kn(s,e,n));var u=-1,c=s.length;for(a.length+=c;++u<c;)a[++o]=s[u]}else n||(a[++o]=s)}return a}function On(t,e){return Ns(t,e,Fo)}function Mn(t,e){return Ns(t,e,Pu)}function jn(t,e){return Is(t,e,Pu)}function Rn(t,e){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var a=e[n];Tu(t[a])&&(o[++i]=a)}return o}function Nn(t,e,n){if(null!=t){n!==A&&n in ni(t)&&(e=[n]);for(var r=-1,i=e.length;null!=t&&++r<i;)var o=t=t[e[r]];return o}}function In(t,e,n,r,i,o){if(t===e)return 0!==t||1/t==1/e;var a=typeof t,s=typeof e;return"function"!=a&&"object"!=a&&"function"!=s&&"object"!=s||null==t||null==e?t!==t&&e!==e:Pn(t,e,In,n,r,i,o)}function Pn(t,e,n,r,i,o,a){var s=Eu(t),u=Eu(e),c=$,l=$;s||(c=Wa.call(t),c==Y?c=ee:c!=ee&&(s=Mo(t))),u||(l=Wa.call(e),l==Y?l=ee:l!=ee&&(u=Mo(e)));var f=c==ee,h=l==ee,p=c==l;if(p&&!s&&!f)return Nr(t,e,c);if(!i){var d=f&&qa.call(t,"__wrapped__"),m=h&&qa.call(e,"__wrapped__");if(d||m)return n(d?t.value():t,m?e.value():e,r,i,o,a)}if(!p)return!1;o||(o=[]),a||(a=[]);for(var v=o.length;v--;)if(o[v]==t)return a[v]==e;o.push(t),a.push(e);var g=(s?Rr:Ir)(t,e,n,r,i,o,a);return o.pop(),a.pop(),g}function Dn(t,e,n,r,i){for(var o=-1,a=e.length,s=!i;++o<a;)if(s&&r[o]?n[o]!==t[e[o]]:!(e[o]in t))return!1;for(o=-1;++o<a;){var u=e[o],c=t[u],l=n[o];if(s&&r[o])var f=c!==A||u in t;else f=i?i(c,l,u):A,f===A&&(f=In(l,c,i,!0));if(!f)return!1}return!0}function Ln(t,e){var n=-1,r=Fs(t),i=Yr(r)?Sa(r):[];return js(t,function(t,r,o){i[++n]=e(t,r,o)}),i}function Bn(t){var e=Pu(t),n=e.length;if(!n)return ha(!0);if(1==n){var r=e[0],i=t[r];if($r(i))return function(t){return null==t?!1:t[r]===i&&(i!==A||r in ni(t))}}for(var o=Sa(n),a=Sa(n);n--;)i=t[e[n]],o[n]=i,a[n]=$r(i);return function(t){return null!=t&&Dn(ni(t),e,o,a)}}function Fn(t,e){var n=Eu(t),r=zr(t)&&$r(e),i=t+"";return t=ri(t),function(o){if(null==o)return!1;var a=i;if(o=ni(o),!(!n&&r||a in o)){if(o=1==t.length?o:Nn(o,Yn(t,0,-1)),null==o)return!1;a=yi(t),o=ni(o)}return o[a]===e?e!==A||a in o:In(e,o[a],null,!0)}}function Un(t,e,n,r,i){if(!xo(t))return t;var o=Yr(e.length)&&(Eu(e)||Mo(e));if(!o){var a=Pu(e);Za.apply(a,Us(e))}return en(a||e,function(s,u){if(a&&(u=s,s=e[u]),b(s))r||(r=[]),i||(i=[]),qn(t,e,u,Un,n,r,i);else{var c=t[u],l=n?n(c,s,u,t,e):A,f=l===A;f&&(l=s),!o&&l===A||!f&&(l===l?l===c:c!==c)||(t[u]=l)}}),t}function qn(t,e,n,r,i,o,a){for(var s=o.length,u=e[n];s--;)if(o[s]==u)return void(t[n]=a[s]);var c=t[n],l=i?i(c,u,n,t,e):A,f=l===A;f&&(l=u,Yr(u.length)&&(Eu(u)||Mo(u))?l=Eu(c)?c:Fs(c)?tn(c):[]:Su(u)||mo(u)?l=mo(c)?No(c):Su(c)?c:{}:f=!1),o.push(u),a.push(l),f?t[n]=r(l,u,i,o,a):(l===l?l!==c:c===c)&&(t[n]=l)}function Vn(t){return function(e){return null==e?A:e[t]}}function Wn(t){var e=t+"";return t=ri(t),function(n){return Nn(n,t,e)}}function Gn(t,e){for(var n=e.length;n--;){var r=parseFloat(e[n]);if(r!=i&&Wr(r)){var i=r;is.call(t,r,1)}}return t}function zn(t,e){return t+Ja(ys()*(e-t+1))}function Hn(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function Yn(t,e,n){var r=-1,i=t.length;e=null==e?0:+e||0,0>e&&(e=-e>i?0:i+e),n=n===A||n>i?i:+n||0,0>n&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Sa(i);++r<i;)o[r]=t[r+e];return o}function $n(t,e){var n;return js(t,function(t,r,i){return n=e(t,r,i),!n}),!!n}function Xn(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function Jn(t,e,n){var r=Dr(),i=-1;e=un(e,function(t){return r(t)});var o=Ln(t,function(t){var n=un(e,function(e){return e(t)});return{criteria:n,index:++i,value:t}});return Xn(o,function(t,e){return d(t,e,n)})}function Kn(t,e){var n=0;return js(t,function(t,r,i){n+=+e(t,r,i)||0}),n}function Qn(t,e){var n=-1,r=Lr(),i=t.length,o=r==s,a=o&&i>=200,u=a?Ds():null,c=[];u?(r=Qe,o=!1):(a=!1,u=e?[]:c);t:for(;++n<i;){var l=t[n],f=e?e(l,n,t):l;if(o&&l===l){for(var h=u.length;h--;)if(u[h]===f)continue t;e&&u.push(f),c.push(l)}else r(u,f,0)<0&&((e||a)&&u.push(f),c.push(l))}return c}function Zn(t,e){for(var n=-1,r=e.length,i=Sa(r);++n<r;)i[n]=t[e[n]];return i}function tr(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Yn(t,r?0:o,r?o+1:i):Yn(t,r?o+1:0,r?i:o)}function er(t,e){var n=t;n instanceof i&&(n=n.value());for(var r=-1,o=e.length;++r<o;){var a=[n],s=e[r];Za.apply(a,s.args),n=s.func.apply(s.thisArg,a)}return n}function nr(t,e,n){var r=0,i=t?t.length:r;if("number"==typeof e&&e===e&&Es>=i){for(;i>r;){var o=r+i>>>1,a=t[o];(n?e>=a:e>a)?r=o+1:i=o}return i}return rr(t,e,pa,n)}function rr(t,e,n,r){e=n(e);for(var i=0,o=t?t.length:0,a=e!==e,s=e===A;o>i;){var u=Ja((i+o)/2),c=n(t[u]),l=c===c;if(a)var f=l||r;else f=s?l&&(r||c!==A):r?e>=c:e>c;f?i=u+1:o=u}return ds(o,xs)}function ir(t,e,n){if("function"!=typeof t)return pa;if(e===A)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)};case 5:return function(n,r,i,o,a){return t.call(e,n,r,i,o,a)}}return function(){return t.apply(e,arguments)}}function or(t){return Ya.call(t,0)}function ar(t,e,n){for(var r=n.length,i=-1,o=ps(t.length-r,0),a=-1,s=e.length,u=Sa(o+s);++a<s;)u[a]=e[a];for(;++i<r;)u[n[i]]=t[i];for(;o--;)u[a++]=t[i++];return u}function sr(t,e,n){for(var r=-1,i=n.length,o=-1,a=ps(t.length-i,0),s=-1,u=e.length,c=Sa(a+u);++o<a;)c[o]=t[o];for(var l=o;++s<u;)c[l+s]=e[s];for(;++r<i;)c[l+n[r]]=t[o++];return c}function ur(t,e){return function(n,r,i){var o=e?e():{};if(r=Dr(r,i,3),Eu(n))for(var a=-1,s=n.length;++a<s;){var u=n[a];t(o,u,r(u,a,n),n)}else js(n,function(e,n,i){t(o,e,r(e,n,i),i)});return o}}function cr(t){return uo(function(e,n){var r=-1,i=null==e?0:n.length,o=i>2&&n[i-2],a=i>2&&n[2],s=i>1&&n[i-1];for("function"==typeof o?(o=ir(o,s,5),i-=2):(o="function"==typeof s?s:null,i-=o?1:0),a&&Gr(n[0],n[1],a)&&(o=3>i?null:o,i=1);++r<i;){var u=n[r];u&&t(e,u,o)}return e})}function lr(t,e){return function(n,r){var i=n?Fs(n):0;if(!Yr(i))return t(n,r);for(var o=e?i:-1,a=ni(n);(e?o--:++o<i)&&r(a[o],o,a)!==!1;);return n}}function fr(t){return function(e,n,r){for(var i=ni(e),o=r(e),a=o.length,s=t?a:-1;t?s--:++s<a;){var u=o[s];if(n(i[u],u,i)===!1)break}return e}}function hr(t,e){function n(){var i=this&&this!==rn&&this instanceof n?r:t;return i.apply(e,arguments)}var r=dr(t);return n}function pr(t){return function(e){for(var n=-1,r=la(Jo(e)),i=r.length,o="";++n<i;)o=t(o,r[n],n);return o}}function dr(t){return function(){var e=Ms(t.prototype),n=t.apply(e,arguments);return xo(n)?n:e}}function mr(t){function e(n,r,i){i&&Gr(n,r,i)&&(r=null);var o=jr(n,t,null,null,null,null,null,r);return o.placeholder=e.placeholder,o}return e}function vr(t,e){return function(n,r,i){i&&Gr(n,r,i)&&(r=null);var o=Dr(),a=null==r;if(o===_n&&a||(a=!1,r=o(r,i,3)),a){var s=Eu(n);if(s||!Oo(n))return t(s?n:ei(n));r=l}return Pr(n,r,e)}}function gr(t,e){return function(n,r,i){if(r=Dr(r,i,3),Eu(n)){var o=a(n,r,e);return o>-1?n[o]:A}return An(n,r,t)}}function yr(t){return function(e,n,r){return e&&e.length?(n=Dr(n,r,3),a(e,n,t)):-1}}function br(t){return function(e,n,r){return n=Dr(n,r,3),An(e,n,t,!0)}}function _r(t){return function(){var e=arguments.length;if(!e)return function(){return arguments[0]};for(var n,i=t?e:-1,o=0,a=Sa(e);t?i--:++i<e;){var s=a[o++]=arguments[i];if("function"!=typeof s)throw new Pa(z);var u=n?"":Bs(s);n="wrapper"==u?new r([]):n}for(i=n?-1:e;++i<e;){s=a[i],u=Bs(s);var c="wrapper"==u?Ls(s):null;n=c&&Hr(c[0])?n[Bs(c[0])].apply(n,c[3]):1==s.length&&Hr(s)?n[u]():n.thru(s)}return function(){var t=arguments;if(n&&1==t.length&&Eu(t[0]))return n.plant(t[0]).value();for(var r=0,i=a[r].apply(this,t);++r<e;)i=a[r].call(this,i);return i}}}function wr(t,e){return function(n,r,i){return"function"==typeof r&&i===A&&Eu(n)?t(n,r):e(n,ir(r,i,3))}}function xr(t){return function(e,n,r){return("function"!=typeof n||r!==A)&&(n=ir(n,r,3)),t(e,n,Fo)}}function Er(t){return function(e,n,r){return("function"!=typeof n||r!==A)&&(n=ir(n,r,3)),t(e,n)}}function Cr(t){return function(e,n,r){return e=c(e),e&&(t?e:"")+kr(e,n,r)+(t?"":e)}}function Tr(t){var e=uo(function(n,r){var i=w(r,e.placeholder);return jr(n,t,null,r,i)});return e}function Sr(t,e){return function(n,r,i,o){var a=arguments.length<3;return"function"==typeof r&&o===A&&Eu(n)?t(n,r,i,a):Hn(n,Dr(r,o,4),i,a,e)}}function Ar(t,e,n,r,i,o,a,s,u,c){function l(){for(var b=arguments.length,_=b,x=Sa(b);_--;)x[_]=arguments[_];if(r&&(x=ar(x,r,i)),o&&(x=sr(x,o,a)),d||v){var E=l.placeholder,C=w(x,E);if(b-=C.length,c>b){var T=s?tn(s):null,S=ps(c-b,0),k=d?C:null,j=d?null:C,R=d?x:null,N=d?null:x;e|=d?I:P,e&=~(d?P:I),m||(e&=~(O|M));var D=[t,e,n,R,k,N,j,T,u,S],L=Ar.apply(A,D);return Hr(t)&&qs(L,D),L.placeholder=E,L}}var B=h?n:this;p&&(t=B[y]),s&&(x=Qr(x,s)),f&&u<x.length&&(x.length=u);var F=this&&this!==rn&&this instanceof l?g||dr(t):t;return F.apply(B,x)}var f=e&D,h=e&O,p=e&M,d=e&R,m=e&j,v=e&N,g=!p&&dr(t),y=t;return l}function kr(t,e,n){var r=t.length;if(e=+e,r>=e||!fs(e))return"";var i=e-r;return n=null==n?" ":n+"",na(n,$a(i/n.length)).slice(0,i)}function Or(t,e,n,r){function i(){for(var e=-1,s=arguments.length,u=-1,c=r.length,l=Sa(s+c);++u<c;)l[u]=r[u];for(;s--;)l[u++]=arguments[++e];var f=this&&this!==rn&&this instanceof i?a:t;return f.apply(o?n:this,l)}var o=e&O,a=dr(t);return i}function Mr(t){return function(e,n,r,i){var o=Dr(r);return o===_n&&null==r?nr(e,n,t):rr(e,n,o(r,i,1),t)}}function jr(t,e,n,r,i,o,a,s){var u=e&M;if(!u&&"function"!=typeof t)throw new Pa(z);var c=r?r.length:0;if(c||(e&=~(I|P),r=i=null),c-=i?i.length:0,e&P){var l=r,f=i;r=i=null}var h=u?null:Ls(t),p=[t,e,n,r,i,l,f,o,a,s];if(h&&(Xr(p,h),e=p[1],s=p[9]),p[9]=null==s?u?0:t.length:ps(s-c,0)||0,e==O)var d=hr(p[0],p[2]);else d=e!=I&&e!=(O|I)||p[4].length?Ar.apply(A,p):Or.apply(A,p);var m=h?Ps:qs;return m(d,p)}function Rr(t,e,n,r,i,o,a){var s=-1,u=t.length,c=e.length,l=!0;if(u!=c&&!(i&&c>u))return!1;for(;l&&++s<u;){var f=t[s],h=e[s];if(l=A,r&&(l=i?r(h,f,s):r(f,h,s)),l===A)if(i)for(var p=c;p--&&(h=e[p],!(l=f&&f===h||n(f,h,r,i,o,a))););else l=f&&f===h||n(f,h,r,i,o,a)}return!!l}function Nr(t,e,n){switch(n){case X:case J:return+t==+e;case K:return t.name==e.name&&t.message==e.message;case te:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case ne:case ie:return t==e+""}return!1}function Ir(t,e,n,r,i,o,a){var s=Pu(t),u=s.length,c=Pu(e),l=c.length;if(u!=l&&!i)return!1;for(var f=i,h=-1;++h<u;){var p=s[h],d=i?p in e:qa.call(e,p);if(d){var m=t[p],v=e[p];d=A,r&&(d=i?r(v,m,p):r(m,v,p)),d===A&&(d=m&&m===v||n(m,v,r,i,o,a))}if(!d)return!1;f||(f="constructor"==p)}if(!f){var g=t.constructor,y=e.constructor;if(g!=y&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y))return!1}return!0}function Pr(t,e,n){var r=n?_s:bs,i=r,o=i;return js(t,function(t,a,s){var u=e(t,a,s);((n?i>u:u>i)||u===r&&u===o)&&(i=u,o=t)}),o}function Dr(t,n,r){var i=e.callback||fa;return i=i===fa?_n:i,r?i(t,n,r):i}function Lr(t,n,r){var i=e.indexOf||mi;return i=i===mi?s:i,t?i(t,n,r):i}function Br(t,e,n){for(var r=-1,i=n?n.length:0;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=ds(e,t+a);break;case"takeRight":t=ps(t,e-a)}}return{start:t,end:e}}function Fr(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&qa.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Ur(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=Ra),new e}function qr(t,e,n){var r=t.constructor;switch(e){case ae:return or(t);case X:case J:return new r(+t);case se:case ue:case ce:case le:case fe:case he:case pe:case de:case me:var i=t.buffer;return new r(n?or(i):i,t.byteOffset,t.length);case te:case ie:return new r(t);case ne:var o=new r(t.source,Ie.exec(t));o.lastIndex=t.lastIndex}return o}function Vr(t,e,n){null==t||zr(e,t)||(e=ri(e),t=1==e.length?t:Nn(t,Yn(e,0,-1)),e=yi(e));var r=null==t?t:t[e];return null==r?A:r.apply(t,n)}function Wr(t,e){return t=+t,e=null==e?Ts:e,t>-1&&t%1==0&&e>t}function Gr(t,e,n){if(!xo(n))return!1;var r=typeof e;if("number"==r)var i=Fs(n),o=Yr(i)&&Wr(e,i);else o="string"==r&&e in n;if(o){var a=n[e];return t===t?t===a:a!==a}return!1}function zr(t,e){var n=typeof t;if("string"==n&&Ae.test(t)||"number"==n)return!0;if(Eu(t))return!1;var r=!Se.test(t);return r||null!=e&&t in ni(e)}function Hr(t){var n=Bs(t);return!!n&&t===e[n]&&n in i.prototype}function Yr(t){return"number"==typeof t&&t>-1&&t%1==0&&Ts>=t}function $r(t){return t===t&&(0===t?1/t>0:!xo(t))}function Xr(t,e){var n=t[1],r=e[1],i=n|r,o=D>i,a=r==D&&n==R||r==D&&n==L&&t[7].length<=e[8]||r==(D|L)&&n==R;if(!o&&!a)return t;r&O&&(t[2]=e[2],i|=n&O?0:j);var s=e[3];if(s){var u=t[3];t[3]=u?ar(u,s,e[4]):tn(s),t[4]=u?w(t[3],H):tn(e[4])}return s=e[5],s&&(u=t[5],t[5]=u?sr(u,s,e[6]):tn(s),t[6]=u?w(t[5],H):tn(e[6])),s=e[7],s&&(t[7]=tn(s)),r&D&&(t[8]=null==t[8]?e[8]:ds(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function Jr(t,e){t=ni(t);for(var n=-1,r=e.length,i={};++n<r;){var o=e[n];o in t&&(i[o]=t[o])}return i}function Kr(t,e){var n={};return On(t,function(t,r,i){e(t,r,i)&&(n[r]=t)}),n}function Qr(t,e){for(var n=t.length,r=ds(e.length,n),i=tn(t);r--;){var o=e[r];t[r]=Wr(o,n)?i[o]:A}return t}function Zr(t){{var n;e.support}if(!b(t)||Wa.call(t)!=ee||!qa.call(t,"constructor")&&(n=t.constructor,"function"==typeof n&&!(n instanceof n)))return!1;var r;return On(t,function(t,e){r=e}),r===A||qa.call(t,r)}function ti(t){for(var n=Fo(t),r=n.length,i=r&&t.length,o=e.support,a=i&&Yr(i)&&(Eu(t)||o.nonEnumArgs&&mo(t)),s=-1,u=[];++s<r;){var c=n[s];(a&&Wr(c,i)||qa.call(t,c))&&u.push(c)}return u}function ei(t){return null==t?[]:Yr(Fs(t))?xo(t)?t:Ra(t):zo(t)}function ni(t){return xo(t)?t:Ra(t)}function ri(t){if(Eu(t))return t;var e=[];return c(t).replace(ke,function(t,n,r,i){e.push(r?i.replace(Re,"$1"):n||t)}),e}function ii(t){return t instanceof i?t.clone():new r(t.__wrapped__,t.__chain__,tn(t.__actions__))}function oi(t,e,n){e=(n?Gr(t,e,n):null==e)?1:ps(+e||1,1);for(var r=0,i=t?t.length:0,o=-1,a=Sa($a(i/e));i>r;)a[++o]=Yn(t,r,r+=e);return a}function ai(t){for(var e=-1,n=t?t.length:0,r=-1,i=[];++e<n;){var o=t[e];o&&(i[++r]=o)}return i}function si(t,e,n){var r=t?t.length:0;return r?((n?Gr(t,e,n):null==e)&&(e=1),Yn(t,0>e?0:e)):[]}function ui(t,e,n){var r=t?t.length:0;return r?((n?Gr(t,e,n):null==e)&&(e=1),e=r-(+e||0),Yn(t,0,0>e?0:e)):[]}function ci(t,e,n){return t&&t.length?tr(t,Dr(e,n,3),!0,!0):[]}function li(t,e,n){return t&&t.length?tr(t,Dr(e,n,3),!0):[]}function fi(t,e,n,r){var i=t?t.length:0;return i?(n&&"number"!=typeof n&&Gr(t,e,n)&&(n=0,r=i),Tn(t,e,n,r)):[]}function hi(t){return t?t[0]:A}function pi(t,e,n){var r=t?t.length:0;return n&&Gr(t,e,n)&&(e=!1),r?kn(t,e):[]}function di(t){var e=t?t.length:0;return e?kn(t,!0):[]}function mi(t,e,n){var r=t?t.length:0;if(!r)return-1;if("number"==typeof n)n=0>n?ps(r+n,0):n;else if(n){var i=nr(t,e),o=t[i];return(e===e?e===o:o!==o)?i:-1}return s(t,e,n||0)}function vi(t){return ui(t,1)}function gi(){for(var t=[],e=-1,n=arguments.length,r=[],i=Lr(),o=i==s,a=[];++e<n;){var u=arguments[e];(Eu(u)||mo(u))&&(t.push(u),r.push(o&&u.length>=120?Ds(e&&u):null))}if(n=t.length,2>n)return a;var c=t[0],l=-1,f=c?c.length:0,h=r[0];t:for(;++l<f;)if(u=c[l],(h?Qe(h,u):i(a,u,0))<0){for(e=n;--e;){var p=r[e];if((p?Qe(p,u):i(t[e],u,0))<0)continue t}h&&h.push(u),a.push(u)}return a}function yi(t){var e=t?t.length:0;return e?t[e-1]:A}function bi(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r;if("number"==typeof n)i=(0>n?ps(r+n,0):ds(n||0,r-1))+1;else if(n){i=nr(t,e,!0)-1;var o=t[i];return(e===e?e===o:o!==o)?i:-1}if(e!==e)return y(t,i,!0);for(;i--;)if(t[i]===e)return i;return-1}function _i(){var t=arguments,e=t[0];if(!e||!e.length)return e;for(var n=0,r=Lr(),i=t.length;++n<i;)for(var o=0,a=t[n];(o=r(e,a,o))>-1;)is.call(e,o,1);return e}function wi(t,e,n){var r=[];if(!t||!t.length)return r;var i=-1,o=[],a=t.length;for(e=Dr(e,n,3);++i<a;){var s=t[i];e(s,i,t)&&(r.push(s),o.push(i))}return Gn(t,o),r}function xi(t){return si(t,1)}function Ei(t,e,n){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&Gr(t,e,n)&&(e=0,n=r),Yn(t,e,n)):[]}function Ci(t,e,n){var r=t?t.length:0;return r?((n?Gr(t,e,n):null==e)&&(e=1),Yn(t,0,0>e?0:e)):[]}function Ti(t,e,n){var r=t?t.length:0;return r?((n?Gr(t,e,n):null==e)&&(e=1),e=r-(+e||0),Yn(t,0>e?0:e)):[]}function Si(t,e,n){return t&&t.length?tr(t,Dr(e,n,3),!1,!0):[]}function Ai(t,e,n){return t&&t.length?tr(t,Dr(e,n,3)):[]}function ki(t,e,n,r){var i=t?t.length:0;if(!i)return[];null!=e&&"boolean"!=typeof e&&(r=n,n=Gr(t,e,r)?null:e,e=!1);var o=Dr();return(o!==_n||null!=n)&&(n=o(n,r,3)),e&&Lr()==s?x(t,n):Qn(t,n)}function Oi(t){for(var e=-1,n=(t&&t.length&&cn(un(t,Fs)))>>>0,r=Sa(n);++e<n;)r[e]=un(t,Vn(e));return r}function Mi(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if(Eu(n)||mo(n))var r=r?En(r,n).concat(En(n,r)):n}return r?Qn(r):[]}function ji(t,e){var n=-1,r=t?t.length:0,i={};for(!r||e||Eu(t[0])||(e=[]);++n<r;){var o=t[n];e?i[o]=e[n]:o&&(i[o[0]]=o[1])}return i}function Ri(t){var n=e(t);return n.__chain__=!0,n}function Ni(t,e,n){return e.call(n,t),t}function Ii(t,e,n){return e.call(n,t)}function Pi(){return Ri(this)}function Di(){return new r(this.value(),this.__chain__)}function Li(t){for(var e,r=this;r instanceof n;){var i=ii(r);e?o.__wrapped__=i:e=i;var o=i;r=r.__wrapped__}return o.__wrapped__=t,e}function Bi(){var t=this.__wrapped__;return t instanceof i?(this.__actions__.length&&(t=new i(this)),new r(t.reverse(),this.__chain__)):this.thru(function(t){return t.reverse()})}function Fi(){return this.value()+""}function Ui(){return er(this.__wrapped__,this.__actions__)}function qi(t,e,n){var r=Eu(t)?an:Cn;return n&&Gr(t,e,n)&&(e=null),("function"!=typeof e||n!==A)&&(e=Dr(e,n,3)),r(t,e)}function Vi(t,e,n){var r=Eu(t)?sn:Sn;return e=Dr(e,n,3),r(t,e)}function Wi(t,e){return Zs(t,Bn(e))}function Gi(t,e,n,r){var i=t?Fs(t):0;return Yr(i)||(t=zo(t),i=t.length),i?(n="number"!=typeof n||r&&Gr(e,n,r)?0:0>n?ps(i+n,0):n||0,"string"==typeof t||!Eu(t)&&Oo(t)?i>n&&t.indexOf(e,n)>-1:Lr(t,e,n)>-1):!1}function zi(t,e,n){var r=Eu(t)?un:Ln;return e=Dr(e,n,3),r(t,e)}function Hi(t,e){return zi(t,ba(e))}function Yi(t,e,n){var r=Eu(t)?sn:Sn;return e=Dr(e,n,3),r(t,function(t,n,r){return!e(t,n,r)})}function $i(t,e,n){if(n?Gr(t,e,n):null==e){t=ei(t);var r=t.length;return r>0?t[zn(0,r-1)]:A}var i=Xi(t);return i.length=ds(0>e?0:+e||0,i.length),i}function Xi(t){t=ei(t);for(var e=-1,n=t.length,r=Sa(n);++e<n;){var i=zn(0,e);e!=i&&(r[e]=r[i]),r[i]=t[e]}return r}function Ji(t){var e=t?Fs(t):0;return Yr(e)?e:Pu(t).length}function Ki(t,e,n){var r=Eu(t)?pn:$n;return n&&Gr(t,e,n)&&(e=null),("function"!=typeof e||n!==A)&&(e=Dr(e,n,3)),r(t,e)}function Qi(t,e,n){if(null==t)return[];n&&Gr(t,e,n)&&(e=null);var r=-1;e=Dr(e,n,3);var i=Ln(t,function(t,n,i){return{criteria:e(t,n,i),index:++r,value:t}});return Xn(i,p)}function Zi(t,e,n,r){return null==t?[]:(r&&Gr(e,n,r)&&(n=null),Eu(e)||(e=null==e?[]:[e]),Eu(n)||(n=null==n?[]:[n]),Jn(t,e,n))}function to(t,e){return Vi(t,Bn(e))}function eo(t,e){if("function"!=typeof e){if("function"!=typeof t)throw new Pa(z);var n=t;t=e,e=n}return t=fs(t=+t)?t:0,function(){return--t<1?e.apply(this,arguments):void 0}}function no(t,e,n){return n&&Gr(t,e,n)&&(e=null),e=t&&null==e?t.length:ps(+e||0,0),jr(t,D,null,null,null,null,e)}function ro(t,e){var n;if("function"!=typeof e){if("function"!=typeof t)throw new Pa(z);var r=t;t=e,e=r}return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}}function io(t,e,n){function r(){h&&Xa(h),u&&Xa(u),u=h=p=A}function i(){var n=e-(lu()-l);if(0>=n||n>e){u&&Xa(u);var r=p;u=h=p=A,r&&(d=lu(),c=t.apply(f,s),h||u||(s=f=null))}else h=rs(i,n)}function o(){h&&Xa(h),u=h=p=A,(v||m!==e)&&(d=lu(),c=t.apply(f,s),h||u||(s=f=null))}function a(){if(s=arguments,l=lu(),f=this,p=v&&(h||!g),m===!1)var n=g&&!h;else{u||g||(d=l);var r=m-(l-d),a=0>=r||r>m;a?(u&&(u=Xa(u)),d=l,c=t.apply(f,s)):u||(u=rs(o,r))}return a&&h?h=Xa(h):h||e===m||(h=rs(i,e)),n&&(a=!0,c=t.apply(f,s)),!a||h||u||(s=f=null),c}var s,u,c,l,f,h,p,d=0,m=!1,v=!0;if("function"!=typeof t)throw new Pa(z);if(e=0>e?0:+e||0,n===!0){var g=!0;v=!1}else xo(n)&&(g=n.leading,m="maxWait"in n&&ps(+n.maxWait||0,e),v="trailing"in n?n.trailing:v);return a.cancel=r,a}function oo(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new Pa(z);var n=function(){var r=arguments,i=n.cache,o=e?e.apply(this,r):r[0];if(i.has(o))return i.get(o);var a=t.apply(this,r);return i.set(o,a),a};return n.cache=new oo.Cache,n}function ao(t){if("function"!=typeof t)throw new Pa(z);return function(){return!t.apply(this,arguments)}}function so(t){return ro(2,t)}function uo(t,e){if("function"!=typeof t)throw new Pa(z);return e=ps(e===A?t.length-1:+e||0,0),function(){for(var n=arguments,r=-1,i=ps(n.length-e,0),o=Sa(i);++r<i;)o[r]=n[e+r];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,n[0],o);case 2:return t.call(this,n[0],n[1],o)}var a=Sa(e+1);for(r=-1;++r<e;)a[r]=n[r];return a[e]=o,t.apply(this,a)}}function co(t){if("function"!=typeof t)throw new Pa(z);return function(e){return t.apply(this,e)}}function lo(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Pa(z);return n===!1?r=!1:xo(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),He.leading=r,He.maxWait=+e,He.trailing=i,io(t,e,He)}function fo(t,e){return e=null==e?pa:e,jr(e,I,null,[t],[])}function ho(t,e,n,r){return e&&"boolean"!=typeof e&&Gr(t,e,n)?e=!1:"function"==typeof e&&(r=n,n=e,e=!1),n="function"==typeof n&&ir(n,r,1),wn(t,e,n)}function po(t,e,n){return e="function"==typeof e&&ir(e,n,1),wn(t,!0,e)}function mo(t){var e=b(t)?t.length:A;return Yr(e)&&Wa.call(t)==Y}function vo(t){return t===!0||t===!1||b(t)&&Wa.call(t)==X}function go(t){return b(t)&&Wa.call(t)==J}function yo(t){return!!t&&1===t.nodeType&&b(t)&&Wa.call(t).indexOf("Element")>-1}function bo(t){if(null==t)return!0;var e=Fs(t);return Yr(e)&&(Eu(t)||Oo(t)||mo(t)||b(t)&&Tu(t.splice))?!e:!Pu(t).length}function _o(t,e,n,r){if(n="function"==typeof n&&ir(n,r,3),!n&&$r(t)&&$r(e))return t===e;var i=n?n(t,e):A;return i===A?In(t,e,n):!!i}function wo(t){return b(t)&&"string"==typeof t.message&&Wa.call(t)==K}function xo(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function Eo(t,e,n,r){var i=Pu(e),o=i.length;if(!o)return!0;if(null==t)return!1;if(n="function"==typeof n&&ir(n,r,3),t=ni(t),!n&&1==o){var a=i[0],s=e[a];if($r(s))return s===t[a]&&(s!==A||a in t)}for(var u=Sa(o),c=Sa(o);o--;)s=u[o]=e[i[o]],c[o]=$r(s);return Dn(t,i,u,c,n)}function Co(t){return Ao(t)&&t!=+t}function To(t){return null==t?!1:Wa.call(t)==Q?za.test(Ua.call(t)):b(t)&&De.test(t)}function So(t){return null===t}function Ao(t){return"number"==typeof t||b(t)&&Wa.call(t)==te}function ko(t){return b(t)&&Wa.call(t)==ne||!1}function Oo(t){return"string"==typeof t||b(t)&&Wa.call(t)==ie}function Mo(t){return b(t)&&Yr(t.length)&&!!Ge[Wa.call(t)]}function jo(t){return t===A}function Ro(t){var e=t?Fs(t):0;return Yr(e)?e?tn(t):[]:zo(t)}function No(t){return bn(t,Fo(t))}function Io(t,e,n){var r=Ms(t);return n&&Gr(t,e,n)&&(e=null),e?Os(r,e):r}function Po(t){return Rn(t,Fo(t))}function Do(t,e,n){var r=null==t?A:Nn(t,ri(e),e+"");return r===A?n:r}function Lo(t,e){if(null==t)return!1;var n=qa.call(t,e);return n||zr(e)||(e=ri(e),t=1==e.length?t:Nn(t,Yn(e,0,-1)),e=yi(e),n=null!=t&&qa.call(t,e)),n}function Bo(t,e,n){n&&Gr(t,e,n)&&(e=null);for(var r=-1,i=Pu(t),o=i.length,a={};++r<o;){var s=i[r],u=t[s];e?qa.call(a,u)?a[u].push(s):a[u]=[s]:a[u]=s}return a}function Fo(t){if(null==t)return[];xo(t)||(t=Ra(t));var e=t.length;e=e&&Yr(e)&&(Eu(t)||ks.nonEnumArgs&&mo(t))&&e||0;for(var n=t.constructor,r=-1,i="function"==typeof n&&n.prototype===t,o=Sa(e),a=e>0;++r<e;)o[r]=r+"";for(var s in t)a&&Wr(s,e)||"constructor"==s&&(i||!qa.call(t,s))||o.push(s);return o}function Uo(t,e,n){var r={};return e=Dr(e,n,3),Mn(t,function(t,n,i){r[n]=e(t,n,i)}),r}function qo(t){for(var e=-1,n=Pu(t),r=n.length,i=Sa(r);++e<r;){var o=n[e];i[e]=[o,t[o]]}return i}function Vo(t,e,n){var r=null==t?A:t[e];return r===A&&(null==t||zr(e,t)||(e=ri(e),t=1==e.length?t:Nn(t,Yn(e,0,-1)),r=null==t?A:t[yi(e)]),r=r===A?n:r),Tu(r)?r.call(t):r}function Wo(t,e,n){if(null==t)return t;var r=e+"";e=null!=t[r]||zr(e,t)?[r]:ri(e);for(var i=-1,o=e.length,a=o-1,s=t;null!=s&&++i<o;){var u=e[i];xo(s)&&(i==a?s[u]=n:null==s[u]&&(s[u]=Wr(e[i+1])?[]:{})),s=s[u]}return t}function Go(t,e,n,r){var i=Eu(t)||Mo(t);if(e=Dr(e,r,4),null==n)if(i||xo(t)){var o=t.constructor;n=i?Eu(t)?new o:[]:Ms(Tu(o)&&o.prototype)}else n={};return(i?en:Mn)(t,function(t,r,i){return e(n,t,r,i)}),n}function zo(t){return Zn(t,Pu(t))}function Ho(t){return Zn(t,Fo(t))}function Yo(t,e,n){return e=+e||0,"undefined"==typeof n?(n=e,e=0):n=+n||0,t>=ds(e,n)&&t<ps(e,n)}function $o(t,e,n){n&&Gr(t,e,n)&&(e=n=null);var r=null==t,i=null==e;if(null==n&&(i&&"boolean"==typeof t?(n=t,t=1):"boolean"==typeof e&&(n=e,i=!0)),r&&i&&(e=1,i=!1),t=+t||0,i?(e=t,t=0):e=+e||0,n||t%1||e%1){var o=ys();return ds(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e)}return zn(t,e)}function Xo(t){return t=c(t),t&&t.charAt(0).toUpperCase()+t.slice(1)}function Jo(t){return t=c(t),t&&t.replace(Le,m).replace(je,"")}function Ko(t,e,n){t=c(t),e+="";var r=t.length;return n=n===A?r:ds(0>n?0:+n||0,r),n-=e.length,n>=0&&t.indexOf(e,n)==n}function Qo(t){return t=c(t),t&&xe.test(t)?t.replace(_e,v):t}function Zo(t){return t=c(t),t&&Me.test(t)?t.replace(Oe,"\\$&"):t}function ta(t,e,n){t=c(t),e=+e;var r=t.length;if(r>=e||!fs(e))return t;var i=(e-r)/2,o=Ja(i),a=$a(i);return n=kr("",a,n),n.slice(0,o)+t+n}function ea(t,e,n){return n&&Gr(t,e,n)&&(e=0),gs(t,e)}function na(t,e){var n="";if(t=c(t),e=+e,1>e||!t||!fs(e))return n;do e%2&&(n+=t),e=Ja(e/2),t+=t;while(e);return n
}function ra(t,e,n){return t=c(t),n=null==n?0:ds(0>n?0:+n||0,t.length),t.lastIndexOf(e,n)==n}function ia(t,n,r){var i=e.templateSettings;r&&Gr(t,n,r)&&(n=r=null),t=c(t),n=gn(Os({},r||n),i,vn);var o,a,s=gn(Os({},n.imports),i.imports,vn),u=Pu(s),l=Zn(s,u),f=0,h=n.interpolate||Be,p="__p += '",d=Na((n.escape||Be).source+"|"+h.source+"|"+(h===Te?Ne:Be).source+"|"+(n.evaluate||Be).source+"|$","g"),m="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++We+"]")+"\n";t.replace(d,function(e,n,r,i,s,u){return r||(r=i),p+=t.slice(f,u).replace(Fe,g),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),f=u+e.length,e}),p+="';\n";var v=n.variable;v||(p="with (obj) {\n"+p+"\n}\n"),p=(a?p.replace(ve,""):p).replace(ge,"$1").replace(ye,"$1;"),p="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var y=zu(function(){return Oa(u,m+"return "+p).apply(A,l)});if(y.source=p,wo(y))throw y;return y}function oa(t,e,n){var r=t;return(t=c(t))?(n?Gr(r,e,n):null==e)?t.slice(E(t),C(t)+1):(e+="",t.slice(f(t,e),h(t,e)+1)):t}function aa(t,e,n){var r=t;return t=c(t),t?t.slice((n?Gr(r,e,n):null==e)?E(t):f(t,e+"")):t}function sa(t,e,n){var r=t;return t=c(t),t?(n?Gr(r,e,n):null==e)?t.slice(0,C(t)+1):t.slice(0,h(t,e+"")+1):t}function ua(t,e,n){n&&Gr(t,e,n)&&(e=null);var r=B,i=F;if(null!=e)if(xo(e)){var o="separator"in e?e.separator:o;r="length"in e?+e.length||0:r,i="omission"in e?c(e.omission):i}else r=+e||0;if(t=c(t),r>=t.length)return t;var a=r-i.length;if(1>a)return i;var s=t.slice(0,a);if(null==o)return s+i;if(ko(o)){if(t.slice(a).search(o)){var u,l,f=t.slice(0,a);for(o.global||(o=Na(o.source,(Ie.exec(o)||"")+"g")),o.lastIndex=0;u=o.exec(f);)l=u.index;s=s.slice(0,null==l?a:l)}}else if(t.indexOf(o,a)!=a){var h=s.lastIndexOf(o);h>-1&&(s=s.slice(0,h))}return s+i}function ca(t){return t=c(t),t&&we.test(t)?t.replace(be,T):t}function la(t,e,n){return n&&Gr(t,e,n)&&(e=null),t=c(t),t.match(e||Ue)||[]}function fa(t,e,n){return n&&Gr(t,e,n)&&(e=null),_n(t,e)}function ha(t){return function(){return t}}function pa(t){return t}function da(t){return Bn(wn(t,!0))}function ma(t,e){return Fn(t,wn(e,!0))}function va(t,e,n){if(null==n){var r=xo(e),i=r&&Pu(e),o=i&&i.length&&Rn(e,i);(o?o.length:r)||(o=!1,n=e,e=t,t=this)}o||(o=Rn(e,Pu(e)));var a=!0,s=-1,u=Tu(t),c=o.length;n===!1?a=!1:xo(n)&&"chain"in n&&(a=n.chain);for(;++s<c;){var l=o[s],f=e[l];t[l]=f,u&&(t.prototype[l]=function(e){return function(){var n=this.__chain__;if(a||n){var r=t(this.__wrapped__),i=r.__actions__=tn(this.__actions__);return i.push({func:e,args:arguments,thisArg:t}),r.__chain__=n,r}var o=[this.value()];return Za.apply(o,arguments),e.apply(t,o)}}(f))}return t}function ga(){return t._=Ga,this}function ya(){}function ba(t){return zr(t)?Vn(t):Wn(t)}function _a(t){return function(e){return Nn(t,ri(e),e+"")}}function wa(t,e,n){n&&Gr(t,e,n)&&(e=n=null),t=+t||0,n=null==n?1:+n||0,null==e?(e=t,t=0):e=+e||0;for(var r=-1,i=ps($a((e-t)/(n||1)),0),o=Sa(i);++r<i;)o[r]=t,t+=n;return o}function xa(t,e,n){if(t=Ja(t),1>t||!fs(t))return[];var r=-1,i=Sa(ds(t,ws));for(e=ir(e,n,1);++r<t;)ws>r?i[r]=e(r):e(r);return i}function Ea(t){var e=++Va;return c(t)+e}function Ca(t,e){return(+t||0)+(+e||0)}function Ta(t,e,n){n&&Gr(t,e,n)&&(e=null);var r=Dr(),i=null==e;return r===_n&&i||(i=!1,e=r(e,n,3)),i?dn(Eu(t)?t:ei(t)):Kn(t,e)}t=t?on.defaults(rn.Object(),t,on.pick(rn,Ve)):rn;var Sa=t.Array,Aa=t.Date,ka=t.Error,Oa=t.Function,Ma=t.Math,ja=t.Number,Ra=t.Object,Na=t.RegExp,Ia=t.String,Pa=t.TypeError,Da=Sa.prototype,La=Ra.prototype,Ba=Ia.prototype,Fa=(Fa=t.window)&&Fa.document,Ua=Oa.prototype.toString,qa=La.hasOwnProperty,Va=0,Wa=La.toString,Ga=t._,za=Na("^"+Zo(Wa).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ha=To(Ha=t.ArrayBuffer)&&Ha,Ya=To(Ya=Ha&&new Ha(0).slice)&&Ya,$a=Ma.ceil,Xa=t.clearTimeout,Ja=Ma.floor,Ka=To(Ka=Ra.getOwnPropertySymbols)&&Ka,Qa=To(Qa=Ra.getPrototypeOf)&&Qa,Za=Da.push,ts=To(Ra.preventExtensions=Ra.preventExtensions)&&ts,es=La.propertyIsEnumerable,ns=To(ns=t.Set)&&ns,rs=t.setTimeout,is=Da.splice,os=To(os=t.Uint8Array)&&os,as=To(as=t.WeakMap)&&as,ss=function(){try{var e=To(e=t.Float64Array)&&e,n=new e(new Ha(10),0,1)&&e}catch(r){}return n}(),us=function(){var t={1:0},e=ts&&To(e=Ra.assign)&&e;try{e(ts(t),"xo")}catch(n){}return!t[1]&&e}(),cs=To(cs=Sa.isArray)&&cs,ls=To(ls=Ra.create)&&ls,fs=t.isFinite,hs=To(hs=Ra.keys)&&hs,ps=Ma.max,ds=Ma.min,ms=To(ms=Aa.now)&&ms,vs=To(vs=ja.isFinite)&&vs,gs=t.parseInt,ys=Ma.random,bs=ja.NEGATIVE_INFINITY,_s=ja.POSITIVE_INFINITY,ws=Ma.pow(2,32)-1,xs=ws-1,Es=ws>>>1,Cs=ss?ss.BYTES_PER_ELEMENT:0,Ts=Ma.pow(2,53)-1,Ss=as&&new as,As={},ks=e.support={};!function(t){var e=function(){this.x=t},n=[];e.prototype={valueOf:t,y:t};for(var r in new e)n.push(r);ks.funcDecomp=/\bthis\b/.test(function(){return this}),ks.funcNames="string"==typeof Oa.name;try{ks.dom=11===Fa.createDocumentFragment().nodeType}catch(i){ks.dom=!1}try{ks.nonEnumArgs=!es.call(arguments,1)}catch(i){ks.nonEnumArgs=!0}}(1,0),e.templateSettings={escape:Ee,evaluate:Ce,interpolate:Te,variable:"",imports:{_:e}};var Os=us||function(t,e){return null==e?t:bn(e,Us(e),bn(e,Pu(e),t))},Ms=function(){function e(){}return function(n){if(xo(n)){e.prototype=n;var r=new e;e.prototype=null}return r||t.Object()}}(),js=lr(Mn),Rs=lr(jn,!0),Ns=fr(),Is=fr(!0),Ps=Ss?function(t,e){return Ss.set(t,e),t}:pa;Ya||(or=Ha&&os?function(t){var e=t.byteLength,n=ss?Ja(e/Cs):0,r=n*Cs,i=new Ha(e);if(n){var o=new ss(i,0,n);o.set(new ss(t,0,n))}return e!=r&&(o=new os(i,r),o.set(new os(t,r))),i}:ha(null));var Ds=ls&&ns?function(t){return new Ke(t)}:ha(null),Ls=Ss?function(t){return Ss.get(t)}:ya,Bs=function(){return ks.funcNames?"constant"==ha.name?Vn("name"):function(t){for(var e=t.name,n=As[e],r=n?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}:ha("")}(),Fs=Vn("length"),Us=Ka?function(t){return Ka(ni(t))}:ha([]),qs=function(){var t=0,e=0;return function(n,r){var i=lu(),o=q-(i-e);if(e=i,o>0){if(++t>=U)return n}else t=0;return Ps(n,r)}}(),Vs=uo(function(t,e){return Eu(t)||mo(t)?En(t,kn(e,!1,!0)):[]}),Ws=yr(),Gs=yr(!0),zs=uo(function(t,e){t||(t=[]),e=kn(e);var n=yn(t,e);return Gn(t,e.sort(o)),n}),Hs=Mr(),Ys=Mr(!0),$s=uo(function(t){return Qn(kn(t,!1,!0))}),Xs=uo(function(t,e){return Eu(t)||mo(t)?En(t,e):[]}),Js=uo(Oi),Ks=uo(function(t,e){var n=t?Fs(t):0;return Yr(n)&&(t=ei(t)),yn(t,kn(e))}),Qs=ur(function(t,e,n){qa.call(t,n)?++t[n]:t[n]=1}),Zs=gr(js),tu=gr(Rs,!0),eu=wr(en,js),nu=wr(nn,Rs),ru=ur(function(t,e,n){qa.call(t,n)?t[n].push(e):t[n]=[e]}),iu=ur(function(t,e,n){t[n]=e}),ou=uo(function(t,e,n){var r=-1,i="function"==typeof e,o=zr(e),a=Fs(t),s=Yr(a)?Sa(a):[];return js(t,function(t){var a=i?e:o&&null!=t&&t[e];s[++r]=a?a.apply(t,n):Vr(t,e,n)}),s}),au=ur(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),su=Sr(fn,js),uu=Sr(hn,Rs),cu=uo(function(t,e){if(null==t)return[];var n=e[2];return n&&Gr(e[0],e[1],n)&&(e.length=1),Jn(t,kn(e),[])}),lu=ms||function(){return(new Aa).getTime()},fu=uo(function(t,e,n){var r=O;if(n.length){var i=w(n,fu.placeholder);r|=I}return jr(t,r,e,n,i)}),hu=uo(function(t,e){e=e.length?kn(e):Po(t);for(var n=-1,r=e.length;++n<r;){var i=e[n];t[i]=jr(t[i],O,t)}return t}),pu=uo(function(t,e,n){var r=O|M;if(n.length){var i=w(n,pu.placeholder);r|=I}return jr(e,r,t,n,i)}),du=mr(R),mu=mr(N),vu=uo(function(t,e){return xn(t,1,e)}),gu=uo(function(t,e,n){return xn(t,e,n)}),yu=_r(),bu=_r(!0),_u=Tr(I),wu=Tr(P),xu=uo(function(t,e){return jr(t,L,null,null,null,kn(e))}),Eu=cs||function(t){return b(t)&&Yr(t.length)&&Wa.call(t)==$};ks.dom||(yo=function(t){return!!t&&1===t.nodeType&&b(t)&&!Su(t)});var Cu=vs||function(t){return"number"==typeof t&&fs(t)},Tu=u(/x/)||os&&!u(os)?function(t){return Wa.call(t)==Q}:u,Su=Qa?function(t){if(!t||Wa.call(t)!=ee)return!1;var e=t.valueOf,n=To(e)&&(n=Qa(e))&&Qa(n);return n?t==n||Qa(t)==n:Zr(t)}:Zr,Au=cr(function(t,e,n){return n?gn(t,e,n):Os(t,e)}),ku=uo(function(t){var e=t[0];return null==e?e:(t.push(mn),Au.apply(A,t))}),Ou=br(Mn),Mu=br(jn),ju=xr(Ns),Ru=xr(Is),Nu=Er(Mn),Iu=Er(jn),Pu=hs?function(t){if(t)var e=t.constructor,n=t.length;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&Yr(n)?ti(t):xo(t)?hs(t):[]}:ti,Du=cr(Un),Lu=uo(function(t,e){if(null==t)return{};if("function"!=typeof e[0]){var e=un(kn(e),Ia);return Jr(t,En(Fo(t),e))}var n=ir(e[0],e[1],3);return Kr(t,function(t,e,r){return!n(t,e,r)})}),Bu=uo(function(t,e){return null==t?{}:"function"==typeof e[0]?Kr(t,ir(e[0],e[1],3)):Jr(t,kn(e))}),Fu=pr(function(t,e,n){return e=e.toLowerCase(),t+(n?e.charAt(0).toUpperCase()+e.slice(1):e)}),Uu=pr(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),qu=Cr(),Vu=Cr(!0);8!=gs(qe+"08")&&(ea=function(t,e,n){return(n?Gr(t,e,n):null==e)?e=0:e&&(e=+e),t=oa(t),gs(t,e||(Pe.test(t)?16:10))});var Wu=pr(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Gu=pr(function(t,e,n){return t+(n?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))}),zu=uo(function(t,e){try{return t.apply(A,e)}catch(n){return wo(n)?n:new ka(n)}}),Hu=uo(function(t,e){return function(n){return Vr(n,t,e)}}),Yu=uo(function(t,e){return function(n){return Vr(t,n,e)}}),$u=vr(cn),Xu=vr(ln,!0);return e.prototype=n.prototype,r.prototype=Ms(n.prototype),r.prototype.constructor=r,i.prototype=Ms(n.prototype),i.prototype.constructor=i,oe.prototype["delete"]=Ye,oe.prototype.get=$e,oe.prototype.has=Xe,oe.prototype.set=Je,Ke.prototype.push=Ze,oo.Cache=oe,e.after=eo,e.ary=no,e.assign=Au,e.at=Ks,e.before=ro,e.bind=fu,e.bindAll=hu,e.bindKey=pu,e.callback=fa,e.chain=Ri,e.chunk=oi,e.compact=ai,e.constant=ha,e.countBy=Qs,e.create=Io,e.curry=du,e.curryRight=mu,e.debounce=io,e.defaults=ku,e.defer=vu,e.delay=gu,e.difference=Vs,e.drop=si,e.dropRight=ui,e.dropRightWhile=ci,e.dropWhile=li,e.fill=fi,e.filter=Vi,e.flatten=pi,e.flattenDeep=di,e.flow=yu,e.flowRight=bu,e.forEach=eu,e.forEachRight=nu,e.forIn=ju,e.forInRight=Ru,e.forOwn=Nu,e.forOwnRight=Iu,e.functions=Po,e.groupBy=ru,e.indexBy=iu,e.initial=vi,e.intersection=gi,e.invert=Bo,e.invoke=ou,e.keys=Pu,e.keysIn=Fo,e.map=zi,e.mapValues=Uo,e.matches=da,e.matchesProperty=ma,e.memoize=oo,e.merge=Du,e.method=Hu,e.methodOf=Yu,e.mixin=va,e.negate=ao,e.omit=Lu,e.once=so,e.pairs=qo,e.partial=_u,e.partialRight=wu,e.partition=au,e.pick=Bu,e.pluck=Hi,e.property=ba,e.propertyOf=_a,e.pull=_i,e.pullAt=zs,e.range=wa,e.rearg=xu,e.reject=Yi,e.remove=wi,e.rest=xi,e.restParam=uo,e.set=Wo,e.shuffle=Xi,e.slice=Ei,e.sortBy=Qi,e.sortByAll=cu,e.sortByOrder=Zi,e.spread=co,e.take=Ci,e.takeRight=Ti,e.takeRightWhile=Si,e.takeWhile=Ai,e.tap=Ni,e.throttle=lo,e.thru=Ii,e.times=xa,e.toArray=Ro,e.toPlainObject=No,e.transform=Go,e.union=$s,e.uniq=ki,e.unzip=Oi,e.values=zo,e.valuesIn=Ho,e.where=to,e.without=Xs,e.wrap=fo,e.xor=Mi,e.zip=Js,e.zipObject=ji,e.backflow=bu,e.collect=zi,e.compose=bu,e.each=eu,e.eachRight=nu,e.extend=Au,e.iteratee=fa,e.methods=Po,e.object=ji,e.select=Vi,e.tail=xi,e.unique=ki,va(e,e),e.add=Ca,e.attempt=zu,e.camelCase=Fu,e.capitalize=Xo,e.clone=ho,e.cloneDeep=po,e.deburr=Jo,e.endsWith=Ko,e.escape=Qo,e.escapeRegExp=Zo,e.every=qi,e.find=Zs,e.findIndex=Ws,e.findKey=Ou,e.findLast=tu,e.findLastIndex=Gs,e.findLastKey=Mu,e.findWhere=Wi,e.first=hi,e.get=Do,e.has=Lo,e.identity=pa,e.includes=Gi,e.indexOf=mi,e.inRange=Yo,e.isArguments=mo,e.isArray=Eu,e.isBoolean=vo,e.isDate=go,e.isElement=yo,e.isEmpty=bo,e.isEqual=_o,e.isError=wo,e.isFinite=Cu,e.isFunction=Tu,e.isMatch=Eo,e.isNaN=Co,e.isNative=To,e.isNull=So,e.isNumber=Ao,e.isObject=xo,e.isPlainObject=Su,e.isRegExp=ko,e.isString=Oo,e.isTypedArray=Mo,e.isUndefined=jo,e.kebabCase=Uu,e.last=yi,e.lastIndexOf=bi,e.max=$u,e.min=Xu,e.noConflict=ga,e.noop=ya,e.now=lu,e.pad=ta,e.padLeft=qu,e.padRight=Vu,e.parseInt=ea,e.random=$o,e.reduce=su,e.reduceRight=uu,e.repeat=na,e.result=Vo,e.runInContext=S,e.size=Ji,e.snakeCase=Wu,e.some=Ki,e.sortedIndex=Hs,e.sortedLastIndex=Ys,e.startCase=Gu,e.startsWith=ra,e.sum=Ta,e.template=ia,e.trim=oa,e.trimLeft=aa,e.trimRight=sa,e.trunc=ua,e.unescape=ca,e.uniqueId=Ea,e.words=la,e.all=qi,e.any=Ki,e.contains=Gi,e.detect=Zs,e.foldl=su,e.foldr=uu,e.head=hi,e.include=Gi,e.inject=su,va(e,function(){var t={};return Mn(e,function(n,r){e.prototype[r]||(t[r]=n)}),t}(),!1),e.sample=$i,e.prototype.sample=function(t){return this.__chain__||null!=t?this.thru(function(e){return $i(e,t)}):$i(this.value())},e.VERSION=k,en(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){e[t].placeholder=e}),en(["dropWhile","filter","map","takeWhile"],function(t,e){var n=e!=G,r=e==V;i.prototype[t]=function(t,o){var a=this.__filtered__,s=a&&r?new i(this):this.clone(),u=s.__iteratees__||(s.__iteratees__=[]);return u.push({done:!1,count:0,index:0,iteratee:Dr(t,o,1),limit:-1,type:e}),s.__filtered__=a||n,s}}),en(["drop","take"],function(t,e){var n=t+"While";i.prototype[t]=function(n){var r=this.__filtered__,i=r&&!e?this.dropWhile():this.clone();if(n=null==n?1:ps(Ja(n)||0,0),r)e?i.__takeCount__=ds(i.__takeCount__,n):yi(i.__iteratees__).limit=n;else{var o=i.__views__||(i.__views__=[]);o.push({size:n,type:t+(i.__dir__<0?"Right":"")})}return i},i.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()},i.prototype[t+"RightWhile"]=function(t,e){return this.reverse()[n](t,e).reverse()}}),en(["first","last"],function(t,e){var n="take"+(e?"Right":"");i.prototype[t]=function(){return this[n](1).value()[0]}}),en(["initial","rest"],function(t,e){var n="drop"+(e?"":"Right");i.prototype[t]=function(){return this[n](1)}}),en(["pluck","where"],function(t,e){var n=e?"filter":"map",r=e?Bn:ba;i.prototype[t]=function(t){return this[n](r(t))}}),i.prototype.compact=function(){return this.filter(pa)},i.prototype.reject=function(t,e){return t=Dr(t,e,1),this.filter(function(e){return!t(e)})},i.prototype.slice=function(t,e){t=null==t?0:+t||0;var n=0>t?this.takeRight(-t):this.drop(t);return e!==A&&(e=+e||0,n=0>e?n.dropRight(-e):n.take(e-t)),n},i.prototype.toArray=function(){return this.drop(0)},Mn(i.prototype,function(t,n){var o=e[n];if(o){var a=/^(?:filter|map|reject)|While$/.test(n),s=/^(?:first|last)$/.test(n);e.prototype[n]=function(){var n=arguments,u=(n.length,this.__chain__),c=this.__wrapped__,l=!!this.__actions__.length,f=c instanceof i,h=n[0],p=f||Eu(c);p&&a&&"function"==typeof h&&1!=h.length&&(f=p=!1);var d=f&&!l;if(s&&!u)return d?t.call(c):o.call(e,this.value());var m=function(t){var r=[t];return Za.apply(r,n),o.apply(e,r)};if(p){var v=d?c:new i(this),g=t.apply(v,n);if(!s&&(l||g.__actions__)){var y=g.__actions__||(g.__actions__=[]);y.push({func:Ii,args:[m],thisArg:e})}return new r(g,u)}return this.thru(m)}}}),en(["concat","join","pop","push","replace","shift","sort","splice","split","unshift"],function(t){var n=(/^(?:replace|split)$/.test(t)?Ba:Da)[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:join|pop|replace|shift)$/.test(t);e.prototype[t]=function(){var t=arguments;return i&&!this.__chain__?n.apply(this.value(),t):this[r](function(e){return n.apply(e,t)})}}),Mn(i.prototype,function(t,n){var r=e[n];if(r){var i=r.name,o=As[i]||(As[i]=[]);o.push({name:n,func:r})}}),As[Ar(null,M).name]=[{name:"wrapper",func:null}],i.prototype.clone=_,i.prototype.reverse=Z,i.prototype.value=re,e.prototype.chain=Pi,e.prototype.commit=Di,e.prototype.plant=Li,e.prototype.reverse=Bi,e.prototype.toString=Fi,e.prototype.run=e.prototype.toJSON=e.prototype.valueOf=e.prototype.value=Ui,e.prototype.collect=e.prototype.map,e.prototype.head=e.prototype.first,e.prototype.select=e.prototype.filter,e.prototype.tail=e.prototype.rest,e}var A,k="3.7.0",O=1,M=2,j=4,R=8,N=16,I=32,P=64,D=128,L=256,B=30,F="...",U=150,q=16,V=0,W=1,G=2,z="Expected a function",H="__lodash_placeholder__",Y="[object Arguments]",$="[object Array]",X="[object Boolean]",J="[object Date]",K="[object Error]",Q="[object Function]",Z="[object Map]",te="[object Number]",ee="[object Object]",ne="[object RegExp]",re="[object Set]",ie="[object String]",oe="[object WeakMap]",ae="[object ArrayBuffer]",se="[object Float32Array]",ue="[object Float64Array]",ce="[object Int8Array]",le="[object Int16Array]",fe="[object Int32Array]",he="[object Uint8Array]",pe="[object Uint8ClampedArray]",de="[object Uint16Array]",me="[object Uint32Array]",ve=/\b__p \+= '';/g,ge=/\b(__p \+=) '' \+/g,ye=/(__e\(.*?\)|\b__t\)) \+\n'';/g,be=/&(?:amp|lt|gt|quot|#39|#96);/g,_e=/[&<>"'`]/g,we=RegExp(be.source),xe=RegExp(_e.source),Ee=/<%-([\s\S]+?)%>/g,Ce=/<%([\s\S]+?)%>/g,Te=/<%=([\s\S]+?)%>/g,Se=/\.|\[(?:[^[\]]+|(["'])(?:(?!\1)[^\n\\]|\\.)*?)\1\]/,Ae=/^\w*$/,ke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,Oe=/[.*+?^${}()|[\]\/\\]/g,Me=RegExp(Oe.source),je=/[\u0300-\u036f\ufe20-\ufe23]/g,Re=/\\(\\)?/g,Ne=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ie=/\w*$/,Pe=/^0[xX]/,De=/^\[object .+?Constructor\]$/,Le=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Be=/($^)/,Fe=/['\n\r\u2028\u2029\\]/g,Ue=function(){var t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",e="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(t+"+(?="+t+e+")|"+t+"?"+e+"|"+t+"+|[0-9]+","g")}(),qe=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",Ve=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","document","isFinite","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","window"],We=-1,Ge={};Ge[se]=Ge[ue]=Ge[ce]=Ge[le]=Ge[fe]=Ge[he]=Ge[pe]=Ge[de]=Ge[me]=!0,Ge[Y]=Ge[$]=Ge[ae]=Ge[X]=Ge[J]=Ge[K]=Ge[Q]=Ge[Z]=Ge[te]=Ge[ee]=Ge[ne]=Ge[re]=Ge[ie]=Ge[oe]=!1;var ze={};ze[Y]=ze[$]=ze[ae]=ze[X]=ze[J]=ze[se]=ze[ue]=ze[ce]=ze[le]=ze[fe]=ze[te]=ze[ee]=ze[ne]=ze[ie]=ze[he]=ze[pe]=ze[de]=ze[me]=!0,ze[K]=ze[Q]=ze[Z]=ze[re]=ze[oe]=!1;var He={leading:!1,maxWait:0,trailing:!1},Ye={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},$e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Xe={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Je={"function":!0,object:!0},Ke={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Qe=Je[typeof e]&&e&&!e.nodeType&&e,Ze=Je[typeof t]&&t&&!t.nodeType&&t,tn=Qe&&Ze&&"object"==typeof i&&i&&i.Object&&i,en=Je[typeof self]&&self&&self.Object&&self,nn=Je[typeof window]&&window&&window.Object&&window,rn=(Ze&&Ze.exports===Qe&&Qe,tn||nn!==(this&&this.window)&&nn||en||this),on=S();rn._=on,r=function(){return on}.call(e,n,e,t),!(r!==A&&(t.exports=r))}).call(this)}).call(e,n(44)(t),function(){return this}())},,,function(t,e){/**
	 * @license
	 * pixi.js - v2.2.7
	 * Copyright (c) 2012-2014, Mat Groves
	 * http://goodboydigital.com/
	 *
	 * Compiled: 2015-02-25
	 *
	 * pixi.js is licensed under the MIT License.
	 * http://www.opensource.org/licenses/mit-license.php
	 */
(function(){var n=n||{};n.WEBGL_RENDERER=0,n.CANVAS_RENDERER=1,n.VERSION="v2.2.7",n.blendModes={NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},n.scaleModes={DEFAULT:0,LINEAR:0,NEAREST:1},n._UID=0,"undefined"!=typeof Float32Array?(n.Float32Array=Float32Array,n.Uint16Array=Uint16Array,n.Uint32Array=Uint32Array,n.ArrayBuffer=ArrayBuffer):(n.Float32Array=Array,n.Uint16Array=Array),n.INTERACTION_FREQUENCY=30,n.AUTO_PREVENT_DEFAULT=!0,n.PI_2=2*Math.PI,n.RAD_TO_DEG=180/Math.PI,n.DEG_TO_RAD=Math.PI/180,n.RETINA_PREFIX="@2x",n.dontSayHello=!1,n.defaultRenderOptions={view:null,transparent:!1,antialias:!1,preserveDrawingBuffer:!1,resolution:1,clearBeforeRender:!0,autoResize:!1},n.sayHello=function(t){if(!n.dontSayHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["%c %c %c Pixi.js "+n.VERSION+" - "+t+"  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];console.log.apply(console,e)}else window.console&&console.log("Pixi.js "+n.VERSION+" - http://www.pixijs.com/");n.dontSayHello=!0}},n.Point=function(t,e){this.x=t||0,this.y=e||0},n.Point.prototype.clone=function(){return new n.Point(this.x,this.y)},n.Point.prototype.set=function(t,e){this.x=t||0,this.y=e||(0!==e?this.x:0)},n.Point.prototype.constructor=n.Point,n.Rectangle=function(t,e,n,r){this.x=t||0,this.y=e||0,this.width=n||0,this.height=r||0},n.Rectangle.prototype.clone=function(){return new n.Rectangle(this.x,this.y,this.width,this.height)},n.Rectangle.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=this.x;if(t>=n&&t<=n+this.width){var r=this.y;if(e>=r&&e<=r+this.height)return!0}return!1},n.Rectangle.prototype.constructor=n.Rectangle,n.EmptyRectangle=new n.Rectangle(0,0,0,0),n.Polygon=function(t){if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),t[0]instanceof n.Point){for(var e=[],r=0,i=t.length;i>r;r++)e.push(t[r].x,t[r].y);t=e}this.closed=!0,this.points=t},n.Polygon.prototype.clone=function(){var t=this.points.slice();return new n.Polygon(t)},n.Polygon.prototype.contains=function(t,e){for(var n=!1,r=this.points.length/2,i=0,o=r-1;r>i;o=i++){var a=this.points[2*i],s=this.points[2*i+1],u=this.points[2*o],c=this.points[2*o+1],l=s>e!=c>e&&(u-a)*(e-s)/(c-s)+a>t;l&&(n=!n)}return n},n.Polygon.prototype.constructor=n.Polygon,n.Circle=function(t,e,n){this.x=t||0,this.y=e||0,this.radius=n||0},n.Circle.prototype.clone=function(){return new n.Circle(this.x,this.y,this.radius)},n.Circle.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.x-t,r=this.y-e,i=this.radius*this.radius;return n*=n,r*=r,i>=n+r},n.Circle.prototype.getBounds=function(){return new n.Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},n.Circle.prototype.constructor=n.Circle,n.Ellipse=function(t,e,n,r){this.x=t||0,this.y=e||0,this.width=n||0,this.height=r||0},n.Ellipse.prototype.clone=function(){return new n.Ellipse(this.x,this.y,this.width,this.height)},n.Ellipse.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,r=(e-this.y)/this.height;return n*=n,r*=r,1>=n+r},n.Ellipse.prototype.getBounds=function(){return new n.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},n.Ellipse.prototype.constructor=n.Ellipse,n.RoundedRectangle=function(t,e,n,r,i){this.x=t||0,this.y=e||0,this.width=n||0,this.height=r||0,this.radius=i||20},n.RoundedRectangle.prototype.clone=function(){return new n.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},n.RoundedRectangle.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=this.x;if(t>=n&&t<=n+this.width){var r=this.y;if(e>=r&&e<=r+this.height)return!0}return!1},n.RoundedRectangle.prototype.constructor=n.RoundedRectangle,n.Matrix=function(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0},n.Matrix.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},n.Matrix.prototype.toArray=function(t){this.array||(this.array=new n.Float32Array(9));var e=this.array;return t?(e[0]=this.a,e[1]=this.b,e[2]=0,e[3]=this.c,e[4]=this.d,e[5]=0,e[6]=this.tx,e[7]=this.ty,e[8]=1):(e[0]=this.a,e[1]=this.c,e[2]=this.tx,e[3]=this.b,e[4]=this.d,e[5]=this.ty,e[6]=0,e[7]=0,e[8]=1),e},n.Matrix.prototype.apply=function(t,e){return e=e||new n.Point,e.x=this.a*t.x+this.c*t.y+this.tx,e.y=this.b*t.x+this.d*t.y+this.ty,e},n.Matrix.prototype.applyInverse=function(t,e){e=e||new n.Point;var r=1/(this.a*this.d+this.c*-this.b);return e.x=this.d*r*t.x+-this.c*r*t.y+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*t.y+-this.b*r*t.x+(-this.ty*this.a+this.tx*this.b)*r,e},n.Matrix.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},n.Matrix.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},n.Matrix.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),r=this.a,i=this.c,o=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=i*e-this.d*n,this.d=i*n+this.d*e,this.tx=o*e-this.ty*n,this.ty=o*n+this.ty*e,this},n.Matrix.prototype.append=function(t){var e=this.a,n=this.b,r=this.c,i=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*i+this.ty,this},n.Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},n.identityMatrix=new n.Matrix,n.DisplayObject=function(){this.position=new n.Point,this.scale=new n.Point(1,1),this.pivot=new n.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.buttonMode=!1,this.renderable=!1,this.parent=null,this.stage=null,this.worldAlpha=1,this._interactive=!1,this.defaultCursor="pointer",this.worldTransform=new n.Matrix,this._sr=0,this._cr=1,this.filterArea=null,this._bounds=new n.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},n.DisplayObject.prototype.constructor=n.DisplayObject,Object.defineProperty(n.DisplayObject.prototype,"interactive",{get:function(){return this._interactive},set:function(t){this._interactive=t,this.stage&&(this.stage.dirty=!0)}}),Object.defineProperty(n.DisplayObject.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}}),Object.defineProperty(n.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask&&(this._mask.isMask=!1),this._mask=t,this._mask&&(this._mask.isMask=!0)}}),Object.defineProperty(n.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(t){if(t){for(var e=[],n=0;n<t.length;n++)for(var r=t[n].passes,i=0;i<r.length;i++)e.push(r[i]);this._filterBlock={target:this,filterPasses:e}}this._filters=t}}),Object.defineProperty(n.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap!==t&&(t?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=t)}}),n.DisplayObject.prototype.updateTransform=function(){var t,e,r,i,o,a,s=this.parent.worldTransform,u=this.worldTransform;this.rotation%n.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),t=this._cr*this.scale.x,e=this._sr*this.scale.x,r=-this._sr*this.scale.y,i=this._cr*this.scale.y,o=this.position.x,a=this.position.y,(this.pivot.x||this.pivot.y)&&(o-=this.pivot.x*t+this.pivot.y*r,a-=this.pivot.x*e+this.pivot.y*i),u.a=t*s.a+e*s.c,u.b=t*s.b+e*s.d,u.c=r*s.a+i*s.c,u.d=r*s.b+i*s.d,u.tx=o*s.a+a*s.c+s.tx,u.ty=o*s.b+a*s.d+s.ty):(t=this.scale.x,i=this.scale.y,o=this.position.x-this.pivot.x*t,a=this.position.y-this.pivot.y*i,u.a=t*s.a,u.b=t*s.b,u.c=i*s.c,u.d=i*s.d,u.tx=o*s.a+a*s.c+s.tx,u.ty=o*s.b+a*s.d+s.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha},n.DisplayObject.prototype.displayObjectUpdateTransform=n.DisplayObject.prototype.updateTransform,n.DisplayObject.prototype.getBounds=function(t){return t=t,n.EmptyRectangle},n.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(n.identityMatrix)},n.DisplayObject.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0)},n.DisplayObject.prototype.generateTexture=function(t,e,r){var i=this.getLocalBounds(),o=new n.RenderTexture(0|i.width,0|i.height,r,e,t);return n.DisplayObject._tempMatrix.tx=-i.x,n.DisplayObject._tempMatrix.ty=-i.y,o.render(this,n.DisplayObject._tempMatrix),o},n.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()},n.DisplayObject.prototype.toGlobal=function(t){return this.displayObjectUpdateTransform(),this.worldTransform.apply(t)},n.DisplayObject.prototype.toLocal=function(t,e){return e&&(t=e.toGlobal(t)),this.displayObjectUpdateTransform(),this.worldTransform.applyInverse(t)},n.DisplayObject.prototype._renderCachedSprite=function(t){this._cachedSprite.worldAlpha=this.worldAlpha,t.gl?n.Sprite.prototype._renderWebGL.call(this._cachedSprite,t):n.Sprite.prototype._renderCanvas.call(this._cachedSprite,t)},n.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(0|t.width,0|t.height);else{var e=new n.RenderTexture(0|t.width,0|t.height);this._cachedSprite=new n.Sprite(e),this._cachedSprite.worldTransform=this.worldTransform}var r=this._filters;this._filters=null,this._cachedSprite.filters=r,n.DisplayObject._tempMatrix.tx=-t.x,n.DisplayObject._tempMatrix.ty=-t.y,this._cachedSprite.texture.render(this,n.DisplayObject._tempMatrix,!0),this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._filters=r,this._cacheAsBitmap=!0},n.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)},n.DisplayObject.prototype._renderWebGL=function(t){t=t},n.DisplayObject.prototype._renderCanvas=function(t){t=t},n.DisplayObject._tempMatrix=new n.Matrix,Object.defineProperty(n.DisplayObject.prototype,"x",{get:function(){return this.position.x},set:function(t){this.position.x=t}}),Object.defineProperty(n.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(t){this.position.y=t}}),n.DisplayObjectContainer=function(){n.DisplayObject.call(this),this.children=[]},n.DisplayObjectContainer.prototype=Object.create(n.DisplayObject.prototype),n.DisplayObjectContainer.prototype.constructor=n.DisplayObjectContainer,Object.defineProperty(n.DisplayObjectContainer.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t}}),Object.defineProperty(n.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t}}),n.DisplayObjectContainer.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)},n.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(e>=0&&e<=this.children.length)return t.parent&&t.parent.removeChild(t),t.parent=this,this.children.splice(e,0,t),this.stage&&t.setStageReference(this.stage),t;throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)},n.DisplayObjectContainer.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),r=this.getChildIndex(e);if(0>n||0>r)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[n]=e,this.children[r]=t}},n.DisplayObjectContainer.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},n.DisplayObjectContainer.prototype.setChildIndex=function(t,e){if(0>e||e>=this.children.length)throw new Error("The supplied index is out of bounds");var n=this.getChildIndex(t);this.children.splice(n,1),this.children.splice(e,0,t)},n.DisplayObjectContainer.prototype.getChildAt=function(t){if(0>t||t>=this.children.length)throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[t]},n.DisplayObjectContainer.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1!==e)return this.removeChildAt(e)},n.DisplayObjectContainer.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return this.stage&&e.removeStageReference(),e.parent=void 0,this.children.splice(t,1),e},n.DisplayObjectContainer.prototype.removeChildren=function(t,e){var n=t||0,r="number"==typeof e?e:this.children.length,i=r-n;if(i>0&&r>=i){for(var o=this.children.splice(n,i),a=0;a<o.length;a++){var s=o[a];this.stage&&s.removeStageReference(),s.parent=void 0}return o}if(0===i&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},n.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform()},n.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=n.DisplayObjectContainer.prototype.updateTransform,n.DisplayObjectContainer.prototype.getBounds=function(){if(0===this.children.length)return n.EmptyRectangle;for(var t,e,r,i=1/0,o=1/0,a=-1/0,s=-1/0,u=!1,c=0,l=this.children.length;l>c;c++){var f=this.children[c];f.visible&&(u=!0,t=this.children[c].getBounds(),i=i<t.x?i:t.x,o=o<t.y?o:t.y,e=t.width+t.x,r=t.height+t.y,a=a>e?a:e,s=s>r?s:r)}if(!u)return n.EmptyRectangle;var h=this._bounds;return h.x=i,h.y=o,h.width=a-i,h.height=s-o,h},n.DisplayObjectContainer.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=n.identityMatrix;for(var e=0,r=this.children.length;r>e;e++)this.children[e].updateTransform();var i=this.getBounds();return this.worldTransform=t,i},n.DisplayObjectContainer.prototype.setStageReference=function(t){this.stage=t,this._interactive&&(this.stage.dirty=!0);for(var e=0,n=this.children.length;n>e;e++){var r=this.children[e];r.setStageReference(t)}},n.DisplayObjectContainer.prototype.removeStageReference=function(){for(var t=0,e=this.children.length;e>t;t++){var n=this.children[t];n.removeStageReference()}this._interactive&&(this.stage.dirty=!0),this.stage=null},n.DisplayObjectContainer.prototype._renderWebGL=function(t){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);var e,n;if(this._mask||this._filters){for(this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t);t.spriteBatch.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),t.spriteBatch.start()}else for(e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t)}},n.DisplayObjectContainer.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(t);this._mask&&t.maskManager.pushMask(this._mask,t);for(var e=0,n=this.children.length;n>e;e++){var r=this.children[e];r._renderCanvas(t)}this._mask&&t.maskManager.popMask(t)}},n.Sprite=function(t){n.DisplayObjectContainer.call(this),this.anchor=new n.Point,this.texture=t||n.Texture.emptyTexture,this._width=0,this._height=0,this.tint=16777215,this.blendMode=n.blendModes.NORMAL,this.shader=null,this.texture.baseTexture.hasLoaded?this.onTextureUpdate():this.texture.on("update",this.onTextureUpdate.bind(this)),this.renderable=!0},n.Sprite.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Sprite.prototype.constructor=n.Sprite,Object.defineProperty(n.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(n.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),n.Sprite.prototype.setTexture=function(t){this.texture=t,this.cachedTint=16777215},n.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},n.Sprite.prototype.getBounds=function(t){var e=this.texture.frame.width,n=this.texture.frame.height,r=e*(1-this.anchor.x),i=e*-this.anchor.x,o=n*(1-this.anchor.y),a=n*-this.anchor.y,s=t||this.worldTransform,u=s.a,c=s.b,l=s.c,f=s.d,h=s.tx,p=s.ty,d=-1/0,m=-1/0,v=1/0,g=1/0;if(0===c&&0===l)0>u&&(u*=-1),0>f&&(f*=-1),v=u*i+h,d=u*r+h,g=f*a+p,m=f*o+p;else{var y=u*i+l*a+h,b=f*a+c*i+p,_=u*r+l*a+h,w=f*a+c*r+p,x=u*r+l*o+h,E=f*o+c*r+p,C=u*i+l*o+h,T=f*o+c*i+p;v=v>y?y:v,v=v>_?_:v,v=v>x?x:v,v=v>C?C:v,g=g>b?b:g,g=g>w?w:g,g=g>E?E:g,g=g>T?T:g,d=y>d?y:d,d=_>d?_:d,d=x>d?x:d,d=C>d?C:d,m=b>m?b:m,m=w>m?w:m,m=E>m?E:m,m=T>m?T:m}var S=this._bounds;return S.x=v,S.width=d-v,S.y=g,S.height=m-g,this._currentBounds=S,S},n.Sprite.prototype._renderWebGL=function(t){if(this.visible&&!(this.alpha<=0)){var e,n;if(this._mask||this._filters){var r=t.spriteBatch;for(this._filters&&(r.flush(),t.filterManager.pushFilter(this._filterBlock)),this._mask&&(r.stop(),t.maskManager.pushMask(this.mask,t),r.start()),r.render(this),e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t);r.stop(),this._mask&&t.maskManager.popMask(this._mask,t),this._filters&&t.filterManager.popFilter(),r.start()}else for(t.spriteBatch.render(this),e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t)}},n.Sprite.prototype._renderCanvas=function(t){if(!(this.visible===!1||0===this.alpha||this.texture.crop.width<=0||this.texture.crop.height<=0)){if(this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,t.context.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t),this.texture.valid){var e=this.texture.baseTexture.resolution/t.resolution;t.context.globalAlpha=this.worldAlpha,t.smoothProperty&&t.scaleMode!==this.texture.baseTexture.scaleMode&&(t.scaleMode=this.texture.baseTexture.scaleMode,t.context[t.smoothProperty]=t.scaleMode===n.scaleModes.LINEAR);var r=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,i=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;t.roundPixels?(t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution|0,this.worldTransform.ty*t.resolution|0),r=0|r,i=0|i):t.context.setTransform(this.worldTransform.a,this.worldTransform.b,this.worldTransform.c,this.worldTransform.d,this.worldTransform.tx*t.resolution,this.worldTransform.ty*t.resolution),16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=n.CanvasTinter.getTintedTexture(this,this.tint)),t.context.drawImage(this.tintedTexture,0,0,this.texture.crop.width,this.texture.crop.height,r/e,i/e,this.texture.crop.width/e,this.texture.crop.height/e)):t.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,this.texture.crop.width,this.texture.crop.height,r/e,i/e,this.texture.crop.width/e,this.texture.crop.height/e)}for(var o=0,a=this.children.length;a>o;o++)this.children[o]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},n.Sprite.fromFrame=function(t){var e=n.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache'+this);return new n.Sprite(e)},n.Sprite.fromImage=function(t,e,r){var i=n.Texture.fromImage(t,e,r);return new n.Sprite(i)},n.SpriteBatch=function(t){n.DisplayObjectContainer.call(this),this.textureThing=t,this.ready=!1},n.SpriteBatch.prototype=Object.create(n.DisplayObjectContainer.prototype),n.SpriteBatch.prototype.constructor=n.SpriteBatch,n.SpriteBatch.prototype.initWebGL=function(t){this.fastSpriteBatch=new n.WebGLFastSpriteBatch(t),this.ready=!0},n.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},n.SpriteBatch.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(t.gl),this.fastSpriteBatch.gl!==t.gl&&this.fastSpriteBatch.setContext(t.gl),t.spriteBatch.stop(),t.shaderManager.setShader(t.shaderManager.fastShader),this.fastSpriteBatch.begin(this,t),this.fastSpriteBatch.render(this),t.spriteBatch.start())},n.SpriteBatch.prototype._renderCanvas=function(t){if(this.visible&&!(this.alpha<=0)&&this.children.length){var e=t.context;e.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var n=this.worldTransform,r=!0,i=0;i<this.children.length;i++){var o=this.children[i];if(o.visible){var a=o.texture,s=a.frame;if(e.globalAlpha=this.worldAlpha*o.alpha,o.rotation%(2*Math.PI)===0)r&&(e.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),r=!1),e.drawImage(a.baseTexture.source,s.x,s.y,s.width,s.height,o.anchor.x*-s.width*o.scale.x+o.position.x+.5|0,o.anchor.y*-s.height*o.scale.y+o.position.y+.5|0,s.width*o.scale.x,s.height*o.scale.y);else{r||(r=!0),o.displayObjectUpdateTransform();var u=o.worldTransform;t.roundPixels?e.setTransform(u.a,u.b,u.c,u.d,0|u.tx,0|u.ty):e.setTransform(u.a,u.b,u.c,u.d,u.tx,u.ty),e.drawImage(a.baseTexture.source,s.x,s.y,s.width,s.height,o.anchor.x*-s.width+.5|0,o.anchor.y*-s.height+.5|0,s.width,s.height)}}}}},n.MovieClip=function(t){n.Sprite.call(this,t[0]),this.textures=t,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.currentFrame=0,this.playing=!1},n.MovieClip.prototype=Object.create(n.Sprite.prototype),n.MovieClip.prototype.constructor=n.MovieClip,Object.defineProperty(n.MovieClip.prototype,"totalFrames",{get:function(){return this.textures.length}}),n.MovieClip.prototype.stop=function(){this.playing=!1},n.MovieClip.prototype.play=function(){this.playing=!0},n.MovieClip.prototype.gotoAndStop=function(t){this.playing=!1,this.currentFrame=t;var e=this.currentFrame+.5|0;this.setTexture(this.textures[e%this.textures.length])},n.MovieClip.prototype.gotoAndPlay=function(t){this.currentFrame=t,this.playing=!0},n.MovieClip.prototype.updateTransform=function(){if(this.displayObjectContainerUpdateTransform(),this.playing){this.currentFrame+=this.animationSpeed;var t=this.currentFrame+.5|0;this.currentFrame=this.currentFrame%this.textures.length,this.loop||t<this.textures.length?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},n.MovieClip.fromFrames=function(t){for(var e=[],r=0;r<t.length;r++)e.push(new n.Texture.fromFrame(t[r]));return new n.MovieClip(e)},n.MovieClip.fromImages=function(t){for(var e=[],r=0;r<t.length;r++)e.push(new n.Texture.fromImage(t[r]));return new n.MovieClip(e)},n.FilterBlock=function(){this.visible=!0,this.renderable=!0},n.FilterBlock.prototype.constructor=n.FilterBlock,n.Text=function(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=1,n.Sprite.call(this,n.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(e)},n.Text.prototype=Object.create(n.Sprite.prototype),n.Text.prototype.constructor=n.Text,Object.defineProperty(n.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(n.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),n.Text.prototype.setStyle=function(t){t=t||{},t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.stroke=t.stroke||"black",t.strokeThickness=t.strokeThickness||0,t.wordWrap=t.wordWrap||!1,t.wordWrapWidth=t.wordWrapWidth||100,t.dropShadow=t.dropShadow||!1,t.dropShadowAngle=t.dropShadowAngle||Math.PI/6,t.dropShadowDistance=t.dropShadowDistance||4,t.dropShadowColor=t.dropShadowColor||"black",this.style=t,this.dirty=!0},n.Text.prototype.setText=function(t){this.text=t.toString()||" ",this.dirty=!0},n.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this.resolution,this.context.font=this.style.font;var t=this.text;this.style.wordWrap&&(t=this.wordWrap(this.text));for(var e=t.split(/(?:\r\n|\r|\n)/),n=[],r=0,i=this.determineFontProperties(this.style.font),o=0;o<e.length;o++){var a=this.context.measureText(e[o]).width;n[o]=a,r=Math.max(r,a)}var s=r+this.style.strokeThickness;this.style.dropShadow&&(s+=this.style.dropShadowDistance),this.canvas.width=(s+this.context.lineWidth)*this.resolution;var u=i.fontSize+this.style.strokeThickness,c=u*e.length;this.style.dropShadow&&(c+=this.style.dropShadowDistance),this.canvas.height=c*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="alphabetic";var l,f;if(this.style.dropShadow){this.context.fillStyle=this.style.dropShadowColor;var h=Math.sin(this.style.dropShadowAngle)*this.style.dropShadowDistance,p=Math.cos(this.style.dropShadowAngle)*this.style.dropShadowDistance;for(o=0;o<e.length;o++)l=this.style.strokeThickness/2,f=this.style.strokeThickness/2+o*u+i.ascent,"right"===this.style.align?l+=r-n[o]:"center"===this.style.align&&(l+=(r-n[o])/2),this.style.fill&&this.context.fillText(e[o],l+h,f+p)}for(this.context.fillStyle=this.style.fill,o=0;o<e.length;o++)l=this.style.strokeThickness/2,f=this.style.strokeThickness/2+o*u+i.ascent,"right"===this.style.align?l+=r-n[o]:"center"===this.style.align&&(l+=(r-n[o])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(e[o],l,f),this.style.fill&&this.context.fillText(e[o],l,f);this.updateTexture()},n.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.crop.width=this.texture.frame.width=this.canvas.width,this.texture.crop.height=this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,this.texture.baseTexture.dirty()},n.Text.prototype._renderWebGL=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1),n.Sprite.prototype._renderWebGL.call(this,t)},n.Text.prototype._renderCanvas=function(t){this.dirty&&(this.resolution=t.resolution,this.updateText(),this.dirty=!1),n.Sprite.prototype._renderCanvas.call(this,t)},n.Text.prototype.determineFontProperties=function(t){var e=n.Text.fontPropertiesCache[t];if(!e){e={};var r=n.Text.fontPropertiesCanvas,i=n.Text.fontPropertiesContext;i.font=t;var o=Math.ceil(i.measureText("|Mq").width),a=Math.ceil(i.measureText("M").width),s=2*a;a=1.4*a|0,r.width=o,r.height=s,i.fillStyle="#f00",i.fillRect(0,0,o,s),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText("|MÉq",0,a);var u,c,l=i.getImageData(0,0,o,s).data,f=l.length,h=4*o,p=0,d=!1;for(u=0;a>u;u++){for(c=0;h>c;c+=4)if(255!==l[p+c]){d=!0;break}if(d)break;p+=h}for(e.ascent=a-u,p=f-h,d=!1,u=s;u>a;u--){for(c=0;h>c;c+=4)if(255!==l[p+c]){d=!0;break}if(d)break;p-=h}e.descent=u-a,e.descent+=6,e.fontSize=e.ascent+e.descent,n.Text.fontPropertiesCache[t]=e}return e},n.Text.prototype.wordWrap=function(t){for(var e="",n=t.split("\n"),r=0;r<n.length;r++){for(var i=this.style.wordWrapWidth,o=n[r].split(" "),a=0;a<o.length;a++){var s=this.context.measureText(o[a]).width,u=s+this.context.measureText(" ").width;0===a||u>i?(a>0&&(e+="\n"),e+=o[a],i=this.style.wordWrapWidth-s):(i-=u,e+=" "+o[a])}r<n.length-1&&(e+="\n")}return e},n.Text.prototype.getBounds=function(t){return this.dirty&&(this.updateText(),this.dirty=!1),n.Sprite.prototype.getBounds.call(this,t)},n.Text.prototype.destroy=function(t){this.context=null,this.canvas=null,this.texture.destroy(void 0===t?!0:t)},n.Text.fontPropertiesCache={},n.Text.fontPropertiesCanvas=document.createElement("canvas"),n.Text.fontPropertiesContext=n.Text.fontPropertiesCanvas.getContext("2d"),n.BitmapText=function(t,e){n.DisplayObjectContainer.call(this),this.textWidth=0,this.textHeight=0,this._pool=[],this.setText(t),this.setStyle(e),this.updateText(),this.dirty=!1},n.BitmapText.prototype=Object.create(n.DisplayObjectContainer.prototype),n.BitmapText.prototype.constructor=n.BitmapText,n.BitmapText.prototype.setText=function(t){this.text=t||" ",this.dirty=!0},n.BitmapText.prototype.setStyle=function(t){t=t||{},t.align=t.align||"left",this.style=t;var e=t.font.split(" ");this.fontName=e[e.length-1],this.fontSize=e.length>=2?parseInt(e[e.length-2],10):n.BitmapText.fonts[this.fontName].size,this.dirty=!0,this.tint=t.tint},n.BitmapText.prototype.updateText=function(){for(var t=n.BitmapText.fonts[this.fontName],e=new n.Point,r=null,i=[],o=0,a=[],s=0,u=this.fontSize/t.size,c=0;c<this.text.length;c++){var l=this.text.charCodeAt(c);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(c)))a.push(e.x),o=Math.max(o,e.x),s++,e.x=0,e.y+=t.lineHeight,r=null;else{var f=t.chars[l];f&&(r&&f.kerning[r]&&(e.x+=f.kerning[r]),i.push({texture:f.texture,line:s,charCode:l,position:new n.Point(e.x+f.xOffset,e.y+f.yOffset)}),e.x+=f.xAdvance,r=l)}}a.push(e.x),o=Math.max(o,e.x);var h=[];for(c=0;s>=c;c++){var p=0;"right"===this.style.align?p=o-a[c]:"center"===this.style.align&&(p=(o-a[c])/2),h.push(p)}var d=this.children.length,m=i.length,v=this.tint||16777215;for(c=0;m>c;c++){var g=d>c?this.children[c]:this._pool.pop();g?g.setTexture(i[c].texture):g=new n.Sprite(i[c].texture),g.position.x=(i[c].position.x+h[i[c].line])*u,g.position.y=i[c].position.y*u,g.scale.x=g.scale.y=u,g.tint=v,g.parent||this.addChild(g)}for(;this.children.length>m;){var y=this.getChildAt(this.children.length-1);this._pool.push(y),this.removeChild(y)}this.textWidth=o*u,this.textHeight=(e.y+t.lineHeight)*u},n.BitmapText.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),n.DisplayObjectContainer.prototype.updateTransform.call(this)},n.BitmapText.fonts={},n.InteractionData=function(){this.global=new n.Point,this.target=null,this.originalEvent=null},n.InteractionData.prototype.getLocalPosition=function(t,e){var r=t.worldTransform,i=this.global,o=r.a,a=r.c,s=r.tx,u=r.b,c=r.d,l=r.ty,f=1/(o*c+a*-u);return e=e||new n.Point,e.x=c*f*i.x+-a*f*i.y+(l*a-s*c)*f,e.y=o*f*i.y+-u*f*i.x+(-l*o+s*u)*f,e},n.InteractionData.prototype.constructor=n.InteractionData,n.InteractionManager=function(t){this.stage=t,this.mouse=new n.InteractionData,this.touches={},this.tempPoint=new n.Point,this.mouseoverEnabled=!0,this.pool=[],this.interactiveItems=[],this.interactionDOMElement=null,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onTouchCancel=this.onTouchCancel.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this.mouseOut=!1,this.resolution=1,this._tempPoint=new n.Point
},n.InteractionManager.prototype.constructor=n.InteractionManager,n.InteractionManager.prototype.collectInteractiveSprite=function(t,e){for(var n=t.children,r=n.length,i=r-1;i>=0;i--){var o=n[i];o._interactive?(e.interactiveChildren=!0,this.interactiveItems.push(o),o.children.length>0&&this.collectInteractiveSprite(o,o)):(o.__iParent=null,o.children.length>0&&this.collectInteractiveSprite(o,e))}},n.InteractionManager.prototype.setTarget=function(t){this.target=t,this.resolution=t.resolution,null===this.interactionDOMElement&&this.setTargetDomElement(t.view)},n.InteractionManager.prototype.setTargetDomElement=function(t){this.removeEvents(),window.navigator.msPointerEnabled&&(t.style["-ms-content-zooming"]="none",t.style["-ms-touch-action"]="none"),this.interactionDOMElement=t,t.addEventListener("mousemove",this.onMouseMove,!0),t.addEventListener("mousedown",this.onMouseDown,!0),t.addEventListener("mouseout",this.onMouseOut,!0),t.addEventListener("touchstart",this.onTouchStart,!0),t.addEventListener("touchend",this.onTouchEnd,!0),t.addEventListener("touchleave",this.onTouchCancel,!0),t.addEventListener("touchcancel",this.onTouchCancel,!0),t.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0)},n.InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]="",this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchleave",this.onTouchCancel,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onTouchCancel,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0))},n.InteractionManager.prototype.update=function(){if(this.target){var t=Date.now(),e=t-this.last;if(e=e*n.INTERACTION_FREQUENCY/1e3,!(1>e)){this.last=t;var r=0;this.dirty&&this.rebuildInteractiveGraph();var i=this.interactiveItems.length,o="inherit",a=!1;for(r=0;i>r;r++){var s=this.interactiveItems[r];s.__hit=this.hitTest(s,this.mouse),this.mouse.target=s,s.__hit&&!a?(s.buttonMode&&(o=s.defaultCursor),s.interactiveChildren||(a=!0),s.__isOver||(s.mouseover&&s.mouseover(this.mouse),s.__isOver=!0)):s.__isOver&&(s.mouseout&&s.mouseout(this.mouse),s.__isOver=!1)}this.currentCursorStyle!==o&&(this.currentCursorStyle=o,this.interactionDOMElement.style.cursor=o)}}},n.InteractionManager.prototype.rebuildInteractiveGraph=function(){this.dirty=!1;for(var t=this.interactiveItems.length,e=0;t>e;e++)this.interactiveItems[e].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)},n.InteractionManager.prototype.onMouseMove=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t;var e=this.interactionDOMElement.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width)/this.resolution,this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height)/this.resolution;for(var n=this.interactiveItems.length,r=0;n>r;r++){var i=this.interactiveItems[r];i.mousemove&&i.mousemove(this.mouse)}},n.InteractionManager.prototype.onMouseDown=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t,n.AUTO_PREVENT_DEFAULT&&this.mouse.originalEvent.preventDefault();for(var e=this.interactiveItems.length,r=this.mouse.originalEvent,i=2===r.button||3===r.which,o=i?"rightdown":"mousedown",a=i?"rightclick":"click",s=i?"__rightIsDown":"__mouseIsDown",u=i?"__isRightDown":"__isDown",c=0;e>c;c++){var l=this.interactiveItems[c];if((l[o]||l[a])&&(l[s]=!0,l.__hit=this.hitTest(l,this.mouse),l.__hit&&(l[o]&&l[o](this.mouse),l[u]=!0,!l.interactiveChildren)))break}},n.InteractionManager.prototype.onMouseOut=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t;var e=this.interactiveItems.length;this.interactionDOMElement.style.cursor="inherit";for(var n=0;e>n;n++){var r=this.interactiveItems[n];r.__isOver&&(this.mouse.target=r,r.mouseout&&r.mouseout(this.mouse),r.__isOver=!1)}this.mouseOut=!0,this.mouse.global.x=-1e4,this.mouse.global.y=-1e4},n.InteractionManager.prototype.onMouseUp=function(t){this.dirty&&this.rebuildInteractiveGraph(),this.mouse.originalEvent=t;for(var e=this.interactiveItems.length,n=!1,r=this.mouse.originalEvent,i=2===r.button||3===r.which,o=i?"rightup":"mouseup",a=i?"rightclick":"click",s=i?"rightupoutside":"mouseupoutside",u=i?"__isRightDown":"__isDown",c=0;e>c;c++){var l=this.interactiveItems[c];(l[a]||l[o]||l[s])&&(l.__hit=this.hitTest(l,this.mouse),l.__hit&&!n?(l[o]&&l[o](this.mouse),l[u]&&l[a]&&l[a](this.mouse),l.interactiveChildren||(n=!0)):l[u]&&l[s]&&l[s](this.mouse),l[u]=!1)}},n.InteractionManager.prototype.hitTest=function(t,e){var r=e.global;if(!t.worldVisible)return!1;t.worldTransform.applyInverse(r,this._tempPoint);var i,o=this._tempPoint.x,a=this._tempPoint.y;if(e.target=t,t.hitArea&&t.hitArea.contains)return t.hitArea.contains(o,a);if(t instanceof n.Sprite){var s,u=t.texture.frame.width,c=t.texture.frame.height,l=-u*t.anchor.x;if(o>l&&l+u>o&&(s=-c*t.anchor.y,a>s&&s+c>a))return!0}else if(t instanceof n.Graphics){var f=t.graphicsData;for(i=0;i<f.length;i++){var h=f[i];if(h.fill&&h.shape&&h.shape.contains(o,a))return!0}}var p=t.children.length;for(i=0;p>i;i++){var d=t.children[i],m=this.hitTest(d,e);if(m)return e.target=t,!0}return!1},n.InteractionManager.prototype.onTouchMove=function(t){this.dirty&&this.rebuildInteractiveGraph();var e,n=this.interactionDOMElement.getBoundingClientRect(),r=t.changedTouches,i=0;for(i=0;i<r.length;i++){var o=r[i];e=this.touches[o.identifier],e.originalEvent=t,e.global.x=(o.clientX-n.left)*(this.target.width/n.width)/this.resolution,e.global.y=(o.clientY-n.top)*(this.target.height/n.height)/this.resolution,!navigator.isCocoonJS||n.left||n.top||t.target.style.width||t.target.style.height||(e.global.x=o.clientX,e.global.y=o.clientY);for(var a=0;a<this.interactiveItems.length;a++){var s=this.interactiveItems[a];s.touchmove&&s.__touchData&&s.__touchData[o.identifier]&&s.touchmove(e)}}},n.InteractionManager.prototype.onTouchStart=function(t){this.dirty&&this.rebuildInteractiveGraph();var e=this.interactionDOMElement.getBoundingClientRect();n.AUTO_PREVENT_DEFAULT&&t.preventDefault();for(var r=t.changedTouches,i=0;i<r.length;i++){var o=r[i],a=this.pool.pop();a||(a=new n.InteractionData),a.originalEvent=t,this.touches[o.identifier]=a,a.global.x=(o.clientX-e.left)*(this.target.width/e.width)/this.resolution,a.global.y=(o.clientY-e.top)*(this.target.height/e.height)/this.resolution,!navigator.isCocoonJS||e.left||e.top||t.target.style.width||t.target.style.height||(a.global.x=o.clientX,a.global.y=o.clientY);for(var s=this.interactiveItems.length,u=0;s>u;u++){var c=this.interactiveItems[u];if((c.touchstart||c.tap)&&(c.__hit=this.hitTest(c,a),c.__hit&&(c.touchstart&&c.touchstart(a),c.__isDown=!0,c.__touchData=c.__touchData||{},c.__touchData[o.identifier]=a,!c.interactiveChildren)))break}}},n.InteractionManager.prototype.onTouchEnd=function(t){this.dirty&&this.rebuildInteractiveGraph();for(var e=this.interactionDOMElement.getBoundingClientRect(),n=t.changedTouches,r=0;r<n.length;r++){var i=n[r],o=this.touches[i.identifier],a=!1;o.global.x=(i.clientX-e.left)*(this.target.width/e.width)/this.resolution,o.global.y=(i.clientY-e.top)*(this.target.height/e.height)/this.resolution,!navigator.isCocoonJS||e.left||e.top||t.target.style.width||t.target.style.height||(o.global.x=i.clientX,o.global.y=i.clientY);for(var s=this.interactiveItems.length,u=0;s>u;u++){var c=this.interactiveItems[u];c.__touchData&&c.__touchData[i.identifier]&&(c.__hit=this.hitTest(c,c.__touchData[i.identifier]),o.originalEvent=t,(c.touchend||c.tap)&&(c.__hit&&!a?(c.touchend&&c.touchend(o),c.__isDown&&c.tap&&c.tap(o),c.interactiveChildren||(a=!0)):c.__isDown&&c.touchendoutside&&c.touchendoutside(o),c.__isDown=!1),c.__touchData[i.identifier]=null)}this.pool.push(o),this.touches[i.identifier]=null}},n.InteractionManager.prototype.onTouchCancel=function(t){this.dirty&&this.rebuildInteractiveGraph();for(var e=this.interactionDOMElement.getBoundingClientRect(),n=t.changedTouches,r=0;r<n.length;r++){var i=n[r],o=this.touches[i.identifier],a=!1;o.global.x=(i.clientX-e.left)*(this.target.width/e.width)/this.resolution,o.global.y=(i.clientY-e.top)*(this.target.height/e.height)/this.resolution,!navigator.isCocoonJS||e.left||e.top||t.target.style.width||t.target.style.height||(o.global.x=i.clientX,o.global.y=i.clientY);for(var s=this.interactiveItems.length,u=0;s>u;u++){var c=this.interactiveItems[u];c.__touchData&&c.__touchData[i.identifier]&&(c.__hit=this.hitTest(c,c.__touchData[i.identifier]),o.originalEvent=t,c.touchcancel&&!a&&(c.touchcancel(o),c.interactiveChildren||(a=!0)),c.__isDown=!1,c.__touchData[i.identifier]=null)}this.pool.push(o),this.touches[i.identifier]=null}},n.Stage=function(t){n.DisplayObjectContainer.call(this),this.worldTransform=new n.Matrix,this.interactive=!0,this.interactionManager=new n.InteractionManager(this),this.dirty=!0,this.stage=this,this.stage.hitArea=new n.Rectangle(0,0,1e5,1e5),this.setBackgroundColor(t)},n.Stage.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Stage.prototype.constructor=n.Stage,n.Stage.prototype.setInteractionDelegate=function(t){this.interactionManager.setTargetDomElement(t)},n.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},n.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=n.hex2rgb(this.backgroundColor);var e=this.backgroundColor.toString(16);e="000000".substr(0,6-e.length)+e,this.backgroundColorString="#"+e},n.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},function(t){for(var e=0,n=["ms","moz","webkit","o"],r=0;r<n.length&&!t.requestAnimationFrame;++r)t.requestAnimationFrame=t[n[r]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[n[r]+"CancelAnimationFrame"]||t[n[r]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(n){var r=(new Date).getTime(),i=Math.max(0,16-(r-e)),o=t.setTimeout(function(){n(r+i)},i);return e=r+i,o}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)}),t.requestAnimFrame=t.requestAnimationFrame}(this),n.hex2rgb=function(t){return[(t>>16&255)/255,(t>>8&255)/255,(255&t)/255]},n.rgb2hex=function(t){return(255*t[0]<<16)+(255*t[1]<<8)+255*t[2]},"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){return function(t){function e(){for(var r=arguments.length,o=new Array(r);r--;)o[r]=arguments[r];return o=i.concat(o),n.apply(this instanceof e?this:t,o)}var n=this,r=arguments.length-1,i=[];if(r>0)for(i.length=r;r--;)i[r]=arguments[r+1];if("function"!=typeof n)throw new TypeError;return e.prototype=function o(t){return t&&(o.prototype=t),this instanceof o?void 0:new o}(n.prototype),e}}()),n.AjaxRequest=function(){var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var e=0;e<t.length;e++)try{return new window.ActiveXObject(t[e])}catch(n){}},n.canUseNewCanvasBlendModes=function(){if("undefined"==typeof document)return!1;var t=document.createElement("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="#000",e.fillRect(0,0,1,1),e.globalCompositeOperation="multiply",e.fillStyle="#fff",e.fillRect(0,0,1,1),0===e.getImageData(0,0,1,1).data[0]},n.getNextPowerOfTwo=function(t){if(t>0&&0===(t&t-1))return t;for(var e=1;t>e;)e<<=1;return e},n.isPowerOfTwo=function(t,e){return t>0&&0===(t&t-1)&&e>0&&0===(e&e-1)},n.EventTarget={call:function(t){t&&(t=t.prototype||t,n.EventTarget.mixin(t))},mixin:function(t){t.listeners=function(t){return this._listeners=this._listeners||{},this._listeners[t]?this._listeners[t].slice():[]},t.emit=t.dispatchEvent=function(t,e){if(this._listeners=this._listeners||{},"object"==typeof t&&(e=t,t=t.type),e&&e.__isEventObject===!0||(e=new n.Event(this,t,e)),this._listeners&&this._listeners[t]){var r,i=this._listeners[t].slice(0),o=i.length,a=i[0];for(r=0;o>r;a=i[++r])if(a.call(this,e),e.stoppedImmediate)return this;if(e.stopped)return this}return this.parent&&this.parent.emit&&this.parent.emit.call(this.parent,t,e),this},t.on=t.addEventListener=function(t,e){return this._listeners=this._listeners||{},(this._listeners[t]=this._listeners[t]||[]).push(e),this},t.once=function(t,e){function n(){e.apply(r.off(t,n),arguments)}this._listeners=this._listeners||{};var r=this;return n._originalHandler=e,this.on(t,n)},t.off=t.removeEventListener=function(t,e){if(this._listeners=this._listeners||{},!this._listeners[t])return this;for(var n=this._listeners[t],r=e?n.length:0;r-->0;)(n[r]===e||n[r]._originalHandler===e)&&n.splice(r,1);return 0===n.length&&delete this._listeners[t],this},t.removeAllListeners=function(t){return this._listeners=this._listeners||{},this._listeners[t]?(delete this._listeners[t],this):this}}},n.Event=function(t,e,n){this.__isEventObject=!0,this.stopped=!1,this.stoppedImmediate=!1,this.target=t,this.type=e,this.data=n,this.content=n,this.timeStamp=Date.now()},n.Event.prototype.stopPropagation=function(){this.stopped=!0},n.Event.prototype.stopImmediatePropagation=function(){this.stoppedImmediate=!0},n.autoDetectRenderer=function(t,e,r){t||(t=800),e||(e=600);var i=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}();return i?new n.WebGLRenderer(t,e,r):new n.CanvasRenderer(t,e,r)},n.autoDetectRecommendedRenderer=function(t,e,r){t||(t=800),e||(e=600);var i=function(){try{var t=document.createElement("canvas");return!!window.WebGLRenderingContext&&(t.getContext("webgl")||t.getContext("experimental-webgl"))}catch(e){return!1}}(),o=/Android/i.test(navigator.userAgent);return i&&!o?new n.WebGLRenderer(t,e,r):new n.CanvasRenderer(t,e,r)},n.PolyK={},n.PolyK.Triangulate=function(t){var e=!0,r=t.length>>1;if(3>r)return[];for(var i=[],o=[],a=0;r>a;a++)o.push(a);a=0;for(var s=r;s>3;){var u=o[(a+0)%s],c=o[(a+1)%s],l=o[(a+2)%s],f=t[2*u],h=t[2*u+1],p=t[2*c],d=t[2*c+1],m=t[2*l],v=t[2*l+1],g=!1;if(n.PolyK._convex(f,h,p,d,m,v,e)){g=!0;for(var y=0;s>y;y++){var b=o[y];if(b!==u&&b!==c&&b!==l&&n.PolyK._PointInTriangle(t[2*b],t[2*b+1],f,h,p,d,m,v)){g=!1;break}}}if(g)i.push(u,c,l),o.splice((a+1)%s,1),s--,a=0;else if(a++>3*s){if(!e)return null;for(i=[],o=[],a=0;r>a;a++)o.push(a);a=0,s=r,e=!1}}return i.push(o[0],o[1],o[2]),i},n.PolyK._PointInTriangle=function(t,e,n,r,i,o,a,s){var u=a-n,c=s-r,l=i-n,f=o-r,h=t-n,p=e-r,d=u*u+c*c,m=u*l+c*f,v=u*h+c*p,g=l*l+f*f,y=l*h+f*p,b=1/(d*g-m*m),_=(g*v-m*y)*b,w=(d*y-m*v)*b;return _>=0&&w>=0&&1>_+w},n.PolyK._convex=function(t,e,n,r,i,o,a){return(e-r)*(i-n)+(n-t)*(o-r)>=0===a},n.initDefaultShaders=function(){},n.CompileVertexShader=function(t,e){return n._CompileShader(t,e,t.VERTEX_SHADER)},n.CompileFragmentShader=function(t,e){return n._CompileShader(t,e,t.FRAGMENT_SHADER)},n._CompileShader=function(t,e,n){var r=e.join("\n"),i=t.createShader(n);return t.shaderSource(i,r),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(window.console.log(t.getShaderInfoLog(i)),null)},n.compileProgram=function(t,e,r){var i=n.CompileFragmentShader(t,r),o=n.CompileVertexShader(t,e),a=t.createProgram();return t.attachShader(a,o),t.attachShader(a,i),t.linkProgram(a),t.getProgramParameter(a,t.LINK_STATUS)||window.console.log("Could not initialise shaders"),a},n.PixiShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.firstRun=!0,this.dirty=!0,this.attributes=[],this.init()},n.PixiShader.prototype.constructor=n.PixiShader,n.PixiShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc||n.PixiShader.defaultVertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.dimensions=t.getUniformLocation(e,"dimensions"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(e,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var r in this.uniforms)this.uniforms[r].uniformLocation=t.getUniformLocation(e,r);this.initUniforms(),this.program=e},n.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var t,e=this.gl;for(var n in this.uniforms){t=this.uniforms[n];var r=t.type;"sampler2D"===r?(t._init=!1,null!==t.value&&this.initSampler2D(t)):"mat2"===r||"mat3"===r||"mat4"===r?(t.glMatrix=!0,t.glValueLength=1,"mat2"===r?t.glFunc=e.uniformMatrix2fv:"mat3"===r?t.glFunc=e.uniformMatrix3fv:"mat4"===r&&(t.glFunc=e.uniformMatrix4fv)):(t.glFunc=e["uniform"+r],t.glValueLength="2f"===r||"2i"===r?2:"3f"===r||"3i"===r?3:"4f"===r||"4i"===r?4:1)}},n.PixiShader.prototype.initSampler2D=function(t){if(t.value&&t.value.baseTexture&&t.value.baseTexture.hasLoaded){var e=this.gl;if(e.activeTexture(e["TEXTURE"+this.textureCount]),e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]),t.textureData){var n=t.textureData,r=n.magFilter?n.magFilter:e.LINEAR,i=n.minFilter?n.minFilter:e.LINEAR,o=n.wrapS?n.wrapS:e.CLAMP_TO_EDGE,a=n.wrapT?n.wrapT:e.CLAMP_TO_EDGE,s=n.luminance?e.LUMINANCE:e.RGBA;if(n.repeat&&(o=e.REPEAT,a=e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!!n.flipY),n.width){var u=n.width?n.width:512,c=n.height?n.height:2,l=n.border?n.border:0;e.texImage2D(e.TEXTURE_2D,0,s,u,c,l,s,e.UNSIGNED_BYTE,null)}else e.texImage2D(e.TEXTURE_2D,0,s,e.RGBA,e.UNSIGNED_BYTE,t.value.baseTexture.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,a)}e.uniform1i(t.uniformLocation,this.textureCount),t._init=!0,this.textureCount++}},n.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var t,e=this.gl;for(var r in this.uniforms)t=this.uniforms[r],1===t.glValueLength?t.glMatrix===!0?t.glFunc.call(e,t.uniformLocation,t.transpose,t.value):t.glFunc.call(e,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w):"sampler2D"===t.type&&(t._init?(e.activeTexture(e["TEXTURE"+this.textureCount]),t.value.baseTexture._dirty[e.id]?n.instances[e.id].updateTexture(t.value.baseTexture):e.bindTexture(e.TEXTURE_2D,t.value.baseTexture._glTextures[e.id]),e.uniform1i(t.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(t))},n.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},n.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"],n.PixiFastShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},n.PixiFastShader.prototype.constructor=n.PixiFastShader,n.PixiFastShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.dimensions=t.getUniformLocation(e,"dimensions"),this.uMatrix=t.getUniformLocation(e,"uMatrix"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aPositionCoord=t.getAttribLocation(e,"aPositionCoord"),this.aScale=t.getAttribLocation(e,"aScale"),this.aRotation=t.getAttribLocation(e,"aRotation"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.colorAttribute=t.getAttribLocation(e,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=e},n.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},n.StripShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},n.StripShader.prototype.constructor=n.StripShader,n.StripShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.uSampler=t.getUniformLocation(e,"uSampler"),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.aTextureCoord=t.getAttribLocation(e,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},n.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},n.PrimitiveShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},n.PrimitiveShader.prototype.constructor=n.PrimitiveShader,n.PrimitiveShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.tintColor=t.getUniformLocation(e,"tint"),this.flipY=t.getUniformLocation(e,"flipY"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.colorAttribute=t.getAttribLocation(e,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},n.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},n.ComplexPrimitiveShader=function(t){this._UID=n._UID++,this.gl=t,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},n.ComplexPrimitiveShader.prototype.constructor=n.ComplexPrimitiveShader,n.ComplexPrimitiveShader.prototype.init=function(){var t=this.gl,e=n.compileProgram(t,this.vertexSrc,this.fragmentSrc);t.useProgram(e),this.projectionVector=t.getUniformLocation(e,"projectionVector"),this.offsetVector=t.getUniformLocation(e,"offsetVector"),this.tintColor=t.getUniformLocation(e,"tint"),this.color=t.getUniformLocation(e,"color"),this.flipY=t.getUniformLocation(e,"flipY"),this.aVertexPosition=t.getAttribLocation(e,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=t.getUniformLocation(e,"translationMatrix"),this.alpha=t.getUniformLocation(e,"alpha"),this.program=e},n.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},n.WebGLGraphics=function(){},n.WebGLGraphics.renderGraphics=function(t,e){var r,i=e.gl,o=e.projection,a=e.offset,s=e.shaderManager.primitiveShader;t.dirty&&n.WebGLGraphics.updateGraphics(t,i);for(var u=t._webGL[i.id],c=0;c<u.data.length;c++)1===u.data[c].mode?(r=u.data[c],e.stencilManager.pushStencil(t,r,e),i.drawElements(i.TRIANGLE_FAN,4,i.UNSIGNED_SHORT,2*(r.indices.length-4)),e.stencilManager.popStencil(t,r,e)):(r=u.data[c],e.shaderManager.setShader(s),s=e.shaderManager.primitiveShader,i.uniformMatrix3fv(s.translationMatrix,!1,t.worldTransform.toArray(!0)),i.uniform1f(s.flipY,1),i.uniform2f(s.projectionVector,o.x,-o.y),i.uniform2f(s.offsetVector,-a.x,-a.y),i.uniform3fv(s.tintColor,n.hex2rgb(t.tint)),i.uniform1f(s.alpha,t.worldAlpha),i.bindBuffer(i.ARRAY_BUFFER,r.buffer),i.vertexAttribPointer(s.aVertexPosition,2,i.FLOAT,!1,24,0),i.vertexAttribPointer(s.colorAttribute,4,i.FLOAT,!1,24,8),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r.indexBuffer),i.drawElements(i.TRIANGLE_STRIP,r.indices.length,i.UNSIGNED_SHORT,0))},n.WebGLGraphics.updateGraphics=function(t,e){var r=t._webGL[e.id];r||(r=t._webGL[e.id]={lastIndex:0,data:[],gl:e}),t.dirty=!1;var i;if(t.clearDirty){for(t.clearDirty=!1,i=0;i<r.data.length;i++){var o=r.data[i];o.reset(),n.WebGLGraphics.graphicsDataPool.push(o)}r.data=[],r.lastIndex=0}var a;for(i=r.lastIndex;i<t.graphicsData.length;i++){var s=t.graphicsData[i];if(s.type===n.Graphics.POLY){if(s.points=s.shape.points.slice(),s.shape.closed&&(s.points[0]!==s.points[s.points.length-2]||s.points[1]!==s.points[s.points.length-1])&&s.points.push(s.points[0],s.points[1]),s.fill&&s.points.length>=6)if(s.points.length<12){a=n.WebGLGraphics.switchMode(r,0);var u=n.WebGLGraphics.buildPoly(s,a);u||(a=n.WebGLGraphics.switchMode(r,1),n.WebGLGraphics.buildComplexPoly(s,a))}else a=n.WebGLGraphics.switchMode(r,1),n.WebGLGraphics.buildComplexPoly(s,a);s.lineWidth>0&&(a=n.WebGLGraphics.switchMode(r,0),n.WebGLGraphics.buildLine(s,a))}else a=n.WebGLGraphics.switchMode(r,0),s.type===n.Graphics.RECT?n.WebGLGraphics.buildRectangle(s,a):s.type===n.Graphics.CIRC||s.type===n.Graphics.ELIP?n.WebGLGraphics.buildCircle(s,a):s.type===n.Graphics.RREC&&n.WebGLGraphics.buildRoundedRectangle(s,a);r.lastIndex++}for(i=0;i<r.data.length;i++)a=r.data[i],a.dirty&&a.upload()},n.WebGLGraphics.switchMode=function(t,e){var r;return t.data.length?(r=t.data[t.data.length-1],(r.mode!==e||1===e)&&(r=n.WebGLGraphics.graphicsDataPool.pop()||new n.WebGLGraphicsData(t.gl),r.mode=e,t.data.push(r))):(r=n.WebGLGraphics.graphicsDataPool.pop()||new n.WebGLGraphicsData(t.gl),r.mode=e,t.data.push(r)),r.dirty=!0,r},n.WebGLGraphics.buildRectangle=function(t,e){var r=t.shape,i=r.x,o=r.y,a=r.width,s=r.height;if(t.fill){var u=n.hex2rgb(t.fillColor),c=t.fillAlpha,l=u[0]*c,f=u[1]*c,h=u[2]*c,p=e.points,d=e.indices,m=p.length/6;p.push(i,o),p.push(l,f,h,c),p.push(i+a,o),p.push(l,f,h,c),p.push(i,o+s),p.push(l,f,h,c),p.push(i+a,o+s),p.push(l,f,h,c),d.push(m,m,m+1,m+2,m+3,m+3)}if(t.lineWidth){var v=t.points;t.points=[i,o,i+a,o,i+a,o+s,i,o+s,i,o],n.WebGLGraphics.buildLine(t,e),t.points=v}},n.WebGLGraphics.buildRoundedRectangle=function(t,e){var r=t.shape,i=r.x,o=r.y,a=r.width,s=r.height,u=r.radius,c=[];if(c.push(i,o+u),c=c.concat(n.WebGLGraphics.quadraticBezierCurve(i,o+s-u,i,o+s,i+u,o+s)),c=c.concat(n.WebGLGraphics.quadraticBezierCurve(i+a-u,o+s,i+a,o+s,i+a,o+s-u)),c=c.concat(n.WebGLGraphics.quadraticBezierCurve(i+a,o+u,i+a,o,i+a-u,o)),c=c.concat(n.WebGLGraphics.quadraticBezierCurve(i+u,o,i,o,i,o+u)),t.fill){var l=n.hex2rgb(t.fillColor),f=t.fillAlpha,h=l[0]*f,p=l[1]*f,d=l[2]*f,m=e.points,v=e.indices,g=m.length/6,y=n.PolyK.Triangulate(c),b=0;for(b=0;b<y.length;b+=3)v.push(y[b]+g),v.push(y[b]+g),v.push(y[b+1]+g),v.push(y[b+2]+g),v.push(y[b+2]+g);for(b=0;b<c.length;b++)m.push(c[b],c[++b],h,p,d,f)}if(t.lineWidth){var _=t.points;t.points=c,n.WebGLGraphics.buildLine(t,e),t.points=_}},n.WebGLGraphics.quadraticBezierCurve=function(t,e,n,r,i,o){function a(t,e,n){var r=e-t;return t+r*n}for(var s,u,c,l,f,h,p=20,d=[],m=0,v=0;p>=v;v++)m=v/p,s=a(t,n,m),u=a(e,r,m),c=a(n,i,m),l=a(r,o,m),f=a(s,c,m),h=a(u,l,m),d.push(f,h);return d},n.WebGLGraphics.buildCircle=function(t,e){var r,i,o=t.shape,a=o.x,s=o.y;t.type===n.Graphics.CIRC?(r=o.radius,i=o.radius):(r=o.width,i=o.height);var u=40,c=2*Math.PI/u,l=0;if(t.fill){var f=n.hex2rgb(t.fillColor),h=t.fillAlpha,p=f[0]*h,d=f[1]*h,m=f[2]*h,v=e.points,g=e.indices,y=v.length/6;for(g.push(y),l=0;u+1>l;l++)v.push(a,s,p,d,m,h),v.push(a+Math.sin(c*l)*r,s+Math.cos(c*l)*i,p,d,m,h),g.push(y++,y++);g.push(y-1)
}if(t.lineWidth){var b=t.points;for(t.points=[],l=0;u+1>l;l++)t.points.push(a+Math.sin(c*l)*r,s+Math.cos(c*l)*i);n.WebGLGraphics.buildLine(t,e),t.points=b}},n.WebGLGraphics.buildLine=function(t,e){var r=0,i=t.points;if(0!==i.length){if(t.lineWidth%2)for(r=0;r<i.length;r++)i[r]+=.5;var o=new n.Point(i[0],i[1]),a=new n.Point(i[i.length-2],i[i.length-1]);if(o.x===a.x&&o.y===a.y){i=i.slice(),i.pop(),i.pop(),a=new n.Point(i[i.length-2],i[i.length-1]);var s=a.x+.5*(o.x-a.x),u=a.y+.5*(o.y-a.y);i.unshift(s,u),i.push(s,u)}var c,l,f,h,p,d,m,v,g,y,b,_,w,x,E,C,T,S,A,k,O,M,j,R=e.points,N=e.indices,I=i.length/2,P=i.length,D=R.length/6,L=t.lineWidth/2,B=n.hex2rgb(t.lineColor),F=t.lineAlpha,U=B[0]*F,q=B[1]*F,V=B[2]*F;for(f=i[0],h=i[1],p=i[2],d=i[3],g=-(h-d),y=f-p,j=Math.sqrt(g*g+y*y),g/=j,y/=j,g*=L,y*=L,R.push(f-g,h-y,U,q,V,F),R.push(f+g,h+y,U,q,V,F),r=1;I-1>r;r++)f=i[2*(r-1)],h=i[2*(r-1)+1],p=i[2*r],d=i[2*r+1],m=i[2*(r+1)],v=i[2*(r+1)+1],g=-(h-d),y=f-p,j=Math.sqrt(g*g+y*y),g/=j,y/=j,g*=L,y*=L,b=-(d-v),_=p-m,j=Math.sqrt(b*b+_*_),b/=j,_/=j,b*=L,_*=L,E=-y+h-(-y+d),C=-g+p-(-g+f),T=(-g+f)*(-y+d)-(-g+p)*(-y+h),S=-_+v-(-_+d),A=-b+p-(-b+m),k=(-b+m)*(-_+d)-(-b+p)*(-_+v),O=E*A-S*C,Math.abs(O)<.1?(O+=10.1,R.push(p-g,d-y,U,q,V,F),R.push(p+g,d+y,U,q,V,F)):(c=(C*k-A*T)/O,l=(S*T-E*k)/O,M=(c-p)*(c-p)+(l-d)+(l-d),M>19600?(w=g-b,x=y-_,j=Math.sqrt(w*w+x*x),w/=j,x/=j,w*=L,x*=L,R.push(p-w,d-x),R.push(U,q,V,F),R.push(p+w,d+x),R.push(U,q,V,F),R.push(p-w,d-x),R.push(U,q,V,F),P++):(R.push(c,l),R.push(U,q,V,F),R.push(p-(c-p),d-(l-d)),R.push(U,q,V,F)));for(f=i[2*(I-2)],h=i[2*(I-2)+1],p=i[2*(I-1)],d=i[2*(I-1)+1],g=-(h-d),y=f-p,j=Math.sqrt(g*g+y*y),g/=j,y/=j,g*=L,y*=L,R.push(p-g,d-y),R.push(U,q,V,F),R.push(p+g,d+y),R.push(U,q,V,F),N.push(D),r=0;P>r;r++)N.push(D++);N.push(D-1)}},n.WebGLGraphics.buildComplexPoly=function(t,e){var r=t.points.slice();if(!(r.length<6)){var i=e.indices;e.points=r,e.alpha=t.fillAlpha,e.color=n.hex2rgb(t.fillColor);for(var o,a,s=1/0,u=-1/0,c=1/0,l=-1/0,f=0;f<r.length;f+=2)o=r[f],a=r[f+1],s=s>o?o:s,u=o>u?o:u,c=c>a?a:c,l=a>l?a:l;r.push(s,c,u,c,u,l,s,l);var h=r.length/2;for(f=0;h>f;f++)i.push(f)}},n.WebGLGraphics.buildPoly=function(t,e){var r=t.points;if(!(r.length<6)){var i=e.points,o=e.indices,a=r.length/2,s=n.hex2rgb(t.fillColor),u=t.fillAlpha,c=s[0]*u,l=s[1]*u,f=s[2]*u,h=n.PolyK.Triangulate(r);if(!h)return!1;var p=i.length/6,d=0;for(d=0;d<h.length;d+=3)o.push(h[d]+p),o.push(h[d]+p),o.push(h[d+1]+p),o.push(h[d+2]+p),o.push(h[d+2]+p);for(d=0;a>d;d++)i.push(r[2*d],r[2*d+1],c,l,f,u);return!0}},n.WebGLGraphics.graphicsDataPool=[],n.WebGLGraphicsData=function(t){this.gl=t,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},n.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[]},n.WebGLGraphicsData.prototype.upload=function(){var t=this.gl;this.glPoints=new n.Float32Array(this.points),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW),this.glIndicies=new n.Uint16Array(this.indices),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndicies,t.STATIC_DRAW),this.dirty=!1},n.glContexts=[],n.instances=[],n.WebGLRenderer=function(t,e,r){if(r)for(var i in n.defaultRenderOptions)"undefined"==typeof r[i]&&(r[i]=n.defaultRenderOptions[i]);else r=n.defaultRenderOptions;n.defaultRenderer||(n.sayHello("webGL"),n.defaultRenderer=this),this.type=n.WEBGL_RENDERER,this.resolution=r.resolution,this.transparent=r.transparent,this.autoResize=r.autoResize||!1,this.preserveDrawingBuffer=r.preserveDrawingBuffer,this.clearBeforeRender=r.clearBeforeRender,this.width=t||800,this.height=e||600,this.view=r.view||document.createElement("canvas"),this.contextLostBound=this.handleContextLost.bind(this),this.contextRestoredBound=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.contextLostBound,!1),this.view.addEventListener("webglcontextrestored",this.contextRestoredBound,!1),this._contextOptions={alpha:this.transparent,antialias:r.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:r.preserveDrawingBuffer},this.projection=new n.Point,this.offset=new n.Point(0,0),this.shaderManager=new n.WebGLShaderManager,this.spriteBatch=new n.WebGLSpriteBatch,this.maskManager=new n.WebGLMaskManager,this.filterManager=new n.WebGLFilterManager,this.stencilManager=new n.WebGLStencilManager,this.blendModeManager=new n.WebGLBlendModeManager,this.renderSession={},this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,this.renderSession.renderer=this,this.renderSession.resolution=this.resolution,this.initContext(),this.mapBlendModes()},n.WebGLRenderer.prototype.constructor=n.WebGLRenderer,n.WebGLRenderer.prototype.initContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=t,!t)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=t.id=n.WebGLRenderer.glContextId++,n.glContexts[this.glContextId]=t,n.instances[this.glContextId]=this,t.disable(t.DEPTH_TEST),t.disable(t.CULL_FACE),t.enable(t.BLEND),this.shaderManager.setContext(t),this.spriteBatch.setContext(t),this.maskManager.setContext(t),this.filterManager.setContext(t),this.blendModeManager.setContext(t),this.stencilManager.setContext(t),this.renderSession.gl=this.gl,this.resize(this.width,this.height)},n.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(t.interactive&&t.interactionManager.removeEvents(),this.__stage=t),t.updateTransform();var e=this.gl;t._interactive?t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)):t._interactiveEventsAdded&&(t._interactiveEventsAdded=!1,t.interactionManager.setTarget(this)),e.viewport(0,0,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,null),this.clearBeforeRender&&(this.transparent?e.clearColor(0,0,0,0):e.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],1),e.clear(e.COLOR_BUFFER_BIT)),this.renderDisplayObject(t,this.projection)}},n.WebGLRenderer.prototype.renderDisplayObject=function(t,e,r){this.renderSession.blendModeManager.setBlendMode(n.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.flipY=r?-1:1,this.renderSession.projection=e,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,r),t._renderWebGL(this.renderSession),this.spriteBatch.end()},n.WebGLRenderer.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2/this.resolution,this.projection.y=-this.height/2/this.resolution},n.WebGLRenderer.prototype.updateTexture=function(t){if(t.hasLoaded){var e=this.gl;return t._glTextures[e.id]||(t._glTextures[e.id]=e.createTexture()),e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===n.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t.mipmap&&n.isPowerOfTwo(t.width,t.height)?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===n.scaleModes.LINEAR?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST),e.generateMipmap(e.TEXTURE_2D)):e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===n.scaleModes.LINEAR?e.LINEAR:e.NEAREST),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),t._dirty[e.id]=!1,t._glTextures[e.id]}},n.WebGLRenderer.prototype.handleContextLost=function(t){t.preventDefault(),this.contextLost=!0},n.WebGLRenderer.prototype.handleContextRestored=function(){this.initContext();for(var t in n.TextureCache){var e=n.TextureCache[t].baseTexture;e._glTextures=[]}this.contextLost=!1},n.WebGLRenderer.prototype.destroy=function(){this.view.removeEventListener("webglcontextlost",this.contextLostBound),this.view.removeEventListener("webglcontextrestored",this.contextRestoredBound),n.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null},n.WebGLRenderer.prototype.mapBlendModes=function(){var t=this.gl;n.blendModesWebGL||(n.blendModesWebGL=[],n.blendModesWebGL[n.blendModes.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.ADD]=[t.SRC_ALPHA,t.DST_ALPHA],n.blendModesWebGL[n.blendModes.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SCREEN]=[t.SRC_ALPHA,t.ONE],n.blendModesWebGL[n.blendModes.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],n.blendModesWebGL[n.blendModes.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA])},n.WebGLRenderer.glContextId=0,n.WebGLBlendModeManager=function(){this.currentBlendMode=99999},n.WebGLBlendModeManager.prototype.constructor=n.WebGLBlendModeManager,n.WebGLBlendModeManager.prototype.setContext=function(t){this.gl=t},n.WebGLBlendModeManager.prototype.setBlendMode=function(t){if(this.currentBlendMode===t)return!1;this.currentBlendMode=t;var e=n.blendModesWebGL[this.currentBlendMode];return this.gl.blendFunc(e[0],e[1]),!0},n.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},n.WebGLMaskManager=function(){},n.WebGLMaskManager.prototype.constructor=n.WebGLMaskManager,n.WebGLMaskManager.prototype.setContext=function(t){this.gl=t},n.WebGLMaskManager.prototype.pushMask=function(t,e){var r=e.gl;t.dirty&&n.WebGLGraphics.updateGraphics(t,r),t._webGL[r.id].data.length&&e.stencilManager.pushStencil(t,t._webGL[r.id].data[0],e)},n.WebGLMaskManager.prototype.popMask=function(t,e){var n=this.gl;e.stencilManager.popStencil(t,t._webGL[n.id].data[0],e)},n.WebGLMaskManager.prototype.destroy=function(){this.gl=null},n.WebGLStencilManager=function(){this.stencilStack=[],this.reverse=!0,this.count=0},n.WebGLStencilManager.prototype.setContext=function(t){this.gl=t},n.WebGLStencilManager.prototype.pushStencil=function(t,e,n){var r=this.gl;this.bindGraphics(t,e,n),0===this.stencilStack.length&&(r.enable(r.STENCIL_TEST),r.clear(r.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(e);var i=this.count;r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.ALWAYS,0,255),r.stencilOp(r.KEEP,r.KEEP,r.INVERT),1===e.mode?(r.drawElements(r.TRIANGLE_FAN,e.indices.length-4,r.UNSIGNED_SHORT,0),this.reverse?(r.stencilFunc(r.EQUAL,255-i,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,i,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(e.indices.length-4)),this.reverse?r.stencilFunc(r.EQUAL,255-(i+1),255):r.stencilFunc(r.EQUAL,i+1,255),this.reverse=!this.reverse):(this.reverse?(r.stencilFunc(r.EQUAL,i,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,255-i,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_STRIP,e.indices.length,r.UNSIGNED_SHORT,0),this.reverse?r.stencilFunc(r.EQUAL,i+1,255):r.stencilFunc(r.EQUAL,255-(i+1),255)),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),this.count++},n.WebGLStencilManager.prototype.bindGraphics=function(t,e,r){this._currentGraphics=t;var i,o=this.gl,a=r.projection,s=r.offset;1===e.mode?(i=r.shaderManager.complexPrimitiveShader,r.shaderManager.setShader(i),o.uniform1f(i.flipY,r.flipY),o.uniformMatrix3fv(i.translationMatrix,!1,t.worldTransform.toArray(!0)),o.uniform2f(i.projectionVector,a.x,-a.y),o.uniform2f(i.offsetVector,-s.x,-s.y),o.uniform3fv(i.tintColor,n.hex2rgb(t.tint)),o.uniform3fv(i.color,e.color),o.uniform1f(i.alpha,t.worldAlpha*e.alpha),o.bindBuffer(o.ARRAY_BUFFER,e.buffer),o.vertexAttribPointer(i.aVertexPosition,2,o.FLOAT,!1,8,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e.indexBuffer)):(i=r.shaderManager.primitiveShader,r.shaderManager.setShader(i),o.uniformMatrix3fv(i.translationMatrix,!1,t.worldTransform.toArray(!0)),o.uniform1f(i.flipY,r.flipY),o.uniform2f(i.projectionVector,a.x,-a.y),o.uniform2f(i.offsetVector,-s.x,-s.y),o.uniform3fv(i.tintColor,n.hex2rgb(t.tint)),o.uniform1f(i.alpha,t.worldAlpha),o.bindBuffer(o.ARRAY_BUFFER,e.buffer),o.vertexAttribPointer(i.aVertexPosition,2,o.FLOAT,!1,24,0),o.vertexAttribPointer(i.colorAttribute,4,o.FLOAT,!1,24,8),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e.indexBuffer))},n.WebGLStencilManager.prototype.popStencil=function(t,e,n){var r=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)r.disable(r.STENCIL_TEST);else{var i=this.count;this.bindGraphics(t,e,n),r.colorMask(!1,!1,!1,!1),1===e.mode?(this.reverse=!this.reverse,this.reverse?(r.stencilFunc(r.EQUAL,255-(i+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)):(r.stencilFunc(r.EQUAL,i+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)),r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,2*(e.indices.length-4)),r.stencilFunc(r.ALWAYS,0,255),r.stencilOp(r.KEEP,r.KEEP,r.INVERT),r.drawElements(r.TRIANGLE_FAN,e.indices.length-4,r.UNSIGNED_SHORT,0),this.reverse?r.stencilFunc(r.EQUAL,i,255):r.stencilFunc(r.EQUAL,255-i,255)):(this.reverse?(r.stencilFunc(r.EQUAL,i+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR)):(r.stencilFunc(r.EQUAL,255-(i+1),255),r.stencilOp(r.KEEP,r.KEEP,r.INCR)),r.drawElements(r.TRIANGLE_STRIP,e.indices.length,r.UNSIGNED_SHORT,0),this.reverse?r.stencilFunc(r.EQUAL,i,255):r.stencilFunc(r.EQUAL,255-i,255)),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}},n.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null,this.gl=null},n.WebGLShaderManager=function(){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var t=0;t<this.maxAttibs;t++)this.attribState[t]=!1;this.stack=[]},n.WebGLShaderManager.prototype.constructor=n.WebGLShaderManager,n.WebGLShaderManager.prototype.setContext=function(t){this.gl=t,this.primitiveShader=new n.PrimitiveShader(t),this.complexPrimitiveShader=new n.ComplexPrimitiveShader(t),this.defaultShader=new n.PixiShader(t),this.fastShader=new n.PixiFastShader(t),this.stripShader=new n.StripShader(t),this.setShader(this.defaultShader)},n.WebGLShaderManager.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++)this.tempAttribState[e]=!1;for(e=0;e<t.length;e++){var n=t[e];this.tempAttribState[n]=!0}var r=this.gl;for(e=0;e<this.attribState.length;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?r.enableVertexAttribArray(e):r.disableVertexAttribArray(e))},n.WebGLShaderManager.prototype.setShader=function(t){return this._currentId===t._UID?!1:(this._currentId=t._UID,this.currentShader=t,this.gl.useProgram(t.program),this.setAttribs(t.attributes),!0)},n.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},n.WebGLSpriteBatch=function(){this.vertSize=5,this.size=2e3;var t=4*this.size*4*this.vertSize,e=6*this.size;this.vertices=new n.ArrayBuffer(t),this.positions=new n.Float32Array(this.vertices),this.colors=new n.Uint32Array(this.vertices),this.indices=new n.Uint16Array(e),this.lastIndexCount=0;for(var r=0,i=0;e>r;r+=6,i+=4)this.indices[r+0]=i+0,this.indices[r+1]=i+1,this.indices[r+2]=i+2,this.indices[r+3]=i+0,this.indices[r+4]=i+2,this.indices[r+5]=i+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.dirty=!0,this.textures=[],this.blendModes=[],this.shaders=[],this.sprites=[],this.defaultShader=new n.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])},n.WebGLSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),this.currentBlendMode=99999;var e=new n.PixiShader(t);e.fragmentSrc=this.defaultShader.fragmentSrc,e.uniforms={},e.init(),this.defaultShader.shaders[t.id]=e},n.WebGLSpriteBatch.prototype.begin=function(t){this.renderSession=t,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},n.WebGLSpriteBatch.prototype.end=function(){this.flush()},n.WebGLSpriteBatch.prototype.render=function(t){var e=t.texture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=e.baseTexture);var n=e._uvs;if(n){var r,i,o,a,s=t.anchor.x,u=t.anchor.y;if(e.trim){var c=e.trim;i=c.x-s*c.width,r=i+e.crop.width,a=c.y-u*c.height,o=a+e.crop.height}else r=e.frame.width*(1-s),i=e.frame.width*-s,o=e.frame.height*(1-u),a=e.frame.height*-u;var l=4*this.currentBatchSize*this.vertSize,f=e.baseTexture.resolution,h=t.worldTransform,p=h.a/f,d=h.b/f,m=h.c/f,v=h.d/f,g=h.tx,y=h.ty,b=this.colors,_=this.positions;this.renderSession.roundPixels?(_[l]=p*i+m*a+g|0,_[l+1]=v*a+d*i+y|0,_[l+5]=p*r+m*a+g|0,_[l+6]=v*a+d*r+y|0,_[l+10]=p*r+m*o+g|0,_[l+11]=v*o+d*r+y|0,_[l+15]=p*i+m*o+g|0,_[l+16]=v*o+d*i+y|0):(_[l]=p*i+m*a+g,_[l+1]=v*a+d*i+y,_[l+5]=p*r+m*a+g,_[l+6]=v*a+d*r+y,_[l+10]=p*r+m*o+g,_[l+11]=v*o+d*r+y,_[l+15]=p*i+m*o+g,_[l+16]=v*o+d*i+y),_[l+2]=n.x0,_[l+3]=n.y0,_[l+7]=n.x1,_[l+8]=n.y1,_[l+12]=n.x2,_[l+13]=n.y2,_[l+17]=n.x3,_[l+18]=n.y3;var w=t.tint;b[l+4]=b[l+9]=b[l+14]=b[l+19]=(w>>16)+(65280&w)+((255&w)<<16)+(255*t.worldAlpha<<24),this.sprites[this.currentBatchSize++]=t}},n.WebGLSpriteBatch.prototype.renderTilingSprite=function(t){var e=t.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=e.baseTexture),t._uvs||(t._uvs=new n.TextureUvs);var r=t._uvs;t.tilePosition.x%=e.baseTexture.width*t.tileScaleOffset.x,t.tilePosition.y%=e.baseTexture.height*t.tileScaleOffset.y;var i=t.tilePosition.x/(e.baseTexture.width*t.tileScaleOffset.x),o=t.tilePosition.y/(e.baseTexture.height*t.tileScaleOffset.y),a=t.width/e.baseTexture.width/(t.tileScale.x*t.tileScaleOffset.x),s=t.height/e.baseTexture.height/(t.tileScale.y*t.tileScaleOffset.y);r.x0=0-i,r.y0=0-o,r.x1=1*a-i,r.y1=0-o,r.x2=1*a-i,r.y2=1*s-o,r.x3=0-i,r.y3=1*s-o;var u=t.tint,c=(u>>16)+(65280&u)+((255&u)<<16)+(255*t.alpha<<24),l=this.positions,f=this.colors,h=t.width,p=t.height,d=t.anchor.x,m=t.anchor.y,v=h*(1-d),g=h*-d,y=p*(1-m),b=p*-m,_=4*this.currentBatchSize*this.vertSize,w=e.baseTexture.resolution,x=t.worldTransform,E=x.a/w,C=x.b/w,T=x.c/w,S=x.d/w,A=x.tx,k=x.ty;l[_++]=E*g+T*b+A,l[_++]=S*b+C*g+k,l[_++]=r.x0,l[_++]=r.y0,f[_++]=c,l[_++]=E*v+T*b+A,l[_++]=S*b+C*v+k,l[_++]=r.x1,l[_++]=r.y1,f[_++]=c,l[_++]=E*v+T*y+A,l[_++]=S*y+C*v+k,l[_++]=r.x2,l[_++]=r.y2,f[_++]=c,l[_++]=E*g+T*y+A,l[_++]=S*y+C*g+k,l[_++]=r.x3,l[_++]=r.y3,f[_++]=c,this.sprites[this.currentBatchSize++]=t},n.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t,e=this.gl;if(this.dirty){this.dirty=!1,e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t=this.defaultShader.shaders[e.id];var r=4*this.vertSize;e.vertexAttribPointer(t.aVertexPosition,2,e.FLOAT,!1,r,0),e.vertexAttribPointer(t.aTextureCoord,2,e.FLOAT,!1,r,8),e.vertexAttribPointer(t.colorAttribute,4,e.UNSIGNED_BYTE,!0,r,16)}if(this.currentBatchSize>.5*this.size)e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);else{var i=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize);e.bufferSubData(e.ARRAY_BUFFER,0,i)}for(var o,a,s,u,c=0,l=0,f=null,h=this.renderSession.blendModeManager.currentBlendMode,p=null,d=!1,m=!1,v=0,g=this.currentBatchSize;g>v;v++){if(u=this.sprites[v],o=u.texture.baseTexture,a=u.blendMode,s=u.shader||this.defaultShader,d=h!==a,m=p!==s,(f!==o||d||m)&&(this.renderBatch(f,c,l),l=v,c=0,f=o,d&&(h=a,this.renderSession.blendModeManager.setBlendMode(h)),m)){p=s,t=p.shaders[e.id],t||(t=new n.PixiShader(e),t.fragmentSrc=p.fragmentSrc,t.uniforms=p.uniforms,t.init(),p.shaders[e.id]=t),this.renderSession.shaderManager.setShader(t),t.dirty&&t.syncUniforms();var y=this.renderSession.projection;e.uniform2f(t.projectionVector,y.x,y.y);var b=this.renderSession.offset;e.uniform2f(t.offsetVector,b.x,b.y)}c++}this.renderBatch(f,c,l),this.currentBatchSize=0}},n.WebGLSpriteBatch.prototype.renderBatch=function(t,e,n){if(0!==e){var r=this.gl;t._dirty[r.id]?this.renderSession.renderer.updateTexture(t):r.bindTexture(r.TEXTURE_2D,t._glTextures[r.id]),r.drawElements(r.TRIANGLES,6*e,r.UNSIGNED_SHORT,6*n*2),this.renderSession.drawCount++}},n.WebGLSpriteBatch.prototype.stop=function(){this.flush(),this.dirty=!0},n.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},n.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},n.WebGLFastSpriteBatch=function(t){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var e=4*this.size*this.vertSize,r=6*this.maxSize;this.vertices=new n.Float32Array(e),this.indices=new n.Uint16Array(r),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var i=0,o=0;r>i;i+=6,o+=4)this.indices[i+0]=o+0,this.indices[i+1]=o+1,this.indices[i+2]=o+2,this.indices[i+3]=o+0,this.indices[i+4]=o+2,this.indices[i+5]=o+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(t)},n.WebGLFastSpriteBatch.prototype.constructor=n.WebGLFastSpriteBatch,n.WebGLFastSpriteBatch.prototype.setContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW)},n.WebGLFastSpriteBatch.prototype.begin=function(t,e){this.renderSession=e,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=t.worldTransform.toArray(!0),this.start()},n.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},n.WebGLFastSpriteBatch.prototype.render=function(t){var e=t.children,n=e[0];if(n.texture._uvs){this.currentBaseTexture=n.texture.baseTexture,n.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(n.blendMode));for(var r=0,i=e.length;i>r;r++)this.renderSprite(e[r]);this.flush()}},n.WebGLFastSpriteBatch.prototype.renderSprite=function(t){if(t.visible&&(t.texture.baseTexture===this.currentBaseTexture||(this.flush(),this.currentBaseTexture=t.texture.baseTexture,t.texture._uvs))){var e,n,r,i,o,a,s,u,c=this.vertices;if(e=t.texture._uvs,n=t.texture.frame.width,r=t.texture.frame.height,t.texture.trim){var l=t.texture.trim;o=l.x-t.anchor.x*l.width,i=o+t.texture.crop.width,s=l.y-t.anchor.y*l.height,a=s+t.texture.crop.height}else i=t.texture.frame.width*(1-t.anchor.x),o=t.texture.frame.width*-t.anchor.x,a=t.texture.frame.height*(1-t.anchor.y),s=t.texture.frame.height*-t.anchor.y;u=4*this.currentBatchSize*this.vertSize,c[u++]=o,c[u++]=s,c[u++]=t.position.x,c[u++]=t.position.y,c[u++]=t.scale.x,c[u++]=t.scale.y,c[u++]=t.rotation,c[u++]=e.x0,c[u++]=e.y1,c[u++]=t.alpha,c[u++]=i,c[u++]=s,c[u++]=t.position.x,c[u++]=t.position.y,c[u++]=t.scale.x,c[u++]=t.scale.y,c[u++]=t.rotation,c[u++]=e.x1,c[u++]=e.y1,c[u++]=t.alpha,c[u++]=i,c[u++]=a,c[u++]=t.position.x,c[u++]=t.position.y,c[u++]=t.scale.x,c[u++]=t.scale.y,c[u++]=t.rotation,c[u++]=e.x2,c[u++]=e.y2,c[u++]=t.alpha,c[u++]=o,c[u++]=a,c[u++]=t.position.x,c[u++]=t.position.y,c[u++]=t.scale.x,c[u++]=t.scale.y,c[u++]=t.rotation,c[u++]=e.x3,c[u++]=e.y3,c[u++]=t.alpha,this.currentBatchSize++,this.currentBatchSize>=this.size&&this.flush()}},n.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var t=this.gl;if(this.currentBaseTexture._glTextures[t.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,t),t.bindTexture(t.TEXTURE_2D,this.currentBaseTexture._glTextures[t.id]),this.currentBatchSize>.5*this.size)t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);else{var e=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);t.bufferSubData(t.ARRAY_BUFFER,0,e)}t.drawElements(t.TRIANGLES,6*this.currentBatchSize,t.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},n.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},n.WebGLFastSpriteBatch.prototype.start=function(){var t=this.gl;t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.renderSession.projection;t.uniform2f(this.shader.projectionVector,e.x,e.y),t.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var n=4*this.vertSize;t.vertexAttribPointer(this.shader.aVertexPosition,2,t.FLOAT,!1,n,0),t.vertexAttribPointer(this.shader.aPositionCoord,2,t.FLOAT,!1,n,8),t.vertexAttribPointer(this.shader.aScale,2,t.FLOAT,!1,n,16),t.vertexAttribPointer(this.shader.aRotation,1,t.FLOAT,!1,n,24),t.vertexAttribPointer(this.shader.aTextureCoord,2,t.FLOAT,!1,n,28),t.vertexAttribPointer(this.shader.colorAttribute,1,t.FLOAT,!1,n,36)},n.WebGLFilterManager=function(){this.filterStack=[],this.offsetX=0,this.offsetY=0},n.WebGLFilterManager.prototype.constructor=n.WebGLFilterManager,n.WebGLFilterManager.prototype.setContext=function(t){this.gl=t,this.texturePool=[],this.initShaderBuffers()},n.WebGLFilterManager.prototype.begin=function(t,e){this.renderSession=t,this.defaultShader=t.shaderManager.defaultShader;var n=this.renderSession.projection;this.width=2*n.x,this.height=2*-n.y,this.buffer=e},n.WebGLFilterManager.prototype.pushFilter=function(t){var e=this.gl,r=this.renderSession.projection,i=this.renderSession.offset;t._filterArea=t.target.filterArea||t.target.getBounds(),this.filterStack.push(t);var o=t.filterPasses[0];this.offsetX+=t._filterArea.x,this.offsetY+=t._filterArea.y;var a=this.texturePool.pop();a?a.resize(this.width,this.height):a=new n.FilterTexture(this.gl,this.width,this.height),e.bindTexture(e.TEXTURE_2D,a.texture);var s=t._filterArea,u=o.padding;s.x-=u,s.y-=u,s.width+=2*u,s.height+=2*u,s.x<0&&(s.x=0),s.width>this.width&&(s.width=this.width),s.y<0&&(s.y=0),s.height>this.height&&(s.height=this.height),e.bindFramebuffer(e.FRAMEBUFFER,a.frameBuffer),e.viewport(0,0,s.width,s.height),r.x=s.width/2,r.y=-s.height/2,i.x=-s.x,i.y=-s.y,e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),t._glFilterTexture=a},n.WebGLFilterManager.prototype.popFilter=function(){var t=this.gl,e=this.filterStack.pop(),r=e._filterArea,i=e._glFilterTexture,o=this.renderSession.projection,a=this.renderSession.offset;if(e.filterPasses.length>1){t.viewport(0,0,r.width,r.height),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=r.height,this.vertexArray[2]=r.width,this.vertexArray[3]=r.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=r.width,this.vertexArray[7]=0,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=r.width/this.width,this.uvArray[5]=r.height/this.height,this.uvArray[6]=r.width/this.width,this.uvArray[7]=r.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray);var s=i,u=this.texturePool.pop();u||(u=new n.FilterTexture(this.gl,this.width,this.height)),u.resize(this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,u.frameBuffer),t.clear(t.COLOR_BUFFER_BIT),t.disable(t.BLEND);for(var c=0;c<e.filterPasses.length-1;c++){var l=e.filterPasses[c];t.bindFramebuffer(t.FRAMEBUFFER,u.frameBuffer),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,s.texture),this.applyFilterPass(l,r,r.width,r.height);var f=s;s=u,u=f}t.enable(t.BLEND),i=s,this.texturePool.push(u)}var h=e.filterPasses[e.filterPasses.length-1];this.offsetX-=r.x,this.offsetY-=r.y;var p=this.width,d=this.height,m=0,v=0,g=this.buffer;if(0===this.filterStack.length)t.colorMask(!0,!0,!0,!0);else{var y=this.filterStack[this.filterStack.length-1];r=y._filterArea,p=r.width,d=r.height,m=r.x,v=r.y,g=y._glFilterTexture.frameBuffer}o.x=p/2,o.y=-d/2,a.x=m,a.y=v,r=e._filterArea;var b=r.x-m,_=r.y-v;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=b,this.vertexArray[1]=_+r.height,this.vertexArray[2]=b+r.width,this.vertexArray[3]=_+r.height,this.vertexArray[4]=b,this.vertexArray[5]=_,this.vertexArray[6]=b+r.width,this.vertexArray[7]=_,t.bufferSubData(t.ARRAY_BUFFER,0,this.vertexArray),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=r.width/this.width,this.uvArray[5]=r.height/this.height,this.uvArray[6]=r.width/this.width,this.uvArray[7]=r.height/this.height,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvArray),t.viewport(0,0,p*this.renderSession.resolution,d*this.renderSession.resolution),t.bindFramebuffer(t.FRAMEBUFFER,g),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,i.texture),this.applyFilterPass(h,r,p,d),this.texturePool.push(i),e._glFilterTexture=null},n.WebGLFilterManager.prototype.applyFilterPass=function(t,e,r,i){var o=this.gl,a=t.shaders[o.id];a||(a=new n.PixiShader(o),a.fragmentSrc=t.fragmentSrc,a.uniforms=t.uniforms,a.init(),t.shaders[o.id]=a),this.renderSession.shaderManager.setShader(a),o.uniform2f(a.projectionVector,r/2,-i/2),o.uniform2f(a.offsetVector,0,0),t.uniforms.dimensions&&(t.uniforms.dimensions.value[0]=this.width,t.uniforms.dimensions.value[1]=this.height,t.uniforms.dimensions.value[2]=this.vertexArray[0],t.uniforms.dimensions.value[3]=this.vertexArray[5]),a.syncUniforms(),o.bindBuffer(o.ARRAY_BUFFER,this.vertexBuffer),o.vertexAttribPointer(a.aVertexPosition,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,this.uvBuffer),o.vertexAttribPointer(a.aTextureCoord,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ARRAY_BUFFER,this.colorBuffer),o.vertexAttribPointer(a.colorAttribute,2,o.FLOAT,!1,0,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.indexBuffer),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0),this.renderSession.drawCount++},n.WebGLFilterManager.prototype.initShaderBuffers=function(){var t=this.gl;this.vertexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.vertexArray=new n.Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertexArray,t.STATIC_DRAW),this.uvArray=new n.Float32Array([0,0,1,0,0,1,1,1]),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvArray,t.STATIC_DRAW),this.colorArray=new n.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colorArray,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),t.STATIC_DRAW)
},n.WebGLFilterManager.prototype.destroy=function(){var t=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var e=0;e<this.texturePool.length;e++)this.texturePool[e].destroy();this.texturePool=null,t.deleteBuffer(this.vertexBuffer),t.deleteBuffer(this.uvBuffer),t.deleteBuffer(this.colorBuffer),t.deleteBuffer(this.indexBuffer)},n.FilterTexture=function(t,e,r,i){this.gl=t,this.frameBuffer=t.createFramebuffer(),this.texture=t.createTexture(),i=i||n.scaleModes.DEFAULT,t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i===n.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i===n.scaleModes.LINEAR?t.LINEAR:t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),this.renderBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.renderBuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.renderBuffer),this.resize(e,r)},n.FilterTexture.prototype.constructor=n.FilterTexture,n.FilterTexture.prototype.clear=function(){var t=this.gl;t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT)},n.FilterTexture.prototype.resize=function(t,e){if(this.width!==t||this.height!==e){this.width=t,this.height=e;var n=this.gl;n.bindTexture(n.TEXTURE_2D,this.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t,e,0,n.RGBA,n.UNSIGNED_BYTE,null),n.bindRenderbuffer(n.RENDERBUFFER,this.renderBuffer),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t,e)}},n.FilterTexture.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer),t.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},n.CanvasBuffer=function(t,e){this.width=t,this.height=e,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=t,this.canvas.height=e},n.CanvasBuffer.prototype.constructor=n.CanvasBuffer,n.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height)},n.CanvasBuffer.prototype.resize=function(t,e){this.width=this.canvas.width=t,this.height=this.canvas.height=e},n.CanvasMaskManager=function(){},n.CanvasMaskManager.prototype.constructor=n.CanvasMaskManager,n.CanvasMaskManager.prototype.pushMask=function(t,e){var r=e.context;r.save();var i=t.alpha,o=t.worldTransform,a=e.resolution;r.setTransform(o.a*a,o.b*a,o.c*a,o.d*a,o.tx*a,o.ty*a),n.CanvasGraphics.renderGraphicsMask(t,r),r.clip(),t.worldAlpha=i},n.CanvasMaskManager.prototype.popMask=function(t){t.context.restore()},n.CanvasTinter=function(){},n.CanvasTinter.getTintedTexture=function(t,e){var r=t.texture;e=n.CanvasTinter.roundColor(e);var i="#"+("00000"+(0|e).toString(16)).substr(-6);if(r.tintCache=r.tintCache||{},r.tintCache[i])return r.tintCache[i];var o=n.CanvasTinter.canvas||document.createElement("canvas");if(n.CanvasTinter.tintMethod(r,e,o),n.CanvasTinter.convertTintToImage){var a=new Image;a.src=o.toDataURL(),r.tintCache[i]=a}else r.tintCache[i]=o,n.CanvasTinter.canvas=null;return o},n.CanvasTinter.tintWithMultiply=function(t,e,n){var r=n.getContext("2d"),i=t.crop;n.width=i.width,n.height=i.height,r.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="multiply",r.drawImage(t.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height),r.globalCompositeOperation="destination-atop",r.drawImage(t.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height)},n.CanvasTinter.tintWithOverlay=function(t,e,n){var r=n.getContext("2d"),i=t.crop;n.width=i.width,n.height=i.height,r.globalCompositeOperation="copy",r.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),r.fillRect(0,0,i.width,i.height),r.globalCompositeOperation="destination-atop",r.drawImage(t.baseTexture.source,i.x,i.y,i.width,i.height,0,0,i.width,i.height)},n.CanvasTinter.tintWithPerPixel=function(t,e,r){var i=r.getContext("2d"),o=t.crop;r.width=o.width,r.height=o.height,i.globalCompositeOperation="copy",i.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height);for(var a=n.hex2rgb(e),s=a[0],u=a[1],c=a[2],l=i.getImageData(0,0,o.width,o.height),f=l.data,h=0;h<f.length;h+=4)f[h+0]*=s,f[h+1]*=u,f[h+2]*=c;i.putImageData(l,0,0)},n.CanvasTinter.roundColor=function(t){var e=n.CanvasTinter.cacheStepsPerColorChannel,r=n.hex2rgb(t);return r[0]=Math.min(255,r[0]/e*e),r[1]=Math.min(255,r[1]/e*e),r[2]=Math.min(255,r[2]/e*e),n.rgb2hex(r)},n.CanvasTinter.cacheStepsPerColorChannel=8,n.CanvasTinter.convertTintToImage=!1,n.CanvasTinter.canUseMultiply=n.canUseNewCanvasBlendModes(),n.CanvasTinter.tintMethod=n.CanvasTinter.canUseMultiply?n.CanvasTinter.tintWithMultiply:n.CanvasTinter.tintWithPerPixel,n.CanvasRenderer=function(t,e,r){if(r)for(var i in n.defaultRenderOptions)"undefined"==typeof r[i]&&(r[i]=n.defaultRenderOptions[i]);else r=n.defaultRenderOptions;n.defaultRenderer||(n.sayHello("Canvas"),n.defaultRenderer=this),this.type=n.CANVAS_RENDERER,this.resolution=r.resolution,this.clearBeforeRender=r.clearBeforeRender,this.transparent=r.transparent,this.autoResize=r.autoResize||!1,this.width=t||800,this.height=e||600,this.width*=this.resolution,this.height*=this.resolution,this.view=r.view||document.createElement("canvas"),this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.view.width=this.width*this.resolution,this.view.height=this.height*this.resolution,this.count=0,this.maskManager=new n.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1},this.mapBlendModes(),this.resize(t,e),"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="msImageSmoothingEnabled")},n.CanvasRenderer.prototype.constructor=n.CanvasRenderer,n.CanvasRenderer.prototype.render=function(t){t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.renderSession.currentBlendMode=n.blendModes.NORMAL,this.context.globalCompositeOperation=n.blendModesCanvas[n.blendModes.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=t.backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this)))},n.CanvasRenderer.prototype.destroy=function(t){"undefined"==typeof t&&(t=!0),t&&this.view.parent&&this.view.parent.removeChild(this.view),this.view=null,this.context=null,this.maskManager=null,this.renderSession=null},n.CanvasRenderer.prototype.resize=function(t,e){this.width=t*this.resolution,this.height=e*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},n.CanvasRenderer.prototype.renderDisplayObject=function(t,e){this.renderSession.context=e||this.context,this.renderSession.resolution=this.resolution,t._renderCanvas(this.renderSession)},n.CanvasRenderer.prototype.mapBlendModes=function(){n.blendModesCanvas||(n.blendModesCanvas=[],n.canUseNewCanvasBlendModes()?(n.blendModesCanvas[n.blendModes.NORMAL]="source-over",n.blendModesCanvas[n.blendModes.ADD]="lighter",n.blendModesCanvas[n.blendModes.MULTIPLY]="multiply",n.blendModesCanvas[n.blendModes.SCREEN]="screen",n.blendModesCanvas[n.blendModes.OVERLAY]="overlay",n.blendModesCanvas[n.blendModes.DARKEN]="darken",n.blendModesCanvas[n.blendModes.LIGHTEN]="lighten",n.blendModesCanvas[n.blendModes.COLOR_DODGE]="color-dodge",n.blendModesCanvas[n.blendModes.COLOR_BURN]="color-burn",n.blendModesCanvas[n.blendModes.HARD_LIGHT]="hard-light",n.blendModesCanvas[n.blendModes.SOFT_LIGHT]="soft-light",n.blendModesCanvas[n.blendModes.DIFFERENCE]="difference",n.blendModesCanvas[n.blendModes.EXCLUSION]="exclusion",n.blendModesCanvas[n.blendModes.HUE]="hue",n.blendModesCanvas[n.blendModes.SATURATION]="saturation",n.blendModesCanvas[n.blendModes.COLOR]="color",n.blendModesCanvas[n.blendModes.LUMINOSITY]="luminosity"):(n.blendModesCanvas[n.blendModes.NORMAL]="source-over",n.blendModesCanvas[n.blendModes.ADD]="lighter",n.blendModesCanvas[n.blendModes.MULTIPLY]="source-over",n.blendModesCanvas[n.blendModes.SCREEN]="source-over",n.blendModesCanvas[n.blendModes.OVERLAY]="source-over",n.blendModesCanvas[n.blendModes.DARKEN]="source-over",n.blendModesCanvas[n.blendModes.LIGHTEN]="source-over",n.blendModesCanvas[n.blendModes.COLOR_DODGE]="source-over",n.blendModesCanvas[n.blendModes.COLOR_BURN]="source-over",n.blendModesCanvas[n.blendModes.HARD_LIGHT]="source-over",n.blendModesCanvas[n.blendModes.SOFT_LIGHT]="source-over",n.blendModesCanvas[n.blendModes.DIFFERENCE]="source-over",n.blendModesCanvas[n.blendModes.EXCLUSION]="source-over",n.blendModesCanvas[n.blendModes.HUE]="source-over",n.blendModesCanvas[n.blendModes.SATURATION]="source-over",n.blendModesCanvas[n.blendModes.COLOR]="source-over",n.blendModesCanvas[n.blendModes.LUMINOSITY]="source-over"))},n.CanvasGraphics=function(){},n.CanvasGraphics.renderGraphics=function(t,e){var r=t.worldAlpha;t.dirty&&(this.updateGraphicsTint(t),t.dirty=!1);for(var i=0;i<t.graphicsData.length;i++){var o=t.graphicsData[i],a=o.shape,s=o._fillTint,u=o._lineTint;if(e.lineWidth=o.lineWidth,o.type===n.Graphics.POLY){e.beginPath();var c=a.points;e.moveTo(c[0],c[1]);for(var l=1;l<c.length/2;l++)e.lineTo(c[2*l],c[2*l+1]);a.closed&&e.lineTo(c[0],c[1]),c[0]===c[c.length-2]&&c[1]===c[c.length-1]&&e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*r,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*r,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.stroke())}else if(o.type===n.Graphics.RECT)(o.fillColor||0===o.fillColor)&&(e.globalAlpha=o.fillAlpha*r,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fillRect(a.x,a.y,a.width,a.height)),o.lineWidth&&(e.globalAlpha=o.lineAlpha*r,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.strokeRect(a.x,a.y,a.width,a.height));else if(o.type===n.Graphics.CIRC)e.beginPath(),e.arc(a.x,a.y,a.radius,0,2*Math.PI),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*r,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*r,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.stroke());else if(o.type===n.Graphics.ELIP){var f=2*a.width,h=2*a.height,p=a.x-f/2,d=a.y-h/2;e.beginPath();var m=.5522848,v=f/2*m,g=h/2*m,y=p+f,b=d+h,_=p+f/2,w=d+h/2;e.moveTo(p,w),e.bezierCurveTo(p,w-g,_-v,d,_,d),e.bezierCurveTo(_+v,d,y,w-g,y,w),e.bezierCurveTo(y,w+g,_+v,b,_,b),e.bezierCurveTo(_-v,b,p,w+g,p,w),e.closePath(),o.fill&&(e.globalAlpha=o.fillAlpha*r,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*r,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.stroke())}else if(o.type===n.Graphics.RREC){var x=a.x,E=a.y,C=a.width,T=a.height,S=a.radius,A=Math.min(C,T)/2|0;S=S>A?A:S,e.beginPath(),e.moveTo(x,E+S),e.lineTo(x,E+T-S),e.quadraticCurveTo(x,E+T,x+S,E+T),e.lineTo(x+C-S,E+T),e.quadraticCurveTo(x+C,E+T,x+C,E+T-S),e.lineTo(x+C,E+S),e.quadraticCurveTo(x+C,E,x+C-S,E),e.lineTo(x+S,E),e.quadraticCurveTo(x,E,x,E+S),e.closePath(),(o.fillColor||0===o.fillColor)&&(e.globalAlpha=o.fillAlpha*r,e.fillStyle="#"+("00000"+(0|s).toString(16)).substr(-6),e.fill()),o.lineWidth&&(e.globalAlpha=o.lineAlpha*r,e.strokeStyle="#"+("00000"+(0|u).toString(16)).substr(-6),e.stroke())}}},n.CanvasGraphics.renderGraphicsMask=function(t,e){var r=t.graphicsData.length;if(0!==r){r>1&&(r=1,window.console.log("Pixi.js warning: masks in canvas can only mask using the first path in the graphics object"));for(var i=0;1>i;i++){var o=t.graphicsData[i],a=o.shape;if(o.type===n.Graphics.POLY){e.beginPath();var s=a.points;e.moveTo(s[0],s[1]);for(var u=1;u<s.length/2;u++)e.lineTo(s[2*u],s[2*u+1]);s[0]===s[s.length-2]&&s[1]===s[s.length-1]&&e.closePath()}else if(o.type===n.Graphics.RECT)e.beginPath(),e.rect(a.x,a.y,a.width,a.height),e.closePath();else if(o.type===n.Graphics.CIRC)e.beginPath(),e.arc(a.x,a.y,a.radius,0,2*Math.PI),e.closePath();else if(o.type===n.Graphics.ELIP){var c=2*a.width,l=2*a.height,f=a.x-c/2,h=a.y-l/2;e.beginPath();var p=.5522848,d=c/2*p,m=l/2*p,v=f+c,g=h+l,y=f+c/2,b=h+l/2;e.moveTo(f,b),e.bezierCurveTo(f,b-m,y-d,h,y,h),e.bezierCurveTo(y+d,h,v,b-m,v,b),e.bezierCurveTo(v,b+m,y+d,g,y,g),e.bezierCurveTo(y-d,g,f,b+m,f,b),e.closePath()}else if(o.type===n.Graphics.RREC){var _=a.points,w=_[0],x=_[1],E=_[2],C=_[3],T=_[4],S=Math.min(E,C)/2|0;T=T>S?S:T,e.beginPath(),e.moveTo(w,x+T),e.lineTo(w,x+C-T),e.quadraticCurveTo(w,x+C,w+T,x+C),e.lineTo(w+E-T,x+C),e.quadraticCurveTo(w+E,x+C,w+E,x+C-T),e.lineTo(w+E,x+T),e.quadraticCurveTo(w+E,x,w+E-T,x),e.lineTo(w+T,x),e.quadraticCurveTo(w,x,w,x+T),e.closePath()}}}},n.CanvasGraphics.updateGraphicsTint=function(t){if(16777215!==t.tint)for(var e=(t.tint>>16&255)/255,n=(t.tint>>8&255)/255,r=(255&t.tint)/255,i=0;i<t.graphicsData.length;i++){var o=t.graphicsData[i],a=0|o.fillColor,s=0|o.lineColor;o._fillTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*n*255<<8)+(255&a)/255*r*255,o._lineTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*n*255<<8)+(255&s)/255*r*255}},n.Graphics=function(){n.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this.blendMode=n.blendModes.NORMAL,this.currentPath=null,this._webGL=[],this.isMask=!1,this.boundsPadding=0,this._localBounds=new n.Rectangle(0,0,1,1),this.dirty=!0,this.webGLDirty=!1,this.cachedSpriteDirty=!1},n.Graphics.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Graphics.prototype.constructor=n.Graphics,Object.defineProperty(n.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(t){this._cacheAsBitmap=t,this._cacheAsBitmap?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}}),n.Graphics.prototype.lineStyle=function(t,e,r){if(this.lineWidth=t||0,this.lineColor=e||0,this.lineAlpha=arguments.length<3?1:r,this.currentPath){if(this.currentPath.shape.points.length)return this.drawShape(new n.Polygon(this.currentPath.shape.points.slice(-2))),this;this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha}return this},n.Graphics.prototype.moveTo=function(t,e){return this.drawShape(new n.Polygon([t,e])),this},n.Graphics.prototype.lineTo=function(t,e){return this.currentPath.shape.points.push(t,e),this.dirty=!0,this},n.Graphics.prototype.quadraticCurveTo=function(t,e,n,r){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var i,o,a=20,s=this.currentPath.shape.points;0===s.length&&this.moveTo(0,0);for(var u=s[s.length-2],c=s[s.length-1],l=0,f=1;a>=f;f++)l=f/a,i=u+(t-u)*l,o=c+(e-c)*l,s.push(i+(t+(n-t)*l-i)*l,o+(e+(r-e)*l-o)*l);return this.dirty=!0,this},n.Graphics.prototype.bezierCurveTo=function(t,e,n,r,i,o){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var a,s,u,c,l,f=20,h=this.currentPath.shape.points,p=h[h.length-2],d=h[h.length-1],m=0,v=1;f>=v;v++)m=v/f,a=1-m,s=a*a,u=s*a,c=m*m,l=c*m,h.push(u*p+3*s*m*t+3*a*c*n+l*i,u*d+3*s*m*e+3*a*c*r+l*o);return this.dirty=!0,this},n.Graphics.prototype.arcTo=function(t,e,n,r,i){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var o=this.currentPath.shape.points,a=o[o.length-2],s=o[o.length-1],u=s-e,c=a-t,l=r-e,f=n-t,h=Math.abs(u*f-c*l);if(1e-8>h||0===i)(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e);else{var p=u*u+c*c,d=l*l+f*f,m=u*l+c*f,v=i*Math.sqrt(p)/h,g=i*Math.sqrt(d)/h,y=v*m/p,b=g*m/d,_=v*f+g*c,w=v*l+g*u,x=c*(g+y),E=u*(g+y),C=f*(v+b),T=l*(v+b),S=Math.atan2(E-w,x-_),A=Math.atan2(T-w,C-_);this.arc(_+t,w+e,i,S,A,c*l>f*u)}return this.dirty=!0,this},n.Graphics.prototype.arc=function(t,e,n,r,i,o){var a,s=t+Math.cos(r)*n,u=e+Math.sin(r)*n;if(this.currentPath?(a=this.currentPath.shape.points,0===a.length?a.push(s,u):(a[a.length-2]!==s||a[a.length-1]!==u)&&a.push(s,u)):(this.moveTo(s,u),a=this.currentPath.shape.points),r===i)return this;!o&&r>=i?i+=2*Math.PI:o&&i>=r&&(r+=2*Math.PI);var c=o?-1*(r-i):i-r,l=Math.abs(c)/(2*Math.PI)*40;if(0===c)return this;for(var f=c/(2*l),h=2*f,p=Math.cos(f),d=Math.sin(f),m=l-1,v=m%1/m,g=0;m>=g;g++){var y=g+v*g,b=f+r+h*y,_=Math.cos(b),w=-Math.sin(b);a.push((p*_+d*w)*n+t,(p*-w+d*_)*n+e)}return this.dirty=!0,this},n.Graphics.prototype.beginFill=function(t,e){return this.filling=!0,this.fillColor=t||0,this.fillAlpha=void 0===e?1:e,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},n.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},n.Graphics.prototype.drawRect=function(t,e,r,i){return this.drawShape(new n.Rectangle(t,e,r,i)),this},n.Graphics.prototype.drawRoundedRect=function(t,e,r,i,o){return this.drawShape(new n.RoundedRectangle(t,e,r,i,o)),this},n.Graphics.prototype.drawCircle=function(t,e,r){return this.drawShape(new n.Circle(t,e,r)),this},n.Graphics.prototype.drawEllipse=function(t,e,r,i){return this.drawShape(new n.Ellipse(t,e,r,i)),this},n.Graphics.prototype.drawPolygon=function(t){return t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.drawShape(new n.Polygon(t)),this},n.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},n.Graphics.prototype.generateTexture=function(t,e){t=t||1;var r=this.getBounds(),i=new n.CanvasBuffer(r.width*t,r.height*t),o=n.Texture.fromCanvas(i.canvas,e);return o.baseTexture.resolution=t,i.context.scale(t,t),i.context.translate(-r.x,-r.y),n.CanvasGraphics.renderGraphics(this,i.context),o},n.Graphics.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.worldAlpha=this.worldAlpha,void n.Sprite.prototype._renderWebGL.call(this._cachedSprite,t);if(t.spriteBatch.stop(),t.blendModeManager.setBlendMode(this.blendMode),this._mask&&t.maskManager.pushMask(this._mask,t),this._filters&&t.filterManager.pushFilter(this._filterBlock),this.blendMode!==t.spriteBatch.currentBlendMode){t.spriteBatch.currentBlendMode=this.blendMode;var e=n.blendModesWebGL[t.spriteBatch.currentBlendMode];t.spriteBatch.gl.blendFunc(e[0],e[1])}if(this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1),n.WebGLGraphics.renderGraphics(this,t),this.children.length){t.spriteBatch.start();for(var r=0,i=this.children.length;i>r;r++)this.children[r]._renderWebGL(t);t.spriteBatch.stop()}this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this.mask,t),t.drawCount++,t.spriteBatch.start()}},n.Graphics.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha&&this.isMask!==!0){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,void n.Sprite.prototype._renderCanvas.call(this._cachedSprite,t);var e=t.context,r=this.worldTransform;this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]),this._mask&&t.maskManager.pushMask(this._mask,t);var i=t.resolution;e.setTransform(r.a*i,r.b*i,r.c*i,r.d*i,r.tx*i,r.ty*i),n.CanvasGraphics.renderGraphics(this,e);for(var o=0,a=this.children.length;a>o;o++)this.children[o]._renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},n.Graphics.prototype.getBounds=function(t){if(this.isMask)return n.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.webGLDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var e=this._localBounds,r=e.x,i=e.width+e.x,o=e.y,a=e.height+e.y,s=t||this.worldTransform,u=s.a,c=s.b,l=s.c,f=s.d,h=s.tx,p=s.ty,d=u*i+l*a+h,m=f*a+c*i+p,v=u*r+l*a+h,g=f*a+c*r+p,y=u*r+l*o+h,b=f*o+c*r+p,_=u*i+l*o+h,w=f*o+c*i+p,x=d,E=m,C=d,T=m;return C=C>v?v:C,C=C>y?y:C,C=C>_?_:C,T=T>g?g:T,T=T>b?b:T,T=T>w?w:T,x=v>x?v:x,x=y>x?y:x,x=_>x?_:x,E=g>E?g:E,E=b>E?b:E,E=w>E?w:E,this._bounds.x=C,this._bounds.width=x-C,this._bounds.y=T,this._bounds.height=E-T,this._bounds},n.Graphics.prototype.updateLocalBounds=function(){var t=1/0,e=-1/0,r=1/0,i=-1/0;if(this.graphicsData.length)for(var o,a,s,u,c,l,f=0;f<this.graphicsData.length;f++){var h=this.graphicsData[f],p=h.type,d=h.lineWidth;if(o=h.shape,p===n.Graphics.RECT||p===n.Graphics.RREC)s=o.x-d/2,u=o.y-d/2,c=o.width+d,l=o.height+d,t=t>s?s:t,e=s+c>e?s+c:e,r=r>u?u:r,i=u+l>i?u+l:i;else if(p===n.Graphics.CIRC)s=o.x,u=o.y,c=o.radius+d/2,l=o.radius+d/2,t=t>s-c?s-c:t,e=s+c>e?s+c:e,r=r>u-l?u-l:r,i=u+l>i?u+l:i;else if(p===n.Graphics.ELIP)s=o.x,u=o.y,c=o.width+d/2,l=o.height+d/2,t=t>s-c?s-c:t,e=s+c>e?s+c:e,r=r>u-l?u-l:r,i=u+l>i?u+l:i;else{a=o.points;for(var m=0;m<a.length;m+=2)s=a[m],u=a[m+1],t=t>s-d?s-d:t,e=s+d>e?s+d:e,r=r>u-d?u-d:r,i=u+d>i?u+d:i}}else t=0,e=0,r=0,i=0;var v=this.boundsPadding;this._localBounds.x=t-v,this._localBounds.width=e-t+2*v,this._localBounds.y=r-v,this._localBounds.height=i-r+2*v},n.Graphics.prototype._generateCachedSprite=function(){var t=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(t.width,t.height);else{var e=new n.CanvasBuffer(t.width,t.height),r=n.Texture.fromCanvas(e.canvas);this._cachedSprite=new n.Sprite(r),this._cachedSprite.buffer=e,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(t.x/t.width),this._cachedSprite.anchor.y=-(t.y/t.height),this._cachedSprite.buffer.context.translate(-t.x,-t.y),this.worldAlpha=1,n.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},n.Graphics.prototype.updateCachedSpriteTexture=function(){var t=this._cachedSprite,e=t.texture,n=t.buffer.canvas;e.baseTexture.width=n.width,e.baseTexture.height=n.height,e.crop.width=e.frame.width=n.width,e.crop.height=e.frame.height=n.height,t._width=n.width,t._height=n.height,e.baseTexture.dirty()},n.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},n.Graphics.prototype.drawShape=function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var e=new n.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);return this.graphicsData.push(e),e.type===n.Graphics.POLY&&(e.shape.closed=this.filling,this.currentPath=e),this.dirty=!0,e},n.GraphicsData=function(t,e,n,r,i,o,a){this.lineWidth=t,this.lineColor=e,this.lineAlpha=n,this._lineTint=e,this.fillColor=r,this.fillAlpha=i,this._fillTint=r,this.fill=o,this.shape=a,this.type=a.type},n.Graphics.POLY=0,n.Graphics.RECT=1,n.Graphics.CIRC=2,n.Graphics.ELIP=3,n.Graphics.RREC=4,n.Polygon.prototype.type=n.Graphics.POLY,n.Rectangle.prototype.type=n.Graphics.RECT,n.Circle.prototype.type=n.Graphics.CIRC,n.Ellipse.prototype.type=n.Graphics.ELIP,n.RoundedRectangle.prototype.type=n.Graphics.RREC,n.Strip=function(t){n.DisplayObjectContainer.call(this),this.texture=t,this.uvs=new n.Float32Array([0,1,1,1,1,0,0,1]),this.vertices=new n.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new n.Float32Array([1,1,1,1]),this.indices=new n.Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=n.blendModes.NORMAL,this.canvasPadding=0,this.drawMode=n.Strip.DrawModes.TRIANGLE_STRIP},n.Strip.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Strip.prototype.constructor=n.Strip,n.Strip.prototype._renderWebGL=function(t){!this.visible||this.alpha<=0||(t.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(t),t.shaderManager.setShader(t.shaderManager.stripShader),this._renderStrip(t),t.spriteBatch.start())},n.Strip.prototype._initWebGL=function(t){var e=t.gl;this._vertexBuffer=e.createBuffer(),this._indexBuffer=e.createBuffer(),this._uvBuffer=e.createBuffer(),this._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvs,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)},n.Strip.prototype._renderStrip=function(t){var e=t.gl,r=t.projection,i=t.offset,o=t.shaderManager.stripShader,a=this.drawMode===n.Strip.DrawModes.TRIANGLE_STRIP?e.TRIANGLE_STRIP:e.TRIANGLES;t.blendModeManager.setBlendMode(this.blendMode),e.uniformMatrix3fv(o.translationMatrix,!1,this.worldTransform.toArray(!0)),e.uniform2f(o.projectionVector,r.x,-r.y),e.uniform2f(o.offsetVector,-i.x,-i.y),e.uniform1f(o.alpha,this.worldAlpha),this.dirty?(this.dirty=!1,e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.STATIC_DRAW),e.vertexAttribPointer(o.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvs,e.STATIC_DRAW),e.vertexAttribPointer(o.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),this.texture.baseTexture._dirty[e.id]?t.renderer.updateTexture(this.texture.baseTexture):e.bindTexture(e.TEXTURE_2D,this.texture.baseTexture._glTextures[e.id]),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)):(e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices),e.vertexAttribPointer(o.aVertexPosition,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this._uvBuffer),e.vertexAttribPointer(o.aTextureCoord,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),this.texture.baseTexture._dirty[e.id]?t.renderer.updateTexture(this.texture.baseTexture):e.bindTexture(e.TEXTURE_2D,this.texture.baseTexture._glTextures[e.id]),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),e.drawElements(a,this.indices.length,e.UNSIGNED_SHORT,0)},n.Strip.prototype._renderCanvas=function(t){var e=t.context,r=this.worldTransform;t.roundPixels?e.setTransform(r.a,r.b,r.c,r.d,0|r.tx,0|r.ty):e.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.drawMode===n.Strip.DrawModes.TRIANGLE_STRIP?this._renderCanvasTriangleStrip(e):this._renderCanvasTriangles(e)},n.Strip.prototype._renderCanvasTriangleStrip=function(t){var e=this.vertices,n=this.uvs,r=e.length/2;this.count++;for(var i=0;r-2>i;i++){var o=2*i;this._renderCanvasDrawTriangle(t,e,n,o,o+2,o+4)}},n.Strip.prototype._renderCanvasTriangles=function(t){var e=this.vertices,n=this.uvs,r=this.indices,i=r.length;this.count++;for(var o=0;i>o;o+=3){var a=2*r[o],s=2*r[o+1],u=2*r[o+2];this._renderCanvasDrawTriangle(t,e,n,a,s,u)}},n.Strip.prototype._renderCanvasDrawTriangle=function(t,e,n,r,i,o){var a=this.texture.baseTexture.source,s=this.texture.width,u=this.texture.height,c=e[r],l=e[i],f=e[o],h=e[r+1],p=e[i+1],d=e[o+1],m=n[r]*s,v=n[i]*s,g=n[o]*s,y=n[r+1]*u,b=n[i+1]*u,_=n[o+1]*u;if(this.canvasPadding>0){var w=this.canvasPadding/this.worldTransform.a,x=this.canvasPadding/this.worldTransform.d,E=(c+l+f)/3,C=(h+p+d)/3,T=c-E,S=h-C,A=Math.sqrt(T*T+S*S);c=E+T/A*(A+w),h=C+S/A*(A+x),T=l-E,S=p-C,A=Math.sqrt(T*T+S*S),l=E+T/A*(A+w),p=C+S/A*(A+x),T=f-E,S=d-C,A=Math.sqrt(T*T+S*S),f=E+T/A*(A+w),d=C+S/A*(A+x)}t.save(),t.beginPath(),t.moveTo(c,h),t.lineTo(l,p),t.lineTo(f,d),t.closePath(),t.clip();var k=m*b+y*g+v*_-b*g-y*v-m*_,O=c*b+y*f+l*_-b*f-y*l-c*_,M=m*l+c*g+v*f-l*g-c*v-m*f,j=m*b*f+y*l*g+c*v*_-c*b*g-y*v*f-m*l*_,R=h*b+y*d+p*_-b*d-y*p-h*_,N=m*p+h*g+v*d-p*g-h*v-m*d,I=m*b*d+y*p*g+h*v*_-h*b*g-y*v*d-m*p*_;t.transform(O/k,R/k,M/k,N/k,j/k,I/k),t.drawImage(a,0,0),t.restore()},n.Strip.prototype.renderStripFlat=function(t){var e=this.context,n=t.vertices,r=n.length/2;this.count++,e.beginPath();for(var i=1;r-2>i;i++){var o=2*i,a=n[o],s=n[o+2],u=n[o+4],c=n[o+1],l=n[o+3],f=n[o+5];e.moveTo(a,c),e.lineTo(s,l),e.lineTo(u,f)}e.fillStyle="#FF0000",e.fill(),e.closePath()},n.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},n.Strip.prototype.getBounds=function(t){for(var e=t||this.worldTransform,r=e.a,i=e.b,o=e.c,a=e.d,s=e.tx,u=e.ty,c=-1/0,l=-1/0,f=1/0,h=1/0,p=this.vertices,d=0,m=p.length;m>d;d+=2){var v=p[d],g=p[d+1],y=r*v+o*g+s,b=a*g+i*v+u;f=f>y?y:f,h=h>b?b:h,c=y>c?y:c,l=b>l?b:l}if(f===-1/0||1/0===l)return n.EmptyRectangle;var _=this._bounds;return _.x=f,_.width=c-f,_.y=h,_.height=l-h,this._currentBounds=_,_},n.Strip.DrawModes={TRIANGLE_STRIP:0,TRIANGLES:1},n.Rope=function(t,e){n.Strip.call(this,t),this.points=e,this.vertices=new n.Float32Array(4*e.length),this.uvs=new n.Float32Array(4*e.length),this.colors=new n.Float32Array(2*e.length),this.indices=new n.Uint16Array(2*e.length),this.refresh()},n.Rope.prototype=Object.create(n.Strip.prototype),n.Rope.prototype.constructor=n.Rope,n.Rope.prototype.refresh=function(){var t=this.points;if(!(t.length<1)){var e=this.uvs,n=t[0],r=this.indices,i=this.colors;this.count-=.2,e[0]=0,e[1]=0,e[2]=0,e[3]=1,i[0]=1,i[1]=1,r[0]=0,r[1]=1;for(var o,a,s,u=t.length,c=1;u>c;c++)o=t[c],a=4*c,s=c/(u-1),c%2?(e[a]=s,e[a+1]=0,e[a+2]=s,e[a+3]=1):(e[a]=s,e[a+1]=0,e[a+2]=s,e[a+3]=1),a=2*c,i[a]=1,i[a+1]=1,a=2*c,r[a]=a,r[a+1]=a+1,n=o}},n.Rope.prototype.updateTransform=function(){var t=this.points;if(!(t.length<1)){var e,r=t[0],i={x:0,y:0};this.count-=.2;for(var o,a,s,u,c,l=this.vertices,f=t.length,h=0;f>h;h++)o=t[h],a=4*h,e=h<t.length-1?t[h+1]:o,i.y=-(e.x-r.x),i.x=e.y-r.y,s=10*(1-h/(f-1)),s>1&&(s=1),u=Math.sqrt(i.x*i.x+i.y*i.y),c=this.texture.height/2,i.x/=u,i.y/=u,i.x*=c,i.y*=c,l[a]=o.x+i.x,l[a+1]=o.y+i.y,l[a+2]=o.x-i.x,l[a+3]=o.y-i.y,r=o;n.DisplayObjectContainer.prototype.updateTransform.call(this)}},n.Rope.prototype.setTexture=function(t){this.texture=t},n.TilingSprite=function(t,e,r){n.Sprite.call(this,t),this._width=e||100,this._height=r||100,this.tileScale=new n.Point(1,1),this.tileScaleOffset=new n.Point(1,1),this.tilePosition=new n.Point(0,0),this.renderable=!0,this.tint=16777215,this.blendMode=n.blendModes.NORMAL},n.TilingSprite.prototype=Object.create(n.Sprite.prototype),n.TilingSprite.prototype.constructor=n.TilingSprite,Object.defineProperty(n.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t}}),Object.defineProperty(n.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t}}),n.TilingSprite.prototype.setTexture=function(t){this.texture!==t&&(this.texture=t,this.refreshTexture=!0,this.cachedTint=16777215)},n.TilingSprite.prototype._renderWebGL=function(t){if(this.visible!==!1&&0!==this.alpha){var e,n;for(this._mask&&(t.spriteBatch.stop(),t.maskManager.pushMask(this.mask,t),t.spriteBatch.start()),this._filters&&(t.spriteBatch.flush(),t.filterManager.pushFilter(this._filterBlock)),!this.tilingTexture||this.refreshTexture?(this.generateTilingTexture(!0),this.tilingTexture&&this.tilingTexture.needsUpdate&&(t.renderer.updateTexture(this.tilingTexture.baseTexture),this.tilingTexture.needsUpdate=!1)):t.spriteBatch.renderTilingSprite(this),e=0,n=this.children.length;n>e;e++)this.children[e]._renderWebGL(t);
t.spriteBatch.stop(),this._filters&&t.filterManager.popFilter(),this._mask&&t.maskManager.popMask(this._mask,t),t.spriteBatch.start()}},n.TilingSprite.prototype._renderCanvas=function(t){if(this.visible!==!1&&0!==this.alpha){var e=t.context;this._mask&&t.maskManager.pushMask(this._mask,t),e.globalAlpha=this.worldAlpha;var r,i,o=this.worldTransform,a=t.resolution;if(e.setTransform(o.a*a,o.b*a,o.c*a,o.d*a,o.tx*a,o.ty*a),!this.__tilePattern||this.refreshTexture){if(this.generateTilingTexture(!1),!this.tilingTexture)return;this.__tilePattern=e.createPattern(this.tilingTexture.baseTexture.source,"repeat")}this.blendMode!==t.currentBlendMode&&(t.currentBlendMode=this.blendMode,e.globalCompositeOperation=n.blendModesCanvas[t.currentBlendMode]);var s=this.tilePosition,u=this.tileScale;for(s.x%=this.tilingTexture.baseTexture.width,s.y%=this.tilingTexture.baseTexture.height,e.scale(u.x,u.y),e.translate(s.x+this.anchor.x*-this._width,s.y+this.anchor.y*-this._height),e.fillStyle=this.__tilePattern,e.fillRect(-s.x,-s.y,this._width/u.x,this._height/u.y),e.scale(1/u.x,1/u.y),e.translate(-s.x+this.anchor.x*this._width,-s.y+this.anchor.y*this._height),this._mask&&t.maskManager.popMask(t),r=0,i=this.children.length;i>r;r++)this.children[r]._renderCanvas(t)}},n.TilingSprite.prototype.getBounds=function(){var t=this._width,e=this._height,n=t*(1-this.anchor.x),r=t*-this.anchor.x,i=e*(1-this.anchor.y),o=e*-this.anchor.y,a=this.worldTransform,s=a.a,u=a.b,c=a.c,l=a.d,f=a.tx,h=a.ty,p=s*r+c*o+f,d=l*o+u*r+h,m=s*n+c*o+f,v=l*o+u*n+h,g=s*n+c*i+f,y=l*i+u*n+h,b=s*r+c*i+f,_=l*i+u*r+h,w=-1/0,x=-1/0,E=1/0,C=1/0;E=E>p?p:E,E=E>m?m:E,E=E>g?g:E,E=E>b?b:E,C=C>d?d:C,C=C>v?v:C,C=C>y?y:C,C=C>_?_:C,w=p>w?p:w,w=m>w?m:w,w=g>w?g:w,w=b>w?b:w,x=d>x?d:x,x=v>x?v:x,x=y>x?y:x,x=_>x?_:x;var T=this._bounds;return T.x=E,T.width=w-E,T.y=C,T.height=x-C,this._currentBounds=T,T},n.TilingSprite.prototype.onTextureUpdate=function(){},n.TilingSprite.prototype.generateTilingTexture=function(t){if(this.texture.baseTexture.hasLoaded){var e,r,i=this.originalTexture||this.texture,o=i.frame,a=o.width!==i.baseTexture.width||o.height!==i.baseTexture.height,s=!1;if(t?(e=n.getNextPowerOfTwo(o.width),r=n.getNextPowerOfTwo(o.height),(o.width!==e||o.height!==r||i.baseTexture.width!==e||i.baseTexture.height||r)&&(s=!0)):a&&(i.trim?(e=i.trim.width,r=i.trim.height):(e=o.width,r=o.height),s=!0),s){var u;this.tilingTexture&&this.tilingTexture.isTiling?(u=this.tilingTexture.canvasBuffer,u.resize(e,r),this.tilingTexture.baseTexture.width=e,this.tilingTexture.baseTexture.height=r,this.tilingTexture.needsUpdate=!0):(u=new n.CanvasBuffer(e,r),this.tilingTexture=n.Texture.fromCanvas(u.canvas),this.tilingTexture.canvasBuffer=u,this.tilingTexture.isTiling=!0),u.context.drawImage(i.baseTexture.source,i.crop.x,i.crop.y,i.crop.width,i.crop.height,0,0,e,r),this.tileScaleOffset.x=o.width/e,this.tileScaleOffset.y=o.height/r}else this.tilingTexture&&this.tilingTexture.isTiling&&this.tilingTexture.destroy(!0),this.tileScaleOffset.x=1,this.tileScaleOffset.y=1,this.tilingTexture=i;this.refreshTexture=!1,this.originalTexture=this.texture,this.texture=this.tilingTexture,this.tilingTexture.baseTexture._powerOf2=!0}},n.TilingSprite.prototype.destroy=function(){n.Sprite.prototype.destroy.call(this),this.tileScale=null,this.tileScaleOffset=null,this.tilePosition=null,this.tilingTexture.destroy(!0),this.tilingTexture=null};var r={radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:"undefined"==typeof Float32Array?Array:Float32Array,Uint16Array:"undefined"==typeof Uint16Array?Array:Uint16Array};r.BoneData=function(t,e){this.name=t,this.parent=e},r.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:!0,inheritRotation:!0,flipX:!1,flipY:!1},r.SlotData=function(t,e){this.name=t,this.boneData=e},r.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,additiveBlending:!1},r.IkConstraintData=function(t){this.name=t,this.bones=[]},r.IkConstraintData.prototype={target:null,bendDirection:1,mix:1},r.Bone=function(t,e,n){this.data=t,this.skeleton=e,this.parent=n,this.setToSetupPose()},r.Bone.yDown=!1,r.Bone.prototype={x:0,y:0,rotation:0,rotationIK:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,worldFlipX:!1,worldFlipY:!1,updateWorldTransform:function(){var t=this.parent;if(t)this.worldX=this.x*t.m00+this.y*t.m01+t.worldX,this.worldY=this.x*t.m10+this.y*t.m11+t.worldY,this.data.inheritScale?(this.worldScaleX=t.worldScaleX*this.scaleX,this.worldScaleY=t.worldScaleY*this.scaleY):(this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY),this.worldRotation=this.data.inheritRotation?t.worldRotation+this.rotationIK:this.rotationIK,this.worldFlipX=t.worldFlipX!=this.flipX,this.worldFlipY=t.worldFlipY!=this.flipY;else{var e=this.skeleton.flipX,n=this.skeleton.flipY;this.worldX=e?-this.x:this.x,this.worldY=n!=r.Bone.yDown?-this.y:this.y,this.worldScaleX=this.scaleX,this.worldScaleY=this.scaleY,this.worldRotation=this.rotationIK,this.worldFlipX=e!=this.flipX,this.worldFlipY=n!=this.flipY}var i=this.worldRotation*r.degRad,o=Math.cos(i),a=Math.sin(i);this.worldFlipX?(this.m00=-o*this.worldScaleX,this.m01=a*this.worldScaleY):(this.m00=o*this.worldScaleX,this.m01=-a*this.worldScaleY),this.worldFlipY!=r.Bone.yDown?(this.m10=-a*this.worldScaleX,this.m11=-o*this.worldScaleY):(this.m10=a*this.worldScaleX,this.m11=o*this.worldScaleY)},setToSetupPose:function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.rotationIK=this.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.flipX=t.flipX,this.flipY=t.flipY},worldToLocal:function(t){var e=t[0]-this.worldX,n=t[1]-this.worldY,i=this.m00,o=this.m10,a=this.m01,s=this.m11;this.worldFlipX!=(this.worldFlipY!=r.Bone.yDown)&&(i=-i,s=-s);var u=1/(i*s-a*o);t[0]=e*i*u-n*a*u,t[1]=n*s*u-e*o*u},localToWorld:function(t){var e=t[0],n=t[1];t[0]=e*this.m00+n*this.m01+this.worldX,t[1]=e*this.m10+n*this.m11+this.worldY}},r.Slot=function(t,e){this.data=t,this.bone=e,this.setToSetupPose()},r.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,attachmentVertices:[],setAttachment:function(t){this.attachment=t,this._attachmentTime=this.bone.skeleton.time,this.attachmentVertices.length=0},setAttachmentTime:function(t){this._attachmentTime=this.bone.skeleton.time-t},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var t=this.data;this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a;for(var e=this.bone.skeleton.data.slots,n=0,r=e.length;r>n;n++)if(e[n]==t){this.setAttachment(t.attachmentName?this.bone.skeleton.getAttachmentBySlotIndex(n,t.attachmentName):null);break}}},r.IkConstraint=function(t,e){this.data=t,this.mix=t.mix,this.bendDirection=t.bendDirection,this.bones=[];for(var n=0,r=t.bones.length;r>n;n++)this.bones.push(e.findBone(t.bones[n].name));this.target=e.findBone(t.target.name)},r.IkConstraint.prototype={apply:function(){var t=this.target,e=this.bones;switch(e.length){case 1:r.IkConstraint.apply1(e[0],t.worldX,t.worldY,this.mix);break;case 2:r.IkConstraint.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.mix)}}},r.IkConstraint.apply1=function(t,e,n,i){var o=t.data.inheritRotation&&t.parent?t.parent.worldRotation:0,a=t.rotation,s=Math.atan2(n-t.worldY,e-t.worldX)*r.radDeg-o;t.rotationIK=a+(s-a)*i},r.IkConstraint.apply2=function(t,e,n,i,o,a){var s=e.rotation,u=t.rotation;if(!a)return e.rotationIK=s,void(t.rotationIK=u);var c,l,f=r.temp,h=t.parent;h?(f[0]=n,f[1]=i,h.worldToLocal(f),n=(f[0]-t.x)*h.worldScaleX,i=(f[1]-t.y)*h.worldScaleY):(n-=t.x,i-=t.y),e.parent==t?(c=e.x,l=e.y):(f[0]=e.x,f[1]=e.y,e.parent.localToWorld(f),t.worldToLocal(f),c=f[0],l=f[1]);var p=c*t.worldScaleX,d=l*t.worldScaleY,m=Math.atan2(d,p),v=Math.sqrt(p*p+d*d),g=e.data.length*e.worldScaleX,y=2*v*g;if(1e-4>y)return void(e.rotationIK=s+(Math.atan2(i,n)*r.radDeg-u-s)*a);var b=(n*n+i*i-v*v-g*g)/y;-1>b?b=-1:b>1&&(b=1);var _=Math.acos(b)*o,w=v+g*b,x=g*Math.sin(_),E=Math.atan2(i*w-n*x,n*w+i*x),C=(E-m)*r.radDeg-u;C>180?C-=360:-180>C&&(C+=360),t.rotationIK=u+C*a,C=(_+m)*r.radDeg-s,C>180?C-=360:-180>C&&(C+=360),e.rotationIK=s+(C+t.worldRotation-e.parent.worldRotation)*a},r.Skin=function(t){this.name=t,this.attachments={}},r.Skin.prototype={addAttachment:function(t,e,n){this.attachments[t+":"+e]=n},getAttachment:function(t,e){return this.attachments[t+":"+e]},_attachAll:function(t,e){for(var n in e.attachments){var r=n.indexOf(":"),i=parseInt(n.substring(0,r)),o=n.substring(r+1),a=t.slots[i];if(a.attachment&&a.attachment.name==o){var s=this.getAttachment(i,o);s&&a.setAttachment(s)}}}},r.Animation=function(t,e,n){this.name=t,this.timelines=e,this.duration=n},r.Animation.prototype={apply:function(t,e,n,r,i){r&&0!=this.duration&&(n%=this.duration,e%=this.duration);for(var o=this.timelines,a=0,s=o.length;s>a;a++)o[a].apply(t,e,n,i,1)},mix:function(t,e,n,r,i,o){r&&0!=this.duration&&(n%=this.duration,e%=this.duration);for(var a=this.timelines,s=0,u=a.length;u>s;s++)a[s].apply(t,e,n,i,o)}},r.Animation.binarySearch=function(t,e,n){var r=0,i=Math.floor(t.length/n)-2;if(!i)return n;for(var o=i>>>1;;){if(t[(o+1)*n]<=e?r=o+1:i=o,r==i)return(r+1)*n;o=r+i>>>1}},r.Animation.binarySearch1=function(t,e){var n=0,r=t.length-2;if(!r)return 1;for(var i=r>>>1;;){if(t[i+1]<=e?n=i+1:r=i,n==r)return n+1;i=n+r>>>1}},r.Animation.linearSearch=function(t,e,n){for(var r=0,i=t.length-n;i>=r;r+=n)if(t[r]>e)return r;return-1},r.Curves=function(){this.curves=[]},r.Curves.prototype={setLinear:function(t){this.curves[19*t]=0},setStepped:function(t){this.curves[19*t]=1},setCurve:function(t,e,n,r,i){var o=.1,a=o*o,s=a*o,u=3*o,c=3*a,l=6*a,f=6*s,h=2*-e+r,p=2*-n+i,d=3*(e-r)+1,m=3*(n-i)+1,v=e*u+h*c+d*s,g=n*u+p*c+m*s,y=h*l+d*f,b=p*l+m*f,_=d*f,w=m*f,x=19*t,E=this.curves;E[x++]=2;for(var C=v,T=g,S=x+19-1;S>x;x+=2)E[x]=C,E[x+1]=T,v+=y,g+=b,y+=_,b+=w,C+=v,T+=g},getCurvePercent:function(t,e){e=0>e?0:e>1?1:e;var n=this.curves,r=19*t,i=n[r];if(0===i)return e;if(1==i)return 0;r++;for(var o=0,a=r,s=r+19-1;s>r;r+=2)if(o=n[r],o>=e){var u,c;return r==a?(u=0,c=0):(u=n[r-2],c=n[r-1]),c+(n[r+1]-c)*(e-u)/(o-u)}var l=n[r-1];return l+(1-l)*(e-o)/(1-o)}},r.RotateTimeline=function(t){this.curves=new r.Curves(t),this.frames=[],this.frames.length=2*t},r.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,n){t*=2,this.frames[t]=e,this.frames[t+1]=n},apply:function(t,e,n,i,o){var a=this.frames;if(!(n<a[0])){var s=t.bones[this.boneIndex];if(n>=a[a.length-2]){for(var u=s.data.rotation+a[a.length-1]-s.rotation;u>180;)u-=360;for(;-180>u;)u+=360;return void(s.rotation+=u*o)}var c=r.Animation.binarySearch(a,n,2),l=a[c-1],f=a[c],h=1-(n-f)/(a[c-2]-f);h=this.curves.getCurvePercent(c/2-1,h);for(var u=a[c+1]-l;u>180;)u-=360;for(;-180>u;)u+=360;for(u=s.data.rotation+(l+u*h)-s.rotation;u>180;)u-=360;for(;-180>u;)u+=360;s.rotation+=u*o}}},r.TranslateTimeline=function(t){this.curves=new r.Curves(t),this.frames=[],this.frames.length=3*t},r.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,n,r){t*=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r},apply:function(t,e,n,i,o){var a=this.frames;if(!(n<a[0])){var s=t.bones[this.boneIndex];if(n>=a[a.length-3])return s.x+=(s.data.x+a[a.length-2]-s.x)*o,void(s.y+=(s.data.y+a[a.length-1]-s.y)*o);var u=r.Animation.binarySearch(a,n,3),c=a[u-2],l=a[u-1],f=a[u],h=1-(n-f)/(a[u+-3]-f);h=this.curves.getCurvePercent(u/3-1,h),s.x+=(s.data.x+c+(a[u+1]-c)*h-s.x)*o,s.y+=(s.data.y+l+(a[u+2]-l)*h-s.y)*o}}},r.ScaleTimeline=function(t){this.curves=new r.Curves(t),this.frames=[],this.frames.length=3*t},r.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,n,r){t*=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r},apply:function(t,e,n,i,o){var a=this.frames;if(!(n<a[0])){var s=t.bones[this.boneIndex];if(n>=a[a.length-3])return s.scaleX+=(s.data.scaleX*a[a.length-2]-s.scaleX)*o,void(s.scaleY+=(s.data.scaleY*a[a.length-1]-s.scaleY)*o);var u=r.Animation.binarySearch(a,n,3),c=a[u-2],l=a[u-1],f=a[u],h=1-(n-f)/(a[u+-3]-f);h=this.curves.getCurvePercent(u/3-1,h),s.scaleX+=(s.data.scaleX*(c+(a[u+1]-c)*h)-s.scaleX)*o,s.scaleY+=(s.data.scaleY*(l+(a[u+2]-l)*h)-s.scaleY)*o}}},r.ColorTimeline=function(t){this.curves=new r.Curves(t),this.frames=[],this.frames.length=5*t},r.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(t,e,n,r,i,o){t*=5,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r,this.frames[t+3]=i,this.frames[t+4]=o},apply:function(t,e,n,i,o){var a=this.frames;if(!(n<a[0])){var s,u,c,l;if(n>=a[a.length-5]){var f=a.length-1;s=a[f-3],u=a[f-2],c=a[f-1],l=a[f]}else{var h=r.Animation.binarySearch(a,n,5),p=a[h-4],d=a[h-3],m=a[h-2],v=a[h-1],g=a[h],y=1-(n-g)/(a[h-5]-g);y=this.curves.getCurvePercent(h/5-1,y),s=p+(a[h+1]-p)*y,u=d+(a[h+2]-d)*y,c=m+(a[h+3]-m)*y,l=v+(a[h+4]-v)*y}var b=t.slots[this.slotIndex];1>o?(b.r+=(s-b.r)*o,b.g+=(u-b.g)*o,b.b+=(c-b.b)*o,b.a+=(l-b.a)*o):(b.r=s,b.g=u,b.b=c,b.a=l)}}},r.AttachmentTimeline=function(t){this.curves=new r.Curves(t),this.frames=[],this.frames.length=t,this.attachmentNames=[],this.attachmentNames.length=t},r.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,n){this.frames[t]=e,this.attachmentNames[t]=n},apply:function(t,e,n){var i=this.frames;if(n<i[0])return void(e>n&&this.apply(t,e,Number.MAX_VALUE,null,0));e>n&&(e=-1);var o=n>=i[i.length-1]?i.length-1:r.Animation.binarySearch1(i,n)-1;if(!(i[o]<e)){var a=this.attachmentNames[o];t.slots[this.slotIndex].setAttachment(a?t.getAttachmentBySlotIndex(this.slotIndex,a):null)}}},r.EventTimeline=function(t){this.frames=[],this.frames.length=t,this.events=[],this.events.length=t},r.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(t,e,n){this.frames[t]=e,this.events[t]=n},apply:function(t,e,n,i,o){if(i){var a=this.frames,s=a.length;if(e>n)this.apply(t,e,Number.MAX_VALUE,i,o),e=-1;else if(e>=a[s-1])return;if(!(n<a[0])){var u;if(e<a[0])u=0;else{u=r.Animation.binarySearch1(a,e);for(var c=a[u];u>0&&a[u-1]==c;)u--}for(var l=this.events;s>u&&n>=a[u];u++)i.push(l[u])}}}},r.DrawOrderTimeline=function(t){this.frames=[],this.frames.length=t,this.drawOrders=[],this.drawOrders.length=t},r.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(t,e,n){this.frames[t]=e,this.drawOrders[t]=n},apply:function(t,e,n){var i=this.frames;if(!(n<i[0])){var o;o=n>=i[i.length-1]?i.length-1:r.Animation.binarySearch1(i,n)-1;var a=t.drawOrder,s=t.slots,u=this.drawOrders[o];if(u)for(var c=0,l=u.length;l>c;c++)a[c]=t.slots[u[c]];else for(var c=0,l=s.length;l>c;c++)a[c]=s[c]}}},r.FfdTimeline=function(t){this.curves=new r.Curves(t),this.frames=[],this.frames.length=t,this.frameVertices=[],this.frameVertices.length=t},r.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,n){this.frames[t]=e,this.frameVertices[t]=n},apply:function(t,e,n,i,o){var a=t.slots[this.slotIndex];if(a.attachment==this.attachment){var s=this.frames;if(!(n<s[0])){var u=this.frameVertices,c=u[0].length,l=a.attachmentVertices;if(l.length!=c&&(o=1),l.length=c,n>=s[s.length-1]){var f=u[s.length-1];if(1>o)for(var h=0;c>h;h++)l[h]+=(f[h]-l[h])*o;else for(var h=0;c>h;h++)l[h]=f[h]}else{var p=r.Animation.binarySearch1(s,n),d=s[p],m=1-(n-d)/(s[p-1]-d);m=this.curves.getCurvePercent(p-1,0>m?0:m>1?1:m);var v=u[p-1],g=u[p];if(1>o)for(var h=0;c>h;h++){var y=v[h];l[h]+=(y+(g[h]-y)*m-l[h])*o}else for(var h=0;c>h;h++){var y=v[h];l[h]=y+(g[h]-y)*m}}}}}},r.IkConstraintTimeline=function(t){this.curves=new r.Curves(t),this.frames=[],this.frames.length=3*t},r.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,n,r){t*=3,this.frames[t]=e,this.frames[t+1]=n,this.frames[t+2]=r},apply:function(t,e,n,i,o){var a=this.frames;if(!(n<a[0])){var s=t.ikConstraints[this.ikConstraintIndex];if(n>=a[a.length-3])return s.mix+=(a[a.length-2]-s.mix)*o,void(s.bendDirection=a[a.length-1]);var u=r.Animation.binarySearch(a,n,3),c=a[u+-2],l=a[u],f=1-(n-l)/(a[u+-3]-l);f=this.curves.getCurvePercent(u/3-1,f);var h=c+(a[u+1]-c)*f;s.mix+=(h-s.mix)*o,s.bendDirection=a[u+-1]}}},r.FlipXTimeline=function(t){this.curves=new r.Curves(t),this.frames=[],this.frames.length=2*t},r.FlipXTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,n){t*=2,this.frames[t]=e,this.frames[t+1]=n?1:0},apply:function(t,e,n){var i=this.frames;if(n<i[0])return void(e>n&&this.apply(t,e,Number.MAX_VALUE,null,0));e>n&&(e=-1);var o=(n>=i[i.length-2]?i.length:r.Animation.binarySearch(i,n,2))-2;i[o]<e||(t.bones[boneIndex].flipX=0!=i[o+1])}},r.FlipYTimeline=function(t){this.curves=new r.Curves(t),this.frames=[],this.frames.length=2*t},r.FlipYTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,n){t*=2,this.frames[t]=e,this.frames[t+1]=n?1:0},apply:function(t,e,n){var i=this.frames;if(n<i[0])return void(e>n&&this.apply(t,e,Number.MAX_VALUE,null,0));e>n&&(e=-1);var o=(n>=i[i.length-2]?i.length:r.Animation.binarySearch(i,n,2))-2;i[o]<e||(t.bones[boneIndex].flipY=0!=i[o+1])}},r.SkeletonData=function(){this.bones=[],this.slots=[],this.skins=[],this.events=[],this.animations=[],this.ikConstraints=[]},r.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(t){for(var e=this.bones,n=0,r=e.length;r>n;n++)if(e[n].name==t)return e[n];return null},findBoneIndex:function(t){for(var e=this.bones,n=0,r=e.length;r>n;n++)if(e[n].name==t)return n;return-1},findSlot:function(t){for(var e=this.slots,n=0,r=e.length;r>n;n++)if(e[n].name==t)return slot[n];return null},findSlotIndex:function(t){for(var e=this.slots,n=0,r=e.length;r>n;n++)if(e[n].name==t)return n;return-1},findSkin:function(t){for(var e=this.skins,n=0,r=e.length;r>n;n++)if(e[n].name==t)return e[n];return null},findEvent:function(t){for(var e=this.events,n=0,r=e.length;r>n;n++)if(e[n].name==t)return e[n];return null},findAnimation:function(t){for(var e=this.animations,n=0,r=e.length;r>n;n++)if(e[n].name==t)return e[n];return null},findIkConstraint:function(t){for(var e=this.ikConstraints,n=0,r=e.length;r>n;n++)if(e[n].name==t)return e[n];return null}},r.Skeleton=function(t){this.data=t,this.bones=[];for(var e=0,n=t.bones.length;n>e;e++){var i=t.bones[e],o=i.parent?this.bones[t.bones.indexOf(i.parent)]:null;this.bones.push(new r.Bone(i,this,o))}this.slots=[],this.drawOrder=[];for(var e=0,n=t.slots.length;n>e;e++){var a=t.slots[e],s=this.bones[t.bones.indexOf(a.boneData)],u=new r.Slot(a,s);this.slots.push(u),this.drawOrder.push(u)}this.ikConstraints=[];for(var e=0,n=t.ikConstraints.length;n>e;e++)this.ikConstraints.push(new r.IkConstraint(t.ikConstraints[e],this));this.boneCache=[],this.updateCache()},r.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:!1,flipY:!1,updateCache:function(){var t=this.ikConstraints,e=t.length,n=e+1,r=this.boneCache;r.length>n&&(r.length=n);for(var i=0,o=r.length;o>i;i++)r[i].length=0;for(;r.length<n;)r[r.length]=[];var a=r[0],s=this.bones;t:for(var i=0,o=s.length;o>i;i++){var u=s[i],c=u;do{for(var l=0;e>l;l++)for(var f=t[l],h=f.bones[0],p=f.bones[f.bones.length-1];;){if(c==p){r[l].push(u),r[l+1].push(u);continue t}if(p==h)break;p=p.parent}c=c.parent}while(c);a[a.length]=u}},updateWorldTransform:function(){for(var t=this.bones,e=0,n=t.length;n>e;e++){var r=t[e];r.rotationIK=r.rotation}for(var e=0,i=this.boneCache.length-1;;){for(var o=this.boneCache[e],a=0,s=o.length;s>a;a++)o[a].updateWorldTransform();if(e==i)break;this.ikConstraints[e].apply(),e++}},setToSetupPose:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},setBonesToSetupPose:function(){for(var t=this.bones,e=0,n=t.length;n>e;e++)t[e].setToSetupPose();for(var r=this.ikConstraints,e=0,n=r.length;n>e;e++){var i=r[e];i.bendDirection=i.data.bendDirection,i.mix=i.data.mix}},setSlotsToSetupPose:function(){for(var t=this.slots,e=this.drawOrder,n=0,r=t.length;r>n;n++)e[n]=t[n],t[n].setToSetupPose(n)},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(t){for(var e=this.bones,n=0,r=e.length;r>n;n++)if(e[n].data.name==t)return e[n];return null},findBoneIndex:function(t){for(var e=this.bones,n=0,r=e.length;r>n;n++)if(e[n].data.name==t)return n;return-1},findSlot:function(t){for(var e=this.slots,n=0,r=e.length;r>n;n++)if(e[n].data.name==t)return e[n];return null},findSlotIndex:function(t){for(var e=this.slots,n=0,r=e.length;r>n;n++)if(e[n].data.name==t)return n;return-1},setSkinByName:function(t){var e=this.data.findSkin(t);if(!e)throw"Skin not found: "+t;this.setSkin(e)},setSkin:function(t){if(t)if(this.skin)t._attachAll(this,this.skin);else for(var e=this.slots,n=0,r=e.length;r>n;n++){var i=e[n],o=i.data.attachmentName;if(o){var a=t.getAttachment(n,o);a&&i.setAttachment(a)}}this.skin=t},getAttachmentBySlotName:function(t,e){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(t),e)},getAttachmentBySlotIndex:function(t,e){if(this.skin){var n=this.skin.getAttachment(t,e);if(n)return n}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},setAttachment:function(t,e){for(var n=this.slots,r=0,i=n.length;i>r;r++){var o=n[r];if(o.data.name==t){var a=null;if(e&&(a=this.getAttachmentBySlotIndex(r,e),!a))throw"Attachment not found: "+e+", for slot: "+t;return void o.setAttachment(a)}}throw"Slot not found: "+t},findIkConstraint:function(t){for(var e=this.ikConstraints,n=0,r=e.length;r>n;n++)if(e[n].data.name==t)return e[n];return null},update:function(t){this.time+=t}},r.EventData=function(t){this.name=t},r.EventData.prototype={intValue:0,floatValue:0,stringValue:null},r.Event=function(t){this.data=t},r.Event.prototype={intValue:0,floatValue:0,stringValue:null},r.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3},r.RegionAttachment=function(t){this.name=t,this.offset=[],this.offset.length=8,this.uvs=[],this.uvs.length=8},r.RegionAttachment.prototype={type:r.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,e,n,r,i){var o=this.uvs;i?(o[2]=t,o[3]=r,o[4]=t,o[5]=e,o[6]=n,o[7]=e,o[0]=n,o[1]=r):(o[0]=t,o[1]=r,o[2]=t,o[3]=e,o[4]=n,o[5]=e,o[6]=n,o[7]=r)},updateOffset:function(){var t=this.width/this.regionOriginalWidth*this.scaleX,e=this.height/this.regionOriginalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.regionOffsetX*t,i=-this.height/2*this.scaleY+this.regionOffsetY*e,o=n+this.regionWidth*t,a=i+this.regionHeight*e,s=this.rotation*r.degRad,u=Math.cos(s),c=Math.sin(s),l=n*u+this.x,f=n*c,h=i*u+this.y,p=i*c,d=o*u+this.x,m=o*c,v=a*u+this.y,g=a*c,y=this.offset;y[0]=l-p,y[1]=h+f,y[2]=l-g,y[3]=v+f,y[4]=d-g,y[5]=v+m,y[6]=d-p,y[7]=h+m},computeVertices:function(t,e,n,r){t+=n.worldX,e+=n.worldY;var i=n.m00,o=n.m01,a=n.m10,s=n.m11,u=this.offset;r[0]=u[0]*i+u[1]*o+t,r[1]=u[0]*a+u[1]*s+e,r[2]=u[2]*i+u[3]*o+t,r[3]=u[2]*a+u[3]*s+e,r[4]=u[4]*i+u[5]*o+t,r[5]=u[4]*a+u[5]*s+e,r[6]=u[6]*i+u[7]*o+t,r[7]=u[6]*a+u[7]*s+e}},r.MeshAttachment=function(t){this.name=t},r.MeshAttachment.prototype={type:r.AttachmentType.mesh,vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var t=this.regionU2-this.regionU,e=this.regionV2-this.regionV,n=this.regionUVs.length;if(this.uvs&&this.uvs.length==n||(this.uvs=new r.Float32Array(n)),this.regionRotate)for(var i=0;n>i;i+=2)this.uvs[i]=this.regionU+this.regionUVs[i+1]*t,this.uvs[i+1]=this.regionV+e-this.regionUVs[i]*e;else for(var i=0;n>i;i+=2)this.uvs[i]=this.regionU+this.regionUVs[i]*t,this.uvs[i+1]=this.regionV+this.regionUVs[i+1]*e},computeWorldVertices:function(t,e,n,r){var i=n.bone;t+=i.worldX,e+=i.worldY;var o=i.m00,a=i.m01,s=i.m10,u=i.m11,c=this.vertices,l=c.length;n.attachmentVertices.length==l&&(c=n.attachmentVertices);for(var f=0;l>f;f+=2){var h=c[f],p=c[f+1];r[f]=h*o+p*a+t,r[f+1]=h*s+p*u+e}}},r.SkinnedMeshAttachment=function(t){this.name=t},r.SkinnedMeshAttachment.prototype={type:r.AttachmentType.skinnedmesh,bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:!1,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var t=this.regionU2-this.regionU,e=this.regionV2-this.regionV,n=this.regionUVs.length;if(this.uvs&&this.uvs.length==n||(this.uvs=new r.Float32Array(n)),this.regionRotate)for(var i=0;n>i;i+=2)this.uvs[i]=this.regionU+this.regionUVs[i+1]*t,this.uvs[i+1]=this.regionV+e-this.regionUVs[i]*e;else for(var i=0;n>i;i+=2)this.uvs[i]=this.regionU+this.regionUVs[i]*t,this.uvs[i+1]=this.regionV+this.regionUVs[i+1]*e},computeWorldVertices:function(t,e,n,r){var i,o,a,s,u,c,l,f=n.bone.skeleton.bones,h=this.weights,p=this.bones,d=0,m=0,v=0,g=0,y=p.length;if(n.attachmentVertices.length)for(var b=n.attachmentVertices;y>m;d+=2){for(o=0,a=0,i=p[m++]+m;i>m;m++,v+=3,g+=2)s=f[p[m]],u=h[v]+b[g],c=h[v+1]+b[g+1],l=h[v+2],o+=(u*s.m00+c*s.m01+s.worldX)*l,a+=(u*s.m10+c*s.m11+s.worldY)*l;r[d]=o+t,r[d+1]=a+e}else for(;y>m;d+=2){for(o=0,a=0,i=p[m++]+m;i>m;m++,v+=3)s=f[p[m]],u=h[v],c=h[v+1],l=h[v+2],o+=(u*s.m00+c*s.m01+s.worldX)*l,a+=(u*s.m10+c*s.m11+s.worldY)*l;r[d]=o+t,r[d+1]=a+e}}},r.BoundingBoxAttachment=function(t){this.name=t,this.vertices=[]},r.BoundingBoxAttachment.prototype={type:r.AttachmentType.boundingbox,computeWorldVertices:function(t,e,n,r){t+=n.worldX,e+=n.worldY;for(var i=n.m00,o=n.m01,a=n.m10,s=n.m11,u=this.vertices,c=0,l=u.length;l>c;c+=2){var f=u[c],h=u[c+1];r[c]=f*i+h*o+t,r[c+1]=f*a+h*s+e}}},r.AnimationStateData=function(t){this.skeletonData=t,this.animationToMixTime={}},r.AnimationStateData.prototype={defaultMix:0,setMixByName:function(t,e,n){var r=this.skeletonData.findAnimation(t);if(!r)throw"Animation not found: "+t;var i=this.skeletonData.findAnimation(e);if(!i)throw"Animation not found: "+e;this.setMix(r,i,n)},setMix:function(t,e,n){this.animationToMixTime[t.name+":"+e.name]=n},getMix:function(t,e){var n=t.name+":"+e.name;return this.animationToMixTime.hasOwnProperty(n)?this.animationToMixTime[n]:this.defaultMix}},r.TrackEntry=function(){},r.TrackEntry.prototype={next:null,previous:null,animation:null,loop:!1,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null},r.AnimationState=function(t){this.data=t,this.tracks=[],this.events=[]},r.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(t){t*=this.timeScale;for(var e=0;e<this.tracks.length;e++){var n=this.tracks[e];if(n){if(n.time+=t*n.timeScale,n.previous){var r=t*n.previous.timeScale;n.previous.time+=r,n.mixTime+=r}var i=n.next;i?(i.time=n.lastTime-i.delay,i.time>=0&&this.setCurrent(e,i)):!n.loop&&n.lastTime>=n.endTime&&this.clearTrack(e)}}},apply:function(t){for(var e=0;e<this.tracks.length;e++){var n=this.tracks[e];if(n){this.events.length=0;var r=n.time,i=n.lastTime,o=n.endTime,a=n.loop;!a&&r>o&&(r=o);var s=n.previous;if(s){var u=s.time;!s.loop&&u>s.endTime&&(u=s.endTime),s.animation.apply(t,u,u,s.loop,null);var c=n.mixTime/n.mixDuration*n.mix;c>=1&&(c=1,n.previous=null),n.animation.mix(t,n.lastTime,r,a,this.events,c)}else 1==n.mix?n.animation.apply(t,n.lastTime,r,a,this.events):n.animation.mix(t,n.lastTime,r,a,this.events,n.mix);for(var l=0,f=this.events.length;f>l;l++){var h=this.events[l];n.onEvent&&n.onEvent(e,h),this.onEvent&&this.onEvent(e,h)}if(a?i%o>r%o:o>i&&r>=o){var p=Math.floor(r/o);n.onComplete&&n.onComplete(e,p),this.onComplete&&this.onComplete(e,p)}n.lastTime=n.time}}},clearTracks:function(){for(var t=0,e=this.tracks.length;e>t;t++)this.clearTrack(t);this.tracks.length=0},clearTrack:function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];e&&(e.onEnd&&e.onEnd(t),this.onEnd&&this.onEnd(t),this.tracks[t]=null)}},_expandToIndex:function(t){if(t<this.tracks.length)return this.tracks[t];for(;t>=this.tracks.length;)this.tracks.push(null);return null},setCurrent:function(t,e){var n=this._expandToIndex(t);if(n){var r=n.previous;n.previous=null,n.onEnd&&n.onEnd(t),this.onEnd&&this.onEnd(t),e.mixDuration=this.data.getMix(n.animation,e.animation),e.mixDuration>0&&(e.mixTime=0,e.previous=r&&n.mixTime/n.mixDuration<.5?r:n)}this.tracks[t]=e,e.onStart&&e.onStart(t),this.onStart&&this.onStart(t)},setAnimationByName:function(t,e,n){var r=this.data.skeletonData.findAnimation(e);if(!r)throw"Animation not found: "+e;return this.setAnimation(t,r,n)},setAnimation:function(t,e,n){var i=new r.TrackEntry;return i.animation=e,i.loop=n,i.endTime=e.duration,this.setCurrent(t,i),i},addAnimationByName:function(t,e,n,r){var i=this.data.skeletonData.findAnimation(e);if(!i)throw"Animation not found: "+e;return this.addAnimation(t,i,n,r)},addAnimation:function(t,e,n,i){var o=new r.TrackEntry;o.animation=e,o.loop=n,o.endTime=e.duration;var a=this._expandToIndex(t);if(a){for(;a.next;)a=a.next;a.next=o}else this.tracks[t]=o;return 0>=i&&(a?i+=a.endTime-this.data.getMix(a.animation,e):i=0),o.delay=i,o},getCurrent:function(t){return t>=this.tracks.length?null:this.tracks[t]}},r.SkeletonJson=function(t){this.attachmentLoader=t},r.SkeletonJson.prototype={scale:1,readSkeletonData:function(t,e){var n=new r.SkeletonData;n.name=e;var i=t.skeleton;i&&(n.hash=i.hash,n.version=i.spine,n.width=i.width||0,n.height=i.height||0);for(var o=t.bones,a=0,s=o.length;s>a;a++){var u=o[a],c=null;if(u.parent&&(c=n.findBone(u.parent),!c))throw"Parent bone not found: "+u.parent;var l=new r.BoneData(u.name,c);l.length=(u.length||0)*this.scale,l.x=(u.x||0)*this.scale,l.y=(u.y||0)*this.scale,l.rotation=u.rotation||0,l.scaleX=u.hasOwnProperty("scaleX")?u.scaleX:1,l.scaleY=u.hasOwnProperty("scaleY")?u.scaleY:1,l.inheritScale=u.hasOwnProperty("inheritScale")?u.inheritScale:!0,l.inheritRotation=u.hasOwnProperty("inheritRotation")?u.inheritRotation:!0,n.bones.push(l)}var f=t.ik;if(f)for(var a=0,s=f.length;s>a;a++){for(var h=f[a],p=new r.IkConstraintData(h.name),o=h.bones,d=0,m=o.length;m>d;d++){var v=n.findBone(o[d]);if(!v)throw"IK bone not found: "+o[d];p.bones.push(v)}if(p.target=n.findBone(h.target),!p.target)throw"Target bone not found: "+h.target;p.bendDirection=!h.hasOwnProperty("bendPositive")||h.bendPositive?1:-1,p.mix=h.hasOwnProperty("mix")?h.mix:1,n.ikConstraints.push(p)}for(var g=t.slots,a=0,s=g.length;s>a;a++){var y=g[a],l=n.findBone(y.bone);if(!l)throw"Slot bone not found: "+y.bone;var b=new r.SlotData(y.name,l),_=y.color;_&&(b.r=this.toColor(_,0),b.g=this.toColor(_,1),b.b=this.toColor(_,2),b.a=this.toColor(_,3)),b.attachmentName=y.attachment,b.additiveBlending=y.additive&&"true"==y.additive,n.slots.push(b)}var w=t.skins;for(var x in w)if(w.hasOwnProperty(x)){var E=w[x],C=new r.Skin(x);for(var T in E)if(E.hasOwnProperty(T)){var S=n.findSlotIndex(T),A=E[T];for(var k in A)if(A.hasOwnProperty(k)){var O=this.readAttachment(C,k,A[k]);O&&C.addAttachment(S,k,O)}}n.skins.push(C),"default"==C.name&&(n.defaultSkin=C)}var M=t.events;for(var j in M)if(M.hasOwnProperty(j)){var R=M[j],N=new r.EventData(j);N.intValue=R["int"]||0,N.floatValue=R["float"]||0,N.stringValue=R.string||null,n.events.push(N)}var I=t.animations;for(var P in I)I.hasOwnProperty(P)&&this.readAnimation(P,I[P],n);return n},readAttachment:function(t,e,n){e=n.name||e;var i=r.AttachmentType[n.type||"region"],o=n.path||e,a=this.scale;
if(i==r.AttachmentType.region){var s=this.attachmentLoader.newRegionAttachment(t,e,o);if(!s)return null;s.path=o,s.x=(n.x||0)*a,s.y=(n.y||0)*a,s.scaleX=n.hasOwnProperty("scaleX")?n.scaleX:1,s.scaleY=n.hasOwnProperty("scaleY")?n.scaleY:1,s.rotation=n.rotation||0,s.width=(n.width||0)*a,s.height=(n.height||0)*a;var u=n.color;return u&&(s.r=this.toColor(u,0),s.g=this.toColor(u,1),s.b=this.toColor(u,2),s.a=this.toColor(u,3)),s.updateOffset(),s}if(i==r.AttachmentType.mesh){var c=this.attachmentLoader.newMeshAttachment(t,e,o);return c?(c.path=o,c.vertices=this.getFloatArray(n,"vertices",a),c.triangles=this.getIntArray(n,"triangles"),c.regionUVs=this.getFloatArray(n,"uvs",1),c.updateUVs(),u=n.color,u&&(c.r=this.toColor(u,0),c.g=this.toColor(u,1),c.b=this.toColor(u,2),c.a=this.toColor(u,3)),c.hullLength=2*(n.hull||0),n.edges&&(c.edges=this.getIntArray(n,"edges")),c.width=(n.width||0)*a,c.height=(n.height||0)*a,c):null}if(i==r.AttachmentType.skinnedmesh){var c=this.attachmentLoader.newSkinnedMeshAttachment(t,e,o);if(!c)return null;c.path=o;for(var l=this.getFloatArray(n,"uvs",1),f=this.getFloatArray(n,"vertices",1),h=[],p=[],d=0,m=f.length;m>d;){var v=0|f[d++];p[p.length]=v;for(var g=d+4*v;g>d;)p[p.length]=f[d],h[h.length]=f[d+1]*a,h[h.length]=f[d+2]*a,h[h.length]=f[d+3],d+=4}return c.bones=p,c.weights=h,c.triangles=this.getIntArray(n,"triangles"),c.regionUVs=l,c.updateUVs(),u=n.color,u&&(c.r=this.toColor(u,0),c.g=this.toColor(u,1),c.b=this.toColor(u,2),c.a=this.toColor(u,3)),c.hullLength=2*(n.hull||0),n.edges&&(c.edges=this.getIntArray(n,"edges")),c.width=(n.width||0)*a,c.height=(n.height||0)*a,c}if(i==r.AttachmentType.boundingbox){for(var y=this.attachmentLoader.newBoundingBoxAttachment(t,e),f=n.vertices,d=0,m=f.length;m>d;d++)y.vertices.push(f[d]*a);return y}throw"Unknown attachment type: "+i},readAnimation:function(t,e,n){var i=[],o=0,a=e.slots;for(var s in a)if(a.hasOwnProperty(s)){var u=a[s],c=n.findSlotIndex(s);for(var l in u)if(u.hasOwnProperty(l)){var f=u[l];if("color"==l){var h=new r.ColorTimeline(f.length);h.slotIndex=c;for(var p=0,d=0,m=f.length;m>d;d++){var v=f[d],g=v.color,y=this.toColor(g,0),b=this.toColor(g,1),_=this.toColor(g,2),w=this.toColor(g,3);h.setFrame(p,v.time,y,b,_,w),this.readCurve(h,p,v),p++}i.push(h),o=Math.max(o,h.frames[5*h.getFrameCount()-5])}else{if("attachment"!=l)throw"Invalid timeline type for a slot: "+l+" ("+s+")";var h=new r.AttachmentTimeline(f.length);h.slotIndex=c;for(var p=0,d=0,m=f.length;m>d;d++){var v=f[d];h.setFrame(p++,v.time,v.name)}i.push(h),o=Math.max(o,h.frames[h.getFrameCount()-1])}}}var x=e.bones;for(var E in x)if(x.hasOwnProperty(E)){var C=n.findBoneIndex(E);if(-1==C)throw"Bone not found: "+E;var T=x[E];for(var l in T)if(T.hasOwnProperty(l)){var f=T[l];if("rotate"==l){var h=new r.RotateTimeline(f.length);h.boneIndex=C;for(var p=0,d=0,m=f.length;m>d;d++){var v=f[d];h.setFrame(p,v.time,v.angle),this.readCurve(h,p,v),p++}i.push(h),o=Math.max(o,h.frames[2*h.getFrameCount()-2])}else if("translate"==l||"scale"==l){var h,S=1;"scale"==l?h=new r.ScaleTimeline(f.length):(h=new r.TranslateTimeline(f.length),S=this.scale),h.boneIndex=C;for(var p=0,d=0,m=f.length;m>d;d++){var v=f[d],A=(v.x||0)*S,k=(v.y||0)*S;h.setFrame(p,v.time,A,k),this.readCurve(h,p,v),p++}i.push(h),o=Math.max(o,h.frames[3*h.getFrameCount()-3])}else{if("flipX"!=l&&"flipY"!=l)throw"Invalid timeline type for a bone: "+l+" ("+E+")";var A="flipX"==l,h=A?new r.FlipXTimeline(f.length):new r.FlipYTimeline(f.length);h.boneIndex=C;for(var O=A?"x":"y",p=0,d=0,m=f.length;m>d;d++){var v=f[d];h.setFrame(p,v.time,v[O]||!1),p++}i.push(h),o=Math.max(o,h.frames[2*h.getFrameCount()-2])}}}var M=e.ik;for(var j in M)if(M.hasOwnProperty(j)){var R=n.findIkConstraint(j),f=M[j],h=new r.IkConstraintTimeline(f.length);h.ikConstraintIndex=n.ikConstraints.indexOf(R);for(var p=0,d=0,m=f.length;m>d;d++){var v=f[d],N=v.hasOwnProperty("mix")?v.mix:1,I=!v.hasOwnProperty("bendPositive")||v.bendPositive?1:-1;h.setFrame(p,v.time,N,I),this.readCurve(h,p,v),p++}i.push(h),o=Math.max(o,h.frames[3*h.frameCount-3])}var P=e.ffd;for(var D in P){var L=n.findSkin(D),u=P[D];for(s in u){var c=n.findSlotIndex(s),B=u[s];for(var F in B){var f=B[F],h=new r.FfdTimeline(f.length),U=L.getAttachment(c,F);if(!U)throw"FFD attachment not found: "+F;h.slotIndex=c,h.attachment=U;var q,V=U.type==r.AttachmentType.mesh;q=V?U.vertices.length:U.weights.length/3*2;for(var p=0,d=0,m=f.length;m>d;d++){var W,v=f[d];if(v.vertices){var G=v.vertices,W=[];W.length=q;var z=v.offset||0,H=G.length;if(1==this.scale)for(var Y=0;H>Y;Y++)W[Y+z]=G[Y];else for(var Y=0;H>Y;Y++)W[Y+z]=G[Y]*this.scale;if(V)for(var $=U.vertices,Y=0,H=W.length;H>Y;Y++)W[Y]+=$[Y]}else V?W=U.vertices:(W=[],W.length=q);h.setFrame(p,v.time,W),this.readCurve(h,p,v),p++}i[i.length]=h,o=Math.max(o,h.frames[h.frameCount-1])}}}var X=e.drawOrder;if(X||(X=e.draworder),X){for(var h=new r.DrawOrderTimeline(X.length),J=n.slots.length,p=0,d=0,m=X.length;m>d;d++){var K=X[d],Q=null;if(K.offsets){Q=[],Q.length=J;for(var Y=J-1;Y>=0;Y--)Q[Y]=-1;var Z=K.offsets,te=[];te.length=J-Z.length;for(var ee=0,ne=0,Y=0,H=Z.length;H>Y;Y++){var re=Z[Y],c=n.findSlotIndex(re.slot);if(-1==c)throw"Slot not found: "+re.slot;for(;ee!=c;)te[ne++]=ee++;Q[ee+re.offset]=ee++}for(;J>ee;)te[ne++]=ee++;for(var Y=J-1;Y>=0;Y--)-1==Q[Y]&&(Q[Y]=te[--ne])}h.setFrame(p++,K.time,Q)}i.push(h),o=Math.max(o,h.frames[h.getFrameCount()-1])}var ie=e.events;if(ie){for(var h=new r.EventTimeline(ie.length),p=0,d=0,m=ie.length;m>d;d++){var oe=ie[d],ae=n.findEvent(oe.name);if(!ae)throw"Event not found: "+oe.name;var se=new r.Event(ae);se.intValue=oe.hasOwnProperty("int")?oe["int"]:ae.intValue,se.floatValue=oe.hasOwnProperty("float")?oe["float"]:ae.floatValue,se.stringValue=oe.hasOwnProperty("string")?oe.string:ae.stringValue,h.setFrame(p++,oe.time,se)}i.push(h),o=Math.max(o,h.frames[h.getFrameCount()-1])}n.animations.push(new r.Animation(t,i,o))},readCurve:function(t,e,n){var r=n.curve;r?"stepped"==r?t.curves.setStepped(e):r instanceof Array&&t.curves.setCurve(e,r[0],r[1],r[2],r[3]):t.curves.setLinear(e)},toColor:function(t,e){if(8!=t.length)throw"Color hexidecimal length must be 8, recieved: "+t;return parseInt(t.substring(2*e,2*e+2),16)/255},getFloatArray:function(t,e,n){var i=t[e],o=new r.Float32Array(i.length),a=0,s=i.length;if(1==n)for(;s>a;a++)o[a]=i[a];else for(;s>a;a++)o[a]=i[a]*n;return o},getIntArray:function(t,e){for(var n=t[e],i=new r.Uint16Array(n.length),o=0,a=n.length;a>o;o++)i[o]=0|n[o];return i}},r.Atlas=function(t,e){this.textureLoader=e,this.pages=[],this.regions=[];var n=new r.AtlasReader(t),i=[];i.length=4;for(var o=null;;){var a=n.readLine();if(null===a)break;if(a=n.trim(a),a.length)if(o){var s=new r.AtlasRegion;s.name=a,s.page=o,s.rotate="true"==n.readValue(),n.readTuple(i);var u=parseInt(i[0]),c=parseInt(i[1]);n.readTuple(i);var l=parseInt(i[0]),f=parseInt(i[1]);s.u=u/o.width,s.v=c/o.height,s.rotate?(s.u2=(u+f)/o.width,s.v2=(c+l)/o.height):(s.u2=(u+l)/o.width,s.v2=(c+f)/o.height),s.x=u,s.y=c,s.width=Math.abs(l),s.height=Math.abs(f),4==n.readTuple(i)&&(s.splits=[parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],4==n.readTuple(i)&&(s.pads=[parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),parseInt(i[3])],n.readTuple(i))),s.originalWidth=parseInt(i[0]),s.originalHeight=parseInt(i[1]),n.readTuple(i),s.offsetX=parseInt(i[0]),s.offsetY=parseInt(i[1]),s.index=parseInt(n.readValue()),this.regions.push(s)}else{o=new r.AtlasPage,o.name=a,2==n.readTuple(i)&&(o.width=parseInt(i[0]),o.height=parseInt(i[1]),n.readTuple(i)),o.format=r.Atlas.Format[i[0]],n.readTuple(i),o.minFilter=r.Atlas.TextureFilter[i[0]],o.magFilter=r.Atlas.TextureFilter[i[1]];var h=n.readValue();o.uWrap=r.Atlas.TextureWrap.clampToEdge,o.vWrap=r.Atlas.TextureWrap.clampToEdge,"x"==h?o.uWrap=r.Atlas.TextureWrap.repeat:"y"==h?o.vWrap=r.Atlas.TextureWrap.repeat:"xy"==h&&(o.uWrap=o.vWrap=r.Atlas.TextureWrap.repeat),e.load(o,a,this),this.pages.push(o)}else o=null}},r.Atlas.prototype={findRegion:function(t){for(var e=this.regions,n=0,r=e.length;r>n;n++)if(e[n].name==t)return e[n];return null},dispose:function(){for(var t=this.pages,e=0,n=t.length;n>e;e++)this.textureLoader.unload(t[e].rendererObject)},updateUVs:function(t){for(var e=this.regions,n=0,r=e.length;r>n;n++){var i=e[n];i.page==t&&(i.u=i.x/t.width,i.v=i.y/t.height,i.rotate?(i.u2=(i.x+i.height)/t.width,i.v2=(i.y+i.width)/t.height):(i.u2=(i.x+i.width)/t.width,i.v2=(i.y+i.height)/t.height))}}},r.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6},r.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6},r.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2},r.AtlasPage=function(){},r.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0},r.AtlasRegion=function(){},r.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:!1,splits:null,pads:null},r.AtlasReader=function(t){this.lines=t.split(/\r\n|\r|\n/)},r.AtlasReader.prototype={index:0,trim:function(t){return t.replace(/^\s+|\s+$/g,"")},readLine:function(){return this.index>=this.lines.length?null:this.lines[this.index++]},readValue:function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw"Invalid line: "+t;return this.trim(t.substring(e+1))},readTuple:function(t){var e=this.readLine(),n=e.indexOf(":");if(-1==n)throw"Invalid line: "+e;for(var r=0,i=n+1;3>r;r++){var o=e.indexOf(",",i);if(-1==o)break;t[r]=this.trim(e.substr(i,o-i)),i=o+1}return t[r]=this.trim(e.substring(i)),r+1}},r.AtlasAttachmentLoader=function(t){this.atlas=t},r.AtlasAttachmentLoader.prototype={newRegionAttachment:function(t,e,n){var i=this.atlas.findRegion(n);if(!i)throw"Region not found in atlas: "+n+" (region attachment: "+e+")";var o=new r.RegionAttachment(e);return o.rendererObject=i,o.setUVs(i.u,i.v,i.u2,i.v2,i.rotate),o.regionOffsetX=i.offsetX,o.regionOffsetY=i.offsetY,o.regionWidth=i.width,o.regionHeight=i.height,o.regionOriginalWidth=i.originalWidth,o.regionOriginalHeight=i.originalHeight,o},newMeshAttachment:function(t,e,n){var i=this.atlas.findRegion(n);if(!i)throw"Region not found in atlas: "+n+" (mesh attachment: "+e+")";var o=new r.MeshAttachment(e);return o.rendererObject=i,o.regionU=i.u,o.regionV=i.v,o.regionU2=i.u2,o.regionV2=i.v2,o.regionRotate=i.rotate,o.regionOffsetX=i.offsetX,o.regionOffsetY=i.offsetY,o.regionWidth=i.width,o.regionHeight=i.height,o.regionOriginalWidth=i.originalWidth,o.regionOriginalHeight=i.originalHeight,o},newSkinnedMeshAttachment:function(t,e,n){var i=this.atlas.findRegion(n);if(!i)throw"Region not found in atlas: "+n+" (skinned mesh attachment: "+e+")";var o=new r.SkinnedMeshAttachment(e);return o.rendererObject=i,o.regionU=i.u,o.regionV=i.v,o.regionU2=i.u2,o.regionV2=i.v2,o.regionRotate=i.rotate,o.regionOffsetX=i.offsetX,o.regionOffsetY=i.offsetY,o.regionWidth=i.width,o.regionHeight=i.height,o.regionOriginalWidth=i.originalWidth,o.regionOriginalHeight=i.originalHeight,o},newBoundingBoxAttachment:function(t,e){return new r.BoundingBoxAttachment(e)}},r.SkeletonBounds=function(){this.polygonPool=[],this.polygons=[],this.boundingBoxes=[]},r.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(t,e){var n=t.slots,i=n.length,o=t.x,a=t.y,s=this.boundingBoxes,u=this.polygonPool,c=this.polygons;s.length=0;for(var l=0,f=c.length;f>l;l++)u.push(c[l]);c.length=0;for(var l=0;i>l;l++){var h=n[l],p=h.attachment;if(p.type==r.AttachmentType.boundingbox){s.push(p);var d,m=u.length;m>0?(d=u[m-1],u.splice(m-1,1)):d=[],c.push(d),d.length=p.vertices.length,p.computeWorldVertices(o,a,h.bone,d)}}e&&this.aabbCompute()},aabbCompute:function(){for(var t=this.polygons,e=Number.MAX_VALUE,n=Number.MAX_VALUE,r=Number.MIN_VALUE,i=Number.MIN_VALUE,o=0,a=t.length;a>o;o++)for(var s=t[o],u=0,c=s.length;c>u;u+=2){var l=s[u],f=s[u+1];e=Math.min(e,l),n=Math.min(n,f),r=Math.max(r,l),i=Math.max(i,f)}this.minX=e,this.minY=n,this.maxX=r,this.maxY=i},aabbContainsPoint:function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},aabbIntersectsSegment:function(t,e,n,r){var i=this.minX,o=this.minY,a=this.maxX,s=this.maxY;if(i>=t&&i>=n||o>=e&&o>=r||t>=a&&n>=a||e>=s&&r>=s)return!1;var u=(r-e)/(n-t),c=u*(i-t)+e;if(c>o&&s>c)return!0;if(c=u*(a-t)+e,c>o&&s>c)return!0;var l=(o-e)/u+t;return l>i&&a>l?!0:(l=(s-e)/u+t,l>i&&a>l?!0:!1)},aabbIntersectsSkeleton:function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},containsPoint:function(t,e){for(var n=this.polygons,r=0,i=n.length;i>r;r++)if(this.polygonContainsPoint(n[r],t,e))return this.boundingBoxes[r];return null},intersectsSegment:function(t,e,n,r){for(var i=this.polygons,o=0,a=i.length;a>o;o++)if(i[o].intersectsSegment(t,e,n,r))return this.boundingBoxes[o];return null},polygonContainsPoint:function(t,e,n){for(var r=t.length,i=r-2,o=!1,a=0;r>a;a+=2){var s=t[a+1],u=t[i+1];if(n>s&&u>=n||n>u&&s>=n){var c=t[a];c+(n-s)/(u-s)*(t[i]-c)<e&&(o=!o)}i=a}return o},polygonIntersectsSegment:function(t,e,n,r,i){for(var o=t.length,a=e-r,s=n-i,u=e*i-n*r,c=t[o-2],l=t[o-1],f=0;o>f;f+=2){var h=t[f],p=t[f+1],d=c*p-l*h,m=c-h,v=l-p,g=a*v-s*m,y=(u*m-a*d)/g;if((y>=c&&h>=y||y>=h&&c>=y)&&(y>=e&&r>=y||y>=r&&e>=y)){var b=(u*v-s*d)/g;if((b>=l&&p>=b||b>=p&&l>=b)&&(b>=n&&i>=b||b>=i&&n>=b))return!0}c=h,l=p}return!1},getPolygon:function(t){var e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}},r.Bone.yDown=!0,n.AnimCache={},n.SpineTextureLoader=function(t,e){n.EventTarget.call(this),this.basePath=t,this.crossorigin=e,this.loadingCount=0},n.SpineTextureLoader.prototype=n.SpineTextureLoader,n.SpineTextureLoader.prototype.load=function(t,e){if(t.rendererObject=n.BaseTexture.fromImage(this.basePath+"/"+e,this.crossorigin),!t.rendererObject.hasLoaded){var r=this;++r.loadingCount,t.rendererObject.addEventListener("loaded",function(){--r.loadingCount,r.dispatchEvent({type:"loadedBaseTexture",content:r})})}},n.SpineTextureLoader.prototype.unload=function(t){t.destroy(!0)},n.Spine=function(t){if(n.DisplayObjectContainer.call(this),this.spineData=n.AnimCache[t],!this.spineData)throw new Error("Spine data must be preloaded using PIXI.SpineLoader or PIXI.AssetLoader: "+t);this.skeleton=new r.Skeleton(this.spineData),this.skeleton.updateWorldTransform(),this.stateData=new r.AnimationStateData(this.spineData),this.state=new r.AnimationState(this.stateData),this.slotContainers=[];for(var e=0,i=this.skeleton.drawOrder.length;i>e;e++){var o=this.skeleton.drawOrder[e],a=o.attachment,s=new n.DisplayObjectContainer;if(this.slotContainers.push(s),this.addChild(s),a instanceof r.RegionAttachment){var u=a.rendererObject.name,c=this.createSprite(o,a);o.currentSprite=c,o.currentSpriteName=u,s.addChild(c)}else{if(!(a instanceof r.MeshAttachment))continue;var l=this.createMesh(o,a);o.currentMesh=l,o.currentMeshName=a.name,s.addChild(l)}}this.autoUpdate=!0},n.Spine.prototype=Object.create(n.DisplayObjectContainer.prototype),n.Spine.prototype.constructor=n.Spine,Object.defineProperty(n.Spine.prototype,"autoUpdate",{get:function(){return this.updateTransform===n.Spine.prototype.autoUpdateTransform},set:function(t){this.updateTransform=t?n.Spine.prototype.autoUpdateTransform:n.DisplayObjectContainer.prototype.updateTransform}}),n.Spine.prototype.update=function(t){this.state.update(t),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform();for(var e=this.skeleton.drawOrder,i=0,o=e.length;o>i;i++){var a=e[i],s=a.attachment,u=this.slotContainers[i];if(s){var c=s.type;if(c===r.AttachmentType.region){if(s.rendererObject&&(!a.currentSpriteName||a.currentSpriteName!==s.name)){var l=s.rendererObject.name;if(void 0!==a.currentSprite&&(a.currentSprite.visible=!1),a.sprites=a.sprites||{},void 0!==a.sprites[l])a.sprites[l].visible=!0;else{var f=this.createSprite(a,s);u.addChild(f)}a.currentSprite=a.sprites[l],a.currentSpriteName=l}var h=a.bone;u.position.x=h.worldX+s.x*h.m00+s.y*h.m01,u.position.y=h.worldY+s.x*h.m10+s.y*h.m11,u.scale.x=h.worldScaleX,u.scale.y=h.worldScaleY,u.rotation=-(a.bone.worldRotation*r.degRad),a.currentSprite.tint=n.rgb2hex([a.r,a.g,a.b])}else{if(c!==r.AttachmentType.skinnedmesh){u.visible=!1;continue}if(!a.currentMeshName||a.currentMeshName!==s.name){var p=s.name;if(void 0!==a.currentMesh&&(a.currentMesh.visible=!1),a.meshes=a.meshes||{},void 0!==a.meshes[p])a.meshes[p].visible=!0;else{var d=this.createMesh(a,s);u.addChild(d)}a.currentMesh=a.meshes[p],a.currentMeshName=p}s.computeWorldVertices(a.bone.skeleton.x,a.bone.skeleton.y,a,a.currentMesh.vertices)}u.visible=!0,u.alpha=a.a}else u.visible=!1}},n.Spine.prototype.autoUpdateTransform=function(){this.lastTime=this.lastTime||Date.now();var t=.001*(Date.now()-this.lastTime);this.lastTime=Date.now(),this.update(t),n.DisplayObjectContainer.prototype.updateTransform.call(this)},n.Spine.prototype.createSprite=function(t,e){var i=e.rendererObject,o=i.page.rendererObject,a=new n.Rectangle(i.x,i.y,i.rotate?i.height:i.width,i.rotate?i.width:i.height),s=new n.Texture(o,a),u=new n.Sprite(s),c=i.rotate?.5*Math.PI:0;return u.scale.set(i.width/i.originalWidth,i.height/i.originalHeight),u.rotation=c-e.rotation*r.degRad,u.anchor.x=u.anchor.y=.5,t.sprites=t.sprites||{},t.sprites[i.name]=u,u},n.Spine.prototype.createMesh=function(t,e){var r=e.rendererObject,i=r.page.rendererObject,o=new n.Texture(i),a=new n.Strip(o);return a.drawMode=n.Strip.DrawModes.TRIANGLES,a.canvasPadding=1.5,a.vertices=new n.Float32Array(e.uvs.length),a.uvs=e.uvs,a.indices=e.triangles,t.meshes=t.meshes||{},t.meshes[e.name]=a,a},n.BaseTextureCache={},n.BaseTextureCacheIdGenerator=0,n.BaseTexture=function(t,e){if(this.resolution=1,this.width=100,this.height=100,this.scaleMode=e||n.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=t,this._UID=n._UID++,this.premultipliedAlpha=!0,this._glTextures=[],this.mipmap=!1,this._dirty=[!0,!0,!0,!0],t){if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty();else{var r=this;this.source.onload=function(){r.hasLoaded=!0,r.width=r.source.naturalWidth||r.source.width,r.height=r.source.naturalHeight||r.source.height,r.dirty(),r.dispatchEvent({type:"loaded",content:r})},this.source.onerror=function(){r.dispatchEvent({type:"error",content:r})}}this.imageUrl=null,this._powerOf2=!1}},n.BaseTexture.prototype.constructor=n.BaseTexture,n.EventTarget.mixin(n.BaseTexture.prototype),n.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete n.BaseTextureCache[this.imageUrl],delete n.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete n.BaseTextureCache[this.source._pixiId],this.source=null,this.unloadFromGPU()},n.BaseTexture.prototype.updateSourceImage=function(t){this.hasLoaded=!1,this.source.src=null,this.source.src=t},n.BaseTexture.prototype.dirty=function(){for(var t=0;t<this._glTextures.length;t++)this._dirty[t]=!0},n.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var t=this._glTextures.length-1;t>=0;t--){var e=this._glTextures[t],r=n.glContexts[t];r&&e&&r.deleteTexture(e)}this._glTextures.length=0,this.dirty()},n.BaseTexture.fromImage=function(t,e,r){var i=n.BaseTextureCache[t];if(void 0===e&&-1===t.indexOf("data:")&&(e=!0),!i){var o=new Image;e&&(o.crossOrigin=""),o.src=t,i=new n.BaseTexture(o,r),i.imageUrl=t,n.BaseTextureCache[t]=i,-1!==t.indexOf(n.RETINA_PREFIX+".")&&(i.resolution=2)}return i},n.BaseTexture.fromCanvas=function(t,e){t._pixiId||(t._pixiId="canvas_"+n.TextureCacheIdGenerator++);var r=n.BaseTextureCache[t._pixiId];return r||(r=new n.BaseTexture(t,e),n.BaseTextureCache[t._pixiId]=r),r},n.TextureCache={},n.FrameCache={},n.TextureCacheIdGenerator=0,n.Texture=function(t,e,r,i){this.noFrame=!1,e||(this.noFrame=!0,e=new n.Rectangle(0,0,1,1)),t instanceof n.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.trim=i,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=r||new n.Rectangle(0,0,1,1),t.hasLoaded?(this.noFrame&&(e=new n.Rectangle(0,0,t.width,t.height)),this.setFrame(e)):t.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))},n.Texture.prototype.constructor=n.Texture,n.EventTarget.mixin(n.Texture.prototype),n.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new n.Rectangle(0,0,t.width,t.height)),this.setFrame(this.frame),this.dispatchEvent({type:"update",content:this})},n.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy(),this.valid=!1},n.Texture.prototype.setFrame=function(t){if(this.noFrame=!1,this.frame=t,this.width=t.width,this.height=t.height,this.crop.x=t.x,this.crop.y=t.y,this.crop.width=t.width,this.crop.height=t.height,!this.trim&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=t&&t.width&&t.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs()},n.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new n.TextureUvs);var t=this.crop,e=this.baseTexture.width,r=this.baseTexture.height;this._uvs.x0=t.x/e,this._uvs.y0=t.y/r,this._uvs.x1=(t.x+t.width)/e,this._uvs.y1=t.y/r,this._uvs.x2=(t.x+t.width)/e,this._uvs.y2=(t.y+t.height)/r,this._uvs.x3=t.x/e,this._uvs.y3=(t.y+t.height)/r},n.Texture.fromImage=function(t,e,r){var i=n.TextureCache[t];return i||(i=new n.Texture(n.BaseTexture.fromImage(t,e,r)),n.TextureCache[t]=i),i},n.Texture.fromFrame=function(t){var e=n.TextureCache[t];if(!e)throw new Error('The frameId "'+t+'" does not exist in the texture cache ');return e},n.Texture.fromCanvas=function(t,e){var r=n.BaseTexture.fromCanvas(t,e);return new n.Texture(r)},n.Texture.addTextureToCache=function(t,e){n.TextureCache[e]=t},n.Texture.removeTextureFromCache=function(t){var e=n.TextureCache[t];return delete n.TextureCache[t],delete n.BaseTextureCache[t],e},n.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},n.Texture.emptyTexture=new n.Texture(new n.BaseTexture),n.RenderTexture=function(t,e,r,i,o){if(this.width=t||100,this.height=e||100,this.resolution=o||1,this.frame=new n.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new n.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new n.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=i||n.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,n.Texture.call(this,this.baseTexture,new n.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution)),this.renderer=r||n.defaultRenderer,this.renderer.type===n.WEBGL_RENDERER){var a=this.renderer.gl;this.baseTexture._dirty[a.id]=!1,this.textureBuffer=new n.FilterTexture(a,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[a.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new n.Point(.5*this.width,.5*-this.height)}else this.render=this.renderCanvas,this.textureBuffer=new n.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()},n.RenderTexture.prototype=Object.create(n.Texture.prototype),n.RenderTexture.prototype.constructor=n.RenderTexture,n.RenderTexture.prototype.resize=function(t,e,r){(t!==this.width||e!==this.height)&&(this.valid=t>0&&e>0,this.width=t,this.height=e,this.frame.width=this.crop.width=t*this.resolution,this.frame.height=this.crop.height=e*this.resolution,r&&(this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution),this.renderer.type===n.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width,this.height))},n.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===n.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},n.RenderTexture.prototype.renderWebGL=function(t,e,n){if(this.valid){var r=t.worldTransform;r.identity(),r.translate(0,2*this.projection.y),e&&r.append(e),r.scale(1,-1),t.worldAlpha=1;for(var i=t.children,o=0,a=i.length;a>o;o++)i[o].updateTransform();var s=this.renderer.gl;s.viewport(0,0,this.width*this.resolution,this.height*this.resolution),s.bindFramebuffer(s.FRAMEBUFFER,this.textureBuffer.frameBuffer),n&&this.textureBuffer.clear(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(t,this.projection,this.textureBuffer.frameBuffer),this.renderer.spriteBatch.dirty=!0}},n.RenderTexture.prototype.renderCanvas=function(t,e,n){if(this.valid){var r=t.worldTransform;r.identity(),e&&r.append(e),t.worldAlpha=1;for(var i=t.children,o=0,a=i.length;a>o;o++)i[o].updateTransform();n&&this.textureBuffer.clear();var s=this.textureBuffer.context,u=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(t,s),this.renderer.resolution=u}},n.RenderTexture.prototype.getImage=function(){var t=new Image;return t.src=this.getBase64(),t},n.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},n.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===n.WEBGL_RENDERER){var t=this.renderer.gl,e=this.textureBuffer.width,r=this.textureBuffer.height,i=new Uint8Array(4*e*r);t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer),t.readPixels(0,0,e,r,t.RGBA,t.UNSIGNED_BYTE,i),t.bindFramebuffer(t.FRAMEBUFFER,null);var o=new n.CanvasBuffer(e,r),a=o.context.getImageData(0,0,e,r);return a.data.set(i),o.context.putImageData(a,0,0),o.canvas}return this.textureBuffer.canvas},n.RenderTexture.tempMatrix=new n.Matrix,n.VideoTexture=function(t,e){if(!t)throw new Error("No video source element specified.");(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),n.BaseTexture.call(this,t,e),this.autoUpdate=!1,this.updateBound=this._onUpdate.bind(this),t.complete||(this._onCanPlay=this.onCanPlay.bind(this),t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("play",this.onPlayStart.bind(this)),t.addEventListener("pause",this.onPlayStop.bind(this)))},n.VideoTexture.prototype=Object.create(n.BaseTexture.prototype),n.VideoTexture.constructor=n.VideoTexture,n.VideoTexture.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this.updateBound),this.dirty())},n.VideoTexture.prototype.onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this.updateBound),this.autoUpdate=!0)},n.VideoTexture.prototype.onPlayStop=function(){this.autoUpdate=!1},n.VideoTexture.prototype.onCanPlay=function(){"canplaythrough"===event.type&&(this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.__loaded||(this.__loaded=!0,this.dispatchEvent({type:"loaded",content:this}))))},n.VideoTexture.prototype.destroy=function(){this.source&&this.source._pixiId&&(n.BaseTextureCache[this.source._pixiId]=null,delete n.BaseTextureCache[this.source._pixiId],this.source._pixiId=null,delete this.source._pixiId),n.BaseTexture.prototype.destroy.call(this)},n.VideoTexture.baseTextureFromVideo=function(t,e){t._pixiId||(t._pixiId="video_"+n.TextureCacheIdGenerator++);var r=n.BaseTextureCache[t._pixiId];return r||(r=new n.VideoTexture(t,e),n.BaseTextureCache[t._pixiId]=r),r},n.VideoTexture.textureFromVideo=function(t,e){var r=n.VideoTexture.baseTextureFromVideo(t,e);return new n.Texture(r)},n.VideoTexture.fromUrl=function(t,e){var r=document.createElement("video");return r.src=t,r.autoPlay=!0,r.play(),n.VideoTexture.textureFromVideo(r,e)},n.AssetLoader=function(t,e){this.assetURLs=t,this.crossorigin=e,this.loadersByType={jpg:n.ImageLoader,jpeg:n.ImageLoader,png:n.ImageLoader,gif:n.ImageLoader,webp:n.ImageLoader,json:n.JsonLoader,atlas:n.AtlasLoader,anim:n.SpineLoader,xml:n.BitmapFontLoader,fnt:n.BitmapFontLoader}},n.EventTarget.mixin(n.AssetLoader.prototype),n.AssetLoader.prototype.constructor=n.AssetLoader,n.AssetLoader.prototype._getDataType=function(t){var e="data:",n=t.slice(0,e.length).toLowerCase();if(n===e){var r=t.slice(e.length),i=r.indexOf(",");if(-1===i)return null;var o=r.slice(0,i).split(";")[0];return o&&"text/plain"!==o.toLowerCase()?o.split("/").pop().toLowerCase():"txt"}return null},n.AssetLoader.prototype.load=function(){function t(t){e.onAssetLoaded(t.data.content)}var e=this;this.loadCount=this.assetURLs.length;for(var n=0;n<this.assetURLs.length;n++){var r=this.assetURLs[n],i=this._getDataType(r);i||(i=r.split("?").shift().split(".").pop().toLowerCase());var o=this.loadersByType[i];if(!o)throw new Error(i+" is an unsupported file type");var a=new o(r,this.crossorigin);a.on("loaded",t),a.load()}},n.AssetLoader.prototype.onAssetLoaded=function(t){this.loadCount--,this.emit("onProgress",{content:this,loader:t,loaded:this.assetURLs.length-this.loadCount,total:this.assetURLs.length}),this.onProgress&&this.onProgress(t),this.loadCount||(this.emit("onComplete",{content:this}),this.onComplete&&this.onComplete())},n.JsonLoader=function(t,e){this.url=t,this.crossorigin=e,this.baseUrl=t.replace(/[^\/]*$/,""),this.loaded=!1},n.JsonLoader.prototype.constructor=n.JsonLoader,n.EventTarget.mixin(n.JsonLoader.prototype),n.JsonLoader.prototype.load=function(){window.XDomainRequest&&this.crossorigin?(this.ajaxRequest=new window.XDomainRequest,this.ajaxRequest.timeout=3e3,this.ajaxRequest.onerror=this.onError.bind(this),this.ajaxRequest.ontimeout=this.onError.bind(this),this.ajaxRequest.onprogress=function(){},this.ajaxRequest.onload=this.onJSONLoaded.bind(this)):(this.ajaxRequest=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP"),this.ajaxRequest.onreadystatechange=this.onReadyStateChanged.bind(this)),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.send()},n.JsonLoader.prototype.onReadyStateChanged=function(){4!==this.ajaxRequest.readyState||200!==this.ajaxRequest.status&&-1!==window.location.href.indexOf("http")||this.onJSONLoaded()},n.JsonLoader.prototype.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return void this.onError();if(this.json=JSON.parse(this.ajaxRequest.responseText),this.json.frames&&this.json.meta&&this.json.meta.image){var t=this.baseUrl+this.json.meta.image,e=new n.ImageLoader(t,this.crossorigin),i=this.json.frames;this.texture=e.texture.baseTexture,e.addEventListener("loaded",this.onLoaded.bind(this));for(var o in i){var a=i[o].frame;if(a){var s=new n.Rectangle(a.x,a.y,a.w,a.h),u=s.clone(),c=null;if(i[o].trimmed){var l=i[o].sourceSize,f=i[o].spriteSourceSize;c=new n.Rectangle(f.x,f.y,l.w,l.h)}n.TextureCache[o]=new n.Texture(this.texture,s,u,c)}}e.load()}else if(this.json.bones)if(n.AnimCache[this.url])this.onLoaded();else{var h=this.url.substr(0,this.url.lastIndexOf("."))+".atlas",p=new n.JsonLoader(h,this.crossorigin),d=this;p.onJSONLoaded=function(){if(!this.ajaxRequest.responseText)return void this.onError();var t=new n.SpineTextureLoader(this.url.substring(0,this.url.lastIndexOf("/"))),e=new r.Atlas(this.ajaxRequest.responseText,t),i=new r.AtlasAttachmentLoader(e),o=new r.SkeletonJson(i),a=o.readSkeletonData(d.json);
n.AnimCache[d.url]=a,d.spine=a,d.spineAtlas=e,d.spineAtlasLoader=p,t.loadingCount>0?t.addEventListener("loadedBaseTexture",function(t){t.content.content.loadingCount<=0&&d.onLoaded()}):d.onLoaded()},p.load()}else this.onLoaded()},n.JsonLoader.prototype.onLoaded=function(){this.loaded=!0,this.dispatchEvent({type:"loaded",content:this})},n.JsonLoader.prototype.onError=function(){this.dispatchEvent({type:"error",content:this})},n.AtlasLoader=function(t,e){this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.crossorigin=e,this.loaded=!1},n.AtlasLoader.constructor=n.AtlasLoader,n.EventTarget.mixin(n.AtlasLoader.prototype),n.AtlasLoader.prototype.load=function(){this.ajaxRequest=new n.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onAtlasLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},n.AtlasLoader.prototype.onAtlasLoaded=function(){if(4===this.ajaxRequest.readyState)if(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http")){this.atlas={meta:{image:[]},frames:[]};var t=this.ajaxRequest.responseText.split(/\r?\n/),e=-3,r=0,i=null,o=!1,a=0,s=0,u=this.onLoaded.bind(this);for(a=0;a<t.length;a++)if(t[a]=t[a].replace(/^\s+|\s+$/g,""),""===t[a]&&(o=a+1),t[a].length>0){if(o===a)this.atlas.meta.image.push(t[a]),r=this.atlas.meta.image.length-1,this.atlas.frames.push({}),e=-3;else if(e>0)if(e%7===1)null!=i&&(this.atlas.frames[r][i.name]=i),i={name:t[a],frame:{}};else{var c=t[a].split(" ");if(e%7===3)i.frame.x=Number(c[1].replace(",","")),i.frame.y=Number(c[2]);else if(e%7===4)i.frame.w=Number(c[1].replace(",","")),i.frame.h=Number(c[2]);else if(e%7===5){var l={x:0,y:0,w:Number(c[1].replace(",","")),h:Number(c[2])};l.w>i.frame.w||l.h>i.frame.h?(i.trimmed=!0,i.realSize=l):i.trimmed=!1}}e++}if(null!=i&&(this.atlas.frames[r][i.name]=i),this.atlas.meta.image.length>0){for(this.images=[],s=0;s<this.atlas.meta.image.length;s++){var f=this.baseUrl+this.atlas.meta.image[s],h=this.atlas.frames[s];this.images.push(new n.ImageLoader(f,this.crossorigin));for(a in h){var p=h[a].frame;p&&(n.TextureCache[a]=new n.Texture(this.images[s].texture.baseTexture,{x:p.x,y:p.y,width:p.w,height:p.h}),h[a].trimmed&&(n.TextureCache[a].realSize=h[a].realSize,n.TextureCache[a].trim.x=0,n.TextureCache[a].trim.y=0))}}for(this.currentImageId=0,s=0;s<this.images.length;s++)this.images[s].on("loaded",u);this.images[this.currentImageId].load()}else this.onLoaded()}else this.onError()},n.AtlasLoader.prototype.onLoaded=function(){this.images.length-1>this.currentImageId?(this.currentImageId++,this.images[this.currentImageId].load()):(this.loaded=!0,this.emit("loaded",{content:this}))},n.AtlasLoader.prototype.onError=function(){this.emit("error",{content:this})},n.SpriteSheetLoader=function(t,e){this.url=t,this.crossorigin=e,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.frames={}},n.SpriteSheetLoader.prototype.constructor=n.SpriteSheetLoader,n.EventTarget.mixin(n.SpriteSheetLoader.prototype),n.SpriteSheetLoader.prototype.load=function(){var t=this,e=new n.JsonLoader(this.url,this.crossorigin);e.on("loaded",function(e){t.json=e.data.content.json,t.onLoaded()}),e.load()},n.SpriteSheetLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})},n.ImageLoader=function(t,e){this.texture=n.Texture.fromImage(t,e),this.frames=[]},n.ImageLoader.prototype.constructor=n.ImageLoader,n.EventTarget.mixin(n.ImageLoader.prototype),n.ImageLoader.prototype.load=function(){this.texture.baseTexture.hasLoaded?this.onLoaded():this.texture.baseTexture.on("loaded",this.onLoaded.bind(this))},n.ImageLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})},n.ImageLoader.prototype.loadFramedSpriteSheet=function(t,e,r){this.frames=[];for(var i=Math.floor(this.texture.width/t),o=Math.floor(this.texture.height/e),a=0,s=0;o>s;s++)for(var u=0;i>u;u++,a++){var c=new n.Texture(this.texture.baseTexture,{x:u*t,y:s*e,width:t,height:e});this.frames.push(c),r&&(n.TextureCache[r+"-"+a]=c)}this.load()},n.BitmapFontLoader=function(t,e){this.url=t,this.crossorigin=e,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null},n.BitmapFontLoader.prototype.constructor=n.BitmapFontLoader,n.EventTarget.mixin(n.BitmapFontLoader.prototype),n.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new n.AjaxRequest,this.ajaxRequest.onreadystatechange=this.onXMLLoaded.bind(this),this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},n.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.protocol.indexOf("http"))){var t=this.ajaxRequest.responseXML;if(!t||/MSIE 9/i.test(navigator.userAgent)||navigator.isCocoonJS)if("function"==typeof window.DOMParser){var e=new DOMParser;t=e.parseFromString(this.ajaxRequest.responseText,"text/xml")}else{var r=document.createElement("div");r.innerHTML=this.ajaxRequest.responseText,t=r}var i=this.baseUrl+t.getElementsByTagName("page")[0].getAttribute("file"),o=new n.ImageLoader(i,this.crossorigin);this.texture=o.texture.baseTexture;var a={},s=t.getElementsByTagName("info")[0],u=t.getElementsByTagName("common")[0];a.font=s.getAttribute("face"),a.size=parseInt(s.getAttribute("size"),10),a.lineHeight=parseInt(u.getAttribute("lineHeight"),10),a.chars={};for(var c=t.getElementsByTagName("char"),l=0;l<c.length;l++){var f=parseInt(c[l].getAttribute("id"),10),h=new n.Rectangle(parseInt(c[l].getAttribute("x"),10),parseInt(c[l].getAttribute("y"),10),parseInt(c[l].getAttribute("width"),10),parseInt(c[l].getAttribute("height"),10));a.chars[f]={xOffset:parseInt(c[l].getAttribute("xoffset"),10),yOffset:parseInt(c[l].getAttribute("yoffset"),10),xAdvance:parseInt(c[l].getAttribute("xadvance"),10),kerning:{},texture:n.TextureCache[f]=new n.Texture(this.texture,h)}}var p=t.getElementsByTagName("kerning");for(l=0;l<p.length;l++){var d=parseInt(p[l].getAttribute("first"),10),m=parseInt(p[l].getAttribute("second"),10),v=parseInt(p[l].getAttribute("amount"),10);a.chars[m].kerning[d]=v}n.BitmapText.fonts[a.font]=a,o.addEventListener("loaded",this.onLoaded.bind(this)),o.load()}},n.BitmapFontLoader.prototype.onLoaded=function(){this.emit("loaded",{content:this})},n.SpineLoader=function(t,e){this.url=t,this.crossorigin=e,this.loaded=!1},n.SpineLoader.prototype.constructor=n.SpineLoader,n.EventTarget.mixin(n.SpineLoader.prototype),n.SpineLoader.prototype.load=function(){var t=this,e=new n.JsonLoader(this.url,this.crossorigin);e.on("loaded",function(e){t.json=e.data.content.json,t.onLoaded()}),e.load()},n.SpineLoader.prototype.onLoaded=function(){this.loaded=!0,this.emit("loaded",{content:this})},n.AbstractFilter=function(t,e){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=e||{},this.fragmentSrc=t||[]},n.AbstractFilter.prototype.constructor=n.AbstractFilter,n.AbstractFilter.prototype.syncUniforms=function(){for(var t=0,e=this.shaders.length;e>t;t++)this.shaders[t].dirty=!0},n.AlphaMaskFilter=function(t){n.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={mask:{type:"sampler2D",value:t},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mask.value.x=t.width,this.uniforms.mask.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D mask;","uniform sampler2D uSampler;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   mapCords *= dimensions.xy / mapDimensions;","   vec4 original =  texture2D(uSampler, vTextureCoord);","   float maskAlpha =  texture2D(mask, mapCords).r;","   original *= maskAlpha;","   gl_FragColor =  original;","}"]},n.AlphaMaskFilter.prototype=Object.create(n.AbstractFilter.prototype),n.AlphaMaskFilter.prototype.constructor=n.AlphaMaskFilter,n.AlphaMaskFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.mask.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.mask.value.height,this.uniforms.mask.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(n.AlphaMaskFilter.prototype,"map",{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}}),n.ColorMatrixFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform mat4 matrix;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * matrix;","}"]},n.ColorMatrixFilter.prototype=Object.create(n.AbstractFilter.prototype),n.ColorMatrixFilter.prototype.constructor=n.ColorMatrixFilter,Object.defineProperty(n.ColorMatrixFilter.prototype,"matrix",{get:function(){return this.uniforms.matrix.value},set:function(t){this.uniforms.matrix.value=t}}),n.GrayFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={gray:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float gray;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);","}"]},n.GrayFilter.prototype=Object.create(n.AbstractFilter.prototype),n.GrayFilter.prototype.constructor=n.GrayFilter,Object.defineProperty(n.GrayFilter.prototype,"gray",{get:function(){return this.uniforms.gray.value},set:function(t){this.uniforms.gray.value=t}}),n.DisplacementFilter=function(t){n.AbstractFilter.call(this),this.passes=[this],t.baseTexture._powerOf2=!0,this.uniforms={displacementMap:{type:"sampler2D",value:t},scale:{type:"2f",value:{x:30,y:30}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:5112}},dimensions:{type:"4fv",value:[0,0,0,0]}},t.baseTexture.hasLoaded?(this.uniforms.mapDimensions.value.x=t.width,this.uniforms.mapDimensions.value.y=t.height):(this.boundLoadedFunction=this.onTextureLoaded.bind(this),t.baseTexture.on("loaded",this.boundLoadedFunction)),this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D displacementMap;","uniform sampler2D uSampler;","uniform vec2 scale;","uniform vec2 offset;","uniform vec4 dimensions;","uniform vec2 mapDimensions;","void main(void) {","   vec2 mapCords = vTextureCoord.xy;","   mapCords += (dimensions.zw + offset)/ dimensions.xy ;","   mapCords.y *= -1.0;","   mapCords.y += 1.0;","   vec2 matSample = texture2D(displacementMap, mapCords).xy;","   matSample -= 0.5;","   matSample *= scale;","   matSample /= mapDimensions;","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + matSample.x, vTextureCoord.y + matSample.y));","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb, 1.0);","   vec2 cord = vTextureCoord;","}"]},n.DisplacementFilter.prototype=Object.create(n.AbstractFilter.prototype),n.DisplacementFilter.prototype.constructor=n.DisplacementFilter,n.DisplacementFilter.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width,this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height,this.uniforms.displacementMap.value.baseTexture.off("loaded",this.boundLoadedFunction)},Object.defineProperty(n.DisplacementFilter.prototype,"map",{get:function(){return this.uniforms.displacementMap.value},set:function(t){this.uniforms.displacementMap.value=t}}),Object.defineProperty(n.DisplacementFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(t){this.uniforms.scale.value=t}}),Object.defineProperty(n.DisplacementFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}),n.PixelateFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:0},dimensions:{type:"4fv",value:new n.Float32Array([1e4,100,10,10])},pixelSize:{type:"2f",value:{x:10,y:10}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 testDim;","uniform vec4 dimensions;","uniform vec2 pixelSize;","uniform sampler2D uSampler;","void main(void) {","   vec2 coord = vTextureCoord;","   vec2 size = dimensions.xy/pixelSize;","   vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;","   gl_FragColor = texture2D(uSampler, color);","}"]},n.PixelateFilter.prototype=Object.create(n.AbstractFilter.prototype),n.PixelateFilter.prototype.constructor=n.PixelateFilter,Object.defineProperty(n.PixelateFilter.prototype,"size",{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.dirty=!0,this.uniforms.pixelSize.value=t}}),n.BlurXFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 4.0*blur, vTextureCoord.y)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x - blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + blur, vTextureCoord.y)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 2.0*blur, vTextureCoord.y)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 3.0*blur, vTextureCoord.y)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x + 4.0*blur, vTextureCoord.y)) * 0.05;","   gl_FragColor = sum;","}"]},n.BlurXFilter.prototype=Object.create(n.AbstractFilter.prototype),n.BlurXFilter.prototype.constructor=n.BlurXFilter,Object.defineProperty(n.BlurXFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.dirty=!0,this.uniforms.blur.value=1/7e3*t}}),n.BlurYFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","   vec4 sum = vec4(0.0);","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 4.0*blur)) * 0.05;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * 0.16;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + blur)) * 0.15;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 2.0*blur)) * 0.12;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 3.0*blur)) * 0.09;","   sum += texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + 4.0*blur)) * 0.05;","   gl_FragColor = sum;","}"]},n.BlurYFilter.prototype=Object.create(n.AbstractFilter.prototype),n.BlurYFilter.prototype.constructor=n.BlurYFilter,Object.defineProperty(n.BlurYFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),n.BlurFilter=function(){this.blurXFilter=new n.BlurXFilter,this.blurYFilter=new n.BlurYFilter,this.passes=[this.blurXFilter,this.blurYFilter]},n.BlurFilter.prototype=Object.create(n.AbstractFilter.prototype),n.BlurFilter.prototype.constructor=n.BlurFilter,Object.defineProperty(n.BlurFilter.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t}}),Object.defineProperty(n.BlurFilter.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}}),Object.defineProperty(n.BlurFilter.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}),n.InvertFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={invert:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float invert;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);","}"]},n.InvertFilter.prototype=Object.create(n.AbstractFilter.prototype),n.InvertFilter.prototype.constructor=n.InvertFilter,Object.defineProperty(n.InvertFilter.prototype,"invert",{get:function(){return this.uniforms.invert.value},set:function(t){this.uniforms.invert.value=t}}),n.SepiaFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={sepia:{type:"1f",value:1}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float sepia;","uniform sampler2D uSampler;","const mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord);","   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);","}"]},n.SepiaFilter.prototype=Object.create(n.AbstractFilter.prototype),n.SepiaFilter.prototype.constructor=n.SepiaFilter,Object.defineProperty(n.SepiaFilter.prototype,"sepia",{get:function(){return this.uniforms.sepia.value},set:function(t){this.uniforms.sepia.value=t}}),n.TwistFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"2f",value:{x:.5,y:.5}}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float radius;","uniform float angle;","uniform vec2 offset;","void main(void) {","   vec2 coord = vTextureCoord - offset;","   float distance = length(coord);","   if (distance < radius) {","       float ratio = (radius - distance) / radius;","       float angleMod = ratio * ratio * angle;","       float s = sin(angleMod);","       float c = cos(angleMod);","       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);","   }","   gl_FragColor = texture2D(uSampler, coord+offset);","}"]},n.TwistFilter.prototype=Object.create(n.AbstractFilter.prototype),n.TwistFilter.prototype.constructor=n.TwistFilter,Object.defineProperty(n.TwistFilter.prototype,"offset",{get:function(){return this.uniforms.offset.value},set:function(t){this.dirty=!0,this.uniforms.offset.value=t}}),Object.defineProperty(n.TwistFilter.prototype,"radius",{get:function(){return this.uniforms.radius.value},set:function(t){this.dirty=!0,this.uniforms.radius.value=t}}),Object.defineProperty(n.TwistFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(t){this.dirty=!0,this.uniforms.angle.value=t}}),n.ColorStepFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={step:{type:"1f",value:5}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform float step;","void main(void) {","   vec4 color = texture2D(uSampler, vTextureCoord);","   color = floor(color * step) / step;","   gl_FragColor = color;","}"]},n.ColorStepFilter.prototype=Object.create(n.AbstractFilter.prototype),n.ColorStepFilter.prototype.constructor=n.ColorStepFilter,Object.defineProperty(n.ColorStepFilter.prototype,"step",{get:function(){return this.uniforms.step.value},set:function(t){this.uniforms.step.value=t}}),n.DotScreenFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec4 dimensions;","uniform sampler2D uSampler;","uniform float angle;","uniform float scale;","float pattern() {","   float s = sin(angle), c = cos(angle);","   vec2 tex = vTextureCoord * dimensions.xy;","   vec2 point = vec2(","       c * tex.x - s * tex.y,","       s * tex.x + c * tex.y","   ) * scale;","   return (sin(point.x) * sin(point.y)) * 4.0;","}","void main() {","   vec4 color = texture2D(uSampler, vTextureCoord);","   float average = (color.r + color.g + color.b) / 3.0;","   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);","}"]},n.DotScreenFilter.prototype=Object.create(n.AbstractFilter.prototype),n.DotScreenFilter.prototype.constructor=n.DotScreenFilter,Object.defineProperty(n.DotScreenFilter.prototype,"scale",{get:function(){return this.uniforms.scale.value},set:function(t){this.dirty=!0,this.uniforms.scale.value=t}}),Object.defineProperty(n.DotScreenFilter.prototype,"angle",{get:function(){return this.uniforms.angle.value},set:function(t){this.dirty=!0,this.uniforms.angle.value=t}}),n.CrossHatchFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={blur:{type:"1f",value:1/512}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform float blur;","uniform sampler2D uSampler;","void main(void) {","    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);","    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);","    if (lum < 1.00) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.75) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.50) {","        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","    if (lum < 0.3) {","        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);","        }","    }","}"]},n.CrossHatchFilter.prototype=Object.create(n.AbstractFilter.prototype),n.CrossHatchFilter.prototype.constructor=n.CrossHatchFilter,Object.defineProperty(n.CrossHatchFilter.prototype,"blur",{get:function(){return this.uniforms.blur.value/(1/7e3)},set:function(t){this.uniforms.blur.value=1/7e3*t}}),n.RGBSplitFilter=function(){n.AbstractFilter.call(this),this.passes=[this],this.uniforms={red:{type:"2f",value:{x:20,y:20}},green:{type:"2f",value:{x:-20,y:20}},blue:{type:"2f",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}},this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform vec2 red;","uniform vec2 green;","uniform vec2 blue;","uniform vec4 dimensions;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;","   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;","   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;","   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;","}"]},n.RGBSplitFilter.prototype=Object.create(n.AbstractFilter.prototype),n.RGBSplitFilter.prototype.constructor=n.RGBSplitFilter,Object.defineProperty(n.RGBSplitFilter.prototype,"red",{get:function(){return this.uniforms.red.value},set:function(t){this.uniforms.red.value=t}}),Object.defineProperty(n.RGBSplitFilter.prototype,"green",{get:function(){return this.uniforms.green.value},set:function(t){this.uniforms.green.value=t}}),Object.defineProperty(n.RGBSplitFilter.prototype,"blue",{get:function(){return this.uniforms.blue.value},set:function(t){this.uniforms.blue.value=t}}),"undefined"!=typeof t&&t.exports&&(e=t.exports=n),e.PIXI=n}).call(this)},,,function(t,e,n){(function(e){"use strict";var r=n(624),i={};i.VERSION="0.2.1",i.sampleRate=44100,i.use=function(){e.AnalyserNode=i.AnalyserNode.exports,e.AudioBuffer=i.AudioBuffer.exports,e.AudioBufferSourceNode=i.AudioBufferSourceNode.exports,e.AudioContext=i.AudioContext,e.AudioDestinationNode=i.AudioDestinationNode.exports,e.AudioListener=i.AudioListener.exports,e.AudioNode=i.AudioNode.exports,e.AudioParam=i.AudioParam.exports,e.AudioProcessingEvent=i.AudioProcessingEvent.exports,e.BiquadFilterNode=i.BiquadFilterNode.exports,e.ChannelMergerNode=i.ChannelMergerNode.exports,e.ChannelSplitterNode=i.ChannelSplitterNode.exports,e.ConvolverNode=i.ConvolverNode.exports,e.DelayNode=i.DelayNode.exports,e.DynamicsCompressorNode=i.DynamicsCompressorNode.exports,e.GainNode=i.GainNode.exports,e.MediaElementAudioSourceNode=i.MediaElementAudioSourceNode.exports,e.MediaStreamAudioDestinationNode=i.MediaStreamAudioDestinationNode.exports,e.MediaStreamAudioSourceNode=i.MediaStreamAudioSourceNode.exports,e.OfflineAudioCompletionEvent=i.OfflineAudioCompletionEvent.exports,e.OfflineAudioContext=i.OfflineAudioContext,e.OscillatorNode=i.OscillatorNode.exports,e.PannerNode=i.PannerNode.exports,e.PeriodicWave=i.PeriodicWave.exports,e.ScriptProcessorNode=i.ScriptProcessorNode.exports,e.WaveShaperNode=i.WaveShaperNode.exports},i.unuse=function(){e.AnalyserNode=r.AnalyserNode,e.AudioBuffer=r.AudioBuffer,e.AudioBufferSourceNode=r.AudioBufferSourceNode,e.AudioContext=r.AudioContext,e.AudioDestinationNode=r.AudioDestinationNode,e.AudioListener=r.AudioListener,e.AudioNode=r.AudioNode,e.AudioParam=r.AudioParam,e.AudioProcessingEvent=r.AudioProcessingEvent,e.BiquadFilterNode=r.BiquadFilterNode,e.ChannelMergerNode=r.ChannelMergerNode,e.ChannelSplitterNode=r.ChannelSplitterNode,e.ConvolverNode=r.ConvolverNode,e.DelayNode=r.DelayNode,e.DynamicsCompressorNode=r.DynamicsCompressorNode,e.GainNode=r.GainNode,e.MediaElementAudioSourceNode=r.MediaElementAudioSourceNode,e.MediaStreamAudioDestinationNode=r.MediaStreamAudioDestinationNode,e.MediaStreamAudioSourceNode=r.MediaStreamAudioSourceNode,e.OfflineAudioCompletionEvent=r.OfflineAudioCompletionEvent,e.OfflineAudioContext=r.OfflineAudioContext,e.OscillatorNode=r.OscillatorNode,e.PannerNode=r.PannerNode,e.PeriodicWave=r.PeriodicWave,e.ScriptProcessorNode=r.ScriptProcessorNode,e.WaveShaperNode=r.WaveShaperNode},t.exports=i}).call(e,function(){return this}())},,,function(t,e,n){"use strict";var r={};r.NOP=function(){},r.inherits=n(629),r.defaults=n(627),r.article=n(353),r.name=n(392),r.toJSON=n(632),r.toMicroseconds=n(393),r.toSeconds=n(633),r.typeCheck=n(355),r.formatter=n(354),r.defineAttribute=n(628),t.exports=r},,,,,,,,function(t,e){"use strict";var n=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=e.SkinNode=function(){function t(){r(this,t)}return n(t,null,{compile:{value:function(t,e){var n=new this;return n.compile(t,e),n}}}),t}();e["default"]=i,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t){var e=void 0;return function(n){e!==n&&(e=n,t(n))}}var i=function(t){return t&&t.__esModule?t["default"]:t},o=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},a=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=i(n(181)),c=e.Instance=function(){function t(e){if(s(this,t),this._context=e.context,this._object=e.object,this._children=e.children,this._bindings=[],this._concerns=[],this.onData=new u(e.onData),this.onDestroy=new u(e.onDestroy),e.bindings){var n=!0,r=!1,i=void 0;try{for(var a,c=e.bindings[Symbol.iterator]();!(n=(a=c.next()).done);n=!0){var l,f=a.value;(l=this).bind.apply(l,o(f))}}catch(h){r=!0,i=h}finally{try{!n&&c["return"]&&c["return"]()}finally{if(r)throw i}}}if(e.concerns){var p=!0,d=!1,m=void 0;try{for(var v,g=e.concerns[Symbol.iterator]();!(p=(v=g.next()).done);p=!0){var y=v.value;this._concerns.push(y.instantiate(this._context,this))}}catch(h){d=!0,m=h}finally{try{!p&&g["return"]&&g["return"]()}finally{if(d)throw m}}}if(e.children){var b=!0,_=!1,w=void 0;try{for(var x,E=e.children[Symbol.iterator]();!(b=(x=E.next()).done);b=!0){var C=x.value;this._concerns.push(C.instantiate(this._context,this._object))}}catch(h){_=!0,w=h}finally{try{!b&&E["return"]&&E["return"]()}finally{if(_)throw w}}}e.onCreate&&new u(e.onCreate).call(),e.parent&&this.attachTo(e.parent)}return a(t,{bind:{value:function(){for(var t=arguments.length,e=Array(t),n=0;t>n;n++)e[n]=arguments[n];var i=r(e.pop());1===e.length&&e[0].constant?i(e[0]()):this._bindings.push(function(t){for(var n=0;n<e.length;n++)t=e[n](t);i(t)})}},attachTo:{value:function(t){this._parent=t,this._parent.addChild(this._object)}},detach:{value:function(){this._parent&&(this._parent.removeChild(this._object),this._parent=null)}},push:{value:function(t){var e;for(e=0;e<this._bindings.length;e++)this._bindings[e](t);for(e=0;e<this._concerns.length;e++)this._concerns[e].push(t);this.onData.call(t)}},destroy:{value:function(){this.detach();for(var t=0;t<this._concerns.length;t++)this._concerns[t].destroy();this.onDestroy.call(),this._concerns=null,this._bindings=null,this._parent=null,this._object=null}},object:{get:function(){return this._object}},parent:{get:function(){return this._parent}}}),t}();e["default"]=c,Object.defineProperty(e,"__esModule",{value:!0})},function(t){t.exports=function(t,e,n,r,i){this.confidence=n,this.name=r||e.name(t),this.lang=i}},,,,function(t){function e(t){var e=this;return"function"==typeof t&&(t=t.call(this)),new Promise(function(r,i){function o(e){var n;try{n=t.next(e)}catch(r){return i(r)}u(n)}function s(e){var n;try{n=t["throw"](e)}catch(r){return i(r)}u(n)}function u(t){if(t.done)return r(t.value);var i=n.call(e,t.value);return i&&a(i)?i.then(o,s):s(new TypeError('You may only yield a function, promise, generator, array, or object, but the following object was passed: "'+String(t.value)+'"'))}o()})}function n(t){return t?a(t)?t:u(t)||s(t)?e.call(this,t):"function"==typeof t?r.call(this,t):Array.isArray(t)?i.call(this,t):c(t)?o.call(this,t):t:t}function r(t){var e=this;return new Promise(function(n,r){t.call(e,function(t,e){return t?r(t):(arguments.length>2&&(e=l.call(arguments,1)),void n(e))})})}function i(t){return Promise.all(t.map(n,this))}function o(t){function e(t,e){r[e]=void 0,o.push(t.then(function(t){r[e]=t}))}for(var r=new t.constructor,i=Object.keys(t),o=[],s=0;s<i.length;s++){var u=i[s],c=n.call(this,t[u]);c&&a(c)?e(c,u):r[u]=t[u]}return Promise.all(o).then(function(){return r})}function a(t){return"function"==typeof t.then}function s(t){return"function"==typeof t.next&&"function"==typeof t["throw"]}function u(t){var e=t.constructor;return e?"GeneratorFunction"===e.name||"GeneratorFunction"===e.displayName?!0:s(e.prototype):!1
}function c(t){return Object==t.constructor}var l=Array.prototype.slice;t.exports=e["default"]=e.co=e,e.wrap=function(t){function n(){return e.call(this,t.apply(this,arguments))}return n.__generatorFunction__=t,n}},function(t){function e(){function t(e){return t.validate(e),e}var e=[].slice.call(arguments);return t.validate=function(t){for(var r=0;r<e.length;r++)n(e[r],t)},t}function n(t,e){if(t===Number&&(t="number"),t===String&&(t="string"),"string"==typeof t){if(typeof e!==t)throw new Error("should be a "+t)}else if("function"==typeof t){if("function"==typeof t.validate)t.validate(e);else if(!(e instanceof t))throw new Error("should be an instance of "+t)}else{if("object"!=typeof t)throw new Error("invalid schema");if(!e)throw new Error("should be an object");r(t,e)}}function r(t,e){for(var r in t){if(!(r in e))throw new Error('missing property: "'+r+'"');try{n(t[r],e[r])}catch(i){throw new Error('error in property "'+r+'": '+i.message)}}}t.exports=e,e.maybe=function(t){function e(t){return e.validate(t),t}return e.validate=function(e){null!==e&&void 0!==e&&n(t,e)},e}},,,,,function(t,e,n){(function(t,r){function i(t,n){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(n)?r.showHidden=n:n&&e._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),u(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function a(t){return t}function s(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function u(t,n,r){if(t.customInspect&&n&&S(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return b(i)||(i=u(t,i,r)),i}var o=c(t,n);if(o)return o;var a=Object.keys(n),m=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),T(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(n);if(0===a.length){if(S(n)){var v=n.name?": "+n.name:"";return t.stylize("[Function"+v+"]","special")}if(x(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(C(n))return t.stylize(Date.prototype.toString.call(n),"date");if(T(n))return l(n)}var g="",y=!1,_=["{","}"];if(d(n)&&(y=!0,_=["[","]"]),S(n)){var w=n.name?": "+n.name:"";g=" [Function"+w+"]"}if(x(n)&&(g=" "+RegExp.prototype.toString.call(n)),C(n)&&(g=" "+Date.prototype.toUTCString.call(n)),T(n)&&(g=" "+l(n)),0===a.length&&(!y||0==n.length))return _[0]+g+_[1];if(0>r)return x(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var E;return E=y?f(t,n,r,m,a):a.map(function(e){return h(t,n,r,m,e,y)}),t.seen.pop(),p(E,g,_)}function c(t,e){if(w(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,i){for(var o=[],a=0,s=e.length;s>a;++a)o.push(j(e,String(a))?h(t,e,n,r,String(a),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(t,e,n,r,i,!0))}),o}function h(t,e,n,r,i,o){var a,s,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),j(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(c.value)<0?(s=v(n)?u(t,c.value,null):u(t,c.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),w(a)){if(o&&i.match(/^\d+$/))return s;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function p(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function v(t){return null===t}function g(t){return null==t}function y(t){return"number"==typeof t}function b(t){return"string"==typeof t}function _(t){return"symbol"==typeof t}function w(t){return void 0===t}function x(t){return E(t)&&"[object RegExp]"===k(t)}function E(t){return"object"==typeof t&&null!==t}function C(t){return E(t)&&"[object Date]"===k(t)}function T(t){return E(t)&&("[object Error]"===k(t)||t instanceof Error)}function S(t){return"function"==typeof t}function A(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function k(t){return Object.prototype.toString.call(t)}function O(t){return 10>t?"0"+t.toString(10):t.toString(10)}function M(){var t=new Date,e=[O(t.getHours()),O(t.getMinutes()),O(t.getSeconds())].join(":");return[t.getDate(),P[t.getMonth()],e].join(" ")}function j(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var R=/%[sdj%]/g;e.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,a=String(t).replace(R,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),s=r[n];o>n;s=r[++n])a+=v(s)||!E(s)?" "+s:" "+i(s);return a},e.deprecate=function(n,i){function o(){if(!a){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),a=!0}return n.apply(this,arguments)}if(w(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(r.noDeprecation===!0)return n;var a=!1;return o};var N,I={};e.debuglog=function(t){if(w(N)&&(N=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!I[t])if(new RegExp("\\b"+t+"\\b","i").test(N)){var n=r.pid;I[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else I[t]=function(){};return I[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=m,e.isNull=v,e.isNullOrUndefined=g,e.isNumber=y,e.isString=b,e.isSymbol=_,e.isUndefined=w,e.isRegExp=x,e.isObject=E,e.isDate=C,e.isError=T,e.isFunction=S,e.isPrimitive=A,e.isBuffer=n(153);var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",M(),e.format.apply(e,arguments))},e.inherits=n(152),e._extend=function(t,e){if(!e||!E(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(e,function(){return this}(),n(1))},,,,,,,function(t,e,n){"use strict";function r(t,e){e=e||{},u.call(this);var n=i.defaults(e.numberOfInputs,1),r=i.defaults(e.numberOfOutputs,1),o=i.defaults(e.channelCount,2),a=i.defaults(e.channelCountMode,"max"),s=i.defaults(e.channelInterpretation,"speakers");i.defineAttribute(this,"context","readonly",t,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"numberOfInputs","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"numberOfOutputs","readonly",r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"channelCount","number",o,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"channelCountMode",c,a,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"channelInterpretation",l,s,function(t){throw new TypeError(i.formatter.concat(this,t))}),Object.defineProperties(this,{$name:{value:i.defaults(e.name,"AudioNode")},$context:{value:t},$inputs:{value:[]}}),this._outputs=[],this._tick=-1}var i=n(16),o=n(61),a=n(13),s=n(147),u=n(306),c="enum { max, clamped-max, explicit }",l="enum { speakers, discrete }",f=function(){throw new TypeError("Illegal constructor")};i.inherits(f,u),i.inherits(r,f),r.exports=f,f.prototype.connect=function(t){function e(t){return this.$context!==t.$context?"cannot connect to a destination belonging to a different audio context":void 0}function n(t,e){return 0>t||this.numberOfOutputs<=t?e+" index ("+t+") exceeds number of outputs ("+this.numberOfOutputs+")":void 0}function r(e,n){return 0>e||t.numberOfInputs<=e?n+" index ("+e+") exceeds number of inputs ("+t.numberOfInputs+")":void 0}var i=new o(this,"connect",[{name:"destination",type:"AudioNode | AudioParam",validate:e},{name:"output",type:"optional number",validate:n},{name:"input",type:"optional number",validate:r}]);i.validateArguments(arguments,function(t){throw new TypeError(i.form+"; "+t)});var a=this._outputs.indexOf(t);-1===a&&(this._outputs.push(t),t.$inputs.push(this))},f.prototype.disconnect=function(){function t(t,e){return 0>t||this.numberOfOutputs<=t?e+" index ("+t+") exceeds number of outputs ("+this.numberOfOutputs+")":void 0}var e=new o(this,"connect",[{name:"output",type:"optional number",validate:t}]);e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),this._outputs.splice(0).forEach(function(t){var e=t.$inputs.indexOf(this);-1!==e&&t.$inputs.splice(e,1)},this)},r.prototype.toJSON=function(t){return i.toJSON(this,function(t,e){var n={};return n.name=i.name(t),(t.constructor.jsonAttrs||[]).forEach(function(r){n[r]=t[r]&&t[r].toJSON?t[r].toJSON(e):t[r]}),t.$context.VERBOSE_JSON&&(n.numberOfInputs=t.numberOfInputs,n.numberOfOutputs=t.numberOfOutputs,n.channelCount=t.channelCount,n.channelCountMode=t.channelCountMode,n.channelInterpretation=t.channelInterpretation),n.inputs=t.$inputs.map(function(t){return t.toJSON(e)}),n},t)},r.prototype.$process=function(t,e){this._tick!==e&&(this._tick=e,this.$inputs.forEach(function(n){n.$process(t,e)}),Object.keys(this).forEach(function(n){this[n]instanceof s&&this[n].$process(t,e)},this),this._process&&this._process(t))},t.exports=a.AudioNode=r},function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(module,exports,__webpack_require__){"use strict";function createFunction(code){var fn=eval("(function(get) { return "+code+" })");return fn.displayName="("+code+")",fn.constant=!!/^[\-0-9\.]+$/.test(code),fn}function Expression(t){log("parsing %s",t);var e=parser.parse(t);log("parsed %s => %s",t,e);var n=createFunction(e),r=void 0;return r=n.constant?n:function(t){return n(function(e){return t[e]})},r.constant=n.constant,r}var _interopRequire=function(t){return t&&t.__esModule?t["default"]:t};exports.Expression=Expression;var debug=_interopRequire(__webpack_require__(96)),log=debug("scintillator:expression"),parser=_interopRequire(__webpack_require__(227));exports["default"]=Expression,Object.defineProperty(exports,"__esModule",{value:!0})},function(t,e){"use strict";function n(t){return{as:function(e){return new Promise(function(n,r){var i=new FileReader;switch(i.onload=function(){n(i.result)},i.onerror=function(){r(new Error("Unable to read from Blob"))},e){case"arraybuffer":i.readAsArrayBuffer(t);break;case"text":i.readAsText(t)}})}}}e.readBlob=n,e["default"]=n,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t){return function(e,n){for(var r=Math.abs(e-n),i=0;i<f.length;i++)if(r<t(f[i]))return f[i].value;return n>e?c:l}}function i(t){return t>=4}function o(t){return t===l||i(t)}function a(t){return 1===t?100:2===t?80:3===t?50:0}var s=function(t){return t&&t.__esModule?t["default"]:t};e.judgeTimeWith=r,e.isBad=i,e.breaksCombo=o,e.weight=a;var u=s(n(7)),c=0;e.UNJUDGED=c;var l=-1;e.MISSED=l;var f=[{value:1,timegate:.02,endTimegate:.04},{value:2,timegate:.05,endTimegate:.1},{value:3,timegate:.1,endTimegate:.2},{value:4,timegate:.2,endTimegate:.2}];e.JUDGMENTS=f;var h=r(u.property("timegate"));e.judgeTime=h;var p=r(u.property("endTimegate"));e.judgeEndTime=p,Object.defineProperty(e,"__esModule",{value:!0})},,,,,,,,,,function(t,e,n){(function(t){function t(e,n,r){if(!(this instanceof t))return new t(e,n,r);var i,o=typeof e;if("number"===o)i=+e;else if("string"===o)i=t.byteLength(e,n);else{if("object"!==o||null===e)throw new TypeError("must start with number, buffer, array or string");"Buffer"===e.type&&P(e.data)&&(e=e.data),i=+e.length}if(i>D)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+D.toString(16)+" bytes");0>i?i=0:i>>>=0;var a=this;t.TYPED_ARRAY_SUPPORT?a=t._augment(new Uint8Array(i)):(a.length=i,a._isBuffer=!0);var s;if(t.TYPED_ARRAY_SUPPORT&&"number"==typeof e.byteLength)a._set(e);else if(T(e))if(t.isBuffer(e))for(s=0;i>s;s++)a[s]=e.readUInt8(s);else for(s=0;i>s;s++)a[s]=(e[s]%256+256)%256;else if("string"===o)a.write(e,0,n);else if("number"===o&&!t.TYPED_ARRAY_SUPPORT&&!r)for(s=0;i>s;s++)a[s]=0;return i>0&&i<=t.poolSize&&(a.parent=L),a}function r(e,n,i){if(!(this instanceof r))return new r(e,n,i);var o=new t(e,n,i);return delete o.parent,o}function i(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;r>a;a++){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))throw new Error("Invalid hex string");t[n+a]=s}return a}function o(t,e,n,r){var i=j(A(e,t.length-n),t,n,r);return i}function a(t,e,n,r){var i=j(k(e),t,n,r);return i}function s(t,e,n,r){return a(t,e,n,r)}function u(t,e,n,r){var i=j(M(e),t,n,r);return i}function c(t,e,n,r){var i=j(O(e,t.length-n),t,n,r);return i}function l(t,e,n){return N.fromByteArray(0===e&&n===t.length?t:t.slice(e,n))}function f(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)t[o]<=127?(r+=R(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+R(i)}function h(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(127&t[i]);return r}function p(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(t[i]);return r}function d(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;n>o;o++)i+=S(t[o]);return i}function m(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function v(t,e,n){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function g(e,n,r,i,o,a){if(!t.isBuffer(e))throw new TypeError("buffer must be a Buffer instance");if(n>o||a>n)throw new RangeError("value is out of bounds");if(r+i>e.length)throw new RangeError("index out of range")}function y(t,e,n,r){0>e&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);o>i;i++)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function b(t,e,n,r){0>e&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);o>i;i++)t[n+i]=e>>>8*(r?i:3-i)&255}function _(t,e,n,r,i,o){if(e>i||o>e)throw new RangeError("value is out of bounds");if(n+r>t.length)throw new RangeError("index out of range");if(0>n)throw new RangeError("index out of range")}function w(t,e,n,r,i){return i||_(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),I.write(t,e,n,r,23,4),n+4}function x(t,e,n,r,i){return i||_(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),I.write(t,e,n,r,52,8),n+8}function E(t){if(t=C(t).replace(F,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function C(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function T(e){return P(e)||t.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function S(t){return 16>t?"0"+t.toString(16):t.toString(16)}function A(t,e){e=e||1/0;for(var n,r=t.length,i=null,o=[],a=0;r>a;a++){if(n=t.charCodeAt(a),n>55295&&57344>n){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(56320>n){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&((e-=3)>-1&&o.push(239,191,189),i=null);if(128>n){if((e-=1)<0)break;o.push(n)}else if(2048>n){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(65536>n){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(2097152>n))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function k(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function O(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);a++)n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}function M(t){return N.toByteArray(E(t))}function j(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function R(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */
var N=n(98),I=n(99),P=n(100);e.Buffer=t,e.SlowBuffer=r,e.INSPECT_MAX_BYTES=50,t.poolSize=8192;var D=1073741823,L={};t.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(n){return!1}}(),t.isBuffer=function(t){return!(null==t||!t._isBuffer)},t.compare=function(e,n){if(!t.isBuffer(e)||!t.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(e===n)return 0;for(var r=e.length,i=n.length,o=0,a=Math.min(r,i);a>o&&e[o]===n[o];o++);return o!==a&&(r=e[o],i=n[o]),i>r?-1:r>i?1:0},t.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,n){if(!P(e))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===e.length)return new t(0);if(1===e.length)return e[0];var r;if(void 0===n)for(n=0,r=0;r<e.length;r++)n+=e[r].length;var i=new t(n),o=0;for(r=0;r<e.length;r++){var a=e[r];a.copy(i,o),o+=a.length}return i},t.byteLength=function(t,e){var n;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":n=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;case"hex":n=t.length>>>1;break;case"utf8":case"utf-8":n=A(t).length;break;case"base64":n=M(t).length;break;default:n=t.length}return n},t.prototype.length=void 0,t.prototype.parent=void 0,t.prototype.toString=function(t,e,n){var r=!1;if(e>>>=0,n=void 0===n||1/0===n?this.length:n>>>0,t||(t="utf8"),0>e&&(e=0),n>this.length&&(n=this.length),e>=n)return"";for(;;)switch(t){case"hex":return d(this,e,n);case"utf8":case"utf-8":return f(this,e,n);case"ascii":return h(this,e,n);case"binary":return p(this,e,n);case"base64":return l(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}},t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:0===t.compare(this,e)},t.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},t.prototype.compare=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?0:t.compare(this,e)},t.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},t.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},t.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var l=r;r=e,e=n,n=l}if(e=Number(e)||0,0>n||0>e||e>this.length)throw new RangeError("attempt to write outside buffer bounds");var f=this.length-e;n?(n=Number(n),n>f&&(n=f)):n=f,r=String(r||"utf8").toLowerCase();var h;switch(r){case"hex":h=i(this,t,e,n);break;case"utf8":case"utf-8":h=o(this,t,e,n);break;case"ascii":h=a(this,t,e,n);break;case"binary":h=s(this,t,e,n);break;case"base64":h=u(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":h=c(this,t,e,n);break;default:throw new TypeError("Unknown encoding: "+r)}return h},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},t.prototype.slice=function(e,n){var r=this.length;e=~~e,n=void 0===n?r:~~n,0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),0>n?(n+=r,0>n&&(n=0)):n>r&&(n=r),e>n&&(n=e);var i;if(t.TYPED_ARRAY_SUPPORT)i=t._augment(this.subarray(e,n));else{var o=n-e;i=new t(o,void 0,!0);for(var a=0;o>a;a++)i[a]=this[a+e]}return i.length&&(i.parent=this.parent||this),i},t.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||v(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},t.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||v(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},t.prototype.readUInt8=function(t,e){return e||v(t,1,this.length),this[t]},t.prototype.readUInt16LE=function(t,e){return e||v(t,2,this.length),this[t]|this[t+1]<<8},t.prototype.readUInt16BE=function(t,e){return e||v(t,2,this.length),this[t]<<8|this[t+1]},t.prototype.readUInt32LE=function(t,e){return e||v(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},t.prototype.readUInt32BE=function(t,e){return e||v(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},t.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||v(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},t.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||v(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},t.prototype.readInt8=function(t,e){return e||v(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},t.prototype.readInt16LE=function(t,e){e||v(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt16BE=function(t,e){e||v(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},t.prototype.readInt32LE=function(t,e){return e||v(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},t.prototype.readInt32BE=function(t,e){return e||v(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},t.prototype.readFloatLE=function(t,e){return e||v(t,4,this.length),I.read(this,t,!0,23,4)},t.prototype.readFloatBE=function(t,e){return e||v(t,4,this.length),I.read(this,t,!1,23,4)},t.prototype.readDoubleLE=function(t,e){return e||v(t,8,this.length),I.read(this,t,!0,52,8)},t.prototype.readDoubleBE=function(t,e){return e||v(t,8,this.length),I.read(this,t,!1,52,8)},t.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||g(this,t,e,n,Math.pow(2,8*n),0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i>>>0&255;return e+n},t.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||g(this,t,e,n,Math.pow(2,8*n),0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o>>>0&255;return e+n},t.prototype.writeUInt8=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,1,255,0),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[n]=e,n+1},t.prototype.writeUInt16LE=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e,this[n+1]=e>>>8):y(this,e,n,!0),n+2},t.prototype.writeUInt16BE=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,2,65535,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=e):y(this,e,n,!1),n+2},t.prototype.writeUInt32LE=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[n+3]=e>>>24,this[n+2]=e>>>16,this[n+1]=e>>>8,this[n]=e):b(this,e,n,!0),n+4},t.prototype.writeUInt32BE=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,4,4294967295,0),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e):b(this,e,n,!1),n+4},t.prototype.writeIntLE=function(t,e,n,r){t=+t,e>>>=0,r||g(this,t,e,n,Math.pow(2,8*n-1)-1,-Math.pow(2,8*n-1));var i=0,o=1,a=0>t?1:0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=(t/o>>0)-a&255;return e+n},t.prototype.writeIntBE=function(t,e,n,r){t=+t,e>>>=0,r||g(this,t,e,n,Math.pow(2,8*n-1)-1,-Math.pow(2,8*n-1));var i=n-1,o=1,a=0>t?1:0;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=(t/o>>0)-a&255;return e+n},t.prototype.writeInt8=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,1,127,-128),t.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[n]=e,n+1},t.prototype.writeInt16LE=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[n]=e,this[n+1]=e>>>8):y(this,e,n,!0),n+2},t.prototype.writeInt16BE=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,2,32767,-32768),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>8,this[n+1]=e):y(this,e,n,!1),n+2},t.prototype.writeInt32LE=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,4,2147483647,-2147483648),t.TYPED_ARRAY_SUPPORT?(this[n]=e,this[n+1]=e>>>8,this[n+2]=e>>>16,this[n+3]=e>>>24):b(this,e,n,!0),n+4},t.prototype.writeInt32BE=function(e,n,r){return e=+e,n>>>=0,r||g(this,e,n,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),t.TYPED_ARRAY_SUPPORT?(this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e):b(this,e,n,!1),n+4},t.prototype.writeFloatLE=function(t,e,n){return w(this,t,e,!0,n)},t.prototype.writeFloatBE=function(t,e,n){return w(this,t,e,!1,n)},t.prototype.writeDoubleLE=function(t,e,n){return x(this,t,e,!0,n)},t.prototype.writeDoubleBE=function(t,e,n){return x(this,t,e,!1,n)},t.prototype.copy=function(e,n,r,i){var o=this;if(r||(r=0),i||0===i||(i=this.length),n>=e.length&&(n=e.length),n||(n=0),i>0&&r>i&&(i=r),i===r)return 0;if(0===e.length||0===o.length)return 0;if(0>n)throw new RangeError("targetStart out of bounds");if(0>r||r>=o.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-n<i-r&&(i=e.length-n+r);var a=i-r;if(1e3>a||!t.TYPED_ARRAY_SUPPORT)for(var s=0;a>s;s++)e[s+n]=this[s+r];else e._set(this.subarray(r,r+a),n);return a},t.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),e>n)throw new RangeError("end < start");if(n!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>n||n>this.length)throw new RangeError("end out of bounds");var r;if("number"==typeof t)for(r=e;n>r;r++)this[r]=t;else{var i=A(t.toString()),o=i.length;for(r=e;n>r;r++)this[r]=i[r%o]}return this}},t.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(t.TYPED_ARRAY_SUPPORT)return new t(this).buffer;for(var e=new Uint8Array(this.length),n=0,r=e.length;r>n;n+=1)e[n]=this[n];return e.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var B=t.prototype;t._augment=function(e){return e.constructor=t,e._isBuffer=!0,e._get=e.get,e._set=e.set,e.get=B.get,e.set=B.set,e.write=B.write,e.toString=B.toString,e.toLocaleString=B.toString,e.toJSON=B.toJSON,e.equals=B.equals,e.compare=B.compare,e.copy=B.copy,e.slice=B.slice,e.readUIntLE=B.readUIntLE,e.readUIntBE=B.readUIntBE,e.readUInt8=B.readUInt8,e.readUInt16LE=B.readUInt16LE,e.readUInt16BE=B.readUInt16BE,e.readUInt32LE=B.readUInt32LE,e.readUInt32BE=B.readUInt32BE,e.readIntLE=B.readIntLE,e.readIntBE=B.readIntBE,e.readInt8=B.readInt8,e.readInt16LE=B.readInt16LE,e.readInt16BE=B.readInt16BE,e.readInt32LE=B.readInt32LE,e.readInt32BE=B.readInt32BE,e.readFloatLE=B.readFloatLE,e.readFloatBE=B.readFloatBE,e.readDoubleLE=B.readDoubleLE,e.readDoubleBE=B.readDoubleBE,e.writeUInt8=B.writeUInt8,e.writeUIntLE=B.writeUIntLE,e.writeUIntBE=B.writeUIntBE,e.writeUInt16LE=B.writeUInt16LE,e.writeUInt16BE=B.writeUInt16BE,e.writeUInt32LE=B.writeUInt32LE,e.writeUInt32BE=B.writeUInt32BE,e.writeIntLE=B.writeIntLE,e.writeIntBE=B.writeIntBE,e.writeInt8=B.writeInt8,e.writeInt16LE=B.writeInt16LE,e.writeInt16BE=B.writeInt16BE,e.writeInt32LE=B.writeInt32LE,e.writeInt32BE=B.writeInt32BE,e.writeFloatLE=B.writeFloatLE,e.writeFloatBE=B.writeFloatBE,e.writeDoubleLE=B.writeDoubleLE,e.writeDoubleBE=B.writeDoubleBE,e.fill=B.fill,e.inspect=B.inspect,e.toArrayBuffer=B.toArrayBuffer,e};var F=/[^+\/0-9A-z\-]/g}).call(e,n(57).Buffer)},function(t,e){"use strict";function n(t,e){if(!e)return function(){};var n=0;return e.report(0,t),function(r){return e.report(++n,t,r)}}function r(t,e){var n=0,r=0;return function(){return t.report(n,++r),Promise.resolve(e.apply(this,arguments)).tap(function(){return t.report(++n,r)})}}function i(t,e){return t.watch(function(){return e.report(t.current,t.total,t.extra)})}e.fixed=n,e.wrapPromise=r,e.bind=i,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t){return"probably"===l.canPlayType(t)}function i(t){var e=t.createGain();e.connect(t.destination),e.disconnect()}var o=function(t){return t&&t.__esModule?t["default"]:t},a=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};e.canPlay=r,e.unmuteAudio=i;var u=o(n(46)),c=o(n(60)),l=document.createElement("audio"),f=e.SamplingMaster=function(){function t(e){s(this,t),this._audioContext=e||c,this._samples=[],this._instances=new Set}return a(t,{unmute:{value:function(){i(this._audioContext)}},audioContext:{get:function(){return this._audioContext}},destroy:{value:function(){if(!this._destroyed){this._destroyed=!0;var t=!0,e=!1,n=void 0;try{for(var r,i=this._samples[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value;o.destroy()}}catch(a){e=!0,n=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}var s=!0,u=!1,c=void 0;try{for(var l,f=this._instances[Symbol.iterator]();!(s=(l=f.next()).done);s=!0){var h=l.value;h.destroy()}}catch(a){u=!0,c=a}finally{try{!s&&f["return"]&&f["return"]()}finally{if(u)throw c}}this._samples=null,this._instances=null}}},sample:{value:function(t){var e=this;return this._coerceToArrayBuffer(t).then(function(t){return e._decodeAudio(t)}).then(function(t){if(e._destroyed)throw new Error("SamplingMaster already destroyed!");var n=new h(e,t);return e._samples.push(n),n})}},_coerceToArrayBuffer:{value:function(t){return t instanceof ArrayBuffer?Promise.resolve(t):u(t).as("arraybuffer")}},_decodeAudio:{value:function(t){var e=this;return new Promise(function(n,r){e.audioContext.decodeAudioData(t,function(t){n(t)},function(t){r("Unable to decode audio: "+t)})})}},_startPlaying:{value:function(t){this._instances.add(t)}},_stoppedPlaying:{value:function(t){this._instances["delete"](t)}}}),t}(),h=function(){function t(e,n){s(this,t),this._master=e,this._buffer=n}return a(t,{play:{value:function(t,e){return new p(this._master,this._buffer,t,e)}},destroy:{value:function(){this._master=null,this._buffer=null}}}),t}(),p=function(){function t(e,n,r,i){var o=this;s(this,t),r=r||0,this._master=e;var a=e.audioContext,u=a.createBufferSource();u.buffer=n,u.onended=function(){return o.stop()};var c=a.createGain();u.connect(c),c.connect(i||a.destination),this._source=u,this._gain=c,u.start(r?Math.max(0,a.currentTime+r):0),this._master._startPlaying(this)}return a(t,{stop:{value:function(){this._source&&(this._source.stop(0),this._source.disconnect(),this._gain.disconnect(),this._source=null,this._gain=null,this._master._stoppedPlaying(this),this.onstop&&this.onstop())}},bad:{value:function(){this._source&&(this._source.playbackRate.value=Math.random()<.5?Math.pow(2,1/12):Math.pow(2,-1/12))}},destroy:{value:function(){this.stop()}}}),t}();e["default"]=f,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){var r=n(97),i=r.AudioContext||r.webkitAudioContext;i&&(t.exports=new i)},function(t,e,n){"use strict";function r(t,e,n){this.instance=t,this.argsInfo=n,this.form=o.methodForm(t,e,n)}var i=n(626),o=n(354),a=n(630);r.prototype.validateArguments=function(t,e){var n=i(t,this.argsInfo.map(function(t){return t.type})),r="";-1!==n&&(r+="the "+a(n)+" argument ",r+=o.shouldBeButGot(this.argsInfo[n].type,t[n]),e.call(this.instance,r)),this.argsInfo.forEach(function(n,r){var i=n.validate&&n.validate.call(this.instance,t[r],this.argsInfo[r].name);i&&e.call(this.instance,i)},this)},r.prototype.assert=function(t,e){t||e.call(this.instance)},t.exports=r},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(145)),o=function(t){return function(e){return null!==e.progress?t(e):""}},a=o(function(t){return i(t.current)+" / "+i(t.total)});e.BYTES_FORMATTER=a;var s=o(function(t){return t.extra+""});e.EXTRA_FORMATTER=s,Object.defineProperty(e,"__esModule",{value:!0})},,function(t,e,n){"use strict";function r(t){if("normal"===t)return u.blendModes.NORMAL;if("screen"===t)return u.blendModes.SCREEN;throw new Error("Invalid blend mode: "+t)}var i=function(t){return t&&t.__esModule?t["default"]:t},o=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=i(n(10)),c=i(n(24)),l=i(n(25)),f=i(n(45)),h=i(n(158)),p=[{name:"x","default":"0",apply:function(t,e){return t.x=e}},{name:"y","default":"0",apply:function(t,e){return t.y=e}},{name:"scale-x","default":"1",apply:function(t,e){return t.scale.x=e}},{name:"scale-y","default":"1",apply:function(t,e){return t.scale.y=e}},{name:"alpha","default":"1",apply:function(t,e){return t.alpha=e}},{name:"width",apply:function(t,e){return t.width=e}},{name:"height",apply:function(t,e){return t.height=e}},{name:"visible",apply:function(t,e){return t.visible=e}}],d=e.DisplayObject=function(t){function e(){s(this,e),null!=t&&t.apply(this,arguments)}return a(e,t),o(e,{compile:{value:function(t,e){this._animation=h.compile(t,e),this._bindings=[];var n=!0,i=!1,o=void 0;try{for(var a,s=p[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value,c=e.attr(u.name)||u["default"];if(c){var l=new f(c),d=this._animation.prop(u.name,l);this._bindings.push({getter:d,apply:u.apply})}}}catch(m){i=!0,o=m}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw o}}this.blendMode=r(e.attr("blend")||"normal"),this.ref=e.attr("ref")||null}},instantiate:{value:function(t,e){var n=this,r=e.object,i=[],o=null;r.blendMode=this.blendMode;for(var a=0;a<this._bindings.length;a++){var s=this._bindings[a];i.push([s.getter,s.apply.bind(null,r)])}return this.ref&&(t.ref(this.ref,r),o=function(){return t.unref(n.ref,r)}),new l({bindings:i,onDestroy:o})}}}),e}(c);e["default"]=d,Object.defineProperty(e,"__esModule",{value:!0})},function(t){function e(t){var e=!1;return{when:function(n,r){if(e)return this;var i=t.match(n);return i&&(e=!0,r(i)),this},"else":function(t){return e?this:void t()}}}t.exports=e},function(t){function e(t){var e=4/11,n=8/11,r=.9,i=4356/361,o=35442/1805,a=16061/1805,s=t*t;return e>t?7.5625*s:n>t?9.075*s-9.9*t+3.4:r>t?i*s-o*t+a:10.8*t*t-20.52*t+10.72}t.exports=e},,,,,,,,,,,,,,,,,,,,,,function(t,e,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(t,e,n){if(t&&c(t)&&t instanceof r)return t;var i=new r;return i.parse(t,e,n),i}function o(t){return u(t)&&(t=i(t)),t instanceof r?t.format():r.prototype.format.call(t)}function a(t,e){return i(t,!1,!0).resolve(e)}function s(t,e){return t?i(t,!1,!0).resolveObject(e):e}function u(t){return"string"==typeof t}function c(t){return"object"==typeof t&&null!==t}function l(t){return null===t}function f(t){return null==t}var h=n(148);e.parse=i,e.resolve=a,e.resolveObject=s,e.format=o,e.Url=r;var p=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","	"],v=["{","}","|","\\","^","`"].concat(m),g=["'"].concat(v),y=["%","/","?",";","#"].concat(g),b=["/","?","#"],_=255,w=/^[a-z0-9A-Z_-]{0,63}$/,x=/^([a-z0-9A-Z_-]{0,63})(.*)$/,E={javascript:!0,"javascript:":!0},C={javascript:!0,"javascript:":!0},T={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},S=n(151);r.prototype.parse=function(t,e,n){if(!u(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t;r=r.trim();var i=p.exec(r);if(i){i=i[0];var o=i.toLowerCase();this.protocol=o,r=r.substr(i.length)}if(n||i||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var a="//"===r.substr(0,2);!a||i&&C[i]||(r=r.substr(2),this.slashes=!0)}if(!C[i]&&(a||i&&!T[i])){for(var s=-1,c=0;c<b.length;c++){var l=r.indexOf(b[c]);-1!==l&&(-1===s||s>l)&&(s=l)}var f,d;d=-1===s?r.lastIndexOf("@"):r.lastIndexOf("@",s),-1!==d&&(f=r.slice(0,d),r=r.slice(d+1),this.auth=decodeURIComponent(f)),s=-1;for(var c=0;c<y.length;c++){var l=r.indexOf(y[c]);-1!==l&&(-1===s||s>l)&&(s=l)}-1===s&&(s=r.length),this.host=r.slice(0,s),r=r.slice(s),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var v=this.hostname.split(/\./),c=0,A=v.length;A>c;c++){var k=v[c];if(k&&!k.match(w)){for(var O="",M=0,j=k.length;j>M;M++)O+=k.charCodeAt(M)>127?"x":k[M];if(!O.match(w)){var R=v.slice(0,c),N=v.slice(c+1),I=k.match(x);I&&(R.push(I[1]),N.unshift(I[2])),N.length&&(r="/"+N.join(".")+r),this.hostname=R.join(".");break}}}if(this.hostname=this.hostname.length>_?"":this.hostname.toLowerCase(),!m){for(var P=this.hostname.split("."),D=[],c=0;c<P.length;++c){var L=P[c];D.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+h.encode(L):L)}this.hostname=D.join(".")}var B=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+B,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!E[o])for(var c=0,A=g.length;A>c;c++){var U=g[c],q=encodeURIComponent(U);q===U&&(q=escape(U)),r=r.split(U).join(q)}var V=r.indexOf("#");-1!==V&&(this.hash=r.substr(V),r=r.slice(0,V));var W=r.indexOf("?");if(-1!==W?(this.search=r.substr(W),this.query=r.substr(W+1),e&&(this.query=S.parse(this.query)),r=r.slice(0,W)):e&&(this.search="",this.query={}),r&&(this.pathname=r),T[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var B=this.pathname||"",L=this.search||"";this.path=B+L}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&c(this.query)&&Object.keys(this.query).length&&(o=S.stringify(this.query));var a=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||T[e])&&i!==!1?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),a=a.replace("#","%23"),e+i+n+a+r},r.prototype.resolve=function(t){return this.resolveObject(i(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if(u(t)){var e=new r;e.parse(t,!1,!0),t=e}var n=new r;if(Object.keys(this).forEach(function(t){n[t]=this[t]},this),n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(n[e]=t[e])}),T[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(t.protocol&&t.protocol!==n.protocol){if(!T[t.protocol])return Object.keys(t).forEach(function(e){n[e]=t[e]}),n.href=n.format(),n;if(n.protocol=t.protocol,t.host||C[t.protocol])n.pathname=t.pathname;else{for(var i=(t.pathname||"").split("/");i.length&&!(t.host=i.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),n.pathname=i.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var o=n.pathname||"",a=n.search||"";n.path=o+a}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var s=n.pathname&&"/"===n.pathname.charAt(0),c=t.host||t.pathname&&"/"===t.pathname.charAt(0),h=c||s||n.host&&t.pathname,p=h,d=n.pathname&&n.pathname.split("/")||[],i=t.pathname&&t.pathname.split("/")||[],m=n.protocol&&!T[n.protocol];if(m&&(n.hostname="",n.port=null,n.host&&(""===d[0]?d[0]=n.host:d.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===i[0]?i[0]=t.host:i.unshift(t.host)),t.host=null),h=h&&(""===i[0]||""===d[0])),c)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,d=i;else if(i.length)d||(d=[]),d.pop(),d=d.concat(i),n.search=t.search,n.query=t.query;else if(!f(t.search)){if(m){n.hostname=n.host=d.shift();var v=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;v&&(n.auth=v.shift(),n.host=n.hostname=v.shift())}return n.search=t.search,n.query=t.query,l(n.pathname)&&l(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!d.length)return n.pathname=null,n.path=n.search?"/"+n.search:null,n.href=n.format(),n;for(var g=d.slice(-1)[0],y=(n.host||t.host)&&("."===g||".."===g)||""===g,b=0,_=d.length;_>=0;_--)g=d[_],"."==g?d.splice(_,1):".."===g?(d.splice(_,1),b++):b&&(d.splice(_,1),b--);if(!h&&!p)for(;b--;b)d.unshift("..");!h||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),y&&"/"!==d.join("/").substr(-1)&&d.push("");var w=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(m){n.hostname=n.host=w?"":d.length?d.shift():"";var v=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;v&&(n.auth=v.shift(),n.host=n.hostname=v.shift())}return h=h||n.host&&d.length,h&&!w&&d.unshift(""),d.length?n.pathname=d.join("/"):(n.pathname=null,n.path=null),l(n.pathname)&&l(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var t=this.host,e=d.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(31)),o=new i({beat:Number,time:Number,position:Number});e.GameEvent=o,e["default"]=o,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t){return{as:function(e,n){return new Promise(function(r,o){var a=new XMLHttpRequest;a.open("GET",t,!0),a.responseType=e,a.onload=function(){200===+a.status?r(a.response):o(new Error("Unable to download "+t+": HTTP "+a.status))},a.onerror=function(){return o(new Error("Unable to download "+t))},n&&(n.formatter=i,a.onprogress=function(t){return n.report(t.loaded,t.total)}),a.send(null)})}}}e.download=r;var i=n(62).BYTES_FORMATTER;e["default"]=r,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){function r(){this.headers=new i,this.objects=new o,this.timeSignatures=new a}var i=n(92),o=n(93),a=n(95);t.exports=r,r.prototype.measureToBeat=function(t,e){return this.timeSignatures.measureToBeat(t,e)}},function(t){function e(){this._data={},this._dataAll={}}t.exports=e,e.prototype.each=function(t){for(var e in this._data)t(e,this._data[e])},e.prototype.get=function(t){return this._data[t.toLowerCase()]},e.prototype.getAll=function(t){return this._dataAll[t.toLowerCase()]},e.prototype.set=function(t,e){var n=t.toLowerCase();this._data[n]=e,(this._dataAll[n]||(this._dataAll[n]=[])).push(e)}},function(t){function e(){this._objects=[]}t.exports=e,e.prototype.add=function(t){if("01"!==t.channel)for(var e=0;e<this._objects.length;e++){var n=this._objects[e];if(n.channel===t.channel&&n.measure===t.measure&&n.fraction===t.fraction)return void(this._objects[e]=t)}this._objects.push(t)},e.prototype.all=function(){return this._objects.slice()},e.prototype.allSorted=function(){var t=this.all();return t.sort(function(t,e){return t.measure+t.fraction-(e.measure+e.fraction)}),t}},function(t,e,n){function r(t){this._segments=t.map(i)}var i=n(143);t.exports=r,r.prototype.t=function(t){for(var e=0;e<this._segments.length;e++)if(e+1>=this._segments.length||t<=this._segments[e+1].x){var n=this._segments[e];return n.t+(t-n.x)/n.dx}},r.prototype.x=function(t){for(var e=0;e<this._segments.length;e++)if(e+1>=this._segments.length||t<=this._segments[e+1].t){var n=this._segments[e];return n.x+(t-n.t)*n.dx}}},function(t){function e(){this._values={}}t.exports=e,e.prototype.set=function(t,e){this._values[t]=e},e.prototype.get=function(t){return this._values[t]||1},e.prototype.getBeats=function(t){return 4*this.get(t)},e.prototype.measureToBeat=function(t,e){for(var n=0,r=0;t>r;r++)n+=this.getBeats(r);return n+this.getBeats(t)*e}},,function(t,e){(function(e){t.exports="undefined"!=typeof window?window:"undefined"!=typeof e?e:{}}).call(e,function(){return this}())},function(t,e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===a||e===f?62:e===s||e===h?63:u>e?-1:u+10>e?e-u+26+26:l+26>e?e-l:c+26>e?e-c+26:void 0}function r(t){function n(t){c[f++]=t}var r,i,a,s,u,c;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=t.length;u="="===t.charAt(l-2)?2:"="===t.charAt(l-1)?1:0,c=new o(3*t.length/4-u),a=u>0?t.length-4:t.length;var f=0;for(r=0,i=0;a>r;r+=4,i+=3)s=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&s)>>16),n((65280&s)>>8),n(255&s);return 2===u?(s=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&s)):1===u&&(s=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(s>>8&255),n(255&s)),c}function i(t){function e(t){return n.charAt(t)}function r(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,a,s=t.length%3,u="";for(i=0,a=t.length-s;a>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=r(o);switch(s){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="+".charCodeAt(0),s="/".charCodeAt(0),u="0".charCodeAt(0),c="a".charCodeAt(0),l="A".charCodeAt(0),f="-".charCodeAt(0),h="_".charCodeAt(0);t.toByteArray=r,t.fromByteArray=i}(e)},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,p=t[e+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?0/0:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,m=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+f>=1?h/u:h*Math.pow(2,1-f),e*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*m}},function(t){var e=Array.isArray,n=Object.prototype.toString;t.exports=e||function(t){return!!t&&"[object Array]"==n.call(t)}},function(t,e,n){"use strict";function r(t,e,n){return 1-(n-t)/(e-t)}function i(t){return t.position}var o=function(t){return t&&t.__esModule?t["default"]:t},a=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=o(n(7)),c=e.NoteArea=function(){function t(e,n){s(this,t),this._notes=u.sortBy(e,i),this._barLines=u(n).pluck("position").sortBy().value()}return a(t,{getVisibleNotes:{value:function(t,e,n){var i=[],o=this._notes;n||(n=0);for(var a=0;a<o.length;a++){var s=o[a],u=s.end?!(s.position>e||s.end.position<t-n):!(s.position>e||s.position<t-n);if(u){var c={note:s};if(s.end){var l=r(t,e,s.position),f=r(t,e,s.end.position);c.y=Math.min(l,f),c.height=Math.abs(l-f)}else c.y=r(t,e,s.position);i.push(c)}}return i}},getVisibleBarLines:{value:function(t,e,n){return n||(n=0),this._barLines.filter(function(r){return r>=t-n&&e>=r}).map(function(n){return{id:n,y:r(t,e,n)}
})}}}),t}();e["default"]=c,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(){return window.innerWidth<window.innerHeight?"/skins/default/skin_touch.xml":"/skins/default/skin_screen.xml"}e.getSkinUrl=r;var i=n(173).load,o=n(172).Context;e.load=i,e.Context=o,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t){var e=t.match(/^(\d+)x(\d+)\+(\d+)\+(\d+)$/);return e?new o.Rectangle(+e[3],+e[4],+e[1],+e[2]):null}var i=function(t){return t&&t.__esModule?t["default"]:t};e.parseFrame=r;var o=i(n(10));Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){e.Reader=n(141),e.Compiler=n(132),e.BMSChart=n(91),e.BMSHeaders=n(92),e.BMSObjects=n(93),e.Speedcore=n(94),e.TimeSignatures=n(95),e.Notes=n(139),e.Timing=n(144),e.SongInfo=n(142),e.Keysounds=n(182)},,function(t,e,n){var r=n(223);t.exports=function(t,e,n,i){if("number"==typeof t&&"number"==typeof e)return r(t,e,n);var o=Math.min(t.length,e.length);i=i||new Array(o);for(var a=0;o>a;a++)i[a]=r(t[a],e[a],n);return i}},,,,,,,,,,,,,,,,,,,,,,,,function(t,e){"use strict";e.getName=function(t){var e=t.displayName||t.name;if(!e){var n=t.toString().match(/function ([^\s\(]+)/);e=n&&n[1]}return e},e.toString=function(){if(this.getCall&&this.callCount)for(var t,e,n=this.callCount;n--;){t=this.getCall(n).thisValue;for(e in t)if(t[e]===this)return e}return this.displayName||"sinon fake"},e.create=function(t){var e=function(){};return e.prototype=t,new e}},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(31)),o=r(n(89)),a=new i(o,{id:Number,end:i.maybe(o),column:String});e.GameNote=a,e["default"]=a,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){function r(t,e){t.split(/\r\n|\r|\n/).map(function(t){return t.trim()}).forEach(function(t,n){e(t,n+1)})}var i=n(65),o=n(91);e.compile=function(t,e){function n(t,e,n,r){var i=Math.floor(n.length/2);if(0!==i)for(var o=0;i>o;o++){var a=n.substr(2*o,2),u=o/i;"00"!==a&&s.objects.add({measure:t,fraction:u,value:a,channel:e,lineNumber:r})}}function a(t,e){f.warnings.push({lineNumber:t,message:e})}e=e||{};var s=new o,u=e.rng||function(t){return 1+Math.floor(Math.random()*t)},c=[],l=[!1],f={headerSentences:0,channelSentences:0,controlSentences:0,skippedSentences:0,malformedSentences:0,chart:s,warnings:[]};return r(t,function(t,e){var r=!0;if("#"===t.charAt(0)&&(i(t).when(/^#RANDOM\s+(\d+)$/i,function(t){f.controlSentences+=1,c.push(u(+t[1]))}).when(/^#IF\s+(\d+)$/i,function(t){f.controlSentences+=1,l.push(c[c.length-1]!==+t[1])}).when(/^#ENDIF$/i,function(){f.controlSentences+=1,l.pop()})["else"](function(){r=!1}),!r)){var o=l[l.length-1];i(t).when(/^#(\d\d\d)02:(\S*)$/,function(t){f.channelSentences+=1,o||s.timeSignatures.set(+t[1],+t[2])}).when(/^#(\d\d\d)(\S\S):(\S*)$/,function(t){f.channelSentences+=1,o||n(+t[1],t[2],t[3],e)}).when(/^#(\w+)(?:\s+(\S.*))?$/,function(t){f.headerSentences+=1,o||s.headers.set(t[1],t[2])})["else"](function(){a(e,"Invalid command")})}}),f}},function(t,e,n){var r=n(138),i=n(137),o=n(135),a=(n(136),n(134),[new r,new i.UTF_16BE,new i.UTF_16LE,new o.sjis,new o.euc_kr]);t.exports.detect=function(t){for(var e=[],n=0;256>n;n++)e[n]=0;for(var n=t.length-1;n>=0;n--)e[255&t[n]]++;for(var r=!1,n=128;159>=n;n+=1)if(0!=e[n]){r=!0;break}var i={fByteStats:e,fC1Bytes:r,fRawInput:t,fRawLength:t.length,fInputBytes:t,fInputLen:t.length},o=a.map(function(t){return t.match(i)}).filter(function(t){return!!t}).sort(function(t,e){return t.confidence-e.confidence}).pop();return o?o.name:null}},function(t,e,n){function r(){}var i=n(36),o=n(26);r.prototype.match=function(t){var e,n,r,i,a=0,s=0,u=0,c=t.fInputBytes,l=t.fInputLen;t:for(e=0;l>e;e++){if(27==c[e]){e:for(r=0;r<this.escapeSequences.length;r++){var f=this.escapeSequences[r];if(!(l-e<f.length)){for(n=1;n<f.length;n++)if(f[n]!=c[e+n])continue e;a++,e+=f.length-1;continue t}}s++}(14==c[e]||15==c[e])&&u++}return 0==a?null:(i=(100*a-100*s)/(a+s),5>a+u&&(i-=10*(5-(a+u))),0>=i?null:new o(t,this,i))},t.exports.ISO_2022_JP=function(){this.name=function(){return"ISO-2022-JP"},this.escapeSequences=[[27,36,40,67],[27,36,40,68],[27,36,64],[27,36,65],[27,36,66],[27,38,64],[27,40,66],[27,40,72],[27,40,73],[27,40,74],[27,46,65],[27,46,70]]},i.inherits(t.exports.ISO_2022_JP,r),t.exports.ISO_2022_KR=function(){this.name=function(){return"ISO-2022-KR"},this.escapeSequences=[[27,36,41,67]]},i.inherits(t.exports.ISO_2022_KR,r),t.exports.ISO_2022_CN=function(){this.name=function(){return"ISO-2022-CN"},this.escapeSequences=[[27,36,41,65],[27,36,41,71],[27,36,42,72],[27,36,41,69],[27,36,43,73],[27,36,43,74],[27,36,43,75],[27,36,43,76],[27,36,43,77],[27,78],[27,79]]},i.inherits(t.exports.ISO_2022_CN,r)},function(t,e,n){function r(t,e){function n(t,e,r,i){if(r>i)return-1;var o=Math.floor(r+i>>>1);return e>t[o]?n(t,e,o+1,i):e<t[o]?n(t,e,r,o-1):o}return n(t,e,0,t.length-1)}function i(){this.charValue=0,this.index=0,this.nextIndex=0,this.error=!1,this.done=!1,this.reset=function(){this.charValue=0,this.index=-1,this.nextIndex=0,this.error=!1,this.done=!1},this.nextByte=function(t){if(this.nextIndex>=t.fRawLength)return this.done=!0,-1;var e=255&t.fRawInput[this.nextIndex++];return e}}function o(){}function a(t,e){t.index=t.nextIndex,t.error=!1;var n=0,r=0,i=0;return n=t.charValue=t.nextByte(e),0>n?t.done=!0:141>=n||(r=t.nextByte(e),t.charValue=t.charValue<<8|r,n>=161&&254>=n?161>r&&(t.error=!0):142!=n?143==n&&(i=t.nextByte(e),t.charValue=t.charValue<<8|i,161>i&&(t.error=!0)):161>r&&(t.error=!0)),0==t.done}var s=n(36),u=n(26);o.prototype.match=function(t){var e=0,n=0,o=0,a=0,s=0,c=0,l=new i;t:{for(l.reset();this.nextChar(l,t);){if(s++,l.error)a++;else{var f=4294967295&l.charValue;255>=f?e++:(n++,null!=this.commonChars&&r(this.commonChars,f)>=0&&o++)}if(a>=2&&5*a>=n)break t}if(10>=n&&0==a)c=0==n&&10>s?0:10;else if(20*a>n)c=0;else if(null==this.commonChars)c=30+n-20*a,c>100&&(c=100);else{var h=Math.log(parseFloat(n)/4),p=90/h;c=Math.floor(Math.log(o+1)*p+10),c=Math.min(c,100)}}return 0==c?null:new u(t,this,c)},o.prototype.nextChar=function(){},t.exports.sjis=function(){this.name=function(){return"Shift-JIS"},this.language=function(){return"ja"},this.commonChars=[33088,33089,33090,33093,33115,33129,33130,33141,33142,33440,33442,33444,33449,33450,33451,33453,33455,33457,33459,33461,33463,33469,33470,33473,33476,33477,33478,33480,33481,33484,33485,33500,33504,33511,33512,33513,33514,33520,33521,33601,33603,33614,33615,33624,33630,33634,33639,33653,33654,33673,33674,33675,33677,33683,36502,37882,38314],this.nextChar=function(t,e){t.index=t.nextIndex,t.error=!1;var n;if(n=t.charValue=t.nextByte(e),0>n)return!1;if(127>=n||n>160&&223>=n)return!0;var r=t.nextByte(e);return 0>r?!1:(t.charValue=n<<8|r,r>=64&&127>=r||r>=128&&255>=r||(t.error=!0),!0)}},s.inherits(t.exports.sjis,o),t.exports.big5=function(){this.name=function(){return"Big5"},this.language=function(){return"zh"},this.commonChars=[41280,41281,41282,41283,41287,41289,41333,41334,42048,42054,42055,42056,42065,42068,42071,42084,42090,42092,42103,42147,42148,42151,42177,42190,42193,42207,42216,42237,42304,42312,42328,42345,42445,42471,42583,42593,42594,42600,42608,42664,42675,42681,42707,42715,42726,42738,42816,42833,42841,42970,43171,43173,43181,43217,43219,43236,43260,43456,43474,43507,43627,43706,43710,43724,43772,44103,44111,44208,44242,44377,44745,45024,45290,45423,45747,45764,45935,46156,46158,46412,46501,46525,46544,46552,46705,47085,47207,47428,47832,47940,48033,48593,49860,50105,50240,50271],this.nextChar=function(t,e){t.index=t.nextIndex,t.error=!1;var n=t.charValue=t.nextByte(e);if(0>n)return!1;if(127>=n||255==n)return!0;var r=t.nextByte(e);return 0>r?!1:(t.charValue=t.charValue<<8|r,(64>r||127==r||255==r)&&(t.error=!0),!0)}},s.inherits(t.exports.big5,o),t.exports.euc_jp=function(){this.name=function(){return"EUC-JP"},this.language=function(){return"ja"},this.commonChars=[41377,41378,41379,41382,41404,41418,41419,41430,41431,42146,42148,42150,42152,42154,42155,42156,42157,42159,42161,42163,42165,42167,42169,42171,42173,42175,42176,42177,42179,42180,42182,42183,42184,42185,42186,42187,42190,42191,42192,42206,42207,42209,42210,42212,42216,42217,42218,42219,42220,42223,42226,42227,42402,42403,42404,42406,42407,42410,42413,42415,42416,42419,42421,42423,42424,42425,42431,42435,42438,42439,42440,42441,42443,42448,42453,42454,42455,42462,42464,42465,42469,42473,42474,42475,42476,42477,42483,47273,47572,47854,48072,48880,49079,50410,50940,51133,51896,51955,52188,52689],this.nextChar=a},s.inherits(t.exports.euc_jp,o),t.exports.euc_kr=function(){this.name=function(){return"EUC-KR"},this.language=function(){return"ko"},this.commonChars=[45217,45235,45253,45261,45268,45286,45293,45304,45306,45308,45496,45497,45511,45527,45538,45994,46011,46274,46287,46297,46315,46501,46517,46527,46535,46569,46835,47023,47042,47054,47270,47278,47286,47288,47291,47337,47531,47534,47564,47566,47613,47800,47822,47824,47857,48103,48115,48125,48301,48314,48338,48374,48570,48576,48579,48581,48838,48840,48863,48878,48888,48890,49057,49065,49088,49124,49131,49132,49144,49319,49327,49336,49338,49339,49341,49351,49356,49358,49359,49366,49370,49381,49403,49404,49572,49574,49590,49622,49631,49654,49656,50337,50637,50862,51151,51153,51154,51160,51173,51373],this.nextChar=a},s.inherits(t.exports.euc_kr,o),t.exports.gb_18030=function(){this.name=function(){return"GB18030"},this.language=function(){return"zh"},this.nextChar=function(t,e){t.index=t.nextIndex,t.error=!1;var n=0,r=0,i=0,o=0;t:if(n=t.charValue=t.nextByte(e),0>n)t.done=!0;else if(!(128>=n))if(r=t.nextByte(e),t.charValue=t.charValue<<8|r,n>=129&&254>=n){if(r>=64&&126>=r||r>=80&&254>=r)break t;if(r>=48&&57>=r&&(i=t.nextByte(e),i>=129&&254>=i&&(o=t.nextByte(e),o>=48&&57>=o))){t.charValue=t.charValue<<16|i<<8|o;break t}t.error=!0}else;return 0==t.done},this.commonChars=[41377,41378,41379,41380,41392,41393,41457,41459,41889,41900,41914,45480,45496,45502,45755,46025,46070,46323,46525,46532,46563,46767,46804,46816,47010,47016,47037,47062,47069,47284,47327,47350,47531,47561,47576,47610,47613,47821,48039,48086,48097,48122,48316,48347,48382,48588,48845,48861,49076,49094,49097,49332,49389,49611,49883,50119,50396,50410,50636,50935,51192,51371,51403,51413,51431,51663,51706,51889,51893,51911,51920,51926,51957,51965,52460,52728,52906,52932,52946,52965,53173,53186,53206,53442,53445,53456,53460,53671,53930,53938,53941,53947,53972,54211,54224,54269,54466,54490,54754,54992]},s.inherits(t.exports.gb_18030,o)},function(t,e,n){function r(t,e){var n=16777215;this.byteIndex=0,this.ngram=0,this.ngramList=t,this.byteMap=e,this.ngramCount=0,this.hitCount=0,this.spaceChar,this.search=function(t,e){var n=0;return t[n+32]<=e&&(n+=32),t[n+16]<=e&&(n+=16),t[n+8]<=e&&(n+=8),t[n+4]<=e&&(n+=4),t[n+2]<=e&&(n+=2),t[n+1]<=e&&(n+=1),t[n]>e&&(n-=1),0>n||t[n]!=e?-1:n},this.lookup=function(t){this.ngramCount+=1,this.search(this.ngramList,t)>=0&&(this.hitCount+=1)},this.addByte=function(t){this.ngram=(this.ngram<<8)+(255&t)&n,this.lookup(this.ngram)},this.nextByte=function(t){return this.byteIndex>=t.fInputLen?-1:255&t.fInputBytes[this.byteIndex++]},this.parse=function(t,e){var n,r=!1;for(this.spaceChar=e;(n=this.nextByte(t))>=0;){var i=this.byteMap[n];0!=i&&(i==this.spaceChar&&r||this.addByte(i),r=i==this.spaceChar)}this.addByte(this.spaceChar);var o=this.hitCount/this.ngramCount;return o>.33?98:Math.floor(300*o)}}function i(t,e){this.fLang=t,this.fNGrams=e}function o(){}var a=n(36),s=n(26);o.prototype.spaceChar=32,o.prototype.ngrams=function(){},o.prototype.byteMap=function(){},o.prototype.match=function(t){var e=this.ngrams(),n=Array.isArray(e)&&e[0]instanceof i;if(!n){var o=new r(e,this.byteMap()),a=o.parse(t,this.spaceChar);return 0>=a?null:new s(t,this,a)}for(var u=-1,c=null,l=e.length-1;l>=0;l--){var f=e[l],o=new r(f.fNGrams,this.byteMap()),a=o.parse(t,this.spaceChar);a>u&&(u=a,c=f.fLang)}var h=this.name(t);return 0>=u?null:new s(t,this,u,h,c)},t.exports.ISO_8859_1=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,170,32,32,32,32,32,32,32,32,32,32,181,32,32,32,32,186,32,32,32,32,32,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,32,248,249,250,251,252,253,254,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,32,248,249,250,251,252,253,254,255]},this.ngrams=function(){return[new i("da",[2122086,2122100,2122853,2123118,2123122,2123375,2123873,2124064,2125157,2125671,2126053,2126697,2126708,2126953,2127465,6383136,6385184,6385252,6386208,6386720,6579488,6579566,6579570,6579572,6627443,6644768,6644837,6647328,6647396,6648352,6648421,6648608,6648864,6713202,6776096,6776174,6776178,6907749,6908960,6909543,7038240,7039845,7103858,7104871,7105637,7169380,7234661,7234848,7235360,7235429,7300896,7302432,7303712,7398688,7479396,7479397,7479411,7496992,7566437,7610483,7628064,7628146,7629164,7759218]),new i("de",[2122094,2122101,2122341,2122849,2122853,2122857,2123113,2123621,2123873,2124142,2125161,2126691,2126693,2127214,2127461,2127471,2127717,2128501,6448498,6514720,6514789,6514804,6578547,6579566,6579570,6580581,6627428,6627443,6646126,6646132,6647328,6648352,6648608,6776174,6841710,6845472,6906728,6907168,6909472,6909541,6911008,7104867,7105637,7217249,7217252,7217267,7234592,7234661,7234848,7235360,7235429,7238757,7479396,7496805,7497065,7562088,7566437,7610468,7628064,7628142,7628146,7695972,7695975,7759218]),new i("en",[2122016,2122094,2122341,2122607,2123375,2123873,2123877,2124142,2125153,2125670,2125938,2126437,2126689,2126708,2126952,2126959,2127720,6383972,6384672,6385184,6385252,6386464,6386720,6386789,6386793,6561889,6561908,6627425,6627443,6627444,6644768,6647412,6648352,6648608,6713202,6840692,6841632,6841714,6906912,6909472,6909543,6909806,6910752,7217249,7217268,7234592,7235360,7238688,7300640,7302688,7303712,7496992,7500576,7544929,7544948,7561577,7566368,7610484,7628146,7628897,7628901,7629167,7630624,7631648]),new i("es",[2122016,2122593,2122607,2122853,2123116,2123118,2123123,2124142,2124897,2124911,2125921,2125935,2125938,2126197,2126437,2126693,2127214,2128160,6365283,6365284,6365285,6365292,6365296,6382441,6382703,6384672,6386208,6386464,6515187,6516590,6579488,6579564,6582048,6627428,6627429,6627436,6646816,6647328,6647412,6648608,6648692,6907246,6943598,7102752,7106419,7217253,7238757,7282788,7282789,7302688,7303712,7303968,7364978,7435621,7495968,7497075,7544932,7544933,7544944,7562528,7628064,7630624,7693600,15953440]),new i("fr",[2122101,2122607,2122849,2122853,2122869,2123118,2123124,2124897,2124901,2125921,2125935,2125938,2126197,2126693,2126703,2127214,2154528,6385268,6386793,6513952,6516590,6579488,6579571,6583584,6627425,6627427,6627428,6627429,6627436,6627440,6627443,6647328,6647412,6648352,6648608,6648864,6649202,6909806,6910752,6911008,7102752,7103776,7103859,7169390,7217252,7234848,7238432,7238688,7302688,7302772,7304562,7435621,7479404,7496992,7544929,7544932,7544933,7544940,7544944,7610468,7628064,7629167,7693600,7696928]),new i("it",[2122092,2122600,2122607,2122853,2122857,2123040,2124140,2124142,2124897,2125925,2125938,2127214,6365283,6365284,6365296,6365299,6386799,6514789,6516590,6579564,6580512,6627425,6627427,6627428,6627433,6627436,6627440,6627443,6646816,6646892,6647412,6648352,6841632,6889569,6889571,6889572,6889587,6906144,6908960,6909472,6909806,7102752,7103776,7104800,7105633,7234848,7235872,7237408,7238757,7282785,7282788,7282793,7282803,7302688,7302757,7366002,7495968,7496992,7563552,7627040,7628064,7629088,7630624,8022383]),new i("nl",[2122092,2122341,2122849,2122853,2122857,2123109,2123118,2123621,2123877,2124142,2125153,2125157,2125680,2126949,2127457,2127461,2127471,2127717,2128489,6381934,6381938,6385184,6385252,6386208,6386720,6514804,6579488,6579566,6579570,6627426,6627446,6645102,6645106,6647328,6648352,6648435,6648864,6776174,6841716,6907168,6909472,6909543,6910752,7217250,7217252,7217253,7217256,7217263,7217270,7234661,7235360,7302756,7303026,7303200,7303712,7562088,7566437,7610468,7628064,7628142,7628146,7758190,7759218,7761775]),new i("no",[2122100,2122102,2122853,2123118,2123122,2123375,2123873,2124064,2125157,2125671,2126053,2126693,2126699,2126703,2126708,2126953,2127465,2155808,6385252,6386208,6386720,6579488,6579566,6579572,6627443,6644768,6647328,6647397,6648352,6648421,6648864,6648948,6713202,6776174,6908779,6908960,6909543,7038240,7039845,7103776,7105637,7169380,7169390,7217267,7234848,7235360,7235429,7237221,7300896,7302432,7303712,7398688,7479411,7496992,7565165,7566437,7610483,7628064,7628142,7628146,7629164,7631904,7631973,7759218]),new i("pt",[2122016,2122607,2122849,2122853,2122863,2123040,2123123,2125153,2125423,2125600,2125921,2125935,2125938,2126197,2126437,2126693,2127213,6365281,6365283,6365284,6365296,6382693,6382703,6384672,6386208,6386273,6386464,6516589,6516590,6578464,6579488,6582048,6582131,6627425,6627428,6647072,6647412,6648608,6648692,6906144,6906721,7169390,7238757,7238767,7282785,7282787,7282788,7282789,7282800,7303968,7364978,7435621,7495968,7497075,7544929,7544932,7544933,7544944,7566433,7628064,7630624,7693600,14905120,15197039]),new i("sv",[2122100,2122102,2122853,2123118,2123510,2123873,2124064,2124142,2124655,2125157,2125667,2126053,2126699,2126703,2126708,2126953,2127457,2127465,2155634,6382693,6385184,6385252,6386208,6386804,6514720,6579488,6579566,6579570,6579572,6644768,6647328,6648352,6648864,6747762,6776174,6909036,6909543,7037216,7105568,7169380,7217267,7233824,7234661,7235360,7235429,7235950,7299944,7302432,7302688,7398688,7479393,7479411,7495968,7564129,7565165,7610483,7627040,7628064,7628146,7629164,7631904,7758194,14971424,16151072])]},this.name=function(t){return t&&t.fC1Bytes?"windows-1252":"ISO-8859-1"}},a.inherits(t.exports.ISO_8859_1,o),t.exports.ISO_8859_2=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,177,32,179,32,181,182,32,32,185,186,187,188,32,190,191,32,177,32,179,32,181,182,183,32,185,186,187,188,32,190,191,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,32,248,249,250,251,252,253,254,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,32,248,249,250,251,252,253,254,32]},this.ngrams=function(){return[new i("cs",[2122016,2122361,2122863,2124389,2125409,2125413,2125600,2125668,2125935,2125938,2126072,2126447,2126693,2126703,2126708,2126959,2127392,2127481,2128481,6365296,6513952,6514720,6627440,6627443,6627446,6647072,6647533,6844192,6844260,6910836,6972704,7042149,7103776,7104800,7233824,7268640,7269408,7269664,7282800,7300206,7301737,7304052,7304480,7304801,7368548,7368554,7369327,7403621,7562528,7565173,7566433,7566441,7566446,7628146,7630573,7630624,7676016,12477728,14773997,15296623,15540336,15540339,15559968,16278884]),new i("hu",[2122016,2122106,2122341,2123111,2123116,2123365,2123873,2123887,2124147,2124645,2124649,2124790,2124901,2125153,2125157,2125161,2125413,2126714,2126949,2156915,6365281,6365291,6365293,6365299,6384416,6385184,6388256,6447470,6448494,6645625,6646560,6646816,6646885,6647072,6647328,6648421,6648864,6648933,6648948,6781216,6844263,6909556,6910752,7020641,7075450,7169383,7170414,7217249,7233899,7234923,7234925,7238688,7300985,7544929,7567973,7567988,7568097,7596391,7610465,7631904,7659891,8021362,14773792,15299360]),new i("pl",[2122618,2122863,2124064,2124389,2124655,2125153,2125161,2125409,2125417,2125668,2125935,2125938,2126697,2127648,2127721,2127737,2128416,2128481,6365296,6365303,6385257,6514720,6519397,6519417,6582048,6584937,6627440,6627443,6627447,6627450,6645615,6646304,6647072,6647401,6778656,6906144,6907168,6907242,7037216,7039264,7039333,7170405,7233824,7235937,7235941,7282800,7305057,7305065,7368556,7369313,7369327,7369338,7502437,7502457,7563754,7564137,7566433,7825765,7955304,7957792,8021280,8022373,8026400,15955744]),new i("ro",[2122016,2122083,2122593,2122597,2122607,2122613,2122853,2122857,2124897,2125153,2125925,2125938,2126693,2126819,2127214,2144873,2158190,6365283,6365284,6386277,6386720,6386789,6386976,6513010,6516590,6518048,6546208,6579488,6627425,6627427,6627428,6627440,6627443,6644e3,6646048,6646885,6647412,6648692,6889569,6889571,6889572,6889584,6907168,6908192,6909472,7102752,7103776,7106418,7107945,7234848,7238770,7303712,7365998,7496992,7497057,7501088,7594784,7628064,7631477,7660320,7694624,7695392,12216608,15625760])]},this.name=function(t){return t&&t.fC1Bytes?"windows-1250":"ISO-8859-2"}},a.inherits(t.exports.ISO_8859_2,o),t.exports.ISO_8859_5=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,241,242,243,244,245,246,247,248,249,250,251,252,32,254,255,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,32,241,242,243,244,245,246,247,248,249,250,251,252,32,254,255]},this.ngrams=function(){return[2150944,2151134,2151646,2152400,2152480,2153168,2153182,2153936,2153941,2154193,2154462,2154464,2154704,2154974,2154978,2155230,2156514,2158050,13688280,13689580,13884960,14015468,14015960,14016994,14017056,14164191,14210336,14211104,14216992,14407133,14407712,14413021,14536736,14538016,14538965,14538991,14540320,14540498,14557394,14557407,14557409,14602784,14602960,14603230,14604576,14605292,14605344,14606818,14671579,14672085,14672088,14672094,14733522,14734804,14803664,14803666,14803672,14806816,14865883,14868e3,14868192,14871584,15196894,15459616]},this.name=function(){return"ISO-8859-5"},this.language=function(){return"ru"}},a.inherits(t.exports.ISO_8859_5,o),t.exports.ISO_8859_6=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,32,32,32,32,32,224,225,226,227,228,229,230,231,232,233,234,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32]},this.ngrams=function(){return[2148324,2148326,2148551,2152932,2154986,2155748,2156006,2156743,13050055,13091104,13093408,13095200,13100064,13100227,13100231,13100232,13100234,13100236,13100237,13100239,13100243,13100249,13100258,13100261,13100264,13100266,13100320,13100576,13100746,13115591,13181127,13181153,13181156,13181157,13181160,13246663,13574343,13617440,13705415,13748512,13836487,14229703,14279913,14805536,14950599,14993696,15001888,15002144,15016135,15058720,15059232,15066656,15081671,15147207,15189792,15255524,15263264,15278279,15343815,15343845,15343848,15386912,15388960,15394336]},this.name=function(){return"ISO-8859-6"},this.language=function(){return"ar"}},a.inherits(t.exports.ISO_8859_6,o),t.exports.ISO_8859_7=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,161,162,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,220,32,221,222,223,32,252,32,253,254,192,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,32,243,244,245,246,247,248,249,250,251,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,32]},this.ngrams=function(){return[2154989,2154992,2155497,2155753,2156016,2156320,2157281,2157797,2158049,2158368,2158817,2158831,2158833,2159604,2159605,2159847,2159855,14672160,14754017,14754036,14805280,14806304,14807292,14807584,14936545,15067424,15069728,15147252,15199520,15200800,15278324,15327520,15330014,15331872,15393257,15393268,15525152,15540449,15540453,15540464,15589664,15725088,15725856,15790069,15790575,15793184,15868129,15868133,15868138,15868144,15868148,15983904,15984416,15987951,16048416,16048617,16050157,16050162,16050666,16052e3,16052213,16054765,16379168,16706848]},this.name=function(t){return t&&t.fC1Bytes?"windows-1253":"ISO-8859-7"},this.language=function(){return"el"}},a.inherits(t.exports.ISO_8859_7,o),t.exports.ISO_8859_8=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,181,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,32,32,32,32,32]},this.ngrams=function(){return[new i("he",[2154725,2154727,2154729,2154746,2154985,2154990,2155744,2155749,2155753,2155758,2155762,2155769,2155770,2157792,2157796,2158304,2159340,2161132,14744096,14950624,14950625,14950628,14950636,14950638,14950649,15001056,15065120,15068448,15068960,15071264,15071776,15278308,15328288,15328762,15329773,15330592,15331104,15333408,15333920,15474912,15474916,15523872,15524896,15540448,15540449,15540452,15540460,15540462,15540473,15655968,15671524,15787040,15788320,15788525,15920160,16261348,16312813,16378912,16392416,16392417,16392420,16392428,16392430,16392441]),new i("he",[2154725,2154732,2155753,2155756,2155758,2155760,2157040,2157810,2157817,2158053,2158057,2158565,2158569,2160869,2160873,2161376,2161381,2161385,14688484,14688492,14688493,14688506,14738464,14738916,14740512,14741024,14754020,14754029,14754042,14950628,14950633,14950636,14950637,14950639,14950648,14950650,15002656,15065120,15066144,15196192,15327264,15327520,15328288,15474916,15474925,15474938,15528480,15530272,15591913,15591920,15591928,15605988,15605997,15606010,15655200,15655968,15918112,16326884,16326893,16326906,16376864,16441376,16442400,16442857])]},this.name=function(t){return t&&t.fC1Bytes?"windows-1255":"ISO-8859-8"},this.language=function(){return"he"}},a.inherits(t.exports.ISO_8859_8,o),t.exports.ISO_8859_9=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,170,32,32,32,32,32,32,32,32,32,32,181,32,32,32,32,186,32,32,32,32,32,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,32,248,249,250,251,252,105,254,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,32,248,249,250,251,252,253,254,255]},this.ngrams=function(){return[2122337,2122345,2122357,2122849,2122853,2123621,2123873,2124140,2124641,2124655,2125153,2125676,2126689,2126945,2127461,2128225,6365282,6384416,6384737,6384993,6385184,6385405,6386208,6386273,6386429,6386685,6388065,6449522,6578464,6579488,6580512,6627426,6627435,6644841,6647328,6648352,6648425,6648681,6909029,6909472,6909545,6910496,7102830,7102834,7103776,7103858,7217249,7217250,7217259,7234657,7234661,7234848,7235872,7235950,7273760,7498094,7535982,7759136,7954720,7958386,16608800,16608868,16609021,16642301]},this.name=function(t){return t&&t.fC1Bytes?"windows-1254":"ISO-8859-9"},this.language=function(){return"tr"}},a.inherits(t.exports.ISO_8859_9,o),t.exports.windows_1251=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,144,131,32,131,32,32,32,32,32,32,154,32,156,157,158,159,144,32,32,32,32,32,32,32,32,32,154,32,156,157,158,159,32,162,162,188,32,180,32,32,184,32,186,32,32,32,32,191,32,32,179,179,180,181,32,32,184,32,186,32,188,190,190,191,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]},this.ngrams=function(){return[2155040,2155246,2155758,2156512,2156576,2157280,2157294,2158048,2158053,2158305,2158574,2158576,2158816,2159086,2159090,2159342,2160626,2162162,14740968,14742268,14937632,15068156,15068648,15069682,15069728,15212783,15263008,15263776,15269664,15459821,15460384,15465709,15589408,15590688,15591653,15591679,15592992,15593186,15605986,15605999,15606001,15655456,15655648,15655918,15657248,15657980,15658016,15659506,15724267,15724773,15724776,15724782,15786210,15787492,15856352,15856354,15856360,15859488,15918571,15920672,15920880,15924256,16249582,16512288]},this.name=function(){return"windows-1251"},this.language=function(){return"ru"
}},a.inherits(t.exports.windows_1251,o),t.exports.windows_1256=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,129,32,131,32,32,32,32,136,32,138,32,156,141,142,143,144,32,32,32,32,32,32,32,152,32,154,32,156,32,32,159,32,32,32,32,32,32,32,32,32,32,170,32,32,32,32,32,32,32,32,32,32,181,32,32,32,32,32,32,32,32,32,32,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,32,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,32,32,32,32,244,32,32,32,32,249,32,251,252,32,32,255]},this.ngrams=function(){return[2148321,2148324,2148551,2153185,2153965,2154977,2155492,2156231,13050055,13091104,13093408,13095200,13099296,13099459,13099463,13099464,13099466,13099468,13099469,13099471,13099475,13099482,13099486,13099491,13099494,13099501,13099808,13100064,13100234,13115591,13181127,13181149,13181153,13181155,13181158,13246663,13574343,13617440,13705415,13748512,13836487,14295239,14344684,14544160,14753991,14797088,14806048,14806304,14885063,14927648,14928160,14935072,14950599,15016135,15058720,15124449,15131680,15474887,15540423,15540451,15540454,15583520,15585568,15590432]},this.name=function(){return"windows-1256"},this.language=function(){return"ar"}},a.inherits(t.exports.windows_1256,o),t.exports.KOI8_R=function(){this.byteMap=function(){return[32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,0,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,163,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,163,32,32,32,32,32,32,32,32,32,32,32,32,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223]},this.ngrams=function(){return[2147535,2148640,2149313,2149327,2150081,2150085,2150338,2150607,2150610,2151105,2151375,2151380,2151631,2152224,2152399,2153153,2153684,2154196,12701385,12702936,12963032,12963529,12964820,12964896,13094688,13181136,13223200,13224224,13226272,13419982,13420832,13424846,13549856,13550880,13552069,13552081,13553440,13553623,13574352,13574355,13574359,13617103,13617696,13618392,13618464,13620180,13621024,13621185,13684684,13685445,13685449,13685455,13812183,13813188,13881632,13882561,13882569,13882583,13944268,13946656,13946834,13948960,14272544,14603471]},this.name=function(){return"KOI8-R"},this.language=function(){return"ru"}},a.inherits(t.exports.KOI8_R,o)},function(t,e,n){function r(){}var i=n(36),o=n(26);t.exports.UTF_16BE=function(){this.name=function(){return"UTF-16BE"},this.match=function(t){var e=t.fRawInput;return e.length>=2&&254==(255&e[0])&&255==(255&e[1])?new o(t,this,confidence=100):null}},t.exports.UTF_16LE=function(){this.name=function(){return"UTF-16LE"},this.match=function(t){var e=t.fRawInput;return e.length>=2&&255==(255&e[0])&&254==(255&e[1])?e.length>=4&&0==e[2]&&0==e[3]?null:new o(t,this,confidence=100):null}},r.prototype.match=function(t){var e=t.fRawInput,n=t.fRawLength/4*4,r=0,i=0,a=!1,s=0;if(0==n)return null;65279==this.getChar(e,0)&&(a=!0);for(var u=0;n>u;u+=4){var c=this.getChar(e,u);0>c||c>=1114111||c>=55296&&57343>=c?i+=1:r+=1}return a&&0==i?s=100:a&&r>10*i?s=80:r>3&&0==i?s=100:r>0&&0==i?s=80:r>10*i&&(s=25),0==s?null:new o(t,this,s)},t.exports.UTF_32BE=function(){this.name=function(){return"UTF-32BE"},this.getChar=function(t,e){return(255&t[e+0])<<24|(255&t[e+1])<<16|(255&t[e+2])<<8|255&t[e+3]}},i.inherits(t.exports.UTF_32BE,r),t.exports.UTF_32LE=function(){this.name=function(){return"UTF-32LE"},this.getChar=function(t,e){return(255&t[e+3])<<24|(255&t[e+2])<<16|(255&t[e+1])<<8|255&t[e+0]}},i.inherits(t.exports.UTF_32LE,r)},function(t,e,n){var r=n(26);t.exports=function(){this.name=function(){return"UTF-8"},this.match=function(t){var e,n=!1,i=0,o=0,a=t.fRawInput,s=0;t.fRawLength>=3&&239==(255&a[0])&&187==(255&a[1])&&191==(255&a[2])&&(n=!0);for(var u=0;u<t.fRawLength;u++){var c=a[u];if(0!=(128&c)){if(192==(224&c))s=1;else if(224==(240&c))s=2;else if(240==(248&c))s=3;else{if(o++,o>5)break;s=0}for(;u++,!(u>=t.fRawLength);){if(128!=(192&a[u])){o++;break}if(0==--s){i++;break}}}}if(e=0,n&&0==o)e=100;else if(n&&i>10*o)e=80;else if(i>3&&0==o)e=100;else if(i>0&&0==o)e=80;else if(0==i&&0==o)e=10;else{if(!(i>10*o))return null;e=25}return new r(t,this,e)}}},function(t,e,n){function r(t){t.forEach(o.validate),this._notes=t}function i(t){this._chart=t}var o=n(140);t.exports=r;var a={IIDX_P1:{11:{column:"1"},12:{column:"2"},13:{column:"3"},14:{column:"4"},15:{column:"5"},18:{column:"6"},19:{column:"7"},16:{column:"SC"}}};r.prototype.count=function(){return this._notes.length},r.prototype.all=function(){return this._notes.slice()},r.fromBMSChart=function(t,e){e=e||{};var n=new i(t);return n.build()},i.prototype.build=function(){return this._notes=[],this._activeLN={},this._lastNote={},this._lnObj=(this._chart.headers.get("lnobj")||"").toLowerCase(),this._channelMapping=a.IIDX_P1,this._objects=this._chart.objects.allSorted(),this._objects.forEach(function(t){this._handle(t)}.bind(this)),new r(this._notes)},i.prototype._handle=function(t){if("01"===t.channel)this._handleNormalNote(t);else switch(t.channel.charAt(0)){case"1":case"2":this._handleNormalNote(t);break;case"5":case"6":this._handleLongNote(t)}},i.prototype._handleNormalNote=function(t){var e=this._normalizeChannel(t.channel),n=this._getBeat(t);if(t.value.toLowerCase()===this._lnObj)this._lastNote[e]&&(this._lastNote[e].endBeat=n);else{var r={beat:n,endBeat:void 0,keysound:t.value,column:this._getColumn(e)};this._lastNote[e]=r,this._notes.push(r)}},i.prototype._handleLongNote=function(t){var e=this._normalizeChannel(t.channel),n=this._getBeat(t);if(this._activeLN[e]){var r=this._activeLN[e];r.endBeat=n,this._notes.push(r),delete this._activeLN[e]}else this._activeLN[e]={beat:n,keysound:t.value,column:this._getColumn(e)}},i.prototype._getBeat=function(t){return this._chart.measureToBeat(t.measure,t.fraction)},i.prototype._getColumn=function(t){return this._channelMapping[t]},i.prototype._normalizeChannel=function(t){return t.replace(/^5/,"1").replace(/^6/,"2")}},function(t,e,n){var r=n(31),i=new r({column:String});t.exports=new r({beat:Number,endBeat:r.maybe(Number),column:r.maybe(i),keysound:String})},function(t,e,n){var r=n(133);e.read=function(){throw new Error("Synchronous read unsupported in browser!")},e.readAsync=function(t,e){var n=r.detect(t),i=new FileReader;i.onload=function(){e(null,i.result)},i.onerror=function(){e(new Error("cannot read it"))},i.readAsText(new Blob([t]),n)}},function(t,e,n){function r(){this.title="NO TITLE",this.artist="NO ARTIST",this.genre="NO GENRE",this.subtitles=[],this.subartists=[],this.difficulty=0,this.level=0}var i=n(65);t.exports=r,r.fromBMSChart=function(t){var e=new r,n=t.headers.get("title"),o=t.headers.get("artist"),a=t.headers.get("genre"),s=+t.headers.get("difficulty"),u=+t.headers.get("playlevel"),c=t.headers.getAll("subtitle"),l=t.headers.getAll("subartist");if("string"==typeof n&&!c){var f=function(t){n=t[1],c=[t[2]]};i(n).when(/^(.*\S)\s*-(.+?)-$/,f).when(/^(.*\S)\s*～(.+?)～$/,f).when(/^(.*\S)\s*\((.+?)\)$/,f).when(/^(.*\S)\s*\[(.+?)\]$/,f).when(/^(.*\S)\s*<(.+?)>$/,f)}return n&&(e.title=n),o&&(e.artist=o),a&&(e.genre=a),c&&(e.subtitles=c),l&&(e.subartists=l),s&&(e.difficulty=s),u&&(e.level=u),e}},function(t,e,n){var r=n(31);t.exports=new r({t:Number,x:Number,dx:Number})},function(t,e,n){function r(t,e){var n={bpm:t,beat:0,seconds:0},r=[{t:0,x:0,dx:t/60}];e=e.slice(),e.sort(function(t,e){return t.beat-e.beat||o[t.type]-o[e.type]}),e.forEach(function(t){var e=t.beat,i=n.seconds+60*(e-n.beat)/n.bpm;switch(t.type){case"bpm":n.bpm=t.bpm,r.push({t:i,x:e,dx:n.bpm/60});break;case"stop":r.push({t:i,x:e,dx:0}),i+=60*(t.stopBeats||0)/n.bpm,r.push({t:i,x:e,dx:n.bpm/60});break;default:throw new Error("Unrecognized segment object!")}n.beat=e,n.seconds=i}),this._speedcore=new i(r)}var i=n(94);t.exports=r;var o={bpm:1,stop:2};r.prototype.beatToSeconds=function(t){return this._speedcore.t(t)},r.prototype.secondsToBeat=function(t){return this._speedcore.x(t)},r.fromBMSChart=function(t){var e=[];return t.objects.all().forEach(function(n){var r,i=t.measureToBeat(n.measure,n.fraction);if("03"===n.channel)r=parseInt(n.value,16),e.push({type:"bpm",beat:i,bpm:r});else if("08"===n.channel)r=t.headers.get("bpm"+n.value),e.push({type:"bpm",beat:i,bpm:r});else if("09"===n.channel){var o=t.headers.get("stop"+n.value)/48;e.push({type:"stop",beat:i,stopBeats:o})}}),new r(+t.headers.get("bpm")||60,e)}},function(t){function e(t){var e=1024*(1<<30),n=1<<30,r=1<<20,i=1024,o=Math.abs(t);return o>=e?Math.round(t/e*100)/100+"tb":o>=n?Math.round(t/n*100)/100+"gb":o>=r?Math.round(t/r*100)/100+"mb":o>=i?Math.round(t/i*100)/100+"kb":t+"b"}t.exports=function(t){if("number"==typeof t)return e(t);var n=t.match(/^(\d+(?:\.\d+)?) *(kb|mb|gb|tb)$/),r=parseFloat(n[1]),i=n[2],o={kb:1024,mb:1<<20,gb:1<<30,tb:1024*(1<<30)};return o[i]*r}},function(t){"use strict";var e=function(){var t={constructor:function(){return"0"},toString:function(){return"1"},valueOf:function(){return"2"},toLocaleString:function(){return"3"},prototype:function(){return"4"},isPrototypeOf:function(){return"5"},propertyIsEnumerable:function(){return"6"},hasOwnProperty:function(){return"7"},length:function(){return"8"},unique:function(){return"9"}},e=[];for(var n in t)e.push(t[n]());return"0123456789"!==e.join("")}();t.exports=function(t){var n,r,i,o=Array.prototype.slice.call(arguments,1);for(r=0;r<o.length;r++){n=o[r];for(i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);e&&n.hasOwnProperty("toString")&&n.toString!==t.toString&&(t.toString=n.toString)}return t}},function(t,e,n){"use strict";function r(t,e,n,r,i){var o=t.context;c.defineAttribute(this,"name","readonly",e,function(t){throw new TypeError(c.formatter.concat(this,t))}),c.defineAttribute(this,"defaultValue","readonly",n,function(t){throw new TypeError(c.formatter.concat(this,t))}),c.defineAttribute(this,"minValue","readonly",r,function(t){throw new TypeError(c.formatter.concat(this,t))}),c.defineAttribute(this,"maxValue","readonly",i,function(t){throw new TypeError(c.formatter.concat(this,t))}),Object.defineProperty(this,"value",{get:function(){return this._value=this.$valueAtTime(o.currentTime),this._value},set:function(t){if(!c.typeCheck(t,"number")){var e="";throw e+="type ",e+=c.formatter.shouldBeButGot("number",t),new TypeError(c.formatter.concat(this,e))}this._value=t},enumerable:!0}),Object.defineProperties(this,{$name:{value:"AudioParam"},$context:{value:o},$node:{value:t},$inputs:{value:[]},$events:{value:[]}}),this._value=this.defaultValue,this._tick=-1}function i(t,e){var n,r=e.time,i=t.$events,o=0,a=i.length;for(n=0;a>n;++n){if(i[n].time===r&&i[n].type===e.type){o=1;break}if(i[n].time>r)break}i.splice(n,o,e)}function o(t,e,n,r,i,o){var a=(r-i)/(o-i);return(1-a)*e+a*n}function a(t,e,n,r,i,o){var a=(r-i)/(o-i);return e>0&&n>0?e*Math.pow(n/e,a):t}function s(t,e,n,r,i){return e+(t-e)*Math.exp((r-n)/i)}function u(t,e,n,r,i){var o=(e-n)/(r-n);return 0>=o?c.defaults(i[0],t):o>=1?c.defaults(i[i.length-1],t):c.defaults(i[i.length*o|0],t)}var c=n(16),l=n(61),f=n(13),h=function(){throw new TypeError("Illegal constructor")};c.inherits(r,h),r.exports=h,h.prototype.setValueAtTime=function(t,e){var n=new l(this,"setValueTime",[{name:"value",type:"number"},{name:"startTime",type:"number"}]);n.validateArguments(arguments,function(t){throw new TypeError(n.form+"; "+t)}),i(this,{type:"SetValue",value:t,time:e})},h.prototype.linearRampToValueAtTime=function(t,e){var n=new l(this,"linearRampToValueAtTime",[{name:"value",type:"number"},{name:"endTime",type:"number"}]);n.validateArguments(arguments,function(t){throw new TypeError(n.form+"; "+t)}),i(this,{type:"LinearRampToValue",value:t,time:e})},h.prototype.exponentialRampToValueAtTime=function(t,e){var n=new l(this,"exponentialRampToValueAtTime",[{name:"value",type:"number"},{name:"endTime",type:"number"}]);n.validateArguments(arguments,function(t){throw new TypeError(n.form+"; "+t)}),i(this,{type:"ExponentialRampToValue",value:t,time:e})},h.prototype.setTargetAtTime=function(t,e,n){var r=new l(this,"setTargetAtTime",[{name:"target",type:"number"},{name:"startTime",type:"number"},{name:"timeConstant",type:"number"}]);r.validateArguments(arguments,function(t){throw new TypeError(r.form+"; "+t)}),i(this,{type:"SetTarget",value:t,time:e,timeConstant:n})},h.prototype.setValueCurveAtTime=function(t,e,n){var r=new l(this,"setValueCurveAtTime",[{name:"values",type:"Float32Array"},{name:"startTime",type:"number"},{name:"duration",type:"number"}]);r.validateArguments(arguments,function(t){throw new TypeError(r.form+"; "+t)}),i(this,{type:"SetValueCurve",time:e,duration:n,curve:t})},h.prototype.cancelScheduledValues=function(t){var e=new l(this,"cancelScheduledValues",[{name:"startTime",type:"number"}]);e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)});for(var n=this.$events,r=0,i=n.length;i>r;++r)if(n[r].time>=t)return n.splice(r)},r.prototype.toJSON=function(t){return c.toJSON(this,function(t,e){var n={};return n.value=t.value,n.inputs=t.$inputs.map(function(t){return t.toJSON(e)}),n},t)},r.prototype.$valueAtTime=function(t){t=c.toSeconds(t);for(var e,n=this._value,r=this.$events,i=0;i<r.length;i++){var l=r[i],f=r[i+1];if(t<l.time)break;if(e=Math.min(t,f?f.time:t),f&&"LinearRampToValue"===f.type)n=o(n,l.value,f.value,e,l.time,f.time);else if(f&&"ExponentialRampToValue"===f.type)n=a(n,l.value,f.value,e,l.time,f.time);else switch(l.type){case"SetValue":case"LinearRampToValue":case"ExponentialRampToValue":n=l.value;break;case"SetTarget":n=s(n,l.value,e,l.time,l.timeConstant);break;case"SetValueCurve":n=u(n,e,l.time,l.time+l.duration,l.curve)}}return n},r.prototype.$process=function(t,e){this._tick!==e&&(this._tick=e,this.$inputs.forEach(function(n){n.$process(t,e)}))},t.exports=f.AudioParam=r},function(t,e,n){var r;(function(t,i){!function(o){function a(t){throw RangeError(R[t])}function s(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function u(t,e){var n=t.split("@"),r="";n.length>1&&(r=n[0]+"@",t=n[1]),t=t.replace(j,".");var i=t.split("."),o=s(i,e).join(".");return r+o}function c(t){for(var e,n,r=[],i=0,o=t.length;o>i;)e=t.charCodeAt(i++),e>=55296&&56319>=e&&o>i?(n=t.charCodeAt(i++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--)):r.push(e);return r}function l(t){return s(t,function(t){var e="";return t>65535&&(t-=65536,e+=P(t>>>10&1023|55296),t=56320|1023&t),e+=P(t)}).join("")}function f(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:w}function h(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function p(t,e,n){var r=0;for(t=n?I(t/T):t>>1,t+=I(t/e);t>N*E>>1;r+=w)t=I(t/N);return I(r+(N+1)*t/(t+C))}function d(t){var e,n,r,i,o,s,u,c,h,d,m=[],v=t.length,g=0,y=A,b=S;for(n=t.lastIndexOf(k),0>n&&(n=0),r=0;n>r;++r)t.charCodeAt(r)>=128&&a("not-basic"),m.push(t.charCodeAt(r));for(i=n>0?n+1:0;v>i;){for(o=g,s=1,u=w;i>=v&&a("invalid-input"),c=f(t.charCodeAt(i++)),(c>=w||c>I((_-g)/s))&&a("overflow"),g+=c*s,h=b>=u?x:u>=b+E?E:u-b,!(h>c);u+=w)d=w-h,s>I(_/d)&&a("overflow"),s*=d;e=m.length+1,b=p(g-o,e,0==o),I(g/e)>_-y&&a("overflow"),y+=I(g/e),g%=e,m.splice(g++,0,y)}return l(m)}function m(t){var e,n,r,i,o,s,u,l,f,d,m,v,g,y,b,C=[];for(t=c(t),v=t.length,e=A,n=0,o=S,s=0;v>s;++s)m=t[s],128>m&&C.push(P(m));for(r=i=C.length,i&&C.push(k);v>r;){for(u=_,s=0;v>s;++s)m=t[s],m>=e&&u>m&&(u=m);for(g=r+1,u-e>I((_-n)/g)&&a("overflow"),n+=(u-e)*g,e=u,s=0;v>s;++s)if(m=t[s],e>m&&++n>_&&a("overflow"),m==e){for(l=n,f=w;d=o>=f?x:f>=o+E?E:f-o,!(d>l);f+=w)b=l-d,y=w-d,C.push(P(h(d+b%y,0))),l=I(b/y);C.push(P(h(l,0))),o=p(n,g,r==i),n=0,++r}++n,++e}return C.join("")}function v(t){return u(t,function(t){return O.test(t)?d(t.slice(4).toLowerCase()):t})}function g(t){return u(t,function(t){return M.test(t)?"xn--"+m(t):t})}var y=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof i&&i);(y.global===y||y.window===y||y.self===y)&&(o=y);var b,_=2147483647,w=36,x=1,E=26,C=38,T=700,S=72,A=128,k="-",O=/^xn--/,M=/[^\x20-\x7E]/,j=/[\x2E\u3002\uFF0E\uFF61]/g,R={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},N=w-x,I=Math.floor,P=String.fromCharCode;b={version:"1.3.2",ucs2:{decode:c,encode:l},decode:d,encode:m,toASCII:g,toUnicode:v},r=function(){return b}.call(e,n,e,t),!(void 0!==r&&(t.exports=r))}(this)}).call(e,n(44)(t),function(){return this}())},function(t){"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,n,r,i){n=n||"&",r=r||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(n);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var u=t.length;s>0&&u>s&&(u=s);for(var c=0;u>c;++c){var l,f,h,p,d=t[c].replace(a,"%20"),m=d.indexOf(r);m>=0?(l=d.substr(0,m),f=d.substr(m+1)):(l=d,f=""),h=decodeURIComponent(l),p=decodeURIComponent(f),e(o,h)?Array.isArray(o[h])?o[h].push(p):o[h]=[o[h],p]:o[h]=p}return o}},function(t){"use strict";var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,n,r,i){return n=n||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(i){var o=encodeURIComponent(e(i))+r;return Array.isArray(t[i])?t[i].map(function(t){return o+encodeURIComponent(e(t))}).join(n):o+encodeURIComponent(e(t[i]))}).join(n):i?encodeURIComponent(e(i))+r+encodeURIComponent(e(t)):""}},function(t,e,n){"use strict";e.decode=e.parse=n(149),e.encode=e.stringify=n(150)},function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"use strict";var n=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=e.WaveFactory=function(){function t(e,n,i){r(this,t),this._master=e,this._samples=n,this._map=i,this._exclusiveInstances=new Map}return n(t,{playAuto:{value:function(t,e){return this._play({keysound:t,delay:e,exclusive:!0})}},playNote:{value:function(t,e){return this._play({keysound:t,delay:e,exclusive:!0})}},playFree:{value:function(t){return this._play({keysound:t,delay:0,exclusive:!1})}},_play:{value:function(t){var e=t.keysound,n=t.delay,r=t.exclusive;r&&this._stopOldExclusiveSound(e,n);var i=this._map[e.toLowerCase()];if(!i)return null;var o=this._samples[i];if(!o)return null;var a=o.play(n);return r&&this._exclusiveInstances.set(e,a),a}},_stopOldExclusiveSound:{value:function(t,e){var n=this._exclusiveInstances.get(t);n&&(setTimeout(function(){return n.stop()},1e3*e),this._exclusiveInstances["delete"](t))}}}),t}();e["default"]=i,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(){var t=(h.keyboard||"").split(",").map(function(t){return+t}),e={};return c(window).keydown(function(t){return e[t.which]=1}).keyup(function(t){return e[t.which]=0}),{get:function(){return{p1_1:e[t[0]||83],p1_2:e[t[1]||68],p1_3:e[t[2]||70],p1_4:e[t[3]||32],p1_5:e[t[4]||74],p1_6:e[t[5]||75],p1_7:e[t[6]||76],p1_SC:e[t[7]||65],p1_speedup:e[38],p1_speeddown:e[40],start:e[13],select:e[18]}}}}function i(){function t(t){return n.some(function(e){return e.buttons[t].pressed})}function e(t){for(var e=0;e<n.length;e++){var r=n[e];if(Math.abs(r.axes[t])>.01)return r.axes[t]}return 0}var n=[];return window.addEventListener("gamepadconnected",function(t){n.push(t.gamepad)}),{get:function(){var n={p1_1:t(3),p1_2:t(6),p1_3:t(2),p1_4:t(7),p1_5:t(1),p1_6:t(4),p1_7:e(3),p1_SC:e(4),start:t(9),select:t(8)};return n.p1_speedup=(n.start||n.select)&&(n.p1_2||n.p1_4||n.p1_6),n.p1_speeddown=(n.start||n.select)&&(n.p1_1||n.p1_3||n.p1_5||n.p1_7),n}}}var o=function(t){return t&&t.__esModule?t["default"]:t},a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var n,r=[],i=t[Symbol.iterator]();!(n=i.next()).done&&(r.push(n.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=o(n(29)),l=o(n(165)),f=o(n(7)),h=o(n(159)),p=e.GameInput=function(){function t(){u(this,t),this._controls=new Map,this._plugins=[],this.use(new r),this.use(new i)}return s(t,{update:{value:function(){var t=new Map,e=!0,n=!1,r=void 0;try{for(var i,o=this._controls[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var s=a(i.value,2),u=(s[0],s[1]);u.changed=!1}}catch(c){n=!0,r=c}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}var l=!0,f=!1,h=void 0;try{for(var p,d=this._plugins[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var m=p.value,v=!0,g=!1,y=void 0;try{for(var b,_=m()[Symbol.iterator]();!(v=(b=_.next()).done);v=!0){var w=a(b.value,2),x=w[0],E=w[1];t.set(x,E)}}catch(c){g=!0,y=c}finally{try{!v&&_["return"]&&_["return"]()}finally{if(g)throw y}}}}catch(c){f=!0,h=c}finally{try{!l&&d["return"]&&d["return"]()}finally{if(f)throw h}}var C=!0,T=!1,S=void 0;try{for(var A,k=t[Symbol.iterator]();!(C=(A=k.next()).done);C=!0){var O=a(A.value,2),M=O[0],E=O[1],u=this.get(M);u.value!==E&&(u.changed=!0,u.value=E)}}catch(c){T=!0,S=c}finally{try{!C&&k["return"]&&k["return"]()}finally{if(T)throw S}}}},get:{value:function(t){return this._controls.has(t)||this._controls.set(t,new l),this._controls.get(t)}},use:{value:function(t){var e={};this._plugins.push(function(){var n=t.get(),r=[],i=!0,o=!1,a=void 0;try{for(var s,u=f.union(f.keys(n),f.keys(e))[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var c=s.value,l=+e[c]||0,h=+n[c]||0;l!==h&&r.push([c,h]),e[c]=h}}catch(p){o=!0,a=p}finally{try{!i&&u["return"]&&u["return"]()}finally{if(o)throw a}}return r})}}}),t}();e["default"]=p,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e){"use strict";var n=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=e.Player=function(){function t(e,n,i){r(this,t),this._notechart=e,this._number=n,this._options={autosound:!!i.autosound,speed:+i.speed,placement:i.placement||"center"}}return n(t,{notechart:{get:function(){return this._notechart}},columns:{get:function(){return this._notechart.columns}},number:{get:function(){return this._number}},options:{get:function(){return this._options}}}),t}();e["default"]=i,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},i=function(t){return t&&t.__esModule?t["default"]:t},o=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=i(n(7)),u=r(n(47)),c=e.PlayerStats=function(){function t(e){a(this,t),this.totalCombo=s(e.notes).map(function(t){return e.info(t).combos}).sum(),this.combo=0,this.maxCombo=0,this.rawSumJudgmentWeight=0,this.rawTotalComboScore=this._calculateRawTotalComboScore(),this.rawSumComboScore=0,this.poor=!1}return o(t,{score:{get:function(){var t=u.weight(1)*this.totalCombo,e=Math.floor(5e5*this.rawSumJudgmentWeight/t),n=Math.floor(55555*this.rawSumComboScore/this.rawTotalComboScore);return e+n}},handleJudgment:{value:function(t){u.breaksCombo(t)?(this.combo=0,this.poor=!0):(this.combo+=1,this.rawSumComboScore+=this._calculateRawComboScore(this.combo),this.poor=!1),this.rawSumJudgmentWeight+=u.weight(t),this.combo>this.maxCombo&&(this.maxCombo=this.combo)}},_calculateRawTotalComboScore:{value:function(){for(var t=0,e=1;e<=this.totalCombo;e++)t+=this._calculateRawComboScore(e);return t}},_calculateRawComboScore:{value:function(t){return 0===t?0:23>t?1:51>t?2:92>t?3:161>t?4:5}}}),t}();e["default"]=c,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t){var e=l.map(Array.from(t.children("keyframe")),o),n={},r=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var f=u.value,h=+f.t,p=f.ease||"linear";if(isNaN(h))throw new Error('Expected keyframe to have "t" attribute');for(var d in f)if("t"!==d&&"ease"!==d){var m=+f[d],v=n[d]||(n[d]=i(d));v.keyframes.push({time:h,value:m,ease:p})}}}catch(g){a=!0,s=g}finally{try{!r&&c["return"]&&c["return"]()}finally{if(a)throw s}}return{on:t.attr("on")||"",data:l.values(n)}}function i(t){return{name:t,keyframes:[]}}function o(t){return l(t.attributes).map(function(t){return[t.name.toLowerCase(),t.value]}).object().value()}var a=function(t){return t&&t.__esModule?t["default"]:t},s=function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)},u=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};e._compile=r,e._attrs=o;var l=a(n(7)),f=a(n(29)),h=a(n(187)),p=function(t){return Object.assign({},t,{data:h(t.data)})},d=e.Animation=function(){function t(e){c(this,t),this._properties=l(e).map(function(t){return l.pluck(t.data,"name")}).flatten().thru(function(t){return new Set(t)}).value(),this._animations=l.map(e,p),this._events=l.uniq(l.pluck(e,"on"))}return u(t,{prop:{value:function(t,e){var n=this;return this._properties.has(t)?function(r){var i=n._getAnimation(r);return i.hasOwnProperty(t)?i[t]:e(r)}:e}},_getAnimation:{value:function(t){var e=l(this._events).filter(function(e){return""===e||e in t}).max(function(e){return t[e]||0}),n=t.t-(t[e]||0),r=this._animations.filter(function(t){return t.on===e}),i=r.map(function(t){return t.data.values(n)});return Object.assign.apply(Object,[{}].concat(s(i)))}}},{compile:{value:function(e,n){var i=Array.from(n.children("animation")),o=l.map(i,function(t){return r(f(t))});return new t(o)}}}),t}();e["default"]=d,Object.defineProperty(e,"__esModule",{value:!0})},,function(t,e,n){"use strict";function r(t,e,n){var r=s(t);if(r!==e)throw new TypeError("Expected type of "+n+" to be "+e+", but was "+r)}function i(t){return c.isPrototypeOf(t)}function o(t,e){if(null===e||void 0===e)return!1;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n],i=e[n];if(l.isMatcher(r)){if(!r.test(i))return!1}else if("object"===s(r)){if(!o(r,i))return!1}else if(!l.equal(r,i))return!1}return!0}function a(t,e){return function(n,i){r(n,"string","property");var o=1===arguments.length,a=e+'("'+n+'"';return o||(a+=", "+i),a+=")",l(function(e){return void 0!==e&&null!==e&&t(e,n)?o||l.equal(i,e[n]):!1},a)}}var s=n(386),u=n(130),c={toString:function(){return this.message}};c.or=function(t){if(!arguments.length)throw new TypeError("Matcher expected");i(t)||(t=l(t));var e=this,n=u.create(c);return n.test=function(n){return e.test(n)||t.test(n)},n.message=e.message+".or("+t.message+")",n},c.and=function(t){if(!arguments.length)throw new TypeError("Matcher expected");i(t)||(t=l(t));var e=this,n=u.create(c);return n.test=function(n){return e.test(n)&&t.test(n)},n.message=e.message+".and("+t.message+")",n};var l=function(t,e){var n=u.create(c),r=s(t);switch(r){case"object":if("function"==typeof t.test)return n.test=function(e){return t.test(e)===!0},n.message="match("+u.getName(t.test)+")",n;var i=[];for(var a in t)t.hasOwnProperty(a)&&i.push(a+": "+t[a]);n.test=function(e){return o(t,e)},n.message="match("+i.join(", ")+")";break;case"number":n.test=function(e){return t==e};break;case"string":n.test=function(e){return"string"!=typeof e?!1:-1!==e.indexOf(t)},n.message='match("'+t+'")';break;case"regexp":n.test=function(e){return"string"!=typeof e?!1:t.test(e)};break;case"function":n.test=t,n.message=e?e:"match("+u.getName(t)+")";break;default:n.test=function(e){return l.equal(t,e)}}return n.message||(n.message="match("+t+")"),n};l.isMatcher=i,l.any=l(function(){return!0},"any"),l.defined=l(function(t){return null!==t&&void 0!==t},"defined"),l.truthy=l(function(t){return!!t},"truthy"),l.falsy=l(function(t){return!t},"falsy"),l.same=function(t){return l(function(e){return t===e},"same("+t+")")},l.typeOf=function(t){return r(t,"string","type"),l(function(e){return s(e)===t},'typeOf("'+t+'")')},l.instanceOf=function(t){return r(t,"function","type"),l(function(e){return e instanceof t},"instanceOf("+u.getName(t)+")")},l.has=a(function(t,e){return"object"==typeof t?e in t:void 0!==t[e]},"has"),l.hasOwn=a(function(t,e){return t.hasOwnProperty(e)},"hasOwn"),l.bool=l.typeOf("boolean"),l.number=l.typeOf("number"),l.string=l.typeOf("string"),l.object=l.typeOf("object"),l.func=l.typeOf("function"),l.array=l.typeOf("array"),l.regexp=l.typeOf("regexp"),l.date=l.typeOf("date"),l.equal=function(t,e){return t==e},t.exports=l},function(t,e,n){"use strict";function r(){var t=void 0===arguments[0]?"":arguments[0];return s.Compiler.compile(t).chart}function i(t){return u.fromBMSChart(r(t))}function o(t){var e=void 0===arguments[1]?{}:arguments[1];return new c(i(t),1,e)}var a=function(t){return t&&t.__esModule?t["default"]:t};e.chart=r,e.notechart=i,e.playerWithBMS=o;var s=a(n(104)),u=a(n(168)),c=a(n(156)),l=a(n(7)),f=l.tap;e.tap=f,Object.defineProperty(e,"__esModule",{value:!0})},,function(t,e,n){"use strict";function r(t){t=s.sortBy(t,"time");var e=0;return{next:function(n){for(var r=[];e<t.length&&n>=t[e].time;e++)r.push(t[e]);return r}}}var i=function(t){return t&&t.__esModule?t["default"]:t},o=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=i(n(7)),u=i(n(154)),c=n(47).isBad,l=e.PlayerAudio=function(){function t(e){var n=e.player,i=e.samples,o=e.master,s=e.waveFactory;a(this,t);var c=n.notechart;this._waveFactory=s||new u(o,i,c.keysounds),this._autos=r(c.autos),this._notes=r(c.notes),this._played=new Map,this._autosound=!!n.options.autosound}return o(t,{update:{value:function(t,e){this._playAutokeysounds(t),this._playAutosounds(t,e),this._handleSoundNotifications(e&&e.notifications.sounds||[])
}},_playAutokeysounds:{value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=this._autos.next(t+1/30)[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;this._waveFactory.playAuto(a.keysound,a.time-t)}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}}},_playAutosounds:{value:function(t,e){var n=this._notes.next(t+1/30),r=e&&e.stats.poor,i=this._autosound&&!r;if(i){var o=!0,a=!1,s=void 0;try{for(var u,c=n[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;this._hitNote(l,l.time-t)}}catch(f){a=!0,s=f}finally{try{!o&&c["return"]&&c["return"]()}finally{if(a)throw s}}}}},_handleSoundNotifications:{value:function(t){var e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value,s=a.type,u=a.note;"hit"===s?this._hitNote(u,0,a.judgment):"break"===s?this._breakNote(u):"free"===s&&this._waveFactory.playFree(u.keysound,0)}}catch(c){n=!0,r=c}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}}},_hitNote:{value:function(t,e,n){var r=this._played.get(t);r||(r=this._waveFactory.playNote(t.keysound,e),this._played.set(t,r)),r&&c(n)&&r.bad()}},_breakNote:{value:function(t){var e=this._played.get(t);e&&(console.log(e),e.stop())}}}),t}();e["default"]=l,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=r(n(101)),s=n(47),u=s.MISSED,c=s.breaksCombo,l=e.PlayerDisplay=function(){function t(e){o(this,t);var n=e.notechart;this._currentSpeed=1,this._player=e,this._noteArea=new a(n.notes,n.barLines),this._stateful={},this._defaultData={placement:e.options.placement}}return i(t,{update:{value:function(t,e,n){function r(){g.beat=m}function i(){var t=p.getVisibleNotes(v,f(),1),e=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var s=o.value,c=s.note,l=c.column;if(s.height){var h=n.getNoteJudgment(c),d=n.getNoteStatus(c);y("longnote_"+l,{key:c.id,y:s.y,height:s.height,active:0!==h&&h!==u,missed:"judged"===d&&h===u})}else"judged"!==n.getNoteStatus(c)&&y("note_"+l,{key:c.id,y:s.y})}}catch(m){r=!0,i=m}finally{try{!e&&a["return"]&&a["return"]()}finally{if(r)throw i}}}function o(){var t=p.getVisibleBarLines(v,f(),1),e=!0,n=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(e=(i=o.next()).done);e=!0){var a=i.value;y("barlines",{key:a.id,y:a.y})}}catch(s){n=!0,r=s}finally{try{!e&&o["return"]&&o["return"]()}finally{if(n)throw r}}}function a(){var e=n.input,r=!0,i=!1,o=void 0;try{for(var a,s=h.columns[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=e.get(u);g[""+u+"_active"]=0!==c.value?1:0,c.changed&&(0!==c.value?d[""+u+"_down"]=t:d[""+u+"_up"]=t)}}catch(l){i=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}function s(){var e=n.notifications.judgments,r=e[e.length-1];if(r){var i=-1===r.judgment?"missed":""+r.judgment;d["judge_"+i]=t,d.combo=r.combo}g.score=n.stats.score}function l(){for(var e=n.notifications.judgments,r=0;r<e.length;r++){var i=e[r];c(i.judgment)||(d[""+i.column+"_explode"]=t)}}function f(){return v+5/b}var h=this._player,p=this._noteArea,d=this._stateful,m=h.notechart.secondsToBeat(e),v=h.notechart.beatToPosition(m),g=Object.assign({},this._defaultData),y=function(t,e){return(g[t]||(g[t]=[])).push(e)};this._currentSpeed+=(n.speed-this._currentSpeed)/3;var b=this._currentSpeed;return r(),i(),o(),a(),s(),l(),Object.assign(g,d),g}}}),t}();e["default"]=l,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e){"use strict";var n=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),r=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=e.Control=function(){function t(){r(this,t),this.value=0,this.changed=!1}return n(t,{justPressed:{get:function(){return this.changed&&this.value}}}),t}();e["default"]=i,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e){"use strict";function n(t){function e(e){var n=t.refs[e];if(n){var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value,c=u.getBounds(),l=!0,f=!1,h=void 0;try{for(var p,d=t.input[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var m=p.value;if(c.contains(m.x,m.y))return 1}}catch(v){f=!0,h=v}finally{try{!l&&d["return"]&&d["return"]()}finally{if(f)throw h}}}}catch(v){i=!0,o=v}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}}return 0}function n(){var e=t.refs.p1_SC;if(!e)return 0;a=null;var n=!0,r=!1,i=void 0;try{for(var s,u=t.input[Symbol.iterator]();!(n=(s=u.next()).done);n=!0){var c=s.value,l=!0,f=!1,h=void 0;try{for(var p,d=e[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var m=p.value;if(m.getBounds().contains(c.x,c.y)){a=c.y,d["return"]&&d["return"]();break}}}catch(v){f=!0,h=v}finally{try{!l&&d["return"]&&d["return"]()}finally{if(f)throw h}}if(null!==a){u["return"]&&u["return"]();break}}}catch(v){r=!0,i=v}finally{try{!n&&u["return"]&&u["return"]()}finally{if(r)throw i}}return null===a?(o=null,0):(null===o&&(o=a),a>o+16?o=a-16:o-16>a&&(o=a+16),a>o+4?-1:o-4>a?1:0)}function i(){var e=null,n=null,r=!0,i=!1,o=void 0;try{for(var a,s=t.input[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;if(u.y<550)if(null===e)e=u.y;else{if(null!==n)return 0;n=u.y}}}catch(c){i=!0,o=c}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return null!==e&&null!==n?Math.abs(e-n):0}var o=null,a=null;return{get:function(){var t={};t.p1_SC=n();var o=!0,a=!1,s=void 0;try{for(var u,c=r[Symbol.iterator]();!(o=(u=c.next()).done);o=!0){var l=u.value;t[l]=e(l)}}catch(f){a=!0,s=f}finally{try{!o&&c["return"]&&c["return"]()}finally{if(a)throw s}}return t.p1_pinch=i(),t}}}e.TouchPlugin=n;var r=["p1_1","p1_2","p1_3","p1_4","p1_5","p1_6","p1_7","start"];e["default"]=n,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},i=function(t){return t&&t.__esModule?t["default"]:t},o=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=i(n(7)),u=r(n(58)),c=n(62).EXTRA_FORMATTER,l=n(59).canPlay,f=e.SamplesLoader=function(){function t(e,n){a(this,t),this._assets=e,this._master=n}return o(t,{loadFiles:{value:function(t,e,n){var r=this,i=u.fixed(t.length,e),o=u.fixed(t.length,n),a=function(t){return r._loadSample(t,i,o)};return n&&(n.formatter=c),Promise.map(t,a).then(function(t){return s(t).filter().object().value()})}},_loadSample:{value:function(t,e,n){var r=this;return this._getFile(t).then(function(i){return i.read().tap(function(){return e(t)}).then(function(t){return r._decode(t)}).tap(function(){return n(t)}).then(function(e){return[t,e]})["catch"](function(e){return console.error("Unable to decode: "+t,e),null})},function(){return null})}},_decode:{value:function(t){return this._master.sample(t)}},_getFile:{value:function(t){var e=this;return Promise["try"](function(){if(!l('audio/ogg; codecs="vorbis"'))throw new Error("cannot play OGG");return e._assets.file(t.replace(/\.\w+$/,".ogg"))})["catch"](function(){return e._assets.file(t.replace(/\.\w+$/,".m4a"))})["catch"](function(){return e._assets.file(t.replace(/\.\w+$/,".mp3"))})["catch"](function(){return e._assets.file(t)})}}}),t}();e["default"]=f,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=r(n(104)),s=r(n(7)),u=r(n(89)),c=r(n(131)),l=e.Notechart=function(){function t(e){var n=this;o(this,t);var r=a.Notes.fromBMSChart(e),i=a.Timing.fromBMSChart(e),s=a.Keysounds.fromBMSChart(e);this._timing=i,this._keysounds=s,this._notes=this._generatePlayableNotesFromBMS(r),this._autos=this._generateAutoKeysoundEventsFromBMS(r),this._barLines=this._generateBarLines(r,e),this._samples=this._generateKeysoundFiles(s),this._infos=new Map(this._notes.map(function(t){return[t,n._getNoteInfo(t)]}))}return i(t,{notes:{get:function(){return this._notes}},autos:{get:function(){return this._autos}},samples:{get:function(){return this._samples}},keysounds:{get:function(){return this._keysounds.all()}},barLines:{get:function(){return this._barLines}},columns:{get:function(){return["SC","1","2","3","4","5","6","7"]}},info:{value:function(t){return this._infos.get(t)}},beatToSeconds:{value:function(t){return this._timing.beatToSeconds(t)}},beatToPosition:{value:function(t){return t}},secondsToBeat:{value:function(t){return this._timing.secondsToBeat(t)}},secondsToPosition:{value:function(t){return this.beatToPosition(this.secondsToBeat(t))}},_generatePlayableNotesFromBMS:{value:function(t){var e=this,n=1;return t.all().filter(function(t){return t.column}).map(function(t){var r=e._generateEvent(t.beat);return r.id=n++,r.column=t.column.column,r.keysound=t.keysound,r.end=void 0!==t.endBeat?e._generateEvent(t.endBeat):void 0,new c(r)})}},_generateAutoKeysoundEventsFromBMS:{value:function(t){var e=this;return t.all().filter(function(t){return!t.column}).map(function(t){var n=e._generateEvent(t.beat);return n.keysound=t.keysound,new u(n)})}},_generateBarLines:{value:function(t,e){var n=s.max(t.all().map(function(t){return t.endBeat||t.beat})),r=[{beat:0,position:0}],i=0,o=0,a=0;do i+=e.timeSignatures.getBeats(o),o+=1,a=this.beatToPosition(i),r.push({beat:i,position:a});while(n>=i);return r}},_generateKeysoundFiles:{value:function(t){var e=new Set,n=!0,r=!1,i=void 0;try{for(var o,a=[this.notes,this.autos][Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value,u=!0,c=!1,l=void 0;try{for(var f,h=s[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var p=f.value,d=t.get(p.keysound);d&&e.add(d)}}catch(m){c=!0,l=m}finally{try{!u&&h["return"]&&h["return"]()}finally{if(c)throw l}}}}catch(m){r=!0,i=m}finally{try{!n&&a["return"]&&a["return"]()}finally{if(r)throw i}}return Array.from(e)}},_generateEvent:{value:function(t){return{beat:t,time:this.beatToSeconds(t),position:this.beatToPosition(t)}}},_getNoteInfo:{value:function(t){var e=t.end?2:1;return{combos:e}}}},{fromBMSChart:{value:function(e,n,r){return new t(e,n,r)}}}),t}();e["default"]=l,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t){return function(e){var n=0;return Object.defineProperties({notes:e,update:function(){for(;n<e.length&&"judged"===t.getNoteStatus(e[n]);)n+=1}},{startIndex:{get:function(){return n},configurable:!0,enumerable:!0}})}}var i=function(t){return t&&t.__esModule?t["default"]:t},o=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=i(n(7)),u=n(47),c=u.judgeTime,l=u.judgeEndTime,f=u.isBad,h=u.MISSED,p=i(n(157)),d=e.PlayerState=function(){function t(e){a(this,t),this._player=e,this._columns=e.columns,this._noteBufferByColumn=s(e.notechart.notes).sortBy("time").groupBy("column").mapValues(r(this)).value(),this._noteResult=new Map,this.stats=new p(e.notechart),this.notifications={},this.speed=e.options.speed}return o(t,{update:{value:function(t,e){this._gameTime=t,this._rawInput=e,this.notifications={},this.notifications.sounds=[],this.notifications.judgments=[],this._updateInputColumnMap(),this._judgeNotes(),this._updateSpeed()}},getNoteStatus:{value:function(t){var e=this._noteResult.get(t);return e?e.status:"unjudged"}},getNoteJudgment:{value:function(t){var e=this._noteResult.get(t);return e?e.judgment:0}},getPlayerInput:{value:function(t){return this._rawInput.get("p"+this._player.number+"_"+t)}},_updateInputColumnMap:{value:function(){var t=this;this.input=new Map(this._columns.map(function(e){return[e,t.getPlayerInput(e)]}))}},_judgeNotes:{value:function(){var t=!0,e=!1,n=void 0;try{for(var r,i=this._columns[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var o=r.value,a=this._noteBufferByColumn[o];if(a){var s=this.input.get(o);this._judgeColumn(a,s),a.update()}}}catch(u){e=!0,n=u}finally{try{!t&&i["return"]&&i["return"]()}finally{if(e)throw n}}}},_updateSpeed:{value:function(){this.getPlayerInput("speedup").justPressed&&this._modifySpeed(1),this.getPlayerInput("speeddown").justPressed&&this._modifySpeed(-1);var t=this.getPlayerInput("pinch").value;if(t&&!this._pinching?this._pinching={start:t,speed:this.speed}:t||(this._pinching=null),t){var e=this._pinching,n=e.speed*t/e.start;this.speed=Math.max(.2,Math.round(10*n)/10)}}},_modifySpeed:{value:function(t){var e=this._rawInput.get("select").value?.1:this.speed<.5?.3:.5;this.speed+=t*e,this.speed<.2&&(this.speed=.2)}},_judgeColumn:{value:function(t,e){for(var n=void 0,r=void 0,i=t.notes,o=t.startIndex;o<i.length;o++){var a=i[o];if(this._shouldJudge(a,e,t)){var s="active"!==this.getNoteStatus(a);if(n=a,r=this._judge(a),s)break}}if(e.justPressed)if(n)this.notifications.sounds.push({note:n,type:"hit",judgment:r});else{var u=this._getClosestNote(i);u&&this.notifications.sounds.push({note:u,type:"free"})}}},_getClosestNote:{value:function(t){var e=this;return s.min(t,function(t){return Math.abs(e._gameTime-t.time)})}},_shouldJudge:{value:function(t,e,n){var r=this.getNoteStatus(t);if("unjudged"===r){var i=c(this._gameTime,t.time),o=i===h,a=i>0&&e.changed&&e.value;return f(i)&&this._getClosestNote(n.notes)!==t&&(a=!1),o||a}if("active"===r){var i=l(this._gameTime,t.end.time),o=i===h,s=e.changed;return o||s}return!1}},_judge:{value:function(t){var e=this._gameTime-t.time,n=c(this._gameTime,t.time),r=this._noteResult.get(t);if(t.end)if(r&&"unjudged"!==r.status){if("active"===r.status){var i="SC"===t.column;e=this._gameTime-t.end.time,n=l(this._gameTime,t.end.time)||h,i&&e>0&&(n=1),r={status:"judged",judgment:n,delta:e}}}else{var o=n===h?"judged":"active";r={status:o,judgment:n,delta:e}}else r={status:"judged",judgment:n,delta:e};return n===h&&this.notifications.sounds.push({note:t,type:"break"}),this._noteResult.set(t,r),this._setJudgment(n,e,t.column),n}},_setJudgment:{value:function(t,e,n){this.stats.handleJudgment(t);var r={judgment:t,combo:this.stats.combo,delta:e,column:n};this.notifications.judgments.push(r)}}}),t}();e["default"]=d,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t){return p(t.slice(0,10)).as("text").then(function(e){if("BEMUSEPACK"!==e)throw new Error("Invalid magic number");return p(t.slice(10,14)).as("arraybuffer")}).then(function(t){var e=new Uint8Array(t),n=e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24);return n}).then(function(e){return t.slice(14+e)})}var i=function(t){return t&&t.__esModule?t:{"default":t}},o=function(t){return t&&t.__esModule?t["default"]:t},a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){for(var n,r=[],i=t[Symbol.iterator]();!(n=i.next()).done&&(r.push(n.value),!e||r.length!==e););return r}throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=n(88).resolve,l=o(n(226)),f=o(n(7)),h=o(n(90)),p=o(n(46)),d=o(n(305)),m=o(n(63)),v=i(n(58)),g=e.BemusePackageResources=function(){function t(e){var n=this;u(this,t);var i=l.bind(null,this);this._url=e,i("metadata",function(){return h(c(n._url,"metadata.json")).as("text").then(function(t){return JSON.parse(t)})}),i("refs",function(){return n.metadata.then(function(t){return t.refs.map(function(t){return new b(n,t)})})}),this.progress={all:new m,current:new m},this._loadPayload=v.wrapPromise(this.progress.all,d(1,function(t){return h(t).as("blob",n.progress.current).then(r)}))}return s(t,{url:{get:function(){return this._url}},file:{value:function(t){var e=this;return this.metadata.then(function(n){var r=f.find(n.files,{name:t});if(!r)throw new Error("Unable to find: "+t);return new y(e,r.ref,r.name)})}},getBlob:{value:function(t){var e=a(t,3),n=e[0],r=e[1],i=e[2];return this.refs.then(function(t){return t[n]}).then(function(t){return t.load()}).then(function(t){return t.slice(r,i)})}}}),t}(),y=function(){function t(e,n,r){u(this,t),this._resources=e,this._ref=n,this._name=r}return s(t,{read:{value:function(){return this._resources.getBlob(this._ref).then(function(t){return p(t).as("arraybuffer")})}},name:{get:function(){return this._name}}}),t}(),b=function(){function t(e,n){u(this,t),this._resources=e,this._url=c(e.url,n.path)}return s(t,{load:{value:function(){return this._promise||(this._promise=this._resources._loadPayload(this._url))}}}),t}();e["default"]=g,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=r(n(96)),s=a("scintillator:compiler"),u=r(n(29)),c=r(n(177)),l=r(n(178)),f=r(n(174)),h=r(n(176)),p=r(n(179)),d=r(n(175)),m={skin:c,sprite:l,group:f,object:h,text:p,"if":d},v=function(){function t(e){o(this,t),Object.assign(this,e)}return i(t,{compile:{value:function(e){var n=e[0].nodeName;s("compiling",e[0]);var r=t.getNodeClass(n);if(!r)throw new Error("Invalid node name: "+n);return r.compile(this,e)}},compileChildren:{value:function(e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=Array.from(e.children())[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value,l=c.nodeName,f=t.getNodeClass(l);f&&n.push(this.compile(u(c)))}}catch(h){i=!0,o=h}finally{try{!r&&s["return"]&&s["return"]()}finally{if(i)throw o}}return n}}},{getNodeClass:{value:function(t){return m[t]}}}),t}();t.exports=v},function(t,e,n){"use strict";function r(t,e){return navigator.userAgent.match(/Gecko\//)?new s.autoDetectRenderer(t,e):new s.CanvasRenderer(t,e)}var i=function(t){return t&&t.__esModule?t["default"]:t},o=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=i(n(10)),u=e.Context=function(){function t(e){a(this,t),this.refs={},this._skin=e,this._instance=e.instantiate(this),this._renderer=r(e.width,e.height),this.stage=this._instance.object,this.view=this._renderer.view,this._setupInteractivity()}return o(t,{render:{value:function(t){this._instance.push(t),this._renderer.render(this.stage)}},destroy:{value:function(){this._instance.destroy(),this._instance=null}},input:{get:function(){return this._input.get()}},ref:{value:function(t,e){var n=this.refs[t]||(this.refs[t]=new Set);n.add(e)}},unref:{value:function(t,e){var n=this.refs[t];n&&n["delete"](e)}},_setupInteractivity:{value:function(){var t=this.stage,e=t.interactionManager,n=!1;t.interactive=!0,t.mousedown=function(){n=!0},t.mouseup=function(){n=!1},t.mouseupoutside=function(){n=!1},this._input={get:function(){var t=[];if(n){var r=e.mouse.global;t.push({x:r.x,y:r.y,id:"mouse"})}for(var i in e.touches)if(e.touches[i]){var o=e.touches[i].global;t.push({x:o.x,y:o.y,id:"touch"+i})}return t}}}}}),t}();e["default"]=u,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t,e){return h(regeneratorRuntime.mark(function n(){var r,a,s,u,h,p,g,y,b,_,w,x,E,C,T,S,A,k,O,M,j,R,N;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return c("load XML from %s",t),n.next=3,i(t);case 3:for(r=n.sent,a=new m,s=new Set,u=!0,h=!1,p=void 0,n.prev=9,g=Array.from(r.find("[image]"))[Symbol.iterator]();!(u=(y=g.next()).done);u=!0)b=y.value,s.add(l(b).attr("image"));n.next=17;break;case 13:n.prev=13,n.t7=n["catch"](9),h=!0,p=n.t7;case 17:n.prev=17,n.prev=18,!u&&g["return"]&&g["return"]();case 20:if(n.prev=20,!h){n.next=23;break}throw p;case 23:return n.finish(20);case 24:return n.finish(17);case 25:for(_=!0,w=!1,x=void 0,n.prev=28,E=Array.from(r.find("[font-src]"))[Symbol.iterator]();!(_=(C=E.next()).done);_=!0)b=C.value,s.add(l(b).attr("font-src"));n.next=36;break;case 32:n.prev=32,n.t8=n["catch"](28),w=!0,x=n.t8;case 36:n.prev=36,n.prev=37,!_&&E["return"]&&E["return"]();case 39:if(n.prev=39,!w){n.next=42;break}throw x;case 42:return n.finish(39);case 43:return n.finish(36);case 44:for(T=!0,S=!1,A=void 0,n.prev=47,k=s[Symbol.iterator]();!(T=(O=k.next()).done);T=!0)M=O.value,j=f.resolve(t,M),a.add(M,j);n.next=55;break;case 51:n.prev=51,n.t9=n["catch"](47),S=!0,A=n.t9;case 55:n.prev=55,n.prev=56,!T&&k["return"]&&k["return"]();case 58:if(n.prev=58,!S){n.next=61;break}throw A;case 61:return n.finish(58);case 62:return n.finish(55);case 63:return R=d.fixed(1+s.size,e),R(),n.next=67,o(a,R);case 67:return c("compiling"),N=new v({resources:a}).compile(r),n.abrupt("return",N);case 70:case"end":return n.stop()}},n,this,[[9,13,17,25],[18,,20,24],[28,32,36,44],[37,,39,43],[47,51,55,63],[56,,58,62]])}))}function i(t){return Promise.resolve(l.ajax({url:t,dataType:"xml"})).then(function(t){return l(t.documentElement)})}function o(t,e){return c("loading resources"),new Promise(function(n){if(0===t.urls.length)return n();var r=new p.AssetLoader(t.urls);r.on("onComplete",function(){c("resources finished loading"),n()}),e&&r.on("onProgress",e),r.load()})}var a=function(t){return t&&t.__esModule?t:{"default":t}},s=function(t){return t&&t.__esModule?t["default"]:t};e.load=r;var u=s(n(96)),c=u("scintillator:loader"),l=s(n(29)),f=s(n(88)),h=s(n(30)),p=s(n(10)),d=a(n(58)),m=s(n(180)),v=s(n(171));Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},o=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=r(n(10)),u=r(n(24)),c=r(n(25)),l=r(n(64)),f=n(103).parseFrame,h=e.Mask=function(){function t(e){a(this,t),this._frame=e}return o(t,{instantiate:{value:function(t,e){var n=new s.Graphics;return n.beginFill(),n.drawShape(this._frame),n.endFill(),e.object.mask=n,new c({context:t,object:n,parent:e.object})}}}),t}(),p=e.GroupNode=function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return i(e,t),o(e,{compile:{value:function(t,e){this.children=t.compileChildren(e),this.display=l.compile(t,e);var n=f(e.attr("mask")||"");n&&(this.mask=new h(n))}},instantiate:{value:function(t,e){var n=new s.DisplayObjectContainer,r=[this.display];return this.mask&&r.push(this.mask),new c({context:t,object:n,parent:e,concerns:r,children:this.children})}}}),e}(u);e["default"]=p,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=r(n(10)),u=r(n(24)),c=r(n(25)),l=r(n(45)),f=e.IfNode=function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return o(e,t),i(e,{compile:{value:function(t,e){var n=t.compileChildren(e);if(1!==n.length)throw new Error("Expected exactly 1 children, "+n.length+" found");this.child=n[0],this.key=new l(e.attr("key")),this.value=String(e.attr("value"))}},instantiate:{value:function(t,e){var n=new s.DisplayObjectContainer,r=this.key,i=this.value,o=this.child,a=null;return new c({context:t,parent:e,object:n,onData:function(e){String(r(e))===i?(null===a&&(a=o.instantiate(t,n)),a.push(e)):null!==a&&(a.destroy(),a=null)}})}}}),e}(u);e["default"]=f,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";function r(t,e,n){return{instantiate:function(r,i){function o(){var t;console.log("init i"+n);for(var o=0;n>o;o++)t=e.instantiate(r,i.object),t.detach(),c.push(t)}function a(t){var e,n,r,i=new Set(u.keys());t||(t=[]);for(var o=0;o<t.length;o++)n=t[o],e=n.key,u.has(e)?r=u.get(e):(r=s(),u.set(e,r)),r.push(n),i["delete"](e);var a=!0,l=!1,f=void 0;try{for(var h,p=i[Symbol.iterator]();!(a=(h=p.next()).done);a=!0)e=h.value,r=u.get(e),r.detach(),u["delete"](e),c.push(r)}catch(d){l=!0,f=d}finally{try{!a&&p["return"]&&p["return"]()}finally{if(l)throw f}}}function s(){var t=c.pop();return t?t.attachTo(i.object):t=e.instantiate(r,i.object),t}var u=new Map,c=[];return o(),new l({context:r,onData:function(e){a(t(e))}})}}}var i=function(t){return t&&t.__esModule?t["default"]:t},o=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},s=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=i(n(10)),c=i(n(24)),l=i(n(25)),f=i(n(45)),h=e.ObjectNode=function(t){function e(){s(this,e),null!=t&&t.apply(this,arguments)}return a(e,t),o(e,{compile:{value:function(t,e){if(this.children=t.compileChildren(e),1!==this.children.length)throw new Error("Expected exactly 1 children, "+this.children.length+" given");this.pool=+e.attr("pool")||1,this.key=new f(e.attr("key"))}},instantiate:{value:function(t,e){var n=new u.SpriteBatch,i=new r(this.key,this.children[0],this.pool);return new l({context:t,parent:e,object:n,concerns:[i]})}}}),e}(c);e["default"]=h,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=r(n(10)),u=r(n(24)),c=r(n(25)),l=e.SkinRootNode=function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return o(e,t),i(e,{compile:{value:function(t,e){this.children=t.compileChildren(e),this.width=+e.attr("width"),this.height=+e.attr("height")}},instantiate:{value:function(t){var e=new s.Stage(591879);return new c({context:t,object:e,children:this.children})}}}),e}(u);e["default"]=l,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=r(n(10)),u=r(n(24)),c=r(n(25)),l=n(103).parseFrame,f=r(n(64)),h=e.SpriteNode=function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return o(e,t),i(e,{compile:{value:function(t,e){this.url=t.resources.get(e.attr("image")),this.display=f.compile(t,e),this.frame=l(e.attr("frame")||"")}},instantiate:{value:function(t,e){var n=new s.Sprite(this.getTexture());return new c({context:t,object:n,parent:e,concerns:[this.display]})}},getTexture:{value:function(){if(this._texture)return this._texture;var t=s.scaleModes.NEAREST,e=s.BaseTexture.fromImage(this.url,void 0,t),n=new s.Texture(e,this.frame);return this._texture=n,n}}}),e}(u);e["default"]=h,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},s=r(n(10)),u=r(n(24)),c=r(n(25)),l=r(n(64)),f=r(n(45)),h=e.TextNode=function(t){function e(){a(this,e),null!=t&&t.apply(this,arguments)}return o(e,t),i(e,{compile:{value:function(t,e){this.font=e.attr("font"),this.text=e.attr("text"),this.data=new f(e.attr("data")||"0"),this.display=l.compile(t,e),this.align="center"===e.attr("align")?.5:0}},instantiate:{value:function(t,e){var n=this,r=new s.BitmapText(this.text,{font:this.font}),i=new s.DisplayObjectContainer;return i.addChild(r),new c({context:t,parent:e,object:i,concerns:[this.display],bindings:[[this.data,function(t){r.setText(n.text.replace("%s",t)),r.x=r.width*-n.align}]]})}}}),e}(u);e["default"]=h,Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=function(){function t(t,e){for(var n in e){var r=e[n];r.configurable=!0,r.value&&(r.writable=!0)}Object.defineProperties(t,e)}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=r(n(7)),s=e.Resources=function(){function t(){o(this,t),this._map={}}return i(t,{add:{value:function(t,e){this._map[t]=e}},get:{value:function(t){if(!(t in this._map))throw new Error("Not registered: "+t);return this._map[t]}},urls:{get:function(){return a.values(this._map)}}}),t}();e["default"]=s,Object.defineProperty(e,"__esModule",{value:!0})
},,function(t,e,n){function r(t){this._map=t}var i=n(183);r.prototype.get=function(t){return this._map[t.toLowerCase()]},r.prototype.files=function(){return i.uniq(i.values(this._map))},r.prototype.all=function(){return this._map},r.fromBMSChart=function(t){var e={};return t.headers.each(function(t,n){var r=t.match(/^wav(\S\S)$/i);r&&(e[r[1].toLowerCase()]=n)}),new r(e)},t.exports=r},function(t,e,n){var r;(function(t,i){(function(){function o(t,e){if(t!==e){var n=t===t,r=e===e;if(t>e||!n||"undefined"==typeof t&&r)return 1;if(e>t||!r||"undefined"==typeof e&&n)return-1}return 0}function a(t,e,n){for(var r=t.length,i=n?r:-1;n?i--:++i<r;)if(e(t[i],i,t))return i;return-1}function s(t,e,n){if(e!==e)return y(t,n);for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function u(t){return"function"==typeof t||!1}function c(t){return"string"==typeof t?t:null==t?"":t+""}function l(t){return t.charCodeAt(0)}function f(t,e){for(var n=-1,r=t.length;++n<r&&e.indexOf(t.charAt(n))>-1;);return n}function h(t,e){for(var n=t.length;n--&&e.indexOf(t.charAt(n))>-1;);return n}function p(t,e){return o(t.criteria,e.criteria)||t.index-e.index}function d(t,e,n){for(var r=-1,i=t.criteria,a=e.criteria,s=i.length,u=n.length;++r<s;){var c=o(i[r],a[r]);if(c)return r>=u?c:c*(n[r]?1:-1)}return t.index-e.index}function m(t){return We[t]}function v(t){return Ge[t]}function g(t){return"\\"+Ye[t]}function y(t,e,n){for(var r=t.length,i=e+(n?0:-1);n?i--:++i<r;){var o=t[i];if(o!==o)return i}return-1}function b(t){return!!t&&"object"==typeof t}function _(t){return 160>=t&&t>=9&&13>=t||32==t||160==t||5760==t||6158==t||t>=8192&&(8202>=t||8232==t||8233==t||8239==t||8287==t||12288==t||65279==t)}function w(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;)t[n]===e&&(t[n]=H,o[++i]=n);return o}function x(t,e){for(var n,r=-1,i=t.length,o=-1,a=[];++r<i;){var s=t[r],u=e?e(s,r,t):s;r&&n===u||(n=u,a[++o]=s)}return a}function E(t){for(var e=-1,n=t.length;++e<n&&_(t.charCodeAt(e)););return e}function C(t){for(var e=t.length;e--&&_(t.charCodeAt(e)););return e}function T(t){return ze[t]}function S(t){function e(t){if(b(t)&&!au(t)&&!(t instanceof i)){if(t instanceof r)return t;if(ja.call(t,"__chain__")&&ja.call(t,"__wrapped__"))return $r(t)}return new r(t)}function n(){}function r(t,e,n){this.__wrapped__=t,this.__actions__=n||[],this.__chain__=!!e}function i(t){this.__wrapped__=t,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=ss,this.__views__=null}function _(){var t=this.__actions__,e=this.__iteratees__,n=this.__views__,r=new i(this.__wrapped__);return r.__actions__=t?Je(t):null,r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=e?Je(e):null,r.__takeCount__=this.__takeCount__,r.__views__=n?Je(n):null,r}function Z(){if(this.__filtered__){var t=new i(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function re(){var t=this.__wrapped__.value();if(!au(t))return $n(t,this.__actions__);var e=this.__dir__,n=0>e,r=jr(0,t.length,this.__views__),i=r.start,o=r.end,a=o-i,s=n?o:i-1,u=es(a,this.__takeCount__),c=this.__iteratees__,l=c?c.length:0,f=0,h=[];t:for(;a--&&u>f;){s+=e;for(var p=-1,d=t[s];++p<l;){var m=c[p],v=m.iteratee,g=m.type;if(g==V){if(m.done&&(n?s>m.index:s<m.index)&&(m.count=0,m.done=!1),m.index=s,!m.done){var y=m.limit;if(!(m.done=y>-1?m.count++>=y:!v(d)))continue t}}else{var b=v(d);if(g==G)d=b;else if(!b){if(g==W)continue t;break t}}}h[f++]=d}return h}function oe(){this.__data__={}}function We(t){return this.has(t)&&delete this.__data__[t]}function Ge(t){return"__proto__"==t?A:this.__data__[t]}function ze(t){return"__proto__"!=t&&ja.call(this.__data__,t)}function He(t,e){return"__proto__"!=t&&(this.__data__[t]=e),this}function Ye(t){var e=t?t.length:0;for(this.data={hash:Ka(null),set:new Ga};e--;)this.push(t[e])}function $e(t,e){var n=t.data,r="string"==typeof e||ho(e)?n.set.has(e):n.hash[e];return r?0:-1}function Xe(t){var e=this.data;"string"==typeof t||ho(t)?e.set.add(t):e.hash[t]=!0}function Je(t,e){var n=-1,r=t.length;for(e||(e=ma(r));++n<r;)e[n]=t[n];return e}function Ke(t,e){for(var n=-1,r=t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function Qe(t,e){for(var n=t.length;n--&&e(t[n],n,t)!==!1;);return t}function en(t,e){for(var n=-1,r=t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function nn(t,e){for(var n=-1,r=t.length,i=-1,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[++i]=a)}return o}function rn(t,e){for(var n=-1,r=t.length,i=ma(r);++n<r;)i[n]=e(t[n],n,t);return i}function on(t){for(var e=-1,n=t.length,r=as;++e<n;){var i=t[e];i>r&&(r=i)}return r}function an(t){for(var e=-1,n=t.length,r=ss;++e<n;){var i=t[e];r>i&&(r=i)}return r}function sn(t,e,n,r){var i=-1,o=t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function un(t,e,n,r){var i=t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function cn(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function ln(t){for(var e=t.length,n=0;e--;)n+=+t[e]||0;return n}function fn(t,e){return"undefined"==typeof t?e:t}function hn(t,e,n,r){return"undefined"!=typeof t&&ja.call(r,n)?t:e}function pn(t,e,n){var r=yu(e);if(!n)return mn(e,t,r);for(var i=-1,o=r.length;++i<o;){var a=r[i],s=t[a],u=n(s,e[a],a,t,e);(u===u?u===s:s!==s)&&("undefined"!=typeof s||a in t)||(t[a]=u)}return t}function dn(t,e){for(var n=-1,r=t.length,i=Br(r),o=e.length,a=ma(o);++n<o;){var s=e[n];i?(s=parseFloat(s),a[n]=Pr(s,r)?t[s]:A):a[n]=t[s]}return a}function mn(t,e,n){n||(n=e,e={});for(var r=-1,i=n.length;++r<i;){var o=n[r];e[o]=t[o]}return e}function vn(t,e,n){var r=typeof t;return"function"==r?"undefined"==typeof e?t:Kn(t,e,n):null==t?na:"object"==r?Nn(t):"undefined"==typeof e?Ln(t+""):In(t+"",e)}function gn(t,e,n,r,i,o,a){var s;if(n&&(s=i?n(t,r,i):n(t)),"undefined"!=typeof s)return s;if(!ho(t))return t;var u=au(t);if(u){if(s=Rr(t),!e)return Je(t,s)}else{var c=Na.call(t),l=c==Q;if(c!=ee&&c!=Y&&(!l||i))return qe[c]?Ir(t,c,e):i?t:{};if(s=Nr(l?{}:t),!e)return mn(t,s,yu(t))}o||(o=[]),a||(a=[]);for(var f=o.length;f--;)if(o[f]==t)return a[f];return o.push(t),a.push(s),(u?Ke:Sn)(t,function(r,i){s[i]=gn(r,e,n,i,t,o,a)}),s}function yn(t,e,n){if("function"!=typeof t)throw new Ca(z);return za(function(){t.apply(A,n)},e)}function bn(t,e){var n=t?t.length:0,r=[];if(!n)return r;var i=-1,o=Mr(),a=o==s,u=a&&e.length>=200?xs(e):null,c=e.length;u&&(o=$e,a=!1,e=u);t:for(;++i<n;){var l=t[i];if(a&&l===l){for(var f=c;f--;)if(e[f]===l)continue t;r.push(l)}else o(e,l,0)<0&&r.push(l)}return r}function _n(t,e){var n=!0;return gs(t,function(t,r,i){return n=!!e(t,r,i)}),n}function wn(t,e,n,r){var i=t.length;for(n=null==n?0:+n||0,0>n&&(n=-n>i?0:i+n),r="undefined"==typeof r||r>i?i:+r||0,0>r&&(r+=i),i=n>r?0:r>>>0,n>>>=0;i>n;)t[n++]=e;return t}function xn(t,e){var n=[];return gs(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function En(t,e,n,r){var i;return n(t,function(t,n,o){return e(t,n,o)?(i=r?n:t,!1):void 0}),i}function Cn(t,e,n){for(var r=-1,i=t.length,o=-1,a=[];++r<i;){var s=t[r];if(b(s)&&Br(s.length)&&(au(s)||oo(s))){e&&(s=Cn(s,e,n));var u=-1,c=s.length;for(a.length+=c;++u<c;)a[++o]=s[u]}else n||(a[++o]=s)}return a}function Tn(t,e){return bs(t,e,Oo)}function Sn(t,e){return bs(t,e,yu)}function An(t,e){return _s(t,e,yu)}function kn(t,e){for(var n=-1,r=e.length,i=-1,o=[];++n<r;){var a=e[n];uu(t[a])&&(o[++i]=a)}return o}function On(t,e,n,r,i,o){if(t===e)return 0!==t||1/t==1/e;var a=typeof t,s=typeof e;return"function"!=a&&"object"!=a&&"function"!=s&&"object"!=s||null==t||null==e?t!==t&&e!==e:Mn(t,e,On,n,r,i,o)}function Mn(t,e,n,r,i,o,a){var s=au(t),u=au(e),c=$,l=$;s||(c=Na.call(t),c==Y?c=ee:c!=ee&&(s=wo(t))),u||(l=Na.call(e),l==Y?l=ee:l!=ee&&(u=wo(e)));var f=c==ee||i&&c==Q,h=l==ee||i&&l==Q,p=c==l;if(p&&!s&&!f)return Sr(t,e,c);if(i){if(!(p||f&&h))return!1}else{var d=f&&ja.call(t,"__wrapped__"),m=h&&ja.call(e,"__wrapped__");if(d||m)return n(d?t.value():t,m?e.value():e,r,i,o,a);if(!p)return!1}o||(o=[]),a||(a=[]);for(var v=o.length;v--;)if(o[v]==t)return a[v]==e;o.push(t),a.push(e);var g=(s?Tr:Ar)(t,e,n,r,i,o,a);return o.pop(),a.pop(),g}function jn(t,e,n,r,i){for(var o=-1,a=e.length,s=!i;++o<a;)if(s&&r[o]?n[o]!==t[e[o]]:!(e[o]in t))return!1;for(o=-1;++o<a;){var u=e[o],c=t[u],l=n[o];if(s&&r[o])var f="undefined"!=typeof c||u in t;else f=i?i(c,l,u):A,"undefined"==typeof f&&(f=On(l,c,i,!0));if(!f)return!1}return!0}function Rn(t,e){var n=[];return gs(t,function(t,r,i){n.push(e(t,r,i))}),n}function Nn(t){var e=yu(t),n=e.length;if(!n)return ea(!0);if(1==n){var r=e[0],i=t[r];if(Fr(i))return function(t){return null!=t&&t[r]===i&&("undefined"!=typeof i||r in Yr(t))}}for(var o=ma(n),a=ma(n);n--;)i=t[e[n]],o[n]=i,a[n]=Fr(i);return function(t){return null!=t&&jn(Yr(t),e,o,a)}}function In(t,e){return Fr(e)?function(n){return null!=n&&n[t]===e&&("undefined"!=typeof e||t in Yr(n))}:function(n){return null!=n&&On(e,n[t],null,!0)}}function Pn(t,e,n,r,i){if(!ho(t))return t;var o=Br(e.length)&&(au(e)||wo(e));return(o?Ke:Sn)(e,function(e,a,s){if(b(e))return r||(r=[]),i||(i=[]),Dn(t,s,a,Pn,n,r,i);var u=t[a],c=n?n(u,e,a,t,s):A,l="undefined"==typeof c;l&&(c=e),!o&&"undefined"==typeof c||!l&&(c===c?c===u:u!==u)||(t[a]=c)}),t}function Dn(t,e,n,r,i,o,a){for(var s=o.length,u=e[n];s--;)if(o[s]==u)return void(t[n]=a[s]);var c=t[n],l=i?i(c,u,n,t,e):A,f="undefined"==typeof l;f&&(l=u,Br(u.length)&&(au(u)||wo(u))?l=au(c)?c:c&&c.length?Je(c):[]:cu(u)||oo(u)?l=oo(c)?Co(c):cu(c)?c:{}:f=!1),o.push(u),a.push(l),f?t[n]=r(l,u,i,o,a):(l===l?l!==c:c===c)&&(t[n]=l)}function Ln(t){return function(e){return null==e?A:e[t]}}function Bn(t,e){return t+Ua(os()*(e-t+1))}function Fn(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function Un(t,e,n){var r=-1,i=t.length;e=null==e?0:+e||0,0>e&&(e=-e>i?0:i+e),n="undefined"==typeof n||n>i?i:+n||0,0>n&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=ma(i);++r<i;)o[r]=t[r+e];return o}function qn(t,e){var n;return gs(t,function(t,r,i){return n=e(t,r,i),!n}),!!n}function Vn(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function Wn(t,e,n){var r=-1,i=t.length,o=Br(i)?ma(i):[];return gs(t,function(t){for(var n=e.length,i=ma(n);n--;)i[n]=null==t?A:t[e[n]];o[++r]={criteria:i,index:r,value:t}}),Vn(o,function(t,e){return d(t,e,n)})}function Gn(t,e){var n=0;return gs(t,function(t,r,i){n+=+e(t,r,i)||0}),n}function zn(t,e){var n=-1,r=Mr(),i=t.length,o=r==s,a=o&&i>=200,u=a?xs():null,c=[];u?(r=$e,o=!1):(a=!1,u=e?[]:c);t:for(;++n<i;){var l=t[n],f=e?e(l,n,t):l;if(o&&l===l){for(var h=u.length;h--;)if(u[h]===f)continue t;e&&u.push(f),c.push(l)}else r(u,f,0)<0&&((e||a)&&u.push(f),c.push(l))}return c}function Hn(t,e){for(var n=-1,r=e.length,i=ma(r);++n<r;)i[n]=t[e[n]];return i}function Yn(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?Un(t,r?0:o,r?o+1:i):Un(t,r?o+1:0,r?i:o)}function $n(t,e){var n=t;n instanceof i&&(n=n.value());for(var r=-1,o=e.length;++r<o;){var a=[n],s=e[r];Va.apply(a,s.args),n=s.func.apply(s.thisArg,a)}return n}function Xn(t,e,n){var r=0,i=t?t.length:r;if("number"==typeof e&&e===e&&ls>=i){for(;i>r;){var o=r+i>>>1,a=t[o];(n?e>=a:e>a)?r=o+1:i=o}return i}return Jn(t,e,na,n)}function Jn(t,e,n,r){e=n(e);for(var i=0,o=t?t.length:0,a=e!==e,s="undefined"==typeof e;o>i;){var u=Ua((i+o)/2),c=n(t[u]),l=c===c;if(a)var f=l||r;else f=s?l&&(r||"undefined"!=typeof c):r?e>=c:e>c;f?i=u+1:o=u}return es(o,cs)}function Kn(t,e,n){if("function"!=typeof t)return na;if("undefined"==typeof e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)};case 5:return function(n,r,i,o,a){return t.call(e,n,r,i,o,a)}}return function(){return t.apply(e,arguments)}}function Qn(t){return La.call(t,0)}function Zn(t,e,n){for(var r=n.length,i=-1,o=ts(t.length-r,0),a=-1,s=e.length,u=ma(o+s);++a<s;)u[a]=e[a];for(;++i<r;)u[n[i]]=t[i];for(;o--;)u[a++]=t[i++];return u}function tr(t,e,n){for(var r=-1,i=n.length,o=-1,a=ts(t.length-i,0),s=-1,u=e.length,c=ma(a+u);++o<a;)c[o]=t[o];for(var l=o;++s<u;)c[l+s]=e[s];for(;++r<i;)c[l+n[r]]=t[o++];return c}function er(t,e){return function(n,r,i){var o=e?e():{};if(r=Or(r,i,3),au(n))for(var a=-1,s=n.length;++a<s;){var u=n[a];t(o,u,r(u,a,n),n)}else gs(n,function(e,n,i){t(o,e,r(e,n,i),i)});return o}}function nr(t){return function(){var e=arguments,n=e.length,r=e[0];if(2>n||null==r)return r;var i=e[n-2],o=e[n-1],a=e[3];n>3&&"function"==typeof i?(i=Kn(i,o,5),n-=2):(i=n>2&&"function"==typeof o?o:null,n-=i?1:0),a&&Dr(e[1],e[2],a)&&(i=3==n?null:i,n=2);for(var s=0;++s<n;){var u=e[s];u&&t(r,u,i)}return r}}function rr(t,e){return function(n,r){var i=n?n.length:0;if(!Br(i))return t(n,r);for(var o=e?i:-1,a=Yr(n);(e?o--:++o<i)&&r(a[o],o,a)!==!1;);return n}}function ir(t){return function(e,n,r){for(var i=Yr(e),o=r(e),a=o.length,s=t?a:-1;t?s--:++s<a;){var u=o[s];if(n(i[u],u,i)===!1)break}return e}}function or(t,e){function n(){var i=this&&this!==Ze&&this instanceof n?r:t;return i.apply(e,arguments)}var r=sr(t);return n}function ar(t){return function(e){for(var n=-1,r=Zo(Fo(e)),i=r.length,o="";++n<i;)o=t(o,r[n],n);return o}}function sr(t){return function(){var e=vs(t.prototype),n=t.apply(e,arguments);return ho(n)?n:e}}function ur(t){function e(n,r,i){i&&Dr(n,r,i)&&(r=null);var o=Cr(n,t,null,null,null,null,null,r);return o.placeholder=e.placeholder,o}return e}function cr(t,e){return function(n,r,i){i&&Dr(n,r,i)&&(r=null);var o=Or(),a=null==r;if(o===vn&&a||(a=!1,r=o(r,i,3)),a){var s=au(n);if(s||!_o(n))return t(s?n:Hr(n));r=l}return kr(n,r,e)}}function lr(t,e){return function(n,r,i){if(r=Or(r,i,3),au(n)){var o=a(n,r,e);return o>-1?n[o]:A}return En(n,r,t)}}function fr(t){return function(e,n,r){return e&&e.length?(n=Or(n,r,3),a(e,n,t)):-1}}function hr(t){return function(e,n,r){return n=Or(n,r,3),En(e,n,t,!0)}}function pr(t){return function(){var e=arguments.length;if(!e)return function(){return arguments[0]};for(var n,i=t?e:-1,o=0,a=ma(e);t?i--:++i<e;){var s=a[o++]=arguments[i];if("function"!=typeof s)throw new Ca(z);var u=n?"":Cs(s);n="wrapper"==u?new r([]):n}for(i=n?-1:e;++i<e;){s=a[i],u=Cs(s);var c="wrapper"==u?Es(s):null;n=c&&Lr(c[0])?n[Cs(c[0])].apply(n,c[3]):1==s.length&&Lr(s)?n[u]():n.thru(s)}return function(){var t=arguments;if(n&&1==t.length&&au(t[0]))return n.plant(t[0]).value();for(var r=0,i=a[r].apply(this,t);++r<e;)i=a[r].call(this,i);return i}}}function dr(t,e){return function(n,r,i){return"function"==typeof r&&"undefined"==typeof i&&au(n)?t(n,r):e(n,Kn(r,i,3))}}function mr(t){return function(e,n,r){return("function"!=typeof n||"undefined"!=typeof r)&&(n=Kn(n,r,3)),t(e,n,Oo)}}function vr(t){return function(e,n,r){return("function"!=typeof n||"undefined"!=typeof r)&&(n=Kn(n,r,3)),t(e,n)}}function gr(t){return function(e,n,r){return e=c(e),e&&(t?e:"")+wr(e,n,r)+(t?"":e)}}function yr(t){var e=Zi(function(n,r){var i=w(r,e.placeholder);return Cr(n,t,null,r,i)});return e}function br(t,e){return function(n,r,i,o){var a=arguments.length<3;return"function"==typeof r&&"undefined"==typeof o&&au(n)?t(n,r,i,a):Fn(n,Or(r,o,4),i,a,e)}}function _r(t,e,n,r,i,o,a,s,u,c){function l(){for(var b=arguments.length,_=b,x=ma(b);_--;)x[_]=arguments[_];if(r&&(x=Zn(x,r,i)),o&&(x=tr(x,o,a)),d||v){var E=l.placeholder,C=w(x,E);if(b-=C.length,c>b){var T=s?Je(s):null,S=ts(c-b,0),k=d?C:null,j=d?null:C,R=d?x:null,N=d?null:x;e|=d?I:P,e&=~(d?P:I),m||(e&=~(O|M));var D=[t,e,n,R,k,N,j,T,u,S],L=_r.apply(A,D);return Lr(t)&&Ts(L,D),L.placeholder=E,L}}var B=h?n:this;p&&(t=B[y]),s&&(x=Wr(x,s)),f&&u<x.length&&(x.length=u);var F=this&&this!==Ze&&this instanceof l?g||sr(t):t;return F.apply(B,x)}var f=e&D,h=e&O,p=e&M,d=e&R,m=e&j,v=e&N,g=!p&&sr(t),y=t;return l}function wr(t,e,n){var r=t.length;if(e=+e,r>=e||!Qa(e))return"";var i=e-r;return n=null==n?" ":n+"",zo(n,Ba(i/n.length)).slice(0,i)}function xr(t,e,n,r){function i(){for(var e=-1,s=arguments.length,u=-1,c=r.length,l=ma(s+c);++u<c;)l[u]=r[u];for(;s--;)l[u++]=arguments[++e];var f=this&&this!==Ze&&this instanceof i?a:t;return f.apply(o?n:this,l)}var o=e&O,a=sr(t);return i}function Er(t){return function(e,n,r,i){var o=Or(r);return o===vn&&null==r?Xn(e,n,t):Jn(e,n,o(r,i,1),t)}}function Cr(t,e,n,r,i,o,a,s){var u=e&M;if(!u&&"function"!=typeof t)throw new Ca(z);var c=r?r.length:0;if(c||(e&=~(I|P),r=i=null),c-=i?i.length:0,e&P){var l=r,f=i;r=i=null}var h=u?null:Es(t),p=[t,e,n,r,i,l,f,o,a,s];if(h&&(Ur(p,h),e=p[1],s=p[9]),p[9]=null==s?u?0:t.length:ts(s-c,0)||0,e==O)var d=or(p[0],p[2]);else d=e!=I&&e!=(O|I)||p[4].length?_r.apply(A,p):xr.apply(A,p);var m=h?ws:Ts;return m(d,p)}function Tr(t,e,n,r,i,o,a){var s=-1,u=t.length,c=e.length,l=!0;if(u!=c&&!(i&&c>u))return!1;for(;l&&++s<u;){var f=t[s],h=e[s];if(l=A,r&&(l=i?r(h,f,s):r(f,h,s)),"undefined"==typeof l)if(i)for(var p=c;p--&&(h=e[p],!(l=f&&f===h||n(f,h,r,i,o,a))););else l=f&&f===h||n(f,h,r,i,o,a)}return!!l}function Sr(t,e,n){switch(n){case X:case J:return+t==+e;case K:return t.name==e.name&&t.message==e.message;case te:return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case ne:case ie:return t==e+""}return!1}function Ar(t,e,n,r,i,o,a){var s=yu(t),u=s.length,c=yu(e),l=c.length;if(u!=l&&!i)return!1;for(var f=i,h=-1;++h<u;){var p=s[h],d=i?p in e:ja.call(e,p);if(d){var m=t[p],v=e[p];d=A,r&&(d=i?r(v,m,p):r(m,v,p)),"undefined"==typeof d&&(d=m&&m===v||n(m,v,r,i,o,a))}if(!d)return!1;f||(f="constructor"==p)}if(!f){var g=t.constructor,y=e.constructor;if(g!=y&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y))return!1}return!0}function kr(t,e,n){var r=n?ss:as,i=r,o=i;return gs(t,function(t,a,s){var u=e(t,a,s);((n?i>u:u>i)||u===r&&u===o)&&(i=u,o=t)}),o}function Or(t,n,r){var i=e.callback||ta;return i=i===ta?vn:i,r?i(t,n,r):i}function Mr(t,n,r){var i=e.indexOf||oi;return i=i===oi?s:i,t?i(t,n,r):i}function jr(t,e,n){for(var r=-1,i=n?n.length:0;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=es(e,t+a);break;case"takeRight":t=ts(t,e-a)}}return{start:t,end:e}}function Rr(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&ja.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Nr(t){var e=t.constructor;return"function"==typeof e&&e instanceof e||(e=wa),new e}function Ir(t,e,n){var r=t.constructor;switch(e){case ae:return Qn(t);case X:case J:return new r(+t);case se:case ue:case ce:case le:case fe:case he:case pe:case de:case me:var i=t.buffer;return new r(n?Qn(i):i,t.byteOffset,t.length);case te:case ie:return new r(t);case ne:var o=new r(t.source,ke.exec(t));o.lastIndex=t.lastIndex}return o}function Pr(t,e){return t=+t,e=null==e?hs:e,t>-1&&t%1==0&&e>t}function Dr(t,e,n){if(!ho(n))return!1;var r=typeof e;if("number"==r)var i=n.length,o=Br(i)&&Pr(e,i);else o="string"==r&&e in n;if(o){var a=n[e];return t===t?t===a:a!==a}return!1}function Lr(t){var n=Cs(t);return!!n&&t===e[n]&&n in i.prototype}function Br(t){return"number"==typeof t&&t>-1&&t%1==0&&hs>=t}function Fr(t){return t===t&&(0===t?1/t>0:!ho(t))}function Ur(t,e){var n=t[1],r=e[1],i=n|r,o=D>i,a=r==D&&n==R||r==D&&n==L&&t[7].length<=e[8]||r==(D|L)&&n==R;if(!o&&!a)return t;r&O&&(t[2]=e[2],i|=n&O?0:j);var s=e[3];if(s){var u=t[3];t[3]=u?Zn(u,s,e[4]):Je(s),t[4]=u?w(t[3],H):Je(e[4])}return s=e[5],s&&(u=t[5],t[5]=u?tr(u,s,e[6]):Je(s),t[6]=u?w(t[5],H):Je(e[6])),s=e[7],s&&(t[7]=Je(s)),r&D&&(t[8]=null==t[8]?e[8]:es(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function qr(t,e){t=Yr(t);for(var n=-1,r=e.length,i={};++n<r;){var o=e[n];o in t&&(i[o]=t[o])}return i}function Vr(t,e){var n={};return Tn(t,function(t,r,i){e(t,r,i)&&(n[r]=t)}),n}function Wr(t,e){for(var n=t.length,r=es(e.length,n),i=Je(t);r--;){var o=e[r];t[r]=Pr(o,n)?i[o]:A}return t}function Gr(t){{var n;e.support}if(!b(t)||Na.call(t)!=ee||!ja.call(t,"constructor")&&(n=t.constructor,"function"==typeof n&&!(n instanceof n)))return!1;var r;return Tn(t,function(t,e){r=e}),"undefined"==typeof r||ja.call(t,r)}function zr(t){for(var n=Oo(t),r=n.length,i=r&&t.length,o=e.support,a=i&&Br(i)&&(au(t)||o.nonEnumArgs&&oo(t)),s=-1,u=[];++s<r;){var c=n[s];(a&&Pr(c,i)||ja.call(t,c))&&u.push(c)}return u}function Hr(t){return null==t?[]:Br(t.length)?ho(t)?t:wa(t):Io(t)}function Yr(t){return ho(t)?t:wa(t)}function $r(t){return t instanceof i?t.clone():new r(t.__wrapped__,t.__chain__,Je(t.__actions__))}function Xr(t,e,n){e=(n?Dr(t,e,n):null==e)?1:ts(+e||1,1);for(var r=0,i=t?t.length:0,o=-1,a=ma(Ba(i/e));i>r;)a[++o]=Un(t,r,r+=e);return a}function Jr(t){for(var e=-1,n=t?t.length:0,r=-1,i=[];++e<n;){var o=t[e];o&&(i[++r]=o)}return i}function Kr(t,e,n){var r=t?t.length:0;return r?((n?Dr(t,e,n):null==e)&&(e=1),Un(t,0>e?0:e)):[]}function Qr(t,e,n){var r=t?t.length:0;return r?((n?Dr(t,e,n):null==e)&&(e=1),e=r-(+e||0),Un(t,0,0>e?0:e)):[]}function Zr(t,e,n){return t&&t.length?Yn(t,Or(e,n,3),!0,!0):[]}function ti(t,e,n){return t&&t.length?Yn(t,Or(e,n,3),!0):[]}function ei(t,e,n,r){var i=t?t.length:0;return i?(n&&"number"!=typeof n&&Dr(t,e,n)&&(n=0,r=i),wn(t,e,n,r)):[]}function ni(t){return t?t[0]:A}function ri(t,e,n){var r=t?t.length:0;return n&&Dr(t,e,n)&&(e=!1),r?Cn(t,e):[]}function ii(t){var e=t?t.length:0;return e?Cn(t,!0):[]}function oi(t,e,n){var r=t?t.length:0;if(!r)return-1;if("number"==typeof n)n=0>n?ts(r+n,0):n;else if(n){var i=Xn(t,e),o=t[i];return(e===e?e===o:o!==o)?i:-1}return s(t,e,n||0)}function ai(t){return Qr(t,1)}function si(){for(var t=[],e=-1,n=arguments.length,r=[],i=Mr(),o=i==s;++e<n;){var a=arguments[e];(au(a)||oo(a))&&(t.push(a),r.push(o&&a.length>=120?xs(e&&a):null))}n=t.length;var u=t[0],c=-1,l=u?u.length:0,f=[],h=r[0];t:for(;++c<l;)if(a=u[c],(h?$e(h,a):i(f,a,0))<0){for(e=n;--e;){var p=r[e];if((p?$e(p,a):i(t[e],a,0))<0)continue t}h&&h.push(a),f.push(a)}return f}function ui(t){var e=t?t.length:0;return e?t[e-1]:A}function ci(t,e,n){var r=t?t.length:0;if(!r)return-1;var i=r;if("number"==typeof n)i=(0>n?ts(r+n,0):es(n||0,r-1))+1;else if(n){i=Xn(t,e,!0)-1;var o=t[i];return(e===e?e===o:o!==o)?i:-1}if(e!==e)return y(t,i,!0);for(;i--;)if(t[i]===e)return i;return-1}function li(){var t=arguments,e=t[0];if(!e||!e.length)return e;for(var n=0,r=Mr(),i=t.length;++n<i;)for(var o=0,a=t[n];(o=r(e,a,o))>-1;)Ha.call(e,o,1);return e}function fi(t,e,n){var r=-1,i=t?t.length:0,o=[];for(e=Or(e,n,3);++r<i;){var a=t[r];e(a,r,t)&&(o.push(a),Ha.call(t,r--,1),i--)}return o}function hi(t){return Kr(t,1)}function pi(t,e,n){var r=t?t.length:0;return r?(n&&"number"!=typeof n&&Dr(t,e,n)&&(e=0,n=r),Un(t,e,n)):[]}function di(t,e,n){var r=t?t.length:0;return r?((n?Dr(t,e,n):null==e)&&(e=1),Un(t,0,0>e?0:e)):[]}function mi(t,e,n){var r=t?t.length:0;return r?((n?Dr(t,e,n):null==e)&&(e=1),e=r-(+e||0),Un(t,0>e?0:e)):[]}function vi(t,e,n){return t&&t.length?Yn(t,Or(e,n,3),!1,!0):[]}function gi(t,e,n){return t&&t.length?Yn(t,Or(e,n,3)):[]}function yi(t,e,n,r){var i=t?t.length:0;if(!i)return[];null!=e&&"boolean"!=typeof e&&(r=n,n=Dr(t,e,r)?null:e,e=!1);var o=Or();return(o!==vn||null!=n)&&(n=o(n,r,3)),e&&Mr()==s?x(t,n):zn(t,n)}function bi(t){for(var e=-1,n=(t&&t.length&&on(rn(t,Ma)))>>>0,r=ma(n);++e<n;)r[e]=rn(t,Ln(e));return r}function _i(){for(var t=-1,e=arguments.length;++t<e;){var n=arguments[t];if(au(n)||oo(n))var r=r?bn(r,n).concat(bn(n,r)):n}return r?zn(r):[]}function wi(t,e){var n=-1,r=t?t.length:0,i={};for(!r||e||au(t[0])||(e=[]);++n<r;){var o=t[n];e?i[o]=e[n]:o&&(i[o[0]]=o[1])}return i}function xi(t){var n=e(t);return n.__chain__=!0,n}function Ei(t,e,n){return e.call(n,t),t}function Ci(t,e,n){return e.call(n,t)}function Ti(){return xi(this)}function Si(){return new r(this.value(),this.__chain__)}function Ai(t){for(var e,r=this;r instanceof n;){var i=$r(r);e?o.__wrapped__=i:e=i;var o=i;r=r.__wrapped__}return o.__wrapped__=t,e}function ki(){var t=this.__wrapped__;return t instanceof i?(this.__actions__.length&&(t=new i(this)),new r(t.reverse(),this.__chain__)):this.thru(function(t){return t.reverse()})}function Oi(){return this.value()+""}function Mi(){return $n(this.__wrapped__,this.__actions__)}function ji(t,e,n){var r=au(t)?en:_n;return n&&Dr(t,e,n)&&(e=null),("function"!=typeof e||"undefined"!=typeof n)&&(e=Or(e,n,3)),r(t,e)}function Ri(t,e,n){var r=au(t)?nn:xn;return e=Or(e,n,3),r(t,e)}function Ni(t,e){return Ls(t,Nn(e))}function Ii(t,e,n,r){var i=t?t.length:0;return Br(i)||(t=Io(t),i=t.length),i?(n="number"!=typeof n||r&&Dr(e,n,r)?0:0>n?ts(i+n,0):n||0,"string"==typeof t||!au(t)&&_o(t)?i>n&&t.indexOf(e,n)>-1:Mr(t,e,n)>-1):!1}function Pi(t,e,n){var r=au(t)?rn:Rn;return e=Or(e,n,3),r(t,e)}function Di(t,e){return Pi(t,Ln(e))}function Li(t,e,n){var r=au(t)?nn:xn;return e=Or(e,n,3),r(t,function(t,n,r){return!e(t,n,r)})}function Bi(t,e,n){if(n?Dr(t,e,n):null==e){t=Hr(t);var r=t.length;return r>0?t[Bn(0,r-1)]:A}var i=Fi(t);return i.length=es(0>e?0:+e||0,i.length),i}function Fi(t){t=Hr(t);for(var e=-1,n=t.length,r=ma(n);++e<n;){var i=Bn(0,e);e!=i&&(r[e]=r[i]),r[i]=t[e]}return r}function Ui(t){var e=t?t.length:0;return Br(e)?e:yu(t).length}function qi(t,e,n){var r=au(t)?cn:qn;return n&&Dr(t,e,n)&&(e=null),("function"!=typeof e||"undefined"!=typeof n)&&(e=Or(e,n,3)),r(t,e)}function Vi(t,e,n){if(null==t)return[];var r=-1,i=t.length,o=Br(i)?ma(i):[];return n&&Dr(t,e,n)&&(e=null),e=Or(e,n,3),gs(t,function(t,n,i){o[++r]={criteria:e(t,n,i),index:r,value:t}}),Vn(o,p)}function Wi(){var t=arguments,e=t[0],n=t[3],r=0,i=t.length-1;if(null==e)return[];for(var o=ma(i);i>r;)o[r]=t[++r];return n&&Dr(t[1],t[2],n)&&(o=t[1]),Wn(e,Cn(o),[])}function Gi(t,e,n,r){return null==t?[]:(r&&Dr(e,n,r)&&(n=null),au(e)||(e=null==e?[]:[e]),au(n)||(n=null==n?[]:[n]),Wn(t,e,n))}function zi(t,e){return Ri(t,Nn(e))}function Hi(t,e){if("function"!=typeof e){if("function"!=typeof t)throw new Ca(z);var n=t;t=e,e=n}return t=Qa(t=+t)?t:0,function(){return--t<1?e.apply(this,arguments):void 0}}function Yi(t,e,n){return n&&Dr(t,e,n)&&(e=null),e=t&&null==e?t.length:ts(+e||0,0),Cr(t,D,null,null,null,null,e)}function $i(t,e){var n;if("function"!=typeof e){if("function"!=typeof t)throw new Ca(z);var r=t;t=e,e=r}return function(){return--t>0?n=e.apply(this,arguments):e=null,n}}function Xi(t,e,n){function r(){h&&Fa(h),u&&Fa(u),u=h=p=A}function i(){var n=e-(Ys()-l);if(0>=n||n>e){u&&Fa(u);var r=p;u=h=p=A,r&&(d=Ys(),c=t.apply(f,s),h||u||(s=f=null))}else h=za(i,n)}function o(){h&&Fa(h),u=h=p=A,(v||m!==e)&&(d=Ys(),c=t.apply(f,s),h||u||(s=f=null))}function a(){if(s=arguments,l=Ys(),f=this,p=v&&(h||!g),m===!1)var n=g&&!h;else{u||g||(d=l);var r=m-(l-d),a=0>=r||r>m;a?(u&&(u=Fa(u)),d=l,c=t.apply(f,s)):u||(u=za(o,r))}return a&&h?h=Fa(h):h||e===m||(h=za(i,e)),n&&(a=!0,c=t.apply(f,s)),!a||h||u||(s=f=null),c}var s,u,c,l,f,h,p,d=0,m=!1,v=!0;if("function"!=typeof t)throw new Ca(z);if(e=0>e?0:+e||0,n===!0){var g=!0;v=!1}else ho(n)&&(g=n.leading,m="maxWait"in n&&ts(+n.maxWait||0,e),v="trailing"in n?n.trailing:v);return a.cancel=r,a}function Ji(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new Ca(z);var n=function(){var r=arguments,i=n.cache,o=e?e.apply(this,r):r[0];if(i.has(o))return i.get(o);var a=t.apply(this,r);return i.set(o,a),a};return n.cache=new Ji.Cache,n}function Ki(t){if("function"!=typeof t)throw new Ca(z);return function(){return!t.apply(this,arguments)}}function Qi(t){return $i(t,2)}function Zi(t,e){if("function"!=typeof t)throw new Ca(z);return e=ts("undefined"==typeof e?t.length-1:+e||0,0),function(){for(var n=arguments,r=-1,i=ts(n.length-e,0),o=ma(i);++r<i;)o[r]=n[e+r];switch(e){case 0:return t.call(this,o);case 1:return t.call(this,n[0],o);case 2:return t.call(this,n[0],n[1],o)}var a=ma(e+1);for(r=-1;++r<e;)a[r]=n[r];return a[e]=o,t.apply(this,a)}}function to(t){if("function"!=typeof t)throw new Ca(z);return function(e){return t.apply(this,e)}}function eo(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new Ca(z);return n===!1?r=!1:ho(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ve.leading=r,Ve.maxWait=+e,Ve.trailing=i,Xi(t,e,Ve)}function no(t,e){return e=null==e?na:e,Cr(e,I,null,[t],[])}function ro(t,e,n,r){return e&&"boolean"!=typeof e&&Dr(t,e,n)?e=!1:"function"==typeof e&&(r=n,n=e,e=!1),n="function"==typeof n&&Kn(n,r,1),gn(t,e,n)}function io(t,e,n){return e="function"==typeof e&&Kn(e,n,1),gn(t,!0,e)}function oo(t){var e=b(t)?t.length:A;return Br(e)&&Na.call(t)==Y}function ao(t){return t===!0||t===!1||b(t)&&Na.call(t)==X}function so(t){return b(t)&&Na.call(t)==J}function uo(t){return!!t&&1===t.nodeType&&b(t)&&Na.call(t).indexOf("Element")>-1}function co(t){if(null==t)return!0;var e=t.length;return Br(e)&&(au(t)||_o(t)||oo(t)||b(t)&&uu(t.splice))?!e:!yu(t).length}function lo(t,e,n,r){if(n="function"==typeof n&&Kn(n,r,3),!n&&Fr(t)&&Fr(e))return t===e;var i=n?n(t,e):A;return"undefined"==typeof i?On(t,e,n):!!i}function fo(t){return b(t)&&"string"==typeof t.message&&Na.call(t)==K}function ho(t){var e=typeof t;return"function"==e||!!t&&"object"==e}function po(t,e,n,r){var i=yu(e),o=i.length;if(!o)return!0;if(null==t)return!1;if(n="function"==typeof n&&Kn(n,r,3),!n&&1==o){var a=i[0],s=e[a];if(Fr(s))return s===t[a]&&("undefined"!=typeof s||a in Yr(t))}for(var u=ma(o),c=ma(o);o--;)s=u[o]=e[i[o]],c[o]=Fr(s);return jn(Yr(t),i,u,c,n)}function mo(t){return yo(t)&&t!=+t}function vo(t){return null==t?!1:Na.call(t)==Q?Pa.test(Oa.call(t)):b(t)&&Me.test(t)}function go(t){return null===t}function yo(t){return"number"==typeof t||b(t)&&Na.call(t)==te}function bo(t){return b(t)&&Na.call(t)==ne||!1}function _o(t){return"string"==typeof t||b(t)&&Na.call(t)==ie}function wo(t){return b(t)&&Br(t.length)&&!!Ue[Na.call(t)]}function xo(t){return"undefined"==typeof t}function Eo(t){var e=t?t.length:0;return Br(e)?e?Je(t):[]:Io(t)}function Co(t){return mn(t,Oo(t))}function To(t,e,n){var r=vs(t);return n&&Dr(t,e,n)&&(e=null),e?mn(e,r,yu(e)):r}function So(t){return kn(t,Oo(t))}function Ao(t,e){return t?ja.call(t,e):!1}function ko(t,e,n){n&&Dr(t,e,n)&&(e=null);for(var r=-1,i=yu(t),o=i.length,a={};++r<o;){var s=i[r],u=t[s];e?ja.call(a,u)?a[u].push(s):a[u]=[s]:a[u]=s}return a}function Oo(t){if(null==t)return[];ho(t)||(t=wa(t));var e=t.length;e=e&&Br(e)&&(au(t)||ms.nonEnumArgs&&oo(t))&&e||0;for(var n=t.constructor,r=-1,i="function"==typeof n&&n.prototype===t,o=ma(e),a=e>0;++r<e;)o[r]=r+"";for(var s in t)a&&Pr(s,e)||"constructor"==s&&(i||!ja.call(t,s))||o.push(s);return o}function Mo(t,e,n){var r={};return e=Or(e,n,3),Sn(t,function(t,n,i){r[n]=e(t,n,i)}),r}function jo(t){for(var e=-1,n=yu(t),r=n.length,i=ma(r);++e<r;){var o=n[e];i[e]=[o,t[o]]}return i}function Ro(t,e,n){var r=null==t?A:t[e];return"undefined"==typeof r&&(r=n),uu(r)?r.call(t):r}function No(t,e,n,r){var i=au(t)||wo(t);if(e=Or(e,r,4),null==n)if(i||ho(t)){var o=t.constructor;n=i?au(t)?new o:[]:vs(uu(o)&&o.prototype)}else n={};return(i?Ke:Sn)(t,function(t,r,i){return e(n,t,r,i)}),n}function Io(t){return Hn(t,yu(t))}function Po(t){return Hn(t,Oo(t))}function Do(t,e,n){return e=+e||0,"undefined"==typeof n?(n=e,e=0):n=+n||0,t>=e&&n>t}function Lo(t,e,n){n&&Dr(t,e,n)&&(e=n=null);var r=null==t,i=null==e;if(null==n&&(i&&"boolean"==typeof t?(n=t,t=1):"boolean"==typeof e&&(n=e,i=!0)),r&&i&&(e=1,i=!1),t=+t||0,i?(e=t,t=0):e=+e||0,n||t%1||e%1){var o=os();return es(t+o*(e-t+parseFloat("1e-"+((o+"").length-1))),e)}return Bn(t,e)}function Bo(t){return t=c(t),t&&t.charAt(0).toUpperCase()+t.slice(1)}function Fo(t){return t=c(t),t&&t.replace(je,m).replace(Se,"")}function Uo(t,e,n){t=c(t),e+="";var r=t.length;return n="undefined"==typeof n?r:es(0>n?0:+n||0,r),n-=e.length,n>=0&&t.indexOf(e,n)==n}function qo(t){return t=c(t),t&&xe.test(t)?t.replace(_e,v):t}function Vo(t){return t=c(t),t&&Ie.test(t)?t.replace(Ne,"\\$&"):t}function Wo(t,e,n){t=c(t),e=+e;var r=t.length;if(r>=e||!Qa(e))return t;var i=(e-r)/2,o=Ua(i),a=Ba(i);return n=wr("",a,n),n.slice(0,o)+t+n}function Go(t,e,n){return n&&Dr(t,e,n)&&(e=0),is(t,e)}function zo(t,e){var n="";if(t=c(t),e=+e,1>e||!t||!Qa(e))return n;do e%2&&(n+=t),e=Ua(e/2),t+=t;while(e);return n}function Ho(t,e,n){return t=c(t),n=null==n?0:es(0>n?0:+n||0,t.length),t.lastIndexOf(e,n)==n}function Yo(t,n,r){var i=e.templateSettings;r&&Dr(t,n,r)&&(n=r=null),t=c(t),n=pn(pn({},r||n),i,hn);var o,a,s=pn(pn({},n.imports),i.imports,hn),u=yu(s),l=Hn(s,u),f=0,h=n.interpolate||Re,p="__p += '",d=xa((n.escape||Re).source+"|"+h.source+"|"+(h===Te?Ae:Re).source+"|"+(n.evaluate||Re).source+"|$","g"),m="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++Fe+"]")+"\n";
t.replace(d,function(e,n,r,i,s,u){return r||(r=i),p+=t.slice(f,u).replace(Pe,g),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),r&&(p+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),f=u+e.length,e}),p+="';\n";var v=n.variable;v||(p="with (obj) {\n"+p+"\n}\n"),p=(a?p.replace(ve,""):p).replace(ge,"$1").replace(ye,"$1;"),p="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var y=ku(function(){return ya(u,m+"return "+p).apply(A,l)});if(y.source=p,fo(y))throw y;return y}function $o(t,e,n){var r=t;return(t=c(t))?(n?Dr(r,e,n):null==e)?t.slice(E(t),C(t)+1):(e+="",t.slice(f(t,e),h(t,e)+1)):t}function Xo(t,e,n){var r=t;return t=c(t),t?t.slice((n?Dr(r,e,n):null==e)?E(t):f(t,e+"")):t}function Jo(t,e,n){var r=t;return t=c(t),t?(n?Dr(r,e,n):null==e)?t.slice(0,C(t)+1):t.slice(0,h(t,e+"")+1):t}function Ko(t,e,n){n&&Dr(t,e,n)&&(e=null);var r=B,i=F;if(null!=e)if(ho(e)){var o="separator"in e?e.separator:o;r="length"in e?+e.length||0:r,i="omission"in e?c(e.omission):i}else r=+e||0;if(t=c(t),r>=t.length)return t;var a=r-i.length;if(1>a)return i;var s=t.slice(0,a);if(null==o)return s+i;if(bo(o)){if(t.slice(a).search(o)){var u,l,f=t.slice(0,a);for(o.global||(o=xa(o.source,(ke.exec(o)||"")+"g")),o.lastIndex=0;u=o.exec(f);)l=u.index;s=s.slice(0,null==l?a:l)}}else if(t.indexOf(o,a)!=a){var h=s.lastIndexOf(o);h>-1&&(s=s.slice(0,h))}return s+i}function Qo(t){return t=c(t),t&&we.test(t)?t.replace(be,T):t}function Zo(t,e,n){return n&&Dr(t,e,n)&&(e=null),t=c(t),t.match(e||De)||[]}function ta(t,e,n){return n&&Dr(t,e,n)&&(e=null),b(t)?ra(t):vn(t,e)}function ea(t){return function(){return t}}function na(t){return t}function ra(t){return Nn(gn(t,!0))}function ia(t,e){return In(t+"",gn(e,!0))}function oa(t,e,n){if(null==n){var r=ho(e),i=r&&yu(e),o=i&&i.length&&kn(e,i);(o?o.length:r)||(o=!1,n=e,e=t,t=this)}o||(o=kn(e,yu(e)));var a=!0,s=-1,u=uu(t),c=o.length;n===!1?a=!1:ho(n)&&"chain"in n&&(a=n.chain);for(;++s<c;){var l=o[s],f=e[l];t[l]=f,u&&(t.prototype[l]=function(e){return function(){var n=this.__chain__;if(a||n){var r=t(this.__wrapped__),i=r.__actions__=Je(this.__actions__);return i.push({func:e,args:arguments,thisArg:t}),r.__chain__=n,r}var o=[this.value()];return Va.apply(o,arguments),e.apply(t,o)}}(f))}return t}function aa(){return t._=Ia,this}function sa(){}function ua(t){return Ln(t+"")}function ca(t){return function(e){return null==t?A:t[e]}}function la(t,e,n){n&&Dr(t,e,n)&&(e=n=null),t=+t||0,n=null==n?1:+n||0,null==e?(e=t,t=0):e=+e||0;for(var r=-1,i=ts(Ba((e-t)/(n||1)),0),o=ma(i);++r<i;)o[r]=t,t+=n;return o}function fa(t,e,n){if(t=+t,1>t||!Qa(t))return[];var r=-1,i=ma(es(t,us));for(e=Kn(e,n,1);++r<t;)us>r?i[r]=e(r):e(r);return i}function ha(t){var e=++Ra;return c(t)+e}function pa(t,e){return t+e}function da(t,e,n){n&&Dr(t,e,n)&&(e=null);var r=Or(),i=null==e;return r===vn&&i||(i=!1,e=r(e,n,3)),i?ln(au(t)?t:Hr(t)):Gn(t,e)}t=t?tn.defaults(Ze.Object(),t,tn.pick(Ze,Be)):Ze;var ma=t.Array,va=t.Date,ga=t.Error,ya=t.Function,ba=t.Math,_a=t.Number,wa=t.Object,xa=t.RegExp,Ea=t.String,Ca=t.TypeError,Ta=ma.prototype,Sa=wa.prototype,Aa=Ea.prototype,ka=(ka=t.window)&&ka.document,Oa=ya.prototype.toString,Ma=Ln("length"),ja=Sa.hasOwnProperty,Ra=0,Na=Sa.toString,Ia=t._,Pa=xa("^"+Vo(Na).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Da=vo(Da=t.ArrayBuffer)&&Da,La=vo(La=Da&&new Da(0).slice)&&La,Ba=ba.ceil,Fa=t.clearTimeout,Ua=ba.floor,qa=vo(qa=wa.getPrototypeOf)&&qa,Va=Ta.push,Wa=Sa.propertyIsEnumerable,Ga=vo(Ga=t.Set)&&Ga,za=t.setTimeout,Ha=Ta.splice,Ya=vo(Ya=t.Uint8Array)&&Ya,$a=vo($a=t.WeakMap)&&$a,Xa=function(){try{var e=vo(e=t.Float64Array)&&e,n=new e(new Da(10),0,1)&&e}catch(r){}return n}(),Ja=vo(Ja=ma.isArray)&&Ja,Ka=vo(Ka=wa.create)&&Ka,Qa=t.isFinite,Za=vo(Za=wa.keys)&&Za,ts=ba.max,es=ba.min,ns=vo(ns=va.now)&&ns,rs=vo(rs=_a.isFinite)&&rs,is=t.parseInt,os=ba.random,as=_a.NEGATIVE_INFINITY,ss=_a.POSITIVE_INFINITY,us=ba.pow(2,32)-1,cs=us-1,ls=us>>>1,fs=Xa?Xa.BYTES_PER_ELEMENT:0,hs=ba.pow(2,53)-1,ps=$a&&new $a,ds={},ms=e.support={};!function(){ms.funcDecomp=/\bthis\b/.test(function(){return this}),ms.funcNames="string"==typeof ya.name;try{ms.dom=11===ka.createDocumentFragment().nodeType}catch(t){ms.dom=!1}try{ms.nonEnumArgs=!Wa.call(arguments,1)}catch(t){ms.nonEnumArgs=!0}}(0,0),e.templateSettings={escape:Ee,evaluate:Ce,interpolate:Te,variable:"",imports:{_:e}};var vs=function(){function e(){}return function(n){if(ho(n)){e.prototype=n;var r=new e;e.prototype=null}return r||t.Object()}}(),gs=rr(Sn),ys=rr(An,!0),bs=ir(),_s=ir(!0),ws=ps?function(t,e){return ps.set(t,e),t}:na;La||(Qn=Da&&Ya?function(t){var e=t.byteLength,n=Xa?Ua(e/fs):0,r=n*fs,i=new Da(e);if(n){var o=new Xa(i,0,n);o.set(new Xa(t,0,n))}return e!=r&&(o=new Ya(i,r),o.set(new Ya(t,r))),i}:ea(null));var xs=Ka&&Ga?function(t){return new Ye(t)}:ea(null),Es=ps?function(t){return ps.get(t)}:sa,Cs=function(){return ms.funcNames?"constant"==ea.name?Ln("name"):function(t){for(var e=t.name,n=ds[e],r=n?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}:ea("")}(),Ts=function(){var t=0,e=0;return function(n,r){var i=Ys(),o=q-(i-e);if(e=i,o>0){if(++t>=U)return n}else t=0;return ws(n,r)}}(),Ss=Zi(function(t,e){return au(t)||oo(t)?bn(t,Cn(e,!1,!0)):[]}),As=fr(),ks=fr(!0),Os=Zi(function(t,e){t||(t=[]),e=Cn(e);var n=e.length,r=dn(t,e);for(e.sort(o);n--;){var i=parseFloat(e[n]);if(i!=a&&Pr(i)){var a=i;Ha.call(t,i,1)}}return r}),Ms=Er(),js=Er(!0),Rs=Zi(function(t){return zn(Cn(t,!1,!0))}),Ns=Zi(function(t,e){return au(t)||oo(t)?bn(t,e):[]}),Is=Zi(bi),Ps=Zi(function(t,e){var n=t?t.length:0;return Br(n)&&(t=Hr(t)),dn(t,Cn(e))}),Ds=er(function(t,e,n){ja.call(t,n)?++t[n]:t[n]=1}),Ls=lr(gs),Bs=lr(ys,!0),Fs=dr(Ke,gs),Us=dr(Qe,ys),qs=er(function(t,e,n){ja.call(t,n)?t[n].push(e):t[n]=[e]}),Vs=er(function(t,e,n){t[n]=e}),Ws=Zi(function(t,e,n){var r=-1,i="function"==typeof e,o=t?t.length:0,a=Br(o)?ma(o):[];return gs(t,function(t){var o=i?e:null!=t&&t[e];a[++r]=o?o.apply(t,n):A}),a}),Gs=er(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),zs=br(sn,gs),Hs=br(un,ys),Ys=ns||function(){return(new va).getTime()},$s=Zi(function(t,e,n){var r=O;if(n.length){var i=w(n,$s.placeholder);r|=I}return Cr(t,r,e,n,i)}),Xs=Zi(function(t,e){e=e.length?Cn(e):So(t);for(var n=-1,r=e.length;++n<r;){var i=e[n];t[i]=Cr(t[i],O,t)}return t}),Js=Zi(function(t,e,n){var r=O|M;if(n.length){var i=w(n,Js.placeholder);r|=I}return Cr(e,r,t,n,i)}),Ks=ur(R),Qs=ur(N),Zs=Zi(function(t,e){return yn(t,1,e)}),tu=Zi(function(t,e,n){return yn(t,e,n)}),eu=pr(),nu=pr(!0),ru=yr(I),iu=yr(P),ou=Zi(function(t,e){return Cr(t,L,null,null,null,Cn(e))}),au=Ja||function(t){return b(t)&&Br(t.length)&&Na.call(t)==$};ms.dom||(uo=function(t){return!!t&&1===t.nodeType&&b(t)&&!cu(t)});var su=rs||function(t){return"number"==typeof t&&Qa(t)},uu=u(/x/)||Ya&&!u(Ya)?function(t){return Na.call(t)==Q}:u,cu=qa?function(t){if(!t||Na.call(t)!=ee)return!1;var e=t.valueOf,n=vo(e)&&(n=qa(e))&&qa(n);return n?t==n||qa(t)==n:Gr(t)}:Gr,lu=nr(pn),fu=Zi(function(t){var e=t[0];return null==e?e:(t.push(fn),lu.apply(A,t))}),hu=hr(Sn),pu=hr(An),du=mr(bs),mu=mr(_s),vu=vr(Sn),gu=vr(An),yu=Za?function(t){if(t)var e=t.constructor,n=t.length;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&n&&Br(n)?zr(t):ho(t)?Za(t):[]}:zr,bu=nr(Pn),_u=Zi(function(t,e){if(null==t)return{};if("function"!=typeof e[0]){var e=rn(Cn(e),Ea);return qr(t,bn(Oo(t),e))}var n=Kn(e[0],e[1],3);return Vr(t,function(t,e,r){return!n(t,e,r)})}),wu=Zi(function(t,e){return null==t?{}:"function"==typeof e[0]?Vr(t,Kn(e[0],e[1],3)):qr(t,Cn(e))}),xu=ar(function(t,e,n){return e=e.toLowerCase(),t+(n?e.charAt(0).toUpperCase()+e.slice(1):e)}),Eu=ar(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Cu=gr(),Tu=gr(!0);8!=is(Le+"08")&&(Go=function(t,e,n){return(n?Dr(t,e,n):null==e)?e=0:e&&(e=+e),t=$o(t),is(t,e||(Oe.test(t)?16:10))});var Su=ar(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Au=ar(function(t,e,n){return t+(n?" ":"")+(e.charAt(0).toUpperCase()+e.slice(1))}),ku=Zi(function(t,e){try{return t.apply(A,e)}catch(n){return fo(n)?n:new ga(n)}}),Ou=cr(on),Mu=cr(an,!0);return e.prototype=n.prototype,r.prototype=vs(n.prototype),r.prototype.constructor=r,i.prototype=vs(n.prototype),i.prototype.constructor=i,oe.prototype["delete"]=We,oe.prototype.get=Ge,oe.prototype.has=ze,oe.prototype.set=He,Ye.prototype.push=Xe,Ji.Cache=oe,e.after=Hi,e.ary=Yi,e.assign=lu,e.at=Ps,e.before=$i,e.bind=$s,e.bindAll=Xs,e.bindKey=Js,e.callback=ta,e.chain=xi,e.chunk=Xr,e.compact=Jr,e.constant=ea,e.countBy=Ds,e.create=To,e.curry=Ks,e.curryRight=Qs,e.debounce=Xi,e.defaults=fu,e.defer=Zs,e.delay=tu,e.difference=Ss,e.drop=Kr,e.dropRight=Qr,e.dropRightWhile=Zr,e.dropWhile=ti,e.fill=ei,e.filter=Ri,e.flatten=ri,e.flattenDeep=ii,e.flow=eu,e.flowRight=nu,e.forEach=Fs,e.forEachRight=Us,e.forIn=du,e.forInRight=mu,e.forOwn=vu,e.forOwnRight=gu,e.functions=So,e.groupBy=qs,e.indexBy=Vs,e.initial=ai,e.intersection=si,e.invert=ko,e.invoke=Ws,e.keys=yu,e.keysIn=Oo,e.map=Pi,e.mapValues=Mo,e.matches=ra,e.matchesProperty=ia,e.memoize=Ji,e.merge=bu,e.mixin=oa,e.negate=Ki,e.omit=_u,e.once=Qi,e.pairs=jo,e.partial=ru,e.partialRight=iu,e.partition=Gs,e.pick=wu,e.pluck=Di,e.property=ua,e.propertyOf=ca,e.pull=li,e.pullAt=Os,e.range=la,e.rearg=ou,e.reject=Li,e.remove=fi,e.rest=hi,e.restParam=Zi,e.shuffle=Fi,e.slice=pi,e.sortBy=Vi,e.sortByAll=Wi,e.sortByOrder=Gi,e.spread=to,e.take=di,e.takeRight=mi,e.takeRightWhile=vi,e.takeWhile=gi,e.tap=Ei,e.throttle=eo,e.thru=Ci,e.times=fa,e.toArray=Eo,e.toPlainObject=Co,e.transform=No,e.union=Rs,e.uniq=yi,e.unzip=bi,e.values=Io,e.valuesIn=Po,e.where=zi,e.without=Ns,e.wrap=no,e.xor=_i,e.zip=Is,e.zipObject=wi,e.backflow=nu,e.collect=Pi,e.compose=nu,e.each=Fs,e.eachRight=Us,e.extend=lu,e.iteratee=ta,e.methods=So,e.object=wi,e.select=Ri,e.tail=hi,e.unique=yi,oa(e,e),e.add=pa,e.attempt=ku,e.camelCase=xu,e.capitalize=Bo,e.clone=ro,e.cloneDeep=io,e.deburr=Fo,e.endsWith=Uo,e.escape=qo,e.escapeRegExp=Vo,e.every=ji,e.find=Ls,e.findIndex=As,e.findKey=hu,e.findLast=Bs,e.findLastIndex=ks,e.findLastKey=pu,e.findWhere=Ni,e.first=ni,e.has=Ao,e.identity=na,e.includes=Ii,e.indexOf=oi,e.inRange=Do,e.isArguments=oo,e.isArray=au,e.isBoolean=ao,e.isDate=so,e.isElement=uo,e.isEmpty=co,e.isEqual=lo,e.isError=fo,e.isFinite=su,e.isFunction=uu,e.isMatch=po,e.isNaN=mo,e.isNative=vo,e.isNull=go,e.isNumber=yo,e.isObject=ho,e.isPlainObject=cu,e.isRegExp=bo,e.isString=_o,e.isTypedArray=wo,e.isUndefined=xo,e.kebabCase=Eu,e.last=ui,e.lastIndexOf=ci,e.max=Ou,e.min=Mu,e.noConflict=aa,e.noop=sa,e.now=Ys,e.pad=Wo,e.padLeft=Cu,e.padRight=Tu,e.parseInt=Go,e.random=Lo,e.reduce=zs,e.reduceRight=Hs,e.repeat=zo,e.result=Ro,e.runInContext=S,e.size=Ui,e.snakeCase=Su,e.some=qi,e.sortedIndex=Ms,e.sortedLastIndex=js,e.startCase=Au,e.startsWith=Ho,e.sum=da,e.template=Yo,e.trim=$o,e.trimLeft=Xo,e.trimRight=Jo,e.trunc=Ko,e.unescape=Qo,e.uniqueId=ha,e.words=Zo,e.all=ji,e.any=qi,e.contains=Ii,e.detect=Ls,e.foldl=zs,e.foldr=Hs,e.head=ni,e.include=Ii,e.inject=zs,oa(e,function(){var t={};return Sn(e,function(n,r){e.prototype[r]||(t[r]=n)}),t}(),!1),e.sample=Bi,e.prototype.sample=function(t){return this.__chain__||null!=t?this.thru(function(e){return Bi(e,t)}):Bi(this.value())},e.VERSION=k,Ke(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){e[t].placeholder=e}),Ke(["dropWhile","filter","map","takeWhile"],function(t,e){var n=e!=G,r=e==V;i.prototype[t]=function(t,o){var a=this.__filtered__,s=a&&r?new i(this):this.clone(),u=s.__iteratees__||(s.__iteratees__=[]);return u.push({done:!1,count:0,index:0,iteratee:Or(t,o,1),limit:-1,type:e}),s.__filtered__=a||n,s}}),Ke(["drop","take"],function(t,e){var n=t+"While";i.prototype[t]=function(n){var r=this.__filtered__,i=r&&!e?this.dropWhile():this.clone();if(n=null==n?1:ts(Ua(n)||0,0),r)e?i.__takeCount__=es(i.__takeCount__,n):ui(i.__iteratees__).limit=n;else{var o=i.__views__||(i.__views__=[]);o.push({size:n,type:t+(i.__dir__<0?"Right":"")})}return i},i.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()},i.prototype[t+"RightWhile"]=function(t,e){return this.reverse()[n](t,e).reverse()}}),Ke(["first","last"],function(t,e){var n="take"+(e?"Right":"");i.prototype[t]=function(){return this[n](1).value()[0]}}),Ke(["initial","rest"],function(t,e){var n="drop"+(e?"":"Right");i.prototype[t]=function(){return this[n](1)}}),Ke(["pluck","where"],function(t,e){var n=e?"filter":"map",r=e?Nn:Ln;i.prototype[t]=function(t){return this[n](r(t))}}),i.prototype.compact=function(){return this.filter(na)},i.prototype.reject=function(t,e){return t=Or(t,e,1),this.filter(function(e){return!t(e)})},i.prototype.slice=function(t,e){t=null==t?0:+t||0;var n=0>t?this.takeRight(-t):this.drop(t);return"undefined"!=typeof e&&(e=+e||0,n=0>e?n.dropRight(-e):n.take(e-t)),n},i.prototype.toArray=function(){return this.drop(0)},Sn(i.prototype,function(t,n){var o=e[n];if(o){var a=/^(?:filter|map|reject)|While$/.test(n),s=/^(?:first|last)$/.test(n);e.prototype[n]=function(){var n=arguments,u=(n.length,this.__chain__),c=this.__wrapped__,l=!!this.__actions__.length,f=c instanceof i,h=n[0],p=f||au(c);p&&a&&"function"==typeof h&&1!=h.length&&(f=p=!1);var d=f&&!l;if(s&&!u)return d?t.call(c):o.call(e,this.value());var m=function(t){var r=[t];return Va.apply(r,n),o.apply(e,r)};if(p){var v=d?c:new i(this),g=t.apply(v,n);if(!s&&(l||g.__actions__)){var y=g.__actions__||(g.__actions__=[]);y.push({func:Ci,args:[m],thisArg:e})}return new r(g,u)}return this.thru(m)}}}),Ke(["concat","join","pop","push","replace","shift","sort","splice","split","unshift"],function(t){var n=(/^(?:replace|split)$/.test(t)?Aa:Ta)[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:join|pop|replace|shift)$/.test(t);e.prototype[t]=function(){var t=arguments;return i&&!this.__chain__?n.apply(this.value(),t):this[r](function(e){return n.apply(e,t)})}}),Sn(i.prototype,function(t,n){var r=e[n];if(r){var i=r.name,o=ds[i]||(ds[i]=[]);o.push({name:n,func:r})}}),ds[_r(null,M).name]=[{name:"wrapper",func:null}],i.prototype.clone=_,i.prototype.reverse=Z,i.prototype.value=re,e.prototype.chain=Ti,e.prototype.commit=Si,e.prototype.plant=Ai,e.prototype.reverse=ki,e.prototype.toString=Oi,e.prototype.run=e.prototype.toJSON=e.prototype.valueOf=e.prototype.value=Mi,e.prototype.collect=e.prototype.map,e.prototype.head=e.prototype.first,e.prototype.select=e.prototype.filter,e.prototype.tail=e.prototype.rest,e}var A,k="3.6.0",O=1,M=2,j=4,R=8,N=16,I=32,P=64,D=128,L=256,B=30,F="...",U=150,q=16,V=0,W=1,G=2,z="Expected a function",H="__lodash_placeholder__",Y="[object Arguments]",$="[object Array]",X="[object Boolean]",J="[object Date]",K="[object Error]",Q="[object Function]",Z="[object Map]",te="[object Number]",ee="[object Object]",ne="[object RegExp]",re="[object Set]",ie="[object String]",oe="[object WeakMap]",ae="[object ArrayBuffer]",se="[object Float32Array]",ue="[object Float64Array]",ce="[object Int8Array]",le="[object Int16Array]",fe="[object Int32Array]",he="[object Uint8Array]",pe="[object Uint8ClampedArray]",de="[object Uint16Array]",me="[object Uint32Array]",ve=/\b__p \+= '';/g,ge=/\b(__p \+=) '' \+/g,ye=/(__e\(.*?\)|\b__t\)) \+\n'';/g,be=/&(?:amp|lt|gt|quot|#39|#96);/g,_e=/[&<>"'`]/g,we=RegExp(be.source),xe=RegExp(_e.source),Ee=/<%-([\s\S]+?)%>/g,Ce=/<%([\s\S]+?)%>/g,Te=/<%=([\s\S]+?)%>/g,Se=/[\u0300-\u036f\ufe20-\ufe23]/g,Ae=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ke=/\w*$/,Oe=/^0[xX]/,Me=/^\[object .+?Constructor\]$/,je=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Re=/($^)/,Ne=/[.*+?^${}()|[\]\/\\]/g,Ie=RegExp(Ne.source),Pe=/['\n\r\u2028\u2029\\]/g,De=function(){var t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",e="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(t+"+(?="+t+e+")|"+t+"?"+e+"|"+t+"+|[0-9]+","g")}(),Le=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",Be=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","document","isFinite","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","window"],Fe=-1,Ue={};Ue[se]=Ue[ue]=Ue[ce]=Ue[le]=Ue[fe]=Ue[he]=Ue[pe]=Ue[de]=Ue[me]=!0,Ue[Y]=Ue[$]=Ue[ae]=Ue[X]=Ue[J]=Ue[K]=Ue[Q]=Ue[Z]=Ue[te]=Ue[ee]=Ue[ne]=Ue[re]=Ue[ie]=Ue[oe]=!1;var qe={};qe[Y]=qe[$]=qe[ae]=qe[X]=qe[J]=qe[se]=qe[ue]=qe[ce]=qe[le]=qe[fe]=qe[te]=qe[ee]=qe[ne]=qe[ie]=qe[he]=qe[pe]=qe[de]=qe[me]=!0,qe[K]=qe[Q]=qe[Z]=qe[re]=qe[oe]=!1;var Ve={leading:!1,maxWait:0,trailing:!1},We={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Ge={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},ze={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},He={"function":!0,object:!0},Ye={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},$e=He[typeof e]&&e&&!e.nodeType&&e,Xe=He[typeof t]&&t&&!t.nodeType&&t,Je=$e&&Xe&&"object"==typeof i&&i,Ke=He[typeof self]&&self&&self.Object&&self,Qe=He[typeof window]&&window&&window.Object&&window,Ze=(Xe&&Xe.exports===$e&&$e,Je||Qe!==(this&&this.window)&&Qe||Ke||this),tn=S();Ze._=tn,r=function(){return tn}.call(e,n,e,t),!(r!==A&&(t.exports=r))}).call(this)}).call(e,n(44)(t),function(){return this}())},function(t){t.exports={includeStack:!1,showDiff:!0,truncateThreshold:40}},function(t){/*!
	 * Chai - flag utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){var r=t.__flags||(t.__flags=Object.create(null));return 3!==arguments.length?r[e]:void(r[e]=n)}},function(t,e,n){function r(t,e){for(var n=0;n<t.length;n++)if(t[n].name===e)return n;return-1}function i(t){return this instanceof i?(this.properties=[],void(t&&this.load(t))):new i(t)}var o=n(106),a=n(225);i.prototype.dispose=function(){this.properties.forEach(function(t){t.dispose()}),this.properties.length=0},i.prototype.addProperty=function(t){this.properties.push(new a(t))},i.prototype.duration=function(){for(var t=0,e=0;e<this.properties.length;e++)for(var n=this.properties[e],r=n.keyframes.frames,i=0;i<r.length;i++)t=Math.max(r[i].time,t);return t},i.prototype.property=function(t){var e="number"==typeof t?t:r(this.properties,t);return 0>e?void 0:this.properties[e]},i.prototype.load=function(t){this.dispose(),t&&(this.properties=t.map(function(t){return new a(t)}))},i.prototype["export"]=function(){return this.properties.map(function(t){return t["export"]()})},i.prototype.ease=function(t,e){return e},i.prototype.interpolate=function(t,e,n,r){return o(e.value,n.value,r)},i.prototype.valueOf=function(t,e){var n=e.keyframes,r=n.interpolation(t),i=r[0],o=r[1],a=r[2];if(-1===i||-1===o)return e.value;var s=n.frames[i],u=n.frames[o];if(i===o)return s.value;var c=u.ease;return c&&(a=this.ease(c,a)),this.interpolate(e,s,u,a)},i.prototype.values=function(t,e){e||(e={});for(var n=0;n<this.properties.length;n++){var r=this.properties[n];e[r.name]=this.valueOf(t,r)}return e},t.exports=i},function(t,e,n){function r(t){return this instanceof r?void a.call(this,t):new r(t)}var i=n(205),o=n(219),a=n(186);o(r,a),r.prototype.ease=function(t,e){return i[t](e)},t.exports=r},function(t){function e(t){var e=2.5949095;return(t*=2)<1?.5*t*t*((e+1)*t-e):.5*((t-=2)*t*((e+1)*t+e)+2)}t.exports=e},function(t){function e(t){var e=1.70158;return t*t*((e+1)*t-e)}t.exports=e},function(t){function e(t){var e=1.70158;return--t*t*((e+1)*t+e)+1}t.exports=e},function(t,e,n){function r(t){return.5>t?.5*(1-i(1-2*t)):.5*i(2*t-1)+.5}var i=n(66);t.exports=r},function(t,e,n){function r(t){return 1-i(1-t)}var i=n(66);t.exports=r},function(t){function e(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}t.exports=e},function(t){function e(t){return 1-Math.sqrt(1-t*t)}t.exports=e},function(t){function e(t){return Math.sqrt(1- --t*t)}t.exports=e},function(t){function e(t){return.5>t?4*t*t*t:.5*Math.pow(2*t-2,3)+1}t.exports=e},function(t){function e(t){return t*t*t}t.exports=e},function(t){function e(t){var e=t-1;return e*e*e+1}t.exports=e},function(t){function e(t){return.5>t?.5*Math.sin(13*Math.PI/2*2*t)*Math.pow(2,10*(2*t-1)):.5*Math.sin(-13*Math.PI/2*(2*t-1+1))*Math.pow(2,-10*(2*t-1))+1}t.exports=e},function(t){function e(t){return Math.sin(13*t*Math.PI/2)*Math.pow(2,10*(t-1))}t.exports=e},function(t){function e(t){return Math.sin(-13*(t+1)*Math.PI/2)*Math.pow(2,-10*t)+1}t.exports=e},function(t){function e(t){return 0===t||1===t?t:.5>t?.5*Math.pow(2,20*t-10):-.5*Math.pow(2,10-20*t)+1}t.exports=e},function(t){function e(t){return 0===t?t:Math.pow(2,10*(t-1))}t.exports=e},function(t){function e(t){return 1===t?t:1-Math.pow(2,-10*t)}t.exports=e},function(t,e,n){t.exports={backInOut:n(188),backIn:n(189),backOut:n(190),bounceInOut:n(191),bounceIn:n(192),bounceOut:n(66),circInOut:n(193),circIn:n(194),circOut:n(195),cubicInOut:n(196),cubicIn:n(197),cubicOut:n(198),elasticInOut:n(199),elasticIn:n(200),elasticOut:n(201),expoInOut:n(202),expoIn:n(203),expoOut:n(204),linear:n(206),quadInOut:n(207),quadIn:n(208),quadOut:n(209),quartInOut:n(210),quartIn:n(211),quartOut:n(212),quintInOut:n(213),quintIn:n(214),quintOut:n(215),sineInOut:n(216),sineIn:n(217),sineOut:n(218)}},function(t){function e(t){return t}t.exports=e},function(t){function e(t){return t/=.5,1>t?.5*t*t:(t--,-.5*(t*(t-2)-1))}t.exports=e},function(t){function e(t){return t*t}t.exports=e},function(t){function e(t){return-t*(t-2)}t.exports=e},function(t){function e(t){return.5>t?8*Math.pow(t,4):-8*Math.pow(t-1,4)+1}t.exports=e},function(t){function e(t){return Math.pow(t,4)}t.exports=e},function(t){function e(t){return Math.pow(t-1,3)*(1-t)+1}t.exports=e},function(t){function e(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}t.exports=e},function(t){function e(t){return t*t*t*t*t}t.exports=e},function(t){function e(t){return--t*t*t*t*t+1}t.exports=e},function(t){function e(t){return-.5*(Math.cos(Math.PI*t)-1)}t.exports=e},function(t){function e(t){return 1-Math.cos(t*Math.PI/2)}t.exports=e},function(t){function e(t){return Math.sin(t*Math.PI/2)}t.exports=e},function(t){t.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){function r(t,e){return t.time-e.time}function i(t,e){return this instanceof i?(this.frames=t||[],void(e||this.sort())):new i(t,e)}var o=n(106),a=n(222),s=n(221),u=[0,0,0];i.prototype.nearestIndex=function(t,e){e="number"==typeof e?e:Number.MAX_VALUE;for(var n=Number.MAX_VALUE,r=-1,i=0;i<this.frames.length;i++){var o=Math.abs(this.frames[i].time-t);n>o&&e>=o&&(n=o,r=i)}return r},i.prototype.nearest=function(t,e){var n=this.nearestIndex(t,e);return-1===n?null:this.frames[n]},i.prototype.get=function(t){return this.nearest(t,0)},i.prototype.getIndex=function(t){return this.nearestIndex(t,0)},i.prototype.value=function(t,e){var n=this.interpolation(t);if(-1===n[0]||-1===n[1])return null;var r=this.frames[n[0]],i=this.frames[n[1]],a=n[2];return"function"==typeof e?e(r,i,a):o(r.value,i.value,a)},i.prototype.interpolation=function(t){if(0===this.frames.length)return s(u,-1,-1,0);for(var e=-1,n=this.frames.length-1;n>=0;n--)if(t>=this.frames[n].time){e=n;break}if(-1===e||e===this.frames.length-1)return 0>e&&(e=0),s(u,e,e,0);var r=this.frames[e],i=this.frames[e+1];t=Math.max(r.time,Math.min(t,i.time));var o=a(r.time,i.time,t);return s(u,e,e+1,o)},i.prototype.next=function(t){if(this.frames.length<1)return null;for(var e=-1,n=0;n<this.frames.length;n++)if(t<this.frames[n].time){e=n;break}return-1===e?null:this.frames[e]},i.prototype.previous=function(t){if(this.frames.length<1)return null;for(var e=-1,n=this.frames.length-1;n>=0;n--)if(t>this.frames[n].time){e=n;break}return-1===e?null:this.frames[e]},i.prototype.add=function(t){this.frames.push(t),this.sort()},i.prototype.splice=function(){this.frames.splice.apply(this.frames,arguments),arguments.length>2&&this.sort()},i.prototype.sort=function(){this.frames.sort(r)},i.prototype.clear=function(){this.frames.length=0},Object.defineProperty(i.prototype,"count",{get:function(){return this.frames.length}}),t.exports=i},function(t){function e(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}t.exports=e},function(t){t.exports=function(t,e,n){return(n-t)/(e-t)}},function(t){function e(t,e,n){return t*(1-n)+e*n}t.exports=e},function(t){function e(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])}return t}t.exports=e},function(t,e,n){function r(t){return this instanceof r?(this.keyframes=i(),this.value=null,this.name="",void(t&&this.load(t))):new r(t)}var i=n(220),o=n(224);r.prototype.dispose=function(){this.keyframes.clear()},r.prototype["export"]=function(){return o(this,{keyframes:this.keyframes.frames})},r.prototype.load=function(t){if(this.dispose(),t)for(var e in t)t.hasOwnProperty(e)&&("keyframes"===e?this.keyframes.frames=t.keyframes:this[e]=t[e])},t.exports=r},function(t){"use strict";function e(t,e,n,r){Object.defineProperty(t,e,{get:function(){var t=n.call(this);return Object.defineProperty(this,e,{value:t,enumerable:!!r,writable:!0}),t},set:function(t){return Object.defineProperty(this,e,{value:t,enumerable:!!r,writable:!0}),t},enumerable:!!r,configurable:!0})}t.exports=e},function(t){t.exports=function(){function t(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}function e(t,e,n,r,i,o){this.message=t,this.expected=e,this.found=n,this.offset=r,this.line=i,this.column=o,this.name="SyntaxError"}function n(t){function n(){return t.substring(ge,ve)}function r(e){function n(e,n,r){var i,o;for(i=n;r>i;i++)o=t.charAt(i),"\n"===o?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):"\r"===o||"\u2028"===o||"\u2029"===o?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}return ye!==e&&(ye>e&&(ye=0,be={line:1,column:1,seenCR:!1}),n(be,ye,e),ye=e),be}function i(t){_e>ve||(ve>_e&&(_e=ve,we=[]),we.push(t))}function o(n,i,o){function a(t){var e=1;for(t.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}function s(t,e){function n(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+e(t)}).replace(/[\u0180-\u0FFF]/g,function(t){return"\\u0"+e(t)}).replace(/[\u1080-\uFFFF]/g,function(t){return"\\u"+e(t)})}var r,i,o,a=new Array(t.length);for(o=0;o<t.length;o++)a[o]=t[o].description;return r=t.length>1?a.slice(0,-1).join(", ")+" or "+a[t.length-1]:a[0],i=e?'"'+n(e)+'"':"end of input","Expected "+r+" but "+i+" found."}var u=r(o),c=o<t.length?t.charAt(o):null;return null!==i&&a(i),new e(null!==n?n:s(i,c),i,c,o,u.line,u.column)}function a(){var t;return t=s()}function s(){var e,n,r,o,a,s,c,l;if(e=ve,n=u(),n!==x){for(r=[],o=ve,a=g(),a!==x?(t.substr(ve,2)===S?(s=S,ve+=2):(s=x,0===xe&&i(A)),s!==x?(c=g(),c!==x?(l=u(),l!==x?(a=[a,s,c,l],o=a):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T);o!==x;)r.push(o),o=ve,a=g(),a!==x?(t.substr(ve,2)===S?(s=S,ve+=2):(s=x,0===xe&&i(A)),s!==x?(c=g(),c!==x?(l=u(),l!==x?(a=[a,s,c,l],o=a):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T);r!==x?(ge=e,n=k(n,r),e=n):(ve=e,e=T)}else ve=e,e=T;return e}function u(){var e,n,r,o,a,s,u,l;if(e=ve,n=c(),n!==x){for(r=[],o=ve,a=g(),a!==x?(t.substr(ve,2)===O?(s=O,ve+=2):(s=x,0===xe&&i(M)),s!==x?(u=g(),u!==x?(l=c(),l!==x?(a=[a,s,u,l],o=a):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T);o!==x;)r.push(o),o=ve,a=g(),a!==x?(t.substr(ve,2)===O?(s=O,ve+=2):(s=x,0===xe&&i(M)),s!==x?(u=g(),u!==x?(l=c(),l!==x?(a=[a,s,u,l],o=a):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T);r!==x?(ge=e,n=k(n,r),e=n):(ve=e,e=T)}else ve=e,e=T;return e}function c(){var e,n,r,o,a,s,u,c;if(e=ve,n=l(),n!==x){for(r=[],o=ve,a=g(),a!==x?(43===t.charCodeAt(ve)?(s=j,ve++):(s=x,0===xe&&i(R)),s===x&&(45===t.charCodeAt(ve)?(s=N,ve++):(s=x,0===xe&&i(I))),s!==x?(u=g(),u!==x?(c=l(),c!==x?(a=[a,s,u,c],o=a):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T);o!==x;)r.push(o),o=ve,a=g(),a!==x?(43===t.charCodeAt(ve)?(s=j,ve++):(s=x,0===xe&&i(R)),s===x&&(45===t.charCodeAt(ve)?(s=N,ve++):(s=x,0===xe&&i(I))),s!==x?(u=g(),u!==x?(c=l(),c!==x?(a=[a,s,u,c],o=a):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T);r!==x?(ge=e,n=k(n,r),e=n):(ve=e,e=T)}else ve=e,e=T;return e}function l(){var e,n,r,o,a,s,u,c;if(e=ve,n=f(),n!==x){for(r=[],o=ve,a=g(),a!==x?(42===t.charCodeAt(ve)?(s=P,ve++):(s=x,0===xe&&i(D)),s===x&&(47===t.charCodeAt(ve)?(s=L,ve++):(s=x,0===xe&&i(B)),s===x&&(37===t.charCodeAt(ve)?(s=F,ve++):(s=x,0===xe&&i(U)))),s!==x?(u=g(),u!==x?(c=f(),c!==x?(a=[a,s,u,c],o=a):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T);o!==x;)r.push(o),o=ve,a=g(),a!==x?(42===t.charCodeAt(ve)?(s=P,ve++):(s=x,0===xe&&i(D)),s===x&&(47===t.charCodeAt(ve)?(s=L,ve++):(s=x,0===xe&&i(B)),s===x&&(37===t.charCodeAt(ve)?(s=F,ve++):(s=x,0===xe&&i(U)))),s!==x?(u=g(),u!==x?(c=f(),c!==x?(a=[a,s,u,c],o=a):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T)):(ve=o,o=T);r!==x?(ge=e,n=k(n,r),e=n):(ve=e,e=T)}else ve=e,e=T;return e}function f(){var e,n,r,o,a,u;return e=ve,40===t.charCodeAt(ve)?(n=q,ve++):(n=x,0===xe&&i(V)),n!==x?(r=g(),r!==x?(o=s(),o!==x?(a=g(),a!==x?(41===t.charCodeAt(ve)?(u=W,ve++):(u=x,0===xe&&i(G)),u!==x?(ge=e,n=z(o),e=n):(ve=e,e=T)):(ve=e,e=T)):(ve=e,e=T)):(ve=e,e=T)):(ve=e,e=T),e===x&&(e=ve,33===t.charCodeAt(ve)?(n=H,ve++):(n=x,0===xe&&i(Y)),n!==x?(r=f(),r!==x?(ge=e,n=$(r),e=n):(ve=e,e=T)):(ve=e,e=T),e===x&&(e=h(),e===x&&(e=v()))),e}function h(){var e,n,r,o,a;return xe++,e=ve,45===t.charCodeAt(ve)?(n=N,ve++):(n=x,0===xe&&i(I)),n===x&&(n=J),n!==x?(r=m(),r!==x?(o=d(),o===x&&(o=J),o!==x?(a=p(),a===x&&(a=J),a!==x?(ge=e,n=K(),e=n):(ve=e,e=T)):(ve=e,e=T)):(ve=e,e=T)):(ve=e,e=T),xe--,e===x&&(n=x,0===xe&&i(X)),e}function p(){var e,n,r,o,a;if(e=ve,Q.test(t.charAt(ve))?(n=t.charAt(ve),ve++):(n=x,0===xe&&i(Z)),n!==x)if(45===t.charCodeAt(ve)?(r=N,ve++):(r=x,0===xe&&i(I)),r===x&&(43===t.charCodeAt(ve)?(r=j,ve++):(r=x,0===xe&&i(R))),r===x&&(r=J),r!==x){if(o=[],te.test(t.charAt(ve))?(a=t.charAt(ve),ve++):(a=x,0===xe&&i(ee)),a!==x)for(;a!==x;)o.push(a),te.test(t.charAt(ve))?(a=t.charAt(ve),ve++):(a=x,0===xe&&i(ee));else o=T;o!==x?(n=[n,r,o],e=n):(ve=e,e=T)}else ve=e,e=T;else ve=e,e=T;return e}function d(){var e,n,r,o;if(e=ve,46===t.charCodeAt(ve)?(n=ne,ve++):(n=x,0===xe&&i(re)),n!==x){if(r=[],te.test(t.charAt(ve))?(o=t.charAt(ve),ve++):(o=x,0===xe&&i(ee)),o!==x)for(;o!==x;)r.push(o),te.test(t.charAt(ve))?(o=t.charAt(ve),ve++):(o=x,0===xe&&i(ee));else r=T;r!==x?(n=[n,r],e=n):(ve=e,e=T)}else ve=e,e=T;return e}function m(){var e,n,r,o;if(48===t.charCodeAt(ve)?(e=ie,ve++):(e=x,0===xe&&i(oe)),e===x)if(e=ve,ae.test(t.charAt(ve))?(n=t.charAt(ve),ve++):(n=x,0===xe&&i(se)),n!==x){for(r=[],te.test(t.charAt(ve))?(o=t.charAt(ve),ve++):(o=x,0===xe&&i(ee));o!==x;)r.push(o),te.test(t.charAt(ve))?(o=t.charAt(ve),ve++):(o=x,0===xe&&i(ee));r!==x?(n=[n,r],e=n):(ve=e,e=T)}else ve=e,e=T;return e}function v(){var e,n,r,o;if(e=ve,n=[],ue.test(t.charAt(ve))?(r=t.charAt(ve),ve++):(r=x,0===xe&&i(ce)),r!==x)for(;r!==x;)n.push(r),ue.test(t.charAt(ve))?(r=t.charAt(ve),ve++):(r=x,0===xe&&i(ce));else n=T;if(n!==x){for(r=[],le.test(t.charAt(ve))?(o=t.charAt(ve),ve++):(o=x,0===xe&&i(fe));o!==x;)r.push(o),le.test(t.charAt(ve))?(o=t.charAt(ve),ve++):(o=x,0===xe&&i(fe));r!==x?(ge=e,n=he(),e=n):(ve=e,e=T)}else ve=e,e=T;return e}function g(){var e,n;for(xe++,e=[],de.test(t.charAt(ve))?(n=t.charAt(ve),ve++):(n=x,0===xe&&i(me));n!==x;)e.push(n),de.test(t.charAt(ve))?(n=t.charAt(ve),ve++):(n=x,0===xe&&i(me));return xe--,e===x&&(n=x,0===xe&&i(pe)),e}function y(t){var e=t[1],n=t[3];return" "+e+" "+n}function b(t,e){return t+e.map(y).join("")}var _,w=arguments.length>1?arguments[1]:{},x={},E={expr:a},C=a,T=x,S="||",A={type:"literal",value:"||",description:'"||"'},k=function(t,e){return b(t,e)},O="&&",M={type:"literal",value:"&&",description:'"&&"'},j="+",R={type:"literal",value:"+",description:'"+"'},N="-",I={type:"literal",value:"-",description:'"-"'},P="*",D={type:"literal",value:"*",description:'"*"'},L="/",B={type:"literal",value:"/",description:'"/"'},F="%",U={type:"literal",value:"%",description:'"%"'},q="(",V={type:"literal",value:"(",description:'"("'},W=")",G={type:"literal",value:")",description:'")"'},z=function(t){return"("+t+")"},H="!",Y={type:"literal",value:"!",description:'"!"'},$=function(t){return"!"+t},X={type:"other",description:"number"},J=null,K=function(){return n()},Q=/^[eE]/,Z={type:"class",value:"[eE]",description:"[eE]"},te=/^[0-9]/,ee={type:"class",value:"[0-9]",description:"[0-9]"},ne=".",re={type:"literal",value:".",description:'"."'},ie="0",oe={type:"literal",value:"0",description:'"0"'},ae=/^[1-9]/,se={type:"class",value:"[1-9]",description:"[1-9]"},ue=/^[a-zA-Z]/,ce={type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},le=/^[a-zA-Z0-9_]/,fe={type:"class",value:"[a-zA-Z0-9_]",description:"[a-zA-Z0-9_]"},he=function(){return"get("+JSON.stringify(n())+")"},pe={type:"other",description:"whitespace"},de=/^[ \t\n\r]/,me={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},ve=0,ge=0,ye=0,be={line:1,column:1,seenCR:!1},_e=0,we=[],xe=0;if("startRule"in w){if(!(w.startRule in E))throw new Error("Can't start parsing from rule \""+w.startRule+'".');C=E[w.startRule]}if(_=C(),_!==x&&ve===t.length)return _;throw _!==x&&ve<t.length&&i({type:"end",description:"end of input"}),o(null,we,_e)}return t(e,Error),{SyntaxError:e,parse:n}}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function r(t){var e=!1;try{t.appendChild(s),e=s.parentNode==t}catch(n){return!1}finally{try{t.removeChild(s)}catch(n){}}return e}function i(t){return"number"==typeof t&&isNaN(t)}function o(t){return s&&t&&1===t.nodeType&&r(t)}var a=n(160),s="undefined"!=typeof document&&document.createElement("div");t.exports=function u(t,e){if(a.isMatcher(t))return t.test(e);if("object"!=typeof t||"object"!=typeof e)return i(t)&&i(e)?!0:t===e;if(o(t)||o(e))return t===e;if(t===e)return!0;if(null===t&&null!==e||null!==t&&null===e)return!1;if(t instanceof RegExp&&e instanceof RegExp)return t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline;var n=Object.prototype.toString.call(t);if(n!==Object.prototype.toString.call(e))return!1;if("[object Date]"===n)return t.valueOf()===e.valueOf();var r,s=0,c=0;if("[object Array]"==n&&t.length!==e.length)return!1;for(r in t){if(s+=1,!(r in e))return!1;if(!u(t[r],e[r]))return!1}for(r in e)c+=1;return s==c}},function(t,e,n){"use strict";var r=n(571),i=r.configure({quoteStrings:!1,limitChildrenCount:250});t.exports=function(){return i.ascii.apply(i,arguments)}},function(t){"use strict";function e(t,e,n,r){this.resolve=t,this.fn=e,this.self=n||null,this.args=r}t.exports=function(n){function r(t,n){function r(n,r,s){if(t){t--;var u=new i(function(t){t(n.apply(r,s))});return u.then(o,o),u}return new i(function(t){a.push(new e(t,n,r,s))})}function o(){if(t++,a.length){var e=a.shift();e.resolve(r(e.fn,e.self,e.args))}}var a=[];if("function"==typeof t&&"number"==typeof n){var s=n;n=t,t=s}return"function"==typeof n?function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);return r(n,this,t)}:function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);return r(t,this,e)}}var i;if("number"==typeof arguments[0]||"number"==typeof arguments[1]){if(i=t.exports.Promise,"function"!=typeof i)throw new Error("You must provide a Promise polyfill for this library to work in older environments");return r(arguments[0],arguments[1])}return i=n,r},"function"==typeof Promise&&(t.exports.Promise=Promise)},function(t,e,n){(function(e){"use strict";function r(){this._listeners={}}var i=n(16),o=n(61),a=n(13);"undefined"==typeof e.EventTarget&&(e.EventTarget=function(){throw new TypeError("Illegal constructor")}),i.inherits(r,e.EventTarget),r.prototype.addEventListener=function(t,e){var n=new o(this,"addEventListener",[{name:"type",type:"string"},{name:"listener",type:"function"}]);n.validateArguments(arguments,function(t){throw new TypeError(n.form+"; "+t)}),this._listeners[t]=this._listeners[t]||[],this._listeners[t].push(e)},r.prototype.removeEventListener=function(t,e){var n=new o(this,"addEventListener",[{name:"type",type:"string"},{name:"listener",type:"function"}]);n.validateArguments(arguments,function(t){throw new TypeError(n.form+"; "+t)}),this._listeners[t]=this._listeners[t]||[];var r=this._listeners[t].indexOf(e);-1!==r&&this._listeners[t].splice(r,1)},r.prototype.dispatchEvent=function(t){var e=new o(this,"addEventListener",[{name:"event",type:"Event"}]);e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)});var n=t.type;return"function"==typeof this["on"+n]&&this["on"+n].call(this,t),this.$listeners(n).forEach(function(e){e.call(this,t)},this),!0},r.prototype.$listeners=function(t){return(this._listeners[t]||[]).slice()},t.exports=a.EventTarget=r}).call(e,function(){return this}())},function(t,e,n){(function(t,r){function i(t,e){this._id=t,this._clearFn=e}var o=n(1).nextTick,a=Function.prototype.apply,s=Array.prototype.slice,u={},c=0;e.setTimeout=function(){return new i(a.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new i(a.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},e.setImmediate="function"==typeof t?t:function(t){var n=c++,r=arguments.length<2?!1:s.call(arguments,1);return u[n]=!0,o(function(){u[n]&&(r?t.apply(null,r):t.call(null),e.clearImmediate(n))}),n},e.clearImmediate="function"==typeof r?r:function(t){delete u[t]}}).call(e,n(307).setImmediate,n(307).clearImmediate)},,,,,,,,function(t,e,n){"use strict";function r(t,e,n){var r=o.getName(t)+e;throw n.length&&(r+=" Received ["+c.call(n).join(", ")+"]"),new Error(r)}function i(t,e,n,r,i,a){if("number"!=typeof a)throw new TypeError("Call id is not a number");var s=o.create(l);return s.proxy=t,s.thisValue=e,s.args=n,s.returnValue=r,s.exception=i,s.callId=a,s}var o=n(130),a=n(160),s=n(303),u=n(304),c=Array.prototype.slice,l={calledOn:function(t){return a.isMatcher(t)?t.test(this.thisValue):this.thisValue===t},calledWith:function(){for(var t=0,e=arguments.length;e>t;t+=1)if(!s(arguments[t],this.args[t]))return!1;return!0},calledWithMatch:function(){for(var t=0,e=arguments.length;e>t;t+=1){var n=this.args[t],r=arguments[t];if(!a(r).test(n))return!1}return!0},calledWithExactly:function(){return arguments.length==this.args.length&&this.calledWith.apply(this,arguments)},notCalledWith:function(){return!this.calledWith.apply(this,arguments)},notCalledWithMatch:function(){return!this.calledWithMatch.apply(this,arguments)},returned:function(t){return s(t,this.returnValue)},threw:function(t){return"undefined"!=typeof t&&this.exception?this.exception===t||this.exception.name===t:!!this.exception},calledWithNew:function(){return this.proxy.prototype&&this.thisValue instanceof this.proxy},calledBefore:function(t){return this.callId<t.callId},calledAfter:function(t){return this.callId>t.callId},callArg:function(t){this.args[t]()},callArgOn:function(t,e){this.args[t].apply(e)},callArgWith:function(t){this.callArgOnWith.apply(this,[t,null].concat(c.call(arguments,1)))},callArgOnWith:function(t,e){var n=c.call(arguments,2);this.args[t].apply(e,n)},"yield":function(){this.yieldOn.apply(this,[null].concat(c.call(arguments,0)))},yieldOn:function(t){for(var e=this.args,n=0,i=e.length;i>n;++n)if("function"==typeof e[n])return void e[n].apply(t,c.call(arguments,1));r(this.proxy," cannot yield since no callback was passed.",e)},yieldTo:function(t){this.yieldToOn.apply(this,[t,null].concat(c.call(arguments,1)))},yieldToOn:function(t,e){for(var n=this.args,i=0,o=n.length;o>i;++i)if(n[i]&&"function"==typeof n[i][t])return void n[i][t].apply(e,c.call(arguments,2));r(this.proxy," cannot yield to '"+t+"' since no callback was passed.",n)},toString:function(){for(var t=this.proxy.toString()+"(",e=[],n=0,r=this.args.length;r>n;++n)e.push(u(this.args[n]));return t=t+e.join(", ")+")","undefined"!=typeof this.returnValue&&(t+=" => "+u(this.returnValue)),this.exception&&(t+=" !"+this.exception.name,this.exception.message&&(t+="("+this.exception.message+")")),t}};l.invokeCallback=l["yield"],i.toString=l.toString,t.exports=i},function(module,exports,__webpack_require__){"use strict";function spy(t,e){if(!e&&"function"==typeof t)return spy.create(t);if(!t&&!e)return spy.create(function(){});var n=t[e];return wrapMethod(t,e,spy.create(n))}function matchingFake(t,e,n){if(t)for(var r=0,i=t.length;i>r;r++)if(t[r].matches(e,n))return t[r]}function incrementCallCount(){this.called=!0,this.callCount+=1,this.notCalled=!1,this.calledOnce=1==this.callCount,this.calledTwice=2==this.callCount,this.calledThrice=3==this.callCount}function createCallProperties(){this.firstCall=this.getCall(0),this.secondCall=this.getCall(1),this.thirdCall=this.getCall(2),this.lastCall=this.getCall(this.callCount-1),this.calledWithNew=!!(this.calledWithNew||this.lastCall&&this.lastCall.calledWithNew())}function createProxy(func){var p;return func.length?eval("p = (function proxy("+vars.substring(0,2*func.length-1)+") { return p.invoke(func, this, slice.call(arguments)); });"):p=function(){return p.invoke(func,this,slice.call(arguments))},p}function delegateToCalls(t,e,n,r){spyApi[t]=function(){if(!this.called)return r?r.apply(this,arguments):!1;for(var i,o=0,a=0,s=this.callCount;s>a;a+=1)if(i=this.getCall(a),i[n||t].apply(i,arguments)&&(o+=1,e))return!0;return o===this.callCount}}var timesInWords=__webpack_require__(318),wrapMethod=__webpack_require__(319),fn=__webpack_require__(130),extend=__webpack_require__(146),spyCall=__webpack_require__(315),deepEqual=__webpack_require__(303),format=__webpack_require__(304),push=Array.prototype.push,slice=Array.prototype.slice,callId=0,vars="a,b,c,d,e,f,g,h,i,j,k,l",uuid=0,spyApi={reset:function(){if(this.invoking){var t=new Error("Cannot reset Sinon function while invoking it. Move the call to .reset outside of the callback.");throw t.name="InvalidResetException",t}if(this.called=!1,this.notCalled=!0,this.calledOnce=!1,this.calledTwice=!1,this.calledThrice=!1,this.callCount=0,this.firstCall=null,this.secondCall=null,this.thirdCall=null,this.lastCall=null,this.calledWithNew=!1,this.args=[],this.returnValues=[],this.thisValues=[],this.exceptions=[],this.callIds=[],this.fakes)for(var e=0;e<this.fakes.length;e++)this.fakes[e].reset()},create:function(t){var e;"function"!=typeof t?t=function(){}:e=fn.getName(t);var n=createProxy(t);return extend(n,spy),delete n.create,extend(n,t),n.reset(),n.prototype=t.prototype,n.displayName=e||"spy",n.toString=fn.toString,n.instantiateFake=spy.create,n.id="spy#"+uuid++,n},invoke:function(t,e,n){var r,i,o=matchingFake(this.fakes,n);incrementCallCount.call(this),push.call(this.thisValues,e),push.call(this.args,n),push.call(this.callIds,callId++),createCallProperties.call(this);try{this.invoking=!0,i=o?o.invoke(t,e,n):(this.func||t).apply(e,n);var a=this.getCall(this.callCount-1);a.calledWithNew()&&"object"!=typeof i&&(i=e)}catch(s){r=s}finally{delete this.invoking}if(push.call(this.exceptions,r),push.call(this.returnValues,i),createCallProperties.call(this),void 0!==r)throw r;return i},named:function(t){return this.displayName=t,this},getCall:function(t){return 0>t||t>=this.callCount?null:spyCall(this,this.thisValues[t],this.args[t],this.returnValues[t],this.exceptions[t],this.callIds[t])},getCalls:function(){var t,e=[];for(t=0;t<this.callCount;t++)e.push(this.getCall(t));return e},calledBefore:function(t){return this.called?t.called?this.callIds[0]<t.callIds[t.callIds.length-1]:!0:!1},calledAfter:function(t){return this.called&&t.called?this.callIds[this.callCount-1]>t.callIds[t.callCount-1]:!1},withArgs:function(){var t=slice.call(arguments);if(this.fakes){var e=matchingFake(this.fakes,t,!0);if(e)return e}else this.fakes=[];var n=this,r=this.instantiateFake();r.matchingAguments=t,r.parent=this,push.call(this.fakes,r),r.withArgs=function(){return n.withArgs.apply(n,arguments)};for(var i=0;i<this.args.length;i++)r.matches(this.args[i])&&(incrementCallCount.call(r),push.call(r.thisValues,this.thisValues[i]),push.call(r.args,this.args[i]),push.call(r.returnValues,this.returnValues[i]),push.call(r.exceptions,this.exceptions[i]),push.call(r.callIds,this.callIds[i]));return createCallProperties.call(r),r},matches:function(t,e){var n=this.matchingAguments;return n.length<=t.length&&deepEqual(n,t.slice(0,n.length))?!e||n.length==t.length:void 0},printf:function(t){var e,n=this,r=slice.call(arguments,1);return(t||"").replace(/%(.)/g,function(t,i){if(e=spyApi.formatters[i],"function"==typeof e)return e.call(null,n,r);if(!isNaN(parseInt(i,10))){var o=r[i-1];return format(o)}return"%"+i})}};delegateToCalls("calledOn",!0),delegateToCalls("alwaysCalledOn",!1,"calledOn"),delegateToCalls("calledWith",!0),delegateToCalls("calledWithMatch",!0),delegateToCalls("alwaysCalledWith",!1,"calledWith"),delegateToCalls("alwaysCalledWithMatch",!1,"calledWithMatch"),delegateToCalls("calledWithExactly",!0),delegateToCalls("alwaysCalledWithExactly",!1,"calledWithExactly"),delegateToCalls("neverCalledWith",!1,"notCalledWith",function(){return!0}),delegateToCalls("neverCalledWithMatch",!1,"notCalledWithMatch",function(){return!0}),delegateToCalls("threw",!0),delegateToCalls("alwaysThrew",!1,"threw"),delegateToCalls("returned",!0),delegateToCalls("alwaysReturned",!1,"returned"),delegateToCalls("alwaysCalledWithNew",!1,"calledWithNew"),delegateToCalls("callArg",!1,"callArgWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgWith=spyApi.callArg,delegateToCalls("callArgOn",!1,"callArgOnWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgOnWith=spyApi.callArgOn,delegateToCalls("yield",!1,"yield",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),spyApi.invokeCallback=spyApi["yield"],delegateToCalls("yieldOn",!1,"yieldOn",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),delegateToCalls("yieldTo",!1,"yieldTo",function(t){throw new Error(this.toString()+" cannot yield to '"+t+"' since it was not yet invoked.")}),delegateToCalls("yieldToOn",!1,"yieldToOn",function(t){throw new Error(this.toString()+" cannot yield to '"+t+"' since it was not yet invoked.")}),spyApi.formatters={c:function(t){return timesInWords(t.callCount)},n:function(t){return t.toString()},C:function(t){for(var e=[],n=0,r=t.callCount;r>n;++n){var i="    "+t.getCall(n).toString();/\n/.test(e[n-1])&&(i="\n"+i),push.call(e,i)}return e.length>0?"\n"+e.join("\n"):""},t:function(t){for(var e=[],n=0,r=t.callCount;r>n;++n)push.call(e,format(t.thisValues[n]));return e.join(", ")},"*":function(t,e){for(var n=[],r=0,i=e.length;i>r;++r)push.call(n,format(e[r]));return n.join(", ")}},extend(spy,spyApi),module.exports=spy},function(t,e,n){"use strict";function r(t,e,n){if(n&&"function"!=typeof n)throw new TypeError("Custom stub should be function");var i;if(i=n?s(n):r.create(),!t&&void 0===e)return r.create();if(void 0===e&&"object"==typeof t){for(var o in t)"function"==typeof t[o]&&r(t,o);return t}return u(t,e,i)}function i(t){return t.defaultBehavior||o(t)||c.create(t)}function o(t){return t.parent&&a(t.parent)}function a(t){var e=t.behaviors[t.callCount-1];return e&&e.isPresent()?e:i(t)}var s=n(316),u=n(319),c=n(565),l=n(146),f=n(130),h=0,p={create:function(){var t=function(){return a(t).invoke(this,arguments)};t.id="stub#"+h++;var e=t;return t=s(t),t.func=e,l(t,r),t.instantiateFake=r.create,t.displayName="stub",t.toString=f.toString,t.defaultBehavior=null,t.behaviors=[],t},resetBehavior:function(){var t;if(this.defaultBehavior=null,this.behaviors=[],delete this.returnValue,delete this.returnArgAt,this.returnThis=!1,this.fakes)for(t=0;t<this.fakes.length;t++)this.fakes[t].resetBehavior()},onCall:function(t){return this.behaviors[t]||(this.behaviors[t]=c.create(this)),this.behaviors[t]},onFirstCall:function(){return this.onCall(0)},onSecondCall:function(){return this.onCall(1)},onThirdCall:function(){return this.onCall(2)}};for(var d in c)c.hasOwnProperty(d)&&!p.hasOwnProperty(d)&&"create"!=d&&"withArgs"!=d&&"invoke"!=d&&(p[d]=function(t){return function(){return this.defaultBehavior=this.defaultBehavior||c.create(this),this.defaultBehavior[t].apply(this.defaultBehavior,arguments),this}}(d));l(r,p),t.exports=r},function(t){"use strict";t.exports=function(t){switch(t){case 1:return"once";case 2:return"twice";case 3:return"thrice";default:return(t||0)+" times"}}},function(t){"use strict";function e(t,e){for(var n in e)r.call(t,n)||(t[n]=e[n])}function n(t){return"function"==typeof t||!!(t&&t.constructor&&t.call&&t.apply)
}var r=Object.prototype.hasOwnProperty;t.exports=function(t,i,o){if(!t)throw new TypeError("Should wrap property of object");if("function"!=typeof o)throw new TypeError("Method wrapper should be function");var a,s=t[i];if(n(s)){if(s.restore&&s.restore.sinon)a=new TypeError("Attempted to wrap "+i+" which is already wrapped");else if(s.calledBefore){var u=s.returns?"stubbed":"spied on";a=new TypeError("Attempted to wrap "+i+" which is already "+u)}}else a=new TypeError("Attempted to wrap "+typeof s+" property "+i+" as function");if(a)throw s&&s.stackTrace&&(a.stack+="\n--------------\n"+s.stackTrace),a;var c=t.hasOwnProperty?t.hasOwnProperty(i):r.call(t,i);return t[i]=o,o.displayName=i,o.stackTrace=new Error("Stack Trace for original").stack,o.restore=function(){c||delete t[i],t[i]===o&&(t[i]=s)},o.restore.sinon=!0,e(o,s),o}},function(t,e,n){(function(e){"use strict";function r(t,e){this.type=t,this.target=i.defaults(e,null),this.timeStamp=Date.now()}var i=n(16),o=n(13);i.inherits(r,e.Event),"undefined"==typeof e.Event&&(e.Event=r),t.exports=o.Event=r}).call(e,function(){return this}())},function(t,e){(function(e){t.exports=e}).call(e,{})},,,,,,,,,,,,,,,,,,,function(t,e,n){function r(t,e,n){var r={showHidden:e,seen:[],stylize:function(t){return t}};return i(r,t,"undefined"==typeof n?2:n)}function i(t,n,r){if(n&&"function"==typeof n.inspect&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var d=n.inspect(r);return"string"!=typeof d&&(d=i(t,d,r)),d}var b=o(t,n);if(b)return b;if(y(n)){if("outerHTML"in n)return n.outerHTML;try{if(document.xmlVersion){var _=new XMLSerializer;return _.serializeToString(n)}var w="http://www.w3.org/1999/xhtml",x=document.createElementNS(w,"_");return x.appendChild(n.cloneNode(!1)),html=x.innerHTML.replace("><",">"+n.innerHTML+"<"),x.innerHTML="",html}catch(E){}}var C=g(n),T=t.showHidden?v(n):C;if(0===T.length||p(n)&&(1===T.length&&"stack"===T[0]||2===T.length&&"description"===T[0]&&"stack"===T[1])){if("function"==typeof n){var S=m(n),A=S?": "+S:"";return t.stylize("[Function"+A+"]","special")}if(f(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(h(n))return t.stylize(Date.prototype.toUTCString.call(n),"date");if(p(n))return a(n)}var k="",O=!1,M=["{","}"];if(l(n)&&(O=!0,M=["[","]"]),"function"==typeof n){var S=m(n),A=S?": "+S:"";k=" [Function"+A+"]"}if(f(n)&&(k=" "+RegExp.prototype.toString.call(n)),h(n)&&(k=" "+Date.prototype.toUTCString.call(n)),p(n))return a(n);if(0===T.length&&(!O||0==n.length))return M[0]+k+M[1];if(0>r)return f(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var j;return j=O?s(t,n,r,C,T):T.map(function(e){return u(t,n,r,C,e,O)}),t.seen.pop(),c(j,k,M)}function o(t,e){switch(typeof e){case"undefined":return t.stylize("undefined","undefined");case"string":var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string");case"number":return 0===e&&1/e===-1/0?t.stylize("-0","number"):t.stylize(""+e,"number");case"boolean":return t.stylize(""+e,"boolean")}return null===e?t.stylize("null","null"):void 0}function a(t){return"["+Error.prototype.toString.call(t)+"]"}function s(t,e,n,r,i){for(var o=[],a=0,s=e.length;s>a;++a)o.push(Object.prototype.hasOwnProperty.call(e,String(a))?u(t,e,n,r,String(a),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(u(t,e,n,r,i,!0))}),o}function u(t,e,n,r,o,a){var s,u;if(e.__lookupGetter__&&(e.__lookupGetter__(o)?u=e.__lookupSetter__(o)?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):e.__lookupSetter__(o)&&(u=t.stylize("[Setter]","special"))),r.indexOf(o)<0&&(s="["+o+"]"),u||(t.seen.indexOf(e[o])<0?(u=null===n?i(t,e[o],null):i(t,e[o],n-1),u.indexOf("\n")>-1&&(u=a?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n"))):u=t.stylize("[Circular]","special")),"undefined"==typeof s){if(a&&o.match(/^\d+$/))return u;s=JSON.stringify(""+o),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+u}function c(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function l(t){return Array.isArray(t)||"object"==typeof t&&"[object Array]"===d(t)}function f(t){return"object"==typeof t&&"[object RegExp]"===d(t)}function h(t){return"object"==typeof t&&"[object Date]"===d(t)}function p(t){return"object"==typeof t&&"[object Error]"===d(t)}function d(t){return Object.prototype.toString.call(t)}var m=n(369),v=n(457),g=n(454);t.exports=r;var y=function(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName}},,,,,,,,,,,,function(t,e,n){"use strict";function r(t,e,n,r){i.defineAttribute(this,"sampleRate","readonly",r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"length","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"duration","readonly",n/r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"numberOfChannels","readonly",e,function(t){throw new TypeError(i.formatter.concat(this,t))}),Object.defineProperties(this,{$name:{value:"AudioBuffer"},$context:{value:t}}),this._data=new Array(e);for(var o=0;e>o;o++)this._data[o]=new Float32Array(n)}var i=n(16),o=n(61),a=n(13),s=function(){throw new TypeError("Illegal constructor: use audioContext.createBuffer(numberOfChannels: number, length: number, sampleRate: number)")};i.inherits(r,s),r.exports=s,s.prototype.getChannelData=function(t){var e=new o(this,"getChannelData",[{name:"channel",type:"number"}]);return e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),e.assert(t>=0&&t<this._data.length,function(){throw new TypeError(e.form+"; channel index ("+t+") exceeds number of channels (#{"+this._data.length+"})")}),this._data[t]},r.prototype.toJSON=function(){var t={name:this.$name,sampleRate:this.sampleRate,length:this.length,duration:this.duration,numberOfChannels:this.numberOfChannels};return this.$context.VERBOSE_JSON&&(t.data=this._data.map(function(t){return Array.prototype.slice.call(t)})),t},t.exports=a.AudioBuffer=r},function(t){"use strict";function e(t){return/[aeiou]/i.test(t.charAt(0))?"an":"a"}t.exports=e},function(t,e,n){"use strict";function r(t,e,n){var r="";return t?(r+=t.constructor.name,e&&(r+="#"+e)):r+=e,r+="(",r+=n.map(function(t){return t.name+": "+t.type}).join(", "),r+=")"}function i(t,e){var n="";return t=t.replace(/^optional\s*/,"").trim(),n+="should be "+a(t)+" "+t+", ",n+="but got: "+s(e)}function o(t,e){return t.constructor.name+"#"+e}var a=n(353),s=n(631);t.exports={methodForm:r,shouldBeButGot:i,concat:o}},function(t,e){(function(e){"use strict";function n(t,n){switch(n){case"boolean":return"boolean"==typeof t;case"function":return"function"==typeof t;case"number":return"number"==typeof t&&!isNaN(t);case"string":return"string"==typeof t;case"null":return null===t}if(/[A-Z]/.test(n.charAt(0))&&"function"==typeof e[n])return t instanceof e[n];var i=/^enum\s*{(.*?)}$/.exec(n);return i?r(t,i[1].split(",").map(function(t){return t.trim()})):!1}function r(t,e){return e.some(function(e){return/^\d+$/.test(e)?t===+e:t===e})}t.exports=function(t,e){return e.split("|").some(function(e){return n(t,e.trim())})}}).call(e,function(){return this}())},,,,,,,,,,,,function(t,e,n){(function(t){"use strict";function r(){i(),o(),a()}function i(){var e=document.createElement("div");e.id="mocha",document.body.appendChild(e),mocha.setup("bdd"),u.use(c),u.use(l),t.expect=u.expect,t.sinon=f}function o(){n(599)}function a(){var t=[];mocha.run().on("test end",function(t){t.err&&(console.log("%cFailed Spec: %c%s\n %c%s","color: black; font: 16px sans-serif","color: black; font: bold 16px sans-serif",t.title,"color: red; font: bold 1em sans-serif",t.err.message),console.error(t.err.stack))}).on("test end",function(e){t.push("passed"===e.state?{fullName:e.title,status:"passed"}:e.pending?{fullName:e.title,status:"pending"}:{fullName:e.title,status:"failed",failedExpectations:[{message:e.err.message,stack:e.err.stack}]})}).on("suite end",function(e){if(e.root){var n=window.__coverage__||null,r=JSON.stringify({specs:t,coverage:n}),i=new XMLHttpRequest;i.open("POST","/api/test",!0),i.setRequestHeader("Content-Type","application/json"),i.send(r)}})}var s=function(t){return t&&t.__esModule?t["default"]:t};e.main=r,n(560),n(594),n(596);var u=s(n(444)),c=s(n(443)),l=s(n(562)),f=s(n(563));Object.defineProperty(e,"__esModule",{value:!0})}).call(e,function(){return this}())},function(t){/*!
	 * Chai - getActual utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e){return e.length>4?e[4]:t._obj}},function(t){/*!
	 * Chai - getName utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t){if(t.name)return t.name;var e=/^\s?function ([^(]*)\(/.exec(t);return e&&e[1]?e[1]:""}},function(t,e,n){/*!
	 * ## parsePath(path)
	 *
	 * Helper function used to parse string object
	 * paths. Use in conjunction with `_getPathValue`.
	 *
	 *      var parsed = parsePath('myobject.property.subprop');
	 *
	 * ### Paths:
	 *
	 * * Can be as near infinitely deep and nested
	 * * Arrays are also valid using the formal `myobject.document[3].property`.
	 * * Literal dots and brackets (not delimiter) must be backslash-escaped.
	 *
	 * @param {String} path
	 * @returns {Object} parsed
	 * @api private
	 */
function r(t){var e=t.replace(/([^\\])\[/g,"$1.["),n=e.match(/(\\\.|[^.]+?)+/g);return n.map(function(t){var e=/^\[(\d+)\]$/,n=e.exec(t);return n?{i:parseFloat(n[1])}:{p:t.replace(/\\([.\[\]])/g,"$1")}})}/*!
	 * ## _getPathValue(parsed, obj)
	 *
	 * Helper companion function for `.parsePath` that returns
	 * the value located at the parsed address.
	 *
	 *      var value = getPathValue(parsed, obj);
	 *
	 * @param {Object} parsed definition from `parsePath`.
	 * @param {Object} object to search against
	 * @param {Number} object to search against
	 * @returns {Object|Undefined} value
	 * @api private
	 */
function i(t,e,n){var r,i=e;n=void 0===n?t.length:n;for(var o=0,a=n;a>o;o++){var s=t[o];i?("undefined"!=typeof s.p?i=i[s.p]:"undefined"!=typeof s.i&&(i=i[s.i]),o==a-1&&(r=i)):r=void 0}return r}/*!
	 * Chai - getPathInfo utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
var o=n(371);t.exports=function(t,e){var n=r(t),a=n[n.length-1],s={parent:n.length>1?i(n,e,n.length-1):e,name:a.p||a.i,value:i(n,e)};return s.exists=o(s.name,s.parent),s}},function(t,e,n){/*!
	 * Chai - hasProperty utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
var r=n(374),i={number:Number,string:String};t.exports=function(t,e){var n=r(e);return"null"===n||"undefined"===n?!1:(i[n]&&"object"!=typeof e&&(e=new i[n](e)),t in e)}},function(t,e,n){/*!
	 * Chai - flag utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependancies
	 */
var r=n(340),i=n(184);t.exports=function(t){var e=r(t),n=Object.prototype.toString.call(t);if(i.truncateThreshold&&e.length>=i.truncateThreshold){if("[object Function]"===n)return t.name&&""!==t.name?"[Function: "+t.name+"]":"[Function]";if("[object Array]"===n)return"[ Array("+t.length+") ]";if("[object Object]"===n){var o=Object.keys(t),a=o.length>2?o.splice(0,2).join(", ")+", ...":o.join(", ");return"{ Object ("+a+") }"}return e}return e}},function(t){/*!
	 * Chai - transferFlags utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){var r=t.__flags||(t.__flags=Object.create(null));e.__flags||(e.__flags=Object.create(null)),n=3===arguments.length?n:!0;for(var i in r)(n||"object"!==i&&"ssfi"!==i&&"message"!=i)&&(e.__flags[i]=r[i])}},function(t){/*!
	 * Chai - type utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Detectable javascript natives
	 */
var e={"[object Arguments]":"arguments","[object Array]":"array","[object Date]":"date","[object Function]":"function","[object Number]":"number","[object RegExp]":"regexp","[object String]":"string"};t.exports=function(t){var n=Object.prototype.toString.call(t);return e[n]?e[n]:null===t?"null":void 0===t?"undefined":t===Object(t)?"object":typeof t}},,,,,,function(t,e,n){"use strict";function r(t){return t.fakes||(t.fakes=[]),t.fakes}function i(t,e){for(var n=r(t),i=0,o=n.length;o>i;i+=1)"function"==typeof n[i][e]&&n[i][e]()}function o(t){for(var e=r(t),n=0;n<e.length;)e.splice(n,1)}var a=n(316),s=n(317),u=n(383),c=[].push,l=Object.prototype.hasOwnProperty;t.exports={verify:function(){i(this,"verify")},restore:function(){i(this,"restore"),o(this)},reset:function(){i(this,"reset")},verifyAndRestore:function(){var t;try{this.verify()}catch(e){t=e}if(this.restore(),t)throw t},add:function(t){return c.call(r(this),t),t},spy:function(){return this.add(a.apply(null,arguments))},stub:function(t,e,n){if(e){var r=t[e];if("function"!=typeof r){if(!l.call(t,e))throw new TypeError("Cannot stub non-existent own property "+e);return t[e]=n,this.add({restore:function(){t[e]=r}})}}if(!e&&t&&"object"==typeof t){var i=s.apply(null,arguments);for(var o in i)"function"==typeof i[o]&&this.add(i[o]);return i}return this.add(s.apply(null,arguments))},mock:function(){return this.add(u.apply(null,arguments))},inject:function(t){var e=this;return t.spy=function(){return e.spy.apply(e,arguments)},t.stub=function(){return e.stub.apply(e,arguments)},t.mock=function(){return e.mock.apply(e,arguments)},t}}},function(t,e){"use strict";var n=Object.prototype.hasOwnProperty;e.defaultConfig={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},e.getConfig=function(t){var r={};t=t||{};var i=e.defaultConfig;for(var o in i)n.call(i,o)&&(r[o]=n.call(t,o)?t[o]:i[o]);return r}},function(t,e,n){"use strict";function r(t){var e="number"==typeof t.minCalls;return!e||t.callCount>=t.minCalls}function i(t){return"number"!=typeof t.maxCalls?!1:t.callCount===t.maxCalls}function o(t,e){return d&&d.isMatcher(t)?t.test(e):!0}function a(t){return 0==t?"never called":"called "+m(t)}function s(t){var e=t.minCalls,n=t.maxCalls;if("number"==typeof e&&"number"==typeof n){var r=m(e);return e!==n&&(r="at least "+r+" and at most "+m(n)),r}return"number"==typeof e?"at least "+m(e):"at most "+m(n)}var u=n(146),c=n(317),l=n(316),f=n(304),h=n(303),p=n(315),d=n(160),m=n(318),v=Array.prototype.push,g=Array.prototype.slice;t.exports={minCalls:1,maxCalls:1,create:function(e){var n=u(c(),t.exports);return delete n.create,n.method=e,n},invoke:function(t,e,n){return this.verifyCallAllowed(e,n),l.invoke.apply(this,arguments)},atLeast:function(t){if("number"!=typeof t)throw new TypeError("'"+t+"' is not number");return this.limitsSet||(this.maxCalls=null,this.limitsSet=!0),this.minCalls=t,this},atMost:function(t){if("number"!=typeof t)throw new TypeError("'"+t+"' is not number");return this.limitsSet||(this.minCalls=null,this.limitsSet=!0),this.maxCalls=t,this},never:function(){return this.exactly(0)},once:function(){return this.exactly(1)},twice:function(){return this.exactly(2)},thrice:function(){return this.exactly(3)},exactly:function(t){if("number"!=typeof t)throw new TypeError("'"+t+"' is not a number");return this.atLeast(t),this.atMost(t)},met:function(){return!this.failed&&r(this)},verifyCallAllowed:function(e,n){if(i(this)&&(this.failed=!0,t.exports.fail(this.method+" already called "+m(this.maxCalls))),"expectedThis"in this&&this.expectedThis!==e&&t.exports.fail(this.method+" called with "+e+" as thisValue, expected "+this.expectedThis),"expectedArguments"in this){n||t.exports.fail(this.method+" received no arguments, expected "+f(this.expectedArguments)),n.length<this.expectedArguments.length&&t.exports.fail(this.method+" received too few arguments ("+f(n)+"), expected "+f(this.expectedArguments)),this.expectsExactArgCount&&n.length!==this.expectedArguments.length&&t.exports.fail(this.method+" received too many arguments ("+f(n)+"), expected "+f(this.expectedArguments));for(var r=0,a=this.expectedArguments.length;a>r;r+=1)o(this.expectedArguments[r],n[r])||t.exports.fail(this.method+" received wrong arguments "+f(n)+", didn't match "+this.expectedArguments.toString()),h(this.expectedArguments[r],n[r])||t.exports.fail(this.method+" received wrong arguments "+f(n)+", expected "+f(this.expectedArguments))}},allowsCall:function(t,e){if(this.met()&&i(this))return!1;if("expectedThis"in this&&this.expectedThis!==t)return!1;if(!("expectedArguments"in this))return!0;if(e=e||[],e.length<this.expectedArguments.length)return!1;if(this.expectsExactArgCount&&e.length!=this.expectedArguments.length)return!1;for(var n=0,r=this.expectedArguments.length;r>n;n+=1){if(!o(this.expectedArguments[n],e[n]))return!1;if(!h(this.expectedArguments[n],e[n]))return!1}return!0},withArgs:function(){return this.expectedArguments=g.call(arguments),this},withExactArgs:function(){return this.withArgs.apply(this,arguments),this.expectsExactArgCount=!0,this},on:function(t){return this.expectedThis=t,this},toString:function(){var t=(this.expectedArguments||[]).slice();this.expectsExactArgCount||v.call(t,"[...]");var e=p.toString.call({proxy:this.method||"anonymous mock expectation",args:t}),n=e.replace(", [...","[, ...")+" "+s(this);return this.met()?"Expectation met: "+n:"Expected "+n+" ("+a(this.callCount)+")"},verify:function(){return this.met()?t.exports.pass(this.toString()):t.exports.fail(this.toString()),!0},pass:function(){},fail:function(t){var e=new Error(t);throw e.name="ExpectationError",e}}},function(t,e,n){"use strict";function r(t){return t?r.create(t):o.create("Anonymous mock")}function i(t,e){if(t)for(var n=0,r=t.length;r>n;n+=1)e(t[n])}var o=n(382),a=n(146),s=n(319),u=n(315),c=Array.prototype.push;t.exports=a(r,{create:function(t){if(!t)throw new TypeError("object is null");var e=a({},r);return e.object=t,delete e.create,e},expects:function(t){if(!t)throw new TypeError("method is falsy");if(this.expectations||(this.expectations={},this.proxies=[]),!this.expectations[t]){this.expectations[t]=[];var e=this;s(this.object,t,function(){return e.invokeMethod(t,this,arguments)}),c.call(this.proxies,t)}var n=o.create(t);return c.call(this.expectations[t],n),n},restore:function(){var t=this.object;i(this.proxies,function(e){"function"==typeof t[e].restore&&t[e].restore()})},verify:function(){var t=this.expectations||{},e=[],n=[];return i(this.proxies,function(r){i(t[r],function(t){t.met()?c.call(n,t.toString()):c.call(e,t.toString())})}),this.restore(),e.length>0?o.fail(e.concat(n).join("\n")):n.length>0&&o.pass(e.concat(n).join("\n")),!0},invokeMethod:function(t,e,n){var r,i=this.expectations&&this.expectations[t],a=i&&i.length||0;for(r=0;a>r;r+=1)if(!i[r].met()&&i[r].allowsCall(e,n))return i[r].apply(e,n);var s,l=[],f=0;for(r=0;a>r;r+=1)i[r].allowsCall(e,n)?s=s||i[r]:f+=1,c.call(l,"    "+i[r].toString());return 0===f?s.apply(e,n):(l.unshift("Unexpected call: "+u.toString.call({proxy:t,args:n})),void o.fail(l.join("\n")))}})},function(t,e,n){"use strict";function r(t,e,n,r){r&&(!e.injectInto||n in e.injectInto?l.call(t.args,r):(e.injectInto[n]=r,t.injectedKeys.push(n)))}function i(e){var n=o.create(t.exports);return e.useFakeServer&&("object"==typeof e.useFakeServer&&(n.serverPrototype=e.useFakeServer),n.useFakeServer()),e.useFakeTimers&&("object"==typeof e.useFakeTimers?n.useFakeTimers.apply(n,e.useFakeTimers):n.useFakeTimers()),n}var o=n(130),a=n(146),s=n(380),u=n(570),c=n(160),l=[].push;t.exports=a(o.create(s),{useFakeTimers:function(){return this.clock=u.apply(null,arguments),this.add(this.clock)},serverPrototype:{},useFakeServer:function(){var t=this.serverPrototype||sinon.fakeServer;return t&&t.create?(this.server=t.create(),this.add(this.server)):null},inject:function(t){return s.inject.call(this,t),this.clock&&(t.clock=this.clock),this.server&&(t.server=this.server,t.requests=this.server.requests),t.match=c,t},restore:function(){s.restore.apply(this,arguments),this.restoreContext()},restoreContext:function(){if(this.injectedKeys){for(var t=0,e=this.injectedKeys.length;e>t;t++)delete this.injectInto[this.injectedKeys[t]];this.injectedKeys=[]}},create:function(e){if(!e)return o.create(t.exports);var n=i(e);n.args=n.args||[],n.injectedKeys=[],n.injectInto=e.injectInto;var a,s,u=n.inject({});if(e.properties)for(var c=0,l=e.properties.length;l>c;c++)a=e.properties[c],s=u[a]||"sandbox"==a&&n,r(n,e,a,s);else r(n,e,"sandbox",s);return n},match:c})},function(t,e,n){"use strict";function r(t){function e(){var e=i.getConfig(i.config);e.injectInto=e.injectIntoThis&&this||e.injectInto;var n,r,a=o(e),s=!1,u=Array.prototype.slice.call(arguments);if(u.length>0&&"function"==typeof u[arguments.length-1]){var c=u[arguments.length-1];u[arguments.length-1]=function(t){if(t)throw a.restore(),n;a.verifyAndRestore(),c(t)},s=!0}var l=u.concat(a.args);try{r=t.apply(this,l)}catch(f){n=f}if(!s){if("undefined"!=typeof n)throw a.restore(),n;a.verifyAndRestore()}return r}var n=typeof t;if("function"!==n)throw new TypeError("sinon.test needs to wrap a test function, got "+n);return t.length?function(){return e.apply(this,arguments)}:e}var i=n(381),o=n(384).create;r.config={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},t.exports=r},function(t){"use strict";t.exports=function(t){if(null===t)return"null";if(void 0===t)return"undefined";var e=Object.prototype.toString.call(t);return e.substring(8,e.length-1).toLowerCase()}},function(t,e,n){var r,i;(!0&&n(321)&&function(o){r=o,i="function"==typeof r?r.call(e,n,e,t):r,!(void 0!==i&&(t.exports=i))}||"object"==typeof t&&function(e){t.exports=e()}||function(t){this.samsam=t()})(function(){function t(t){var e=t;return"number"==typeof t&&t!==e}function e(t){return f.toString.call(t).split(/[ \]]/)[1]}function n(t){if("Arguments"===e(t))return!0;if("object"!=typeof t||"number"!=typeof t.length||"Array"===e(t))return!1;if("function"==typeof t.callee)return!0;try{t[t.length]=6,delete t[t.length]}catch(n){return!0}return!1}function r(t){if(!t||1!==t.nodeType||!h)return!1;try{t.appendChild(h),t.removeChild(h)}catch(e){return!1}return!0}function i(t){var e,n=[];for(e in t)f.hasOwnProperty.call(t,e)&&n.push(e);return n}function o(t){return"function"==typeof t.getTime&&t.getTime()==t.valueOf()}function a(t){return 0===t&&1/t===-1/0}function s(e,n){return e===n||t(e)&&t(n)?0!==e||a(e)===a(n):void 0}function u(a,u){function c(t){return"object"!=typeof t||null===t||t instanceof Boolean||t instanceof Date||t instanceof Number||t instanceof RegExp||t instanceof String?!1:!0}function l(t,e){var n;for(n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var h=[],p=[],d=[],m=[],v={};return function g(a,u,y,b){var _=typeof a,w=typeof u;if(a===u||t(a)||t(u)||null==a||null==u||"object"!==_||"object"!==w)return s(a,u);if(r(a)||r(u))return!1;var x=o(a),E=o(u);if(!(!x&&!E||x&&E&&a.getTime()===u.getTime()))return!1;if(a instanceof RegExp&&u instanceof RegExp&&a.toString()!==u.toString())return!1;var C=e(a),T=e(u),S=i(a),A=i(u);if(n(a)||n(u)){if(a.length!==u.length)return!1}else if(_!==w||C!==T||S.length!==A.length)return!1;var k,O,M,j,R,N,I,P,D,L,B;for(O=0,M=S.length;M>O;O++){if(k=S[O],!f.hasOwnProperty.call(u,k))return!1;if(j=a[k],R=u[k],N=c(j),I=c(R),P=N?l(h,j):-1,D=I?l(p,R):-1,L=-1!==P?d[P]:y+"["+JSON.stringify(k)+"]",B=-1!==D?m[D]:b+"["+JSON.stringify(k)+"]",v[L+B])return!0;if(-1===P&&N&&(h.push(j),d.push(L)),-1===D&&I&&(p.push(R),m.push(B)),N&&I&&(v[L+B]=!0),!g(j,R,L,B))return!1}return!0}(a,u,"$1","$2")}function c(t,e){if(0===e.length)return!0;var n,r,i,o;for(n=0,r=t.length;r>n;++n)if(l(t[n],e[0])){for(i=0,o=e.length;o>i;++i)if(!l(t[n+i],e[i]))return!1;return!0}return!1}var l,f=Object.prototype,h="undefined"!=typeof document&&document.createElement("div");return l=function p(t,n){if(n&&"function"==typeof n.test)return n.test(t);if("function"==typeof n)return n(t)===!0;if("string"==typeof n){n=n.toLowerCase();var r="string"==typeof t||!!t;return r&&String(t).toLowerCase().indexOf(n)>=0}if("number"==typeof n)return n===t;if("boolean"==typeof n)return n===t;if("undefined"==typeof n)return"undefined"==typeof t;if(null===n)return null===t;if("Array"===e(t)&&"Array"===e(n))return c(t,n);if(n&&"object"==typeof n){if(n===t)return!0;var i;for(i in n){var o=t[i];if("undefined"==typeof o&&"function"==typeof t.getAttribute&&(o=t.getAttribute(i)),null===n[i]||"undefined"==typeof n[i]){if(o!==n[i])return!1}else if("undefined"==typeof o||!p(o,n[i]))return!1}return!0}throw new Error("Matcher was not a string, a number, a function, a boolean or an object")},{isArguments:n,isElement:r,isDate:o,isNegZero:a,identical:s,deepEqual:u,match:l,keys:i}})},,function(t,e,n){"use strict";function r(){if(!(this instanceof r))throw new TypeError("Failed to construct 'AudioContext': Please use the 'new' operator");A.call(this);var t=new s(this),e=a.sampleRate,n=function(){return this._microCurrentTime/1e6},o=new u(this);i.defineAttribute(this,"destination","readonly",t,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"sampleRate","readonly",e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"currentTime","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"listener","readonly",o,function(t){throw new TypeError(i.formatter.concat(this,t))}),Object.defineProperties(this,{$name:{value:"AudioContext"},$context:{value:this}}),this._microCurrentTime=0,this._processedSamples=0,this._tick=0}var i=n(16),o=n(61),a=n(13),s=n(390),u=n(391),c=n(352),l=n(601),f=n(613),h=n(616),p=n(615),d=n(622),m=n(600),v=n(610),g=n(607),y=n(603),b=n(623),_=n(620),w=n(606),x=n(605),E=n(604),C=n(608),T=n(619),S=n(621),A=n(306);n(614),n(612),i.inherits(r,A),r.WEB_AUDIO_TEST_API_VERSION=a.VERSION,r.prototype.createBuffer=function(t,e,n){var r=new o(this,null,[{name:"numberOfChannels",type:"number"},{name:"length",type:"number"},{name:"sampleRate",type:"number"}]);return r.validateArguments(arguments,function(t){throw new TypeError(r.form+"; "+t)}),new c(this,t,e,n)},r.prototype.decodeAudioData=function(t,e,n){var r=new o(this,"decodeAudioData",[{name:"audioData",type:"ArrayBuffer"},{name:"successCallback",type:"function"},{name:"errorCallback",type:"optional function"}]);r.validateArguments(arguments,function(t){throw new TypeError(r.form+"; "+t)}),e=i.defaults(e,i.NOP),n=i.defaults(n,i.NOP);var a=this;setTimeout(function(){a.DECODE_AUDIO_DATA_FAILED?n():e(a.DECODE_AUDIO_DATA_RESULT||new c(a,2,1024,a.sampleRate))},0)},r.prototype.createBufferSource=function(){return new l(this)},r.prototype.createMediaElementSource=function(t){var e=new o(this,"createMediaElementSource",[{name:"mediaElement",type:"HTMLMediaElement"}]);return e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),new f(this,t)},r.prototype.createMediaStreamSource=function(t){var e=new o(this,"createMediaStreamSource",[{name:"mediaStream",type:"MediaStream"}]);return e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),new h(this,t)},r.prototype.createMediaStreamDestination=function(){return new p(this)},r.prototype.createScriptProcessor=function(t,e,n){var r=new o(this,"createScriptProcessor",[{name:"bufferSize",type:"enum { 256, 512, 1024, 2048, 4096, 8192, 16384 }"},{name:"numberOfInputChannels",type:"optional number"},{name:"numberOfOutputChannels",type:"optional number"}]);return r.validateArguments(arguments,function(t){throw new TypeError(r.form+"; "+t)}),t=i.defaults(t,0),e=i.defaults(e,2),n=i.defaults(n,2),new d(this,t,e,n)},r.prototype.createAnalyser=function(){return new m(this)},r.prototype.createGain=function(){return new v(this)},r.prototype.createDelay=function(t){var e=new o(this,"createDelay",[{name:"maxDelayTime",type:"optional number"}]);return e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),t=i.defaults(t,1),new g(this,t)},r.prototype.createBiquadFilter=function(){return new y(this)},r.prototype.createWaveShaper=function(){return new b(this)},r.prototype.createPanner=function(){return new _(this)},r.prototype.createConvolver=function(){return new w(this)},r.prototype.createChannelSplitter=function(t){var e=new o(this,"createChannelSplitter",[{name:"numberOfOutputs",type:"optional number"}]);return e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),t=i.defaults(t,6),new x(this,t)},r.prototype.createChannelMerger=function(t){var e=new o(this,"createChannelMerger",[{name:"numberOfInputs",type:"optional number"}]);return e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),t=i.defaults(t,6),new E(this,t)},r.prototype.createDynamicsCompressor=function(){return new C(this)},r.prototype.createOscillator=function(){return new T(this)},r.prototype.createPeriodicWave=function(t,e){function n(t,e){return 4096<t.length?"length of "+e+" array ("+t.length+") exceeds allow maximum of 4096":void 0}var r=new o(this,"createPeriodicWave",[{name:"real",type:"Float32Array",validate:n},{name:"imag",type:"Float32Array",validate:n}]);return r.validateArguments(arguments,function(t){throw new TypeError(r.form+"; "+t)}),r.assert(t.length===e.length,function(){throw new TypeError(r.form+"; length of real array ("+t.length+") and length of imaginary array ("+e.length+") must match")}),new S(t,e)},r.prototype.toJSON=function(){return this.destination.toJSON([])},r.prototype.$process=function(t){this._process(i.toMicroseconds(t))},r.prototype.$processTo=function(t){t=i.toMicroseconds(t),this._microCurrentTime<t&&this._process(t-this._microCurrentTime)},r.prototype.$reset=function(){this._microCurrentTime=0,this._processedSamples=0,this.destination.$inputs.forEach(function(t){t.disconnect()})},r.prototype._process=function(t){for(var e=this._microCurrentTime+t;this._microCurrentTime<e;){var n=Math.min(this._microCurrentTime+1e3,e),r=Math.floor(n/1e6*this.sampleRate),i=r-this._processedSamples;this._microCurrentTime=n,this._processedSamples=r,this.destination.$process(i,++this._tick)}},t.exports=a.AudioContext=r},function(t,e,n){"use strict";function r(t){o.call(this,t,{name:"AudioDestinationNode",numberOfInputs:1,numberOfOutputs:0,channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"});var e=2;i.defineAttribute(this,"maxChannelCount","readonly",e,function(t){throw new TypeError(i.formatter.concat(this,t))})}var i=n(16),o=n(43),a=n(13),s=function(){throw new TypeError("Illegal constructor")};i.inherits(s,o),i.inherits(r,s),r.exports=s,t.exports=a.AudioDestinationNode=r},function(t,e,n){"use strict";function r(t){var e=1,n=343.3;i.defineAttribute(this,"dopplerFactor","number",e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"speedOfSound","number",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),Object.defineProperties(this,{$name:{value:"AudioListener"},$context:{value:t}})}var i=n(16),o=n(61),a=n(13),s=function(){throw new TypeError("Illegal constructor")};i.inherits(r,s),r.exports=s,s.prototype.setPosition=function(){var t=new o(this,"setPosition",[{name:"x",type:"number"},{name:"y",type:"number"},{name:"z",type:"number"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},s.prototype.setOrientation=function(){var t=new o(this,"setOrientation",[{name:"x",type:"number"},{name:"y",type:"number"},{name:"z",type:"number"},{name:"xUp",type:"number"},{name:"yUp",type:"number"},{name:"zUp",type:"number"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},s.prototype.setVelocity=function(){var t=new o(this,"setVelocity",[{name:"x",type:"number"},{name:"y",type:"number"},{name:"z",type:"number"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},t.exports=a.AudioListener=r},function(t){"use strict";function e(t){return t.hasOwnProperty("$id")?t.$name+"#"+t.$id:t.$name}t.exports=e},function(t){"use strict";function e(t){var e=0;if("number"==typeof t)return e=Math.floor(1e3*t*1e3)||0,Math.max(n,Math.min(e,r));var i=/^([0-5]\d):([0-5]\d)\.(\d\d\d)$/.exec(t);return i?(e+=+i[1],e*=60,e+=+i[2],e*=1e3,e+=+i[3],e*=1e3,Math.max(n,Math.min(e,r))):e}var n=0,r=864e8;t.exports=e},,,,,function(t,e,n){"use strict";var r=n(437).Cachier;describe("Cachier",function(){var t=void 0,e=0,n=function(t){return function(e){return function(){var n=function(r){var i=Promise.resolve().then(e);return r>=t?i:i["catch"](function(){return Promise.delay(100).then(function(){return n(r+1)})})};return n(1)}}};beforeEach(function(){return t=new r("test."+(new Date).getTime()+"."+ ++e)}),afterEach(n(3)(function(){return t.destroyDatabase()})),describe(".connection",function(){it("should be a promise which fullfill with the db connection",function(){return t.connection.then(function(t){expect(t.constructor+"").to.match(/DBDatabase/)})})}),describe("#save",function(){it("stores a blob",function(){var e=new Blob(["hello"]);return expect(t.save("wow",e)).to.eventually.be.ok}),it("rejects when key is invalid",function(){var e=new Blob(["hello"]);return expect(t.save(void 0,e)).to.be.rejected})}),describe("with a blob saved",function(){beforeEach(function(){var e=new Blob(["hello"]);return t.save("wow2",e,{name:"example1"}).delay(10)}),describe("#load",function(){it("should return the blob value",function(){return t.load("wow2").then(function(t){var e=t.blob,n=t.metadata;expect(e.size).to.equal(5),expect(n).to.deep.equal({name:"example1"})})})}),describe("#save",function(){it("should replace content with a new blob",function(){var e=new Blob(["world!"]);return t.save("wow2",e).delay(10).then(function(){return t.load("wow2")}).then(function(t){var e=t.blob,n=t.metadata;expect(e.size).to.equal(6),expect(n).to.equal(void 0)})})}),describe("#delete",function(){it("should remove the blob",function(){return t["delete"]("wow3").then(function(){return expect(t.load("wow3")).to.be.rejected})})})}),describe("#destroyDatabase",function(){it("may be called twice",function(){return t.destroyDatabase()})}),describe("without blob support in IndexedDB",function(){it("still works",function(){var e=new Blob(["hello"],{type:"text/plain"});return t._NO_BLOB=!0,t.save("wow4",e).delay(10).then(function(){return t.load("wow4")}).then(function(t){var e=t.blob;expect(e.size).to.equal(5),expect(e.type).to.equal("text/plain")})})})})},function(){"use strict";describe("The specs",function(){it("runs",function(){expect({runs:!0}.runs).to.equal(!0)})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(163)),o=n(161).playerWithBMS;describe("PlayerAudio",function(){function t(t){e=t,r={playAuto:sinon.stub().returns({}),playNote:sinon.stub().returns({}),playFree:sinon.stub().returns({})},n=new i({player:e,waveFactory:r})}var e=void 0,n=void 0,r=void 0;it("should play autokeysounds on correct time",function(){t({notechart:{autos:[{time:1,keysound:"0x"},{time:2,keysound:"0y"},{time:2,keysound:"0z"}],notes:[]},options:{autosound:!1}}),n.update(0),expect(r.playAuto).to.have.callCount(0),n.update(1),expect(r.playAuto).to.have.callCount(1),expect(r.playAuto).to.have.been.calledWith("0x"),n.update(2),expect(r.playAuto).to.have.callCount(3)}),it("should play notes automatically when autosound is on",function(){t({notechart:{autos:[],notes:[{time:1,keysound:"0x"}]},options:{autosound:!0}}),n.update(1),expect(r.playNote).to.have.been.calledWith("0x")}),it("should not play notes automatically when autosound is off",function(){t({notechart:{autos:[],notes:[{time:1,keysound:"0x"}]},options:{}}),n.update(1),void expect(r.playNote).to.not.have.been.called}),it("should play notes ahead of time",function(){t({notechart:{autos:[{time:1,keysound:"0x"}],notes:[]},options:{}}),n.update(.999),expect(r.playAuto).to.have.been.calledWith("0x"),expect(r.playAuto.getCall(0).args[1]).to.be.closeTo(.001,1e-5)}),it("should play hit notes",function(){t(o()),n.update(.999,{notifications:{sounds:[{note:{keysound:"0x"},type:"hit",judgment:1}]},stats:{}}),expect(r.playNote).to.have.been.calledWith("0x")}),it("badly hit note should sound off-pitch",function(){t(o());var e={bad:sinon.stub()};r.playNote.returns(e),n.update(.999,{notifications:{sounds:[{note:{keysound:"0x"},type:"hit",judgment:4}]},stats:{}}),void expect(e.bad).to.have.been.called}),it("should work even without audio",function(){t(o()),r.playNote.returns(null),n.update(.999,{notifications:{sounds:[{note:{keysound:"0x"},type:"hit",judgment:4}]},stats:{}})}),it("should stop sound when broken",function(){t(o());var e={keysound:"0x"},i={stop:sinon.spy()};r.playNote.returns(i),n.update(.999,{notifications:{sounds:[{note:e,type:"hit"}]},stats:{}}),n.update(1.1,{notifications:{sounds:[{note:e,type:"break"}]},stats:{}}),void expect(i.stop).to.have.been.called}),it("should play sounds when hitting blank space",function(){t(o()),n.update(.999,{notifications:{sounds:[{note:{keysound:"0x"},type:"free"}]},stats:{}}),expect(r.playFree).to.have.been.calledWith("0x")}),it("should play hit note once",function(){t(o());var e={keysound:"0x"};n.update(.999,{notifications:{sounds:[{note:e,type:"hit"}]},stats:{}}),n.update(1,{notifications:{sounds:[{note:e,type:"hit"}]},stats:{}}),expect(r.playNote).to.have.callCount(1)})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(154));describe("WaveFactory",function(){var t=void 0,e=void 0,n=void 0,r=void 0,o=void 0;beforeEach(function(){t={},e={play:sinon.stub()},n={"wow.wav":e},r={"0z":"wow.wav"},o=new i(t,n,r)}),describe("playAuto",function(){it("should play an autokeysound",function(){o.playAuto("0z",.1),expect(e.play).to.have.been.calledWith(.1)})}),describe("playNote",function(){it("should play the keysound",function(){o.playNote("0z",.1),expect(e.play).to.have.been.calledWith(.1)}),it("should stop old sound",function(){var t={stop:sinon.spy()};return e.play.returns(t),o.playNote("0z",0),o.playNote("0z",0),Promise.delay(0).then(function(){return expect(t.stop).to.have.callCount(1)})})}),describe("playFree",function(){it("should play the keysound",function(){o.playFree("0z"),void expect(e.play).to.have.been.called})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(101));describe("NoteArea",function(){it("allows querying the visible note from a list of notes",function(){var t=[{position:1,column:"A"},{position:2,column:"A"},{position:3,column:"A"},{position:4,column:"A"},{position:5,column:"A"},{position:6,column:"A"},{position:10,end:{position:12},column:"B"},{position:11,column:"C"}],e=new i(t,[]);expect(e.getVisibleNotes(1.5,3.5)).to.have.length(2),expect(e.getVisibleNotes(2.5,3.5,1)).to.have.length(2),expect(e.getVisibleNotes(-1,7)).to.have.length(6),expect(e.getVisibleNotes(8,10.1)).to.have.length(1),expect(e.getVisibleNotes(8,10.1)).to.have.length(1),expect(e.getVisibleNotes(8,14)).to.have.length(2),expect(e.getVisibleNotes(11.5,14)).to.have.length(1),expect(e.getVisibleNotes(12.5,14)).to.have.length(0)}),it("allows querying barlines",function(){var t=new i([],[{beat:0,position:0},{beat:4,position:4},{beat:7,position:7}]);expect(t.getVisibleBarLines(1.5,4.5)).to.have.length(1)})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(164)),o=n(161),a=o.tap,s=o.notechart,u=o.playerWithBMS;describe("PlayerDisplay",function(){function t(t){o=new i(t)}function e(t,e,n){c=o.update(t,e,n)}function n(){return{speed:1,input:{get:function(){return{value:0,changed:!1}}},notifications:{judgments:[]},getNoteStatus:sinon.stub().returns("unjudged"),getNoteJudgment:sinon.stub().returns(0),stats:{score:0}}}function r(t){return Object.assign(n(),t)}var o=void 0,c=void 0;it("reacts to input",function(){var n=function(t){return r({input:new Map(t)})};t({notechart:s(),columns:["wow"],options:{placement:"center"}}),e(555,.5,n([["wow",{value:0,changed:!1}]])),expect(c.wow_active).to.equal(0),e(557,2.5,n([["wow",{value:1,changed:!0}]])),expect(c.wow_active).to.equal(1),expect(c.wow_down).to.equal(557),e(558,3.5,n([["wow",{value:0,changed:!0}]])),expect(c.wow_active).to.equal(0),expect(c.wow_up).to.equal(558)}),describe("with note",function(){beforeEach(function(){t(u("#BPM 60\n#00111:11"))}),it("displays unjudged notes",function(){e(3.95,3.95,n()),expect(c.note_1).to.have.length(1)}),it("hides judged notes",function(){var t=a(n(),function(t){return t.getNoteStatus.returns("judged")});e(3.95,3.95,t),void expect(c.note_1).to.be.empty})}),describe("with long note",function(){beforeEach(function(){t(u("#BPM 60\n#00151:1111"))}),it("displays unjudged long notes",function(){e(3.95,3.95,n()),expect(c.longnote_1).to.have.length(1),void expect(c.longnote_1[0].active).to.be["false"],void expect(c.longnote_1[0].missed).to.be["false"]}),it("displays holding long notes",function(){var t=a(n(),function(t){return t.getNoteJudgment.returns(1)});e(3.95,3.95,t),void expect(c.longnote_1[0].active).to.be["true"]}),it("displays holding long notes event it is bad",function(){var t=a(n(),function(t){return t.getNoteJudgment.returns(4)});e(3.95,3.95,t),void expect(c.longnote_1[0].active).to.be["true"]}),it("displays missed long notes",function(){var t=n();t.getNoteJudgment.returns(-1),t.getNoteStatus.returns("judged"),e(3.95,3.95,t),void expect(c.longnote_1[0].missed).to.be["true"]})}),describe("with notification",function(){beforeEach(function(){t(u())}),it("sets judgment time",function(){var t={judgment:1,delta:0,combo:123,column:"SC"};e(12,34,r({notifications:{judgments:[t]}})),expect(c.judge_1).to.equal(12)}),it("sets judgment missed time",function(){var t={judgment:-1,delta:0,combo:0,column:"SC"};e(12,34,r({notifications:{judgments:[t]}})),expect(c.judge_missed).to.equal(12)}),it("sets combo",function(){var t={judgment:1,delta:0,combo:123,column:"SC"};e(12,34,r({notifications:{judgments:[t]}})),expect(c.combo).to.equal(123)}),it("sets note explode time",function(){var t={judgment:1,delta:0,combo:123,column:"SC"};e(12,34,r({notifications:{judgments:[t]}})),expect(c.SC_explode).to.equal(12)}),it("does not set note explode time if missed",function(){var t={judgment:-1,delta:0,combo:123,column:"SC"};e(12,34,r({notifications:{judgments:[t]}})),void expect(c.SC_explode).to.be.empty})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(155));describe("GameInput",function(){var t=void 0,e=void 0;beforeEach(function(){t=new i,e={out:{},get:function(){return this.out}},t.use(e)}),it("should return control with default value of 0",function(){expect(t.get("wow").value).to.equal(0)}),describe("Control#value",function(){it("should return control with correct value",function(){e.out={wow:-1},t.update(),expect(t.get("wow").value).to.equal(-1)})}),describe("Control#changed",function(){it("should return changed state between last update",function(){t.update(),expect(t.get("wow").changed).to.equal(!1),e.out={wow:0},t.update(),expect(t.get("wow").changed).to.equal(!1),e.out={wow:-1},t.update(),expect(t.get("wow").changed).to.equal(!0),e.out={wow:1},t.update(),expect(t.get("wow").changed).to.equal(!0),e.out={wow:1},t.update(),expect(t.get("wow").changed).to.equal(!1),t.update(),expect(t.get("wow").changed).to.equal(!1),e.out={wow:0},t.update(),expect(t.get("wow").changed).to.equal(!0)})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(10)),o=r(n(166));describe("TouchPlugin",function(){it("should get value when touching",function(){var t=new o({refs:{p1_1:new Set([{getBounds:function(){return new i.Rectangle(64,64,64,64)}}]),p1_2:new Set([{getBounds:function(){return new i.Rectangle(128,64,64,64)}}])},input:[{x:72,y:72,id:"touch1"},{x:32,y:32,id:"touch2"}]}),e=t.get();expect(e.p1_1).to.equal(1),expect(e.p1_2).to.equal(0)})})},function(t,e,n){"use strict";
var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(167));describe("SamplesLoader",function(){var t,e,n;beforeEach(function(){t={file:sinon.stub()},e={sample:sinon.stub()},n=new i(t,e)}),describe("#loadFiles",function(){it("should not include undecodable audio",function(){return t.file.returns(Promise.reject()),t.file.withArgs("a.wav").returns(Promise.resolve({read:function(){return Promise.resolve("ok1")}})),e.sample.withArgs("ok1").returns(Promise.reject(new Error(".."))),expect(n.loadFiles(["a.wav"])).to.eventually.deep.eq({})}),it("should try mp3",function(){return t.file.returns(Promise.reject()),t.file.withArgs("a.mp3").returns(Promise.resolve({read:function(){return Promise.resolve("ok1")}})),e.sample.withArgs("ok1").returns(Promise.resolve("ok2")),expect(n.loadFiles(["a.wav"])).to.eventually.deep.eq({"a.wav":"ok2"})}),it("should not include failed matches",function(){return t.file.returns(Promise.reject()),expect(n.loadFiles(["a.wav"])).to.eventually.deep.eq({})})})})},function(t,e,n){"use strict";var r=n(161).notechart;describe("Notechart",function(){describe(".fromBMSChart",function(){it("should work",function(){var t=r("#00111:01\n#00101:02");expect(t.notes).to.have.length(1),expect(t.autos).to.have.length(1),expect(t.notes[0].beat).to.equal(4)}),it("should work with long notes",function(){var t=r("#00151:0101");expect(t.notes).to.have.length(1),expect(t.notes[0].beat).to.equal(4),expect(t.notes[0].end.beat).to.equal(6)})}),describe("#samples",function(){it("should return an array of all used samples",function(){var t=r("#WAV0X wow.wav\n#00101:0x0x");expect(t.samples).to.deep.equal(["wow.wav"])})}),describe("#keysounds",function(){it("should return an object of all keysounds",function(){var t=r("#WAV0X wow.wav\n#WAV0Y wow.wav\n#WAV0Z foon.wav\n#00101:0x0x0y0y0Z0Z");expect(t.keysounds).to.deep.equal({"0x":"wow.wav","0y":"wow.wav","0z":"foon.wav"})})}),describe("#barLines",function(){it("should return the list of beat with barlines",function(){var t=r("#00111:0001\n#00102:0.75");expect(t.barLines).to.deep.equal([{beat:0,position:0},{beat:4,position:4},{beat:7,position:7}])}),it("should consider long notes",function(){var t=r("#00151:0001\n#00251:0001");expect(t.barLines).to.deep.equal([{beat:0,position:0},{beat:4,position:4},{beat:8,position:8},{beat:12,position:12}])})}),describe("#secondsToBeat",function(){it("should convert seconds to beat",function(){var t=r("#BPM 120");expect(t.secondsToBeat(1)).to.equal(2)})}),describe("#secondsToPosition",function(){it("should convert seconds to position",function(){var t=r("#BPM 120");expect(t.secondsToPosition(1)).to.equal(2)})}),describe("#columns",function(){it("should return columns in notechart",function(){var t=r("#00111:11");expect(t.columns).to.deep.equal(["SC","1","2","3","4","5","6","7"])})}),describe("#info",function(){it("normal note should have 1 combo",function(){var t=r("#00111:11");expect(t.info(t.notes[0]).combos).to.equal(1)}),it("long note should have 2 combos",function(){var t=r("#00151:1111");expect(t.info(t.notes[0]).combos).to.equal(2)})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(169)),o=r(n(156)),a=r(n(155)),s=n(161).notechart;describe("PlayerState",function(){it("updates the input",function(){var t=new i({number:1,columns:["wow"],notechart:s(""),options:{speed:1}}),e={get:function(t){return{name:t}}};t.update(0,e),expect(t.input.get("wow").name).to.equal("p1_wow")}),describe("with player and chart",function(){function t(t){var e=void 0===arguments[1]?{speed:1}:arguments[1];n=s(t),r=new o(n,1,e),u=new i(r),c=new a,l={},c.use({get:function(){return l}})}function e(t,e){l=e,c.update(),u.update(t,c)}var n=void 0,r=void 0,u=void 0,c=void 0,l=void 0;describe("node judging",function(){it("judges notes",function(){t("\n          #BPM 120\n          #00111:0101\n        ");var r=n.notes[0].column;expect(u.getNoteStatus(n.notes[0])).to.equal("unjudged"),expect(u.stats.combo).to.equal(0),expect(u.stats.poor).to.equal(!1),expect(u.stats.totalCombo).to.equal(2),void expect(u.notifications.judgments).to.be.empty,e(1.999,{}),expect(u.getNoteStatus(n.notes[0])).to.equal("unjudged"),e(2,{p1_1:1}),expect(u.getNoteStatus(n.notes[0])).to.equal("judged"),expect(u.getNoteJudgment(n.notes[0])).to.equal(1),expect(u.getNoteStatus(n.notes[1])).to.equal("unjudged"),expect(u.notifications.judgments[0]).to.deep.equal({judgment:1,combo:1,delta:0,column:r}),expect(u.stats.poor).to.equal(!1),e(2.1,{p1_1:0}),e(5,{p1_1:0}),expect(u.getNoteStatus(n.notes[1])).to.equal("judged"),expect(u.getNoteJudgment(n.notes[1])).to.equal(-1),expect(u.notifications.judgments[0]).to.deep.equal({judgment:-1,combo:0,delta:2,column:r}),expect(u.stats.poor).to.equal(!0)}),it("judges multiple notes in different column",function(){t("\n          #BPM 120\n          #00111:01\n          #00112:01\n        "),e(2,{p1_1:1,p1_2:1}),expect(u.getNoteStatus(n.notes[0])).to.equal("judged"),expect(u.getNoteStatus(n.notes[1])).to.equal("judged")}),it("judges single note from one column at a time",function(){t("\n          #BPM 480\n          #00111:01010100000000000000000000000000\n        "),e(.531,{p1_1:1}),expect(u.getNoteStatus(n.notes[0])).to.equal("judged"),expect(u.getNoteStatus(n.notes[1])).to.equal("unjudged"),expect(u.getNoteStatus(n.notes[2])).to.equal("unjudged"),e(.531,{p1_1:0}),e(.531,{p1_1:1}),expect(u.getNoteStatus(n.notes[0])).to.equal("judged"),expect(u.getNoteStatus(n.notes[1])).to.equal("judged"),expect(u.getNoteStatus(n.notes[2])).to.equal("unjudged"),e(.531,{p1_1:0}),e(.531,{p1_1:1}),expect(u.getNoteStatus(n.notes[0])).to.equal("judged"),expect(u.getNoteStatus(n.notes[1])).to.equal("judged"),expect(u.getNoteStatus(n.notes[2])).to.equal("judged"),expect(u.getNoteJudgment(n.notes[0])).to.gt(1),expect(u.getNoteJudgment(n.notes[1])).to.eq(1),expect(u.getNoteJudgment(n.notes[2])).to.gt(1)}),it("leaves note unjudged when bad and there are closer note",function(){t("\n          #BPM 120\n          #00111:01010100000000000000000000000000\n        "),e(2.125,{p1_1:1}),expect(u.getNoteStatus(n.notes[0])).to.equal("unjudged"),expect(u.getNoteStatus(n.notes[1])).to.equal("judged"),expect(u.getNoteStatus(n.notes[2])).to.equal("unjudged")}),describe("with long note",function(){var r=void 0;beforeEach(function(){t("\n            #BPM 120\n            #00151:0101\n          "),r=n.notes[0]}),it("judges long note",function(){e(2,{p1_1:1}),expect(u.getNoteStatus(r)).to.equal("active"),expect(u.getNoteJudgment(r)).to.equal(1),expect(u.notifications.judgments[0].judgment).to.equal(1),e(3,{p1_1:0}),expect(u.getNoteStatus(r)).to.equal("judged"),expect(u.getNoteJudgment(r)).to.equal(1),expect(u.notifications.judgments[0].judgment).to.equal(1)}),it("judges missed long note",function(){e(2.3,{p1_1:1}),expect(u.getNoteStatus(r)).to.equal("judged"),expect(u.getNoteJudgment(r)).to.equal(-1)}),it("judges long note lifted too fast as missed",function(){e(2,{p1_1:1}),e(2.01,{p1_1:0}),expect(u.getNoteStatus(r)).to.equal("judged"),expect(u.getNoteJudgment(r)).to.equal(-1)}),it("judges long note lifted too slow as missed",function(){e(2,{p1_1:1}),e(4,{p1_1:1}),expect(u.getNoteStatus(r)).to.equal("judged"),expect(u.getNoteJudgment(r)).to.equal(-1),expect(u.notifications.judgments[0]).to.deep.equal({judgment:-1,combo:0,delta:1,column:r.column})})}),describe("with long scratch note",function(){var r=void 0;beforeEach(function(){t("\n            #BPM 120\n            #00156:0101\n          "),r=n.notes[0]}),it("ends automatically",function(){e(2,{p1_SC:1}),expect(u.getNoteStatus(r)).to.equal("active"),expect(u.getNoteJudgment(r)).to.equal(1),expect(u.notifications.judgments[0].judgment).to.equal(1),e(4,{p1_SC:1}),expect(u.getNoteStatus(r)).to.equal("judged"),expect(u.getNoteJudgment(r)).to.equal(1),expect(u.notifications.judgments[0].judgment).to.equal(1)})}),describe("with long scratch note next to each other",function(){beforeEach(function(){t("\n#BPM 120\n#00156:0100000000000000000000000000000000000000000000000000000000000001\n#00256:0100000000000000000000000000000000000000000000000000000000000001\n          ")}),it("should switch to next one on change",function(){e(2,{p1_SC:1}),e(4,{p1_SC:-1}),expect(u.getNoteStatus(n.notes[0])).to.equal("judged"),expect(u.getNoteStatus(n.notes[1])).to.equal("active")})}),describe("sound notifications",function(){it("notifies of note hit",function(){t("\n            #BPM 120\n            #00111:0102\n          "),e(2,{p1_1:1}),expect(u.notifications.sounds[0].note).to.equal(n.notes[0]),expect(u.notifications.sounds[0].type).to.equal("hit")}),it("should notify missed notes as break",function(){t("\n            #BPM 120\n            #00111:01\n          "),e(5,{p1_1:0}),expect(u.notifications.sounds[0].note).to.equal(n.notes[0]),expect(u.notifications.sounds[0].type).to.equal("break")}),it("notifies of free keysound hit",function(){t("\n            #BPM 60\n            #00111:01\n            #00211:02\n          "),e(4,{p1_1:1}),e(4,{p1_1:0}),e(4,{p1_1:1}),expect(u.notifications.sounds[0].note).to.equal(n.notes[0]),expect(u.notifications.sounds[0].type).to.equal("free"),e(4,{p1_1:0}),void expect(u.notifications.sounds).to.be.empty,e(5,{p1_1:1}),expect(u.notifications.sounds[0].note).to.equal(n.notes[0]),e(5,{p1_1:0}),e(7,{p1_1:1}),expect(u.notifications.sounds[0].note).to.equal(n.notes[1])})})}),describe("speed",function(){it("infers speed from player",function(){t("",{speed:2}),expect(u.speed).to.equal(2)}),it("updates speed on dedicated buttons",function(){t("",{speed:2}),e(1,{p1_speedup:1}),expect(u.speed).to.equal(2.5),e(1.2,{p1_speedup:0,p1_speeddown:1}),expect(u.speed).to.equal(2)}),it("supports fine-grained speed modifications",function(){t("",{speed:2}),e(1,{p1_speedup:1,select:1}),expect(u.speed).to.equal(2.1)}),it("supports pinching to zoom",function(){t("",{speed:2}),e(1,{p1_pinch:300}),e(1.2,{p1_pinch:450}),expect(u.speed).to.equal(3)})})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(157)),o=n(161).notechart;describe("PlayerStats",function(){describe("#score",function(){it("returns the score",function(){var t=new i(o("#00111:1111111111"));expect(t.score).to.equal(0),t.handleJudgment(1),t.handleJudgment(1),t.handleJudgment(1),t.handleJudgment(1),t.handleJudgment(1),expect(t.score).to.equal(555555)})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},i=function(t){return t&&t.__esModule?t["default"]:t},o=i(n(63)),a=r(n(62));describe("ProgressFormatters",function(){describe("BYTES_FORMATTER",function(){it("should return blank for indeterminate",function(){var t=new o;expect(a.BYTES_FORMATTER(t)).to.equal("")}),it("should format as human readable size",function(){var t=new o;t.report(1,1024),expect(a.BYTES_FORMATTER(t)).to.equal("1b / 1kb")})}),describe("EXTRA_FORMATTER",function(){it("should just use the extra",function(){var t=new o;t.report(1,1024,"one.wav"),expect(a.EXTRA_FORMATTER(t)).to.equal("one.wav")})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(63));describe("Progress",function(){describe("#watch",function(){it("should report current progress when watched",function(){var t=new i,e=sinon.spy();t.report(1,10),t.watch(e),expect(e).to.have.callCount(1),expect(e).to.have.been.calledWith(t)})}),describe("#toString",function(){it("should return blank string when no progress",function(){var t=new i;expect(t.toString()).to.equal("")}),it("should return a string representation of the progress",function(){var t=new i;t.report(1,10),expect(t.toString()).to.equal("1 / 10")}),it("should use a formatter",function(){var t=new i;t.report(1,10),t.formatter=function(t){return t.progress+""},expect(t.toString()).to.equal("0.1")})}),describe("#report",function(){it("should fire to all watchers",function(){var t=new i,e=sinon.spy();t.report(1,10),t.report(2,10),t.watch(e),t.report(3,10),t.report(4,10),expect(e).to.have.callCount(3)}),it("should return a function to unsubscribe",function(){var t=new i,e=sinon.spy();t.report(1,10),t.report(2,10);var n=t.watch(e);t.report(3,10),n(),t.report(4,10),expect(e).to.have.callCount(2)})}),describe("#progress",function(){it("returns progress in fraction",function(){var t=new i;t.report(1,10),expect(t.progress).to.equal(.1)}),it("returns null in unavailable",function(){var t=new i;expect(t.progress).to.equal(null)})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},i=function(t){return t&&t.__esModule?t["default"]:t},o=i(n(63)),a=r(n(58));describe("ProgressUtils",function(){describe(".fixed",function(){it("should report for fixed number of items",function(){var t=new o,e=a.fixed(10,t);expect(t.current).to.equal(0),expect(t.total).to.equal(10),e("wow"),expect(t.current).to.equal(1),expect(t.total).to.equal(10),expect(t.extra).to.equal("wow")})}),describe(".wrapPromise",function(){it("should report number of fulfilled promises",function(){var t=new o,e=a.wrapPromise(t,function(t){return t}),n=(e(new Promise(function(){})),e(Promise.resolve(1))),r=(e(Promise.reject(new Error("no"))),e(Promise.resolve(3)));return Promise.all([n,r]).then(function(){expect(t.current).to.equal(2),expect(t.total).to.equal(4)})})}),describe(".bind",function(){it("should bind from one progress to another",function(){var t=new o,e=new o;t.report(10,20),a.bind(t,e),expect(e.current).to.equal(10),expect(e.total).to.equal(20),t.report(15,25),expect(e.current).to.equal(15),expect(e.total).to.equal(25)})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(170));describe("BemusePackageResources",function(){describe("#file",function(){var t;beforeEach(function(){t=new i("/spec/resources/fixtures/a/")}),it("returns a file",function(){return expect(t.file("do.mp3")).to.be.fulfilled}),it("rejects if file not found",function(){return expect(t.file("wow.mp3")).to.be.rejected}),it("can be read",function(){return expect(t.file("mi.mp3").then(function(t){return t.read()}).then(function(t){return t.byteLength})).to.eventually.eq(30093)}),it("cannot read if not bemuse file",function(){return t=new i("/spec/resources/fixtures/b/"),expect(t.file("do.mp3").then(function(t){return t.read()})).to.be.rejected}),it("data is correct",function(){return t.file("mi.mp3").then(function(t){return t.read()}).then(function(t){return new Uint8Array(t)}).then(function(t){expect([t[0],t[1],t[2]]).to.deep.equal([255,251,144])})})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(59));n(625),describe("SamplingMaster",function(){var t=void 0,e=void 0;before(function(){WebAudioTestAPI.use()}),beforeEach(function(){t=new AudioContext,e=new i(t)}),describe("#unmute",function(){it("unmutes the audio",function(){var n=t.createGain();sinon.stub(t,"createGain").returns(n),sinon.spy(n,"connect"),sinon.spy(n,"disconnect"),e.unmute(),void expect(t.createGain).to.have.been.called,void expect(n.connect).to.have.been.called,void expect(n.disconnect).to.have.been.called})}),describe("#sample",function(){it("should coerce blob",function(){return e.sample(new Blob([]))}),it("should coerce array buffer",function(){return e.sample(new ArrayBuffer(0))}),it("should reject when decoding failed",function(){return t.DECODE_AUDIO_DATA_FAILED=!0,expect(e.sample(new ArrayBuffer(0))["finally"](function(){return t.DECODE_AUDIO_DATA_FAILED=!1})).to.be.rejected}),describe("#play",function(){var n=void 0,r=void 0,i=void 0;beforeEach(function(){return r=t.createBufferSource(),i=t.createBuffer(1,44100,44100),r.buffer=i,sinon.stub(t,"createBufferSource").returns(r),sinon.spy(r,"start"),e.sample(new Blob([])).then(function(t){return n=t})}),it("should play a buffer source",function(){n.play(),void expect(t.createBufferSource).to.have.been.called,expect(r.start).to.have.been.calledWith(0)}),it("should play a buffer source with delay",function(){t.$processTo(1),n.play(20),void expect(t.createBufferSource).to.have.been.called,expect(r.start).to.have.been.calledWith(21)}),void function(){try{return new Event("wat").type="customevent",it}catch(t){return it.skip}}()("should call #stop when playing finished",function(){var e=n.play();sinon.spy(e,"stop"),t.$processTo(1.5),void expect(e.stop).to.have.been.called}),describe("#stop",function(){it("should stop the buffer source",function(){var t=n.play();sinon.spy(r,"stop"),t.stop(),void expect(r.stop).to.have.been.called}),it("can be called multiple times",function(){var t=n.play();sinon.spy(r,"stop"),t.stop(),t.stop(),t.stop(),void expect(r.stop).to.have.been.calledOnce}),it("should call #onstop",function(){var t=n.play();t.onstop=sinon.spy(),t.stop(),void expect(t.onstop).to.have.been.called})}),describe("#bad",function(){it("should change pitch of sound",function(){var t=n.play();t.bad(),expect(r.playbackRate.value).not.to.equal(1)})})})}),describe("#destroy",function(){var t=void 0;beforeEach(function(){return e.sample(new Blob([])).then(function(e){return t=e})}),it("should stop all samples",function(){var n=t.play(),r=t.play(),i=t.play();sinon.spy(n,"stop"),sinon.spy(r,"stop"),sinon.spy(i,"stop"),e.destroy(),void expect(n.stop).to.have.been.called,void expect(r.stop).to.have.been.called,void expect(i.stop).to.have.been.called}),it("can no longer create samples",function(){return e.destroy(),expect(e.sample(new Blob([]))).to.be.rejected}),it("only destroys once",function(){var n=t.play();sinon.spy(n,"destroy"),e.destroy(),e.destroy(),expect(n.destroy).to.have.callCount(1)})}),after(function(){WebAudioTestAPI.unuse()})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(45));describe("Scintillator Expression",function(){describe("()",function(){it("should parse",function(){var t=new i("a+b");expect(t({a:1,b:5})).to.equal(6)})}),describe("#constant",function(){it("should be false when containing variables",function(){var t=new i("a+b");void expect(t.constant).to.be["false"]}),it("should be true when only contains number",function(){var t=new i("-1.25");void expect(t.constant).to.be["true"]})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=n(158),o=i._compile,a=i._attrs,s=i.Animation,u=r(n(29)),c=function(t){return u(u.parseXML(t).documentElement)};describe("Scintillator::Animation",function(){describe("_attrs",function(){it("lists all attributes of an element",function(){var t=c('<keyframe t="0" x="10" y="30" />')[0];expect(a(t)).to.deep.equal({t:"0",x:"10",y:"30"})})}),describe("_compile",function(){it("compiles animation into keyframes",function(){var t=c('<animation>\n        <keyframe t="0" x="10" y="30" />\n        <keyframe t="2" x="20" />\n        <keyframe t="5" x="15" y="20" />\n      </animation>');expect(o(t)).to.deep.equal({on:"",data:[{name:"x",keyframes:[{time:0,value:10,ease:"linear"},{time:2,value:20,ease:"linear"},{time:5,value:15,ease:"linear"}]},{name:"y",keyframes:[{time:0,value:30,ease:"linear"},{time:5,value:20,ease:"linear"}]}]})}),it("throws when there is no time",function(){var t=c("<animation>\n        <keyframe />\n      </animation>");expect(function(){return o(t)}).to["throw"](Error)})}),describe("#_properties",function(){it("should return a set of properties",function(){var t=s.compile(null,c('<group>\n        <animation>\n          <keyframe t="0" x="10" />\n          <keyframe t="1" x="20" />\n        </animation>\n        <animation>\n          <keyframe t="0" y="10" />\n          <keyframe t="1" y="20" />\n        </animation>\n      </group>'));expect(Array.from(t._properties)).to.deep.equal(["x","y"])})}),describe("#_events",function(){it("list distinct events",function(){var t=s.compile(null,c('<group>\n        <animation />\n        <animation />\n        <animation on="exit" />\n        <animation on="exit" />\n      </group>'));expect(t._events).to.deep.equal(["","exit"])})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t:{"default":t}},i=function(t){return t&&t.__esModule?t["default"]:t},o=i(n(30)),a=r(n(102)),s=function(t){return"/spec/scintillator/fixtures/"+t};describe("Scintillator",function(){describe("#load",function(){it("should load skin and return skin node",o.wrap(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("bare.xml"));case 2:e=t.sent,expect(e.width).to.equal(123),expect(e.height).to.equal(456);case 5:case"end":return t.stop()}},t,this)}))),it("should reject if invalid",function(){return expect(a.load(s("invalid_tag.xml"))).to.be.rejected})}),describe("Context",function(){it("should instantiate and able to destroy",o.wrap(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("bare.xml"));case 2:e=t.sent,n=new a.Context(e),n.render({}),n.destroy();case 6:case"end":return t.stop()}},t,this)}))),describe("#input",function(){function t(t,e,n){r.view.dispatchEvent(new MouseEvent("mouse"+t,{clientX:e,clientY:n}))}function e(t,e,n){var i=new Event("touch"+t);i.touches=e,i.changedTouches=n,r.view.dispatchEvent(i)}var n=void 0,r=void 0;beforeEach(o.wrap(regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("bare.xml"));case 2:n=t.sent,r=new a.Context(n),r.render({}),r.view.style.position="fixed",r.view.style.top="0",r.view.style.left="0",document.body.appendChild(r.view);case 9:case"end":return t.stop()}},i,this)}))),afterEach(function(){r.destroy(),document.body.removeChild(r.view)}),it("should report touches/mouse inside the region",function(){t("move",10,10),t("down",10,10),expect(r.input).to.deep.equal([{x:10,y:10,id:"mouse"}]);var n={identifier:1,clientX:80,clientY:80};e("start",[n],[n]),expect(r.input).to.deep.equal([{x:10,y:10,id:"mouse"},{x:80,y:80,id:"touch1"}]),t("move",20,20),expect(r.input).to.deep.equal([{x:20,y:20,id:"mouse"},{x:80,y:80,id:"touch1"}]),t("up",10,10),expect(r.input).to.deep.equal([{x:80,y:80,id:"touch1"}]),e("end",[],[n]),expect(r.input).to.deep.equal([])})}),describe("#refs",function(){it("should be a set of refs to the display object",o.wrap(regeneratorRuntime.mark(function t(){var e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("refs.xml"));case 2:e=t.sent,n=new a.Context(e),n.render({}),expect(Array.from(n.refs.a)[0]).to.equal(n.stage.children[0]),n.destroy();case 7:case"end":return t.stop()}},t,this)})))})}),describe("Expressions",function(){it("should be parsed and processed",o.wrap(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("expr_basic.xml"));case 2:e=t.sent,n=new a.Context(e),n.render({}),r=n.stage,expect(r.children[0].x).to.equal(6),expect(r.children[0].y).to.equal(7),n.destroy();case 9:case"end":return t.stop()}},t,this)}))),it("should support variables",o.wrap(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.load(s("expr_variables.xml"));case 2:t=e.sent,n=new a.Context(t),r=n.stage,n.render({a:4,b:3}),expect(r.children[0].x).to.equal(7),expect(r.children[0].y).to.equal(12),n.render({a:10,b:20}),expect(r.children[0].x).to.equal(30),expect(r.children[0].y).to.equal(200),n.destroy();case 12:case"end":return e.stop()}},e,this)})))}),describe("SpriteNode",function(){it("should allow setting sprite frame",o.wrap(regeneratorRuntime.mark(function t(){var e,n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("sprite_attrs.xml"));case 2:e=t.sent,n=new a.Context(e),r=n.stage,n.render({}),i=r.children[0].texture.frame,expect(i.width).to.equal(10),expect(i.height).to.equal(11),expect(i.x).to.equal(12),expect(i.y).to.equal(13),n.destroy();case 12:case"end":return t.stop()}},t,this)}))),it("should allow setting visibility, width, height",o.wrap(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.load(s("sprite_attrs.xml"));case 2:t=e.sent,n=new a.Context(t),r=n.stage,n.render({}),i=r.children[0],expect(i.width).to.equal(3),expect(i.height).to.equal(1),expect(i.visible).to.equal(!1),n.destroy();case 11:case"end":return e.stop()}},e,this)}))),it("should reject if blend mode is invalid",function(){return expect(a.load(s("sprite_invalid_blend.xml"))).to.be.rejected})}),describe("TextNode",function(){it("should display text",o.wrap(regeneratorRuntime.mark(function t(){var e,n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("text.xml"));case 2:e=t.sent,n=new a.Context(e),r=n.stage,n.render({}),i=r.children[0].children[0],expect(i.text).to.equal("Hello world"),n.destroy();case 9:case"end":return t.stop()}},t,this)}))),it("should center text",o.wrap(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.load(s("text_center.xml"));case 2:t=e.sent,n=new a.Context(t),r=n.stage,n.render({}),i=r.children[0].children[0],expect(i.x).to.be.lessThan(0),n.destroy();case 9:case"end":return e.stop()}},e,this)}))),it("should support data interpolation",o.wrap(regeneratorRuntime.mark(function n(){var t,e,r,i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.load(s("text_interpolation.xml"));case 2:t=n.sent,e=new a.Context(t),r=e.stage,e.render({lol:"wow"}),i=r.children[0].children[0],expect(i.text).to.equal("Hello world wow"),e.destroy();case 9:case"end":return n.stop()}},n,this)})))}),describe("IfNode",function(){it("should display child when correct value",o.wrap(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("expr_if.xml"));case 2:e=t.sent,n=new a.Context(e),r=n.stage,n.render({a:"b"}),expect(r.children[0].children).to.have.length(1),n.destroy();case 8:case"end":return t.stop()}},t,this)}))),it("should not display child when correct value",o.wrap(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.load(s("expr_if.xml"));case 2:t=e.sent,n=new a.Context(t),r=n.stage,n.render({a:"x"}),expect(r.children[0].children).to.have.length(0),n.destroy();case 8:case"end":return e.stop()}},e,this)})))}),describe("ObjectNode",function(){it("should display children",o.wrap(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("expr_object.xml"));case 2:e=t.sent,n=new a.Context(e),r=n.stage,n.render({notes:[]}),expect(r.children[0].children).to.have.length(0),n.render({notes:[{key:"a",y:20}]}),expect(r.children[0].children).to.have.length(1),n.render({notes:[{key:"a",y:20},{key:"b",y:10}]}),expect(r.children[0].children).to.have.length(2),n.render({notes:[{key:"b",y:10}]}),expect(r.children[0].children).to.have.length(1),n.destroy();case 14:case"end":return t.stop()}},t,this)}))),it("should update same array with content changed",o.wrap(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.load(s("expr_object.xml"));case 2:t=e.sent,n=new a.Context(t),r=n.stage,i=[],n.render({notes:i}),expect(r.children[0].children).to.have.length(0),i.push({key:"a",y:20}),n.render({notes:i}),expect(r.children[0].children).to.have.length(1),n.destroy();case 12:case"end":return e.stop()}},e,this)}))),it("should let children get value from item",o.wrap(regeneratorRuntime.mark(function n(){var t,e,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,a.load(s("expr_object_var.xml"));case 2:t=n.sent,e=new a.Context(t),r=e.stage,e.render({notes:[]}),e.render({notes:[{key:"a",y:20}]}),expect(r.children[0].children[0].y).to.equal(20),e.render({notes:[{key:"a",y:20},{key:"b",y:10}]}),expect(r.children[0].children[0].y).to.equal(20),e.render({notes:[{key:"b",y:10}]}),expect(r.children[0].children[0].y).to.equal(10),e.destroy();case 13:case"end":return n.stop()}},n,this)})))}),describe("GroupNode",function(){it("should allow masking",o.wrap(regeneratorRuntime.mark(function t(){var e,n,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("group_mask.xml"));case 2:e=t.sent,n=new a.Context(e),r=n.stage,i=r.children[0].mask,expect(i).not.to.equal(null),n.destroy();case 8:case"end":return t.stop()}},t,this)})))}),describe("AnimationNode",function(){it("should allow animations",o.wrap(regeneratorRuntime.mark(function t(){var e,n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.load(s("animation.xml"));case 2:e=t.sent,n=new a.Context(e),r=n.stage.children[0],n.render({t:0}),expect(r.x).to.equal(10),expect(r.y).to.equal(0),n.render({t:.5}),expect(r.x).to.equal(15),expect(r.y).to.equal(1),n.render({t:1}),expect(r.x).to.equal(20),expect(r.y).to.equal(2),n.destroy();case 15:case"end":return t.stop()}},t,this)}))),it("should allow animations on different events",o.wrap(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.load(s("animation.xml"));case 2:t=e.sent,n=new a.Context(t),r=n.stage.children[0],n.render({t:.5,exitEvent:.5}),expect(r.x).to.equal(50),expect(r.y).to.equal(0),n.render({t:1,exitEvent:.5}),expect(r.x).to.equal(60),expect(r.y).to.equal(50),n.render({t:1.5,exitEvent:.5}),expect(r.x).to.equal(70),expect(r.y).to.equal(100),n.destroy();case 15:case"end":return e.stop()}},e,this)})))})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(90));describe("download",function(){it("resolves with correct type",function(){return expect(i("/spec/utils/fixtures/download/hello.txt").as("text")).to.eventually.match(/hello world/)}),it("rejects for 404",function(){return expect(i("/nonexistant").as("blob")).to.be.rejected}),it("rejects for bad url",function(){return expect(i("file:///nonexistant").as("blob")).to.be.rejected}),it("rejects for XHR error",function(){var t=sinon.stub(XMLHttpRequest.prototype,"send",function(){this.onerror(new Error("..."))});return expect(i("/spec/download/fixtures/hello.txt").as("blob")["finally"](function(){return t.restore()})).to.be.rejected})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(310));describe("Observable",function(){describe("stateless mode",function(){it("should call watchers",function(){var t=sinon.spy(),e=sinon.spy(),n=new i,r=n.watch(t);void expect(t).not.to.have.been.called,n.notify("1"),expect(t).to.have.been.calledWith("1"),n.watch(e),void expect(e).not.to.have.been.called,n.notify("2"),expect(t).to.have.been.calledWith("2"),expect(e).to.have.been.calledWith("2"),r(),n.notify("3"),expect(t).not.to.have.been.calledWith("3"),expect(e).to.have.been.calledWith("3")})}),describe("stateful mode",function(){it("should have value",function(){var t=new i("0");expect(t.value).to.equal("0")}),it("should call watchers",function(){var t=sinon.spy(),e=sinon.spy(),n=new i("0"),r=n.watch(t);expect(t).to.have.been.calledWith("0"),n.value="1",expect(t).to.have.been.calledWith("1"),n.watch(e),expect(e).to.have.been.calledWith("1"),n.value="2",expect(t).to.have.been.calledWith("2"),expect(e).to.have.been.calledWith("2"),r(),n.value="3",expect(t).not.to.have.been.calledWith("3"),expect(e).to.have.been.calledWith("3")})})})},function(t,e,n){"use strict";var r=function(t){return t&&t.__esModule?t["default"]:t},i=r(n(46));
describe("readBlob",function(){it("rejects when cannot read blob",function(){var t=new Blob(["hello world"]),e=sinon.stub(FileReader.prototype,"readAsText",function(){this.onerror(new Error("..."))});return expect(i(t).as("text")["finally"](function(){return e.restore()})).to.be.rejected}),it("resolves with correct type",function(){var t=new Blob(["hello world"]);return expect(i(t).as("text")).to.eventually.equal("hello world")})})},,,,,,,,,,,,,,,,,function(t,e){"use strict";function n(t){function e(){return new Promise(function(e,n){var r=o.open(t,1);r.onupgradeneeded=function(t){var r=t.target.result,i=r.createObjectStore("cachier",{keyPath:"_id"});i.transaction.oncomplete=function(){e(r)},i.transaction.onerror=function(){n(new Error("Cannot upgrade database!"))}},r.onerror=function(){n(new Error("Cannot request database!"))},r.onsuccess=function(t){var n=t.target.result;e(n)}})}function n(t){return new Promise(function(e,n){t.onerror=function(){n(new Error("IndexedDB Error: "+t.error))},t.onblocked=function(){console.log(t),n(new Error("IndexedDB Blocked: "+t))},t.onsuccess=function(t){e(t)}})}function r(t){return new Promise(function(e,n){var r=new FileReader;r.onload=function(){e({buffer:r.result,type:t.type})},r.onerror=function(){n(new Error("Unable to convert blob to object!"))},r.readAsArrayBuffer(t)})}function i(t){return t instanceof Blob?t:t.buffer?new Blob([t.buffer],{type:t.type}):void 0}var o=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB,a=e();return t=t||"cachier",{connection:a,save:function(t,e,i){var o=!!this._NO_BLOB;return a.then(function(a){return Promise.resolve().then(function(){if(o)throw new Error("Requested non-Blob storing mode");var r=a.transaction("cachier","readwrite").objectStore("cachier").put({_id:t,blob:e,metadata:i});return n(r)})["catch"](function(){return console.log("Cannot store as blob, store as data-URL instead."),r(e).then(function(e){var r=a.transaction("cachier","readwrite").objectStore("cachier").put({_id:t,blob:e,metadata:i});return n(r)})})})},load:function(t){return a.then(function(e){var r=e.transaction("cachier").objectStore("cachier").get(t);return n(r).then(function(){var t=r.result;return{blob:i(t.blob),metadata:t.metadata}})})},"delete":function(t){return a.then(function(e){var r=e.transaction("cachier","readwrite").objectStore("cachier")["delete"](t);return n(r)})},destroyDatabase:function(){return a?a.then(function(t){t.close()}).then(function(){var e=o.deleteDatabase(t);return n(e)}).tap(function(){a=null}):Promise.resolve()}}}e["default"]=new n,e.Cachier=n,Object.defineProperty(e,"__esModule",{value:!0})},,,,,,function(t){!function(){"use strict";function e(t,n){function r(t){return"function"==typeof t.always&&"function"==typeof t.done&&"function"==typeof t.fail&&"function"==typeof t.pipe&&"function"==typeof t.progress&&"function"==typeof t.state}function i(t){if("function"!=typeof t._obj.then)throw new TypeError(n.inspect(t._obj)+" is not a thenable.");if(r(t._obj))throw new TypeError("Chai as Promised is incompatible with jQuery's thenables, sorry! Please use a Promises/A+ compatible library (see http://promisesaplus.com/).")}function o(t,e){n.addMethod(h.prototype,t,function(){return i(this),e.apply(this,arguments)})}function a(t,e){n.addProperty(h.prototype,t,function(){return i(this),e.apply(this,arguments)})}function s(t,e){t.then(function(){e()},e)}function u(t,e,n){t.assert(!0,null,e,n.expected,n.actual)}function c(t,e,n){t.assert(!1,e,null,n.expected,n.actual)}function l(t){return"function"==typeof t.then?t:t._obj}function f(t,r,i){if(!n.flag(r,"eventually"))return t.apply(r,i);var o=l(r).then(function(t){return r._obj=t,n.flag(r,"eventually",!1),i?e.transformAsserterArgs(i):i}).then(function(e){return t.apply(r,e),r._obj});e.transferPromiseness(r,o)}var h=t.Assertion,p=t.assert,d=Object.getOwnPropertyNames(h.prototype),m={};d.forEach(function(t){m[t]=Object.getOwnPropertyDescriptor(h.prototype,t)}),a("fulfilled",function(){var t=this,n=l(t).then(function(e){return t._obj=e,u(t,"expected promise not to be fulfilled but it was fulfilled with #{act}",{actual:e}),e},function(e){c(t,"expected promise to be fulfilled but it was rejected with #{act}",{actual:e})});e.transferPromiseness(t,n)}),a("rejected",function(){var t=this,n=l(t).then(function(e){return t._obj=e,c(t,"expected promise to be rejected but it was fulfilled with #{act}",{actual:e}),e},function(e){return u(t,"expected promise not to be rejected but it was rejected with #{act}",{actual:e}),e});e.transferPromiseness(t,n)}),o("rejectedWith",function(t,r){var i=null,o=null;t instanceof RegExp||"string"==typeof t?(r=t,t=null):t&&t instanceof Error?(i=t,t=null,r=null):"function"==typeof t?o=(new t).name:t=null;var a=this,s=l(a).then(function(e){var n=null,s=null;if(t)n="expected promise to be rejected with #{exp} but it was fulfilled with #{act}",s=o;else if(r){var u=r instanceof RegExp?"matching":"including";n="expected promise to be rejected with an error "+u+" #{exp} but it was fulfilled with #{act}",s=r}else i&&(n="expected promise to be rejected with #{exp} but it was fulfilled with #{act}",s=i);a._obj=e,c(a,n,{expected:s,actual:e})},function(e){t&&a.assert(e instanceof t,"expected promise to be rejected with #{exp} but it was rejected with #{act}","expected promise not to be rejected with #{exp} but it was rejected with #{act}",o,e);var s="object"===n.type(e)&&"message"in e?e.message:""+e;r&&null!==s&&void 0!==s&&(r instanceof RegExp&&a.assert(r.test(s),"expected promise to be rejected with an error matching #{exp} but got #{act}","expected promise not to be rejected with an error matching #{exp}",r,s),"string"==typeof r&&a.assert(-1!==s.indexOf(r),"expected promise to be rejected with an error including #{exp} but got #{act}","expected promise not to be rejected with an error including #{exp}",r,s)),i&&a.assert(e===i,"expected promise to be rejected with #{exp} but it was rejected with #{act}","expected promise not to be rejected with #{exp}",i,e)});e.transferPromiseness(a,s)}),a("eventually",function(){n.flag(this,"eventually",!0)}),o("notify",function(t){s(l(this),t)}),o("become",function(t){return this.eventually.deep.equal(t)});var v=d.filter(function(t){return"assert"!==t&&"function"==typeof m[t].value});v.forEach(function(t){h.overwriteMethod(t,function(t){return function(){f(t,this,arguments)}})});var g=d.filter(function(t){return"_obj"!==t&&"function"==typeof m[t].get});g.forEach(function(t){var e=m[t],n=!1;try{n="function"==typeof e.get.call({})}catch(r){}n?h.addChainableMethod(t,function(){function t(){return e.get.call(n).apply(n,arguments)}var n=this;f(t,this,arguments)},function(){var t=e.get;f(t,this)}):h.overwriteProperty(t,function(t){return function(){f(t,this)}})});var y=Object.getOwnPropertyNames(p).filter(function(t){return"function"==typeof p[t]});p.isFulfilled=function(t,e){return new h(t,e).to.be.fulfilled},p.isRejected=function(t,e,n){"string"==typeof e&&(n=e,e=void 0);var r=new h(t,n);return void 0!==e?r.to.be.rejectedWith(e):r.to.be.rejected},p.becomes=function(t,e,n){return p.eventually.deepEqual(t,e,n)},p.doesNotBecome=function(t,e,n){return p.eventually.notDeepEqual(t,e,n)},p.eventually={},y.forEach(function(e){p.eventually[e]=function(r){var i,o=Array.prototype.slice.call(arguments,1),a=arguments[p[e].length-1];"string"==typeof a&&(i=function(e){throw new t.AssertionError(a+"\n\nOriginal reason: "+n.inspect(e))});var u=r.then(function(t){return p[e].apply(p,[t].concat(o))},i);return u.notify=function(t){s(u,t)},u}})}t.exports=e,e.transferPromiseness=function(t,e){t.then=e.then.bind(e)},e.transformAsserterArgs=function(t){return t}}()},function(t,e,n){t.exports=n(445)},function(t,e,n){/*!
	 * chai
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
var r=[],e=t.exports={};/*!
	 * Chai version
	 */
e.version="2.2.0",/*!
	 * Assertion Error
	 */
e.AssertionError=n(463);/*!
	 * Utils for plugins (not exported)
	 */
var i=n(458);e.use=function(t){return~r.indexOf(t)||(t(this,i),r.push(t)),this},/*!
	 * Utility Functions
	 */
e.util=i;/*!
	 * Configuration
	 */
var o=n(184);e.config=o;/*!
	 * Primary `Assertion` prototype
	 */
var a=n(446);e.use(a);/*!
	 * Core Assertions
	 */
var s=n(447);e.use(s);/*!
	 * Expect interface
	 */
var u=n(449);e.use(u);/*!
	 * Should interface
	 */
var c=n(450);e.use(c);/*!
	 * Assert interface
	 */
var l=n(448);e.use(l)},function(t,e,n){/*!
	 * chai
	 * http://chaijs.com
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
var r=n(184);t.exports=function(t,e){/*!
	   * Assertion Constructor
	   *
	   * Creates object for chaining.
	   *
	   * @api private
	   */
function n(t,e,n){o(this,"ssfi",n||arguments.callee),o(this,"object",t),o(this,"message",e)}/*!
	   * Module dependencies.
	   */
var i=t.AssertionError,o=e.flag;/*!
	   * Module export.
	   */
t.Assertion=n,Object.defineProperty(n,"includeStack",{get:function(){return console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack},set:function(t){console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack=t}}),Object.defineProperty(n,"showDiff",{get:function(){return console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff},set:function(t){console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff=t}}),n.addProperty=function(t,n){e.addProperty(this.prototype,t,n)},n.addMethod=function(t,n){e.addMethod(this.prototype,t,n)},n.addChainableMethod=function(t,n,r){e.addChainableMethod(this.prototype,t,n,r)},n.overwriteProperty=function(t,n){e.overwriteProperty(this.prototype,t,n)},n.overwriteMethod=function(t,n){e.overwriteMethod(this.prototype,t,n)},n.overwriteChainableMethod=function(t,n,r){e.overwriteChainableMethod(this.prototype,t,n,r)},/*!
	   * ### .assert(expression, message, negateMessage, expected, actual)
	   *
	   * Executes an expression and check expectations. Throws AssertionError for reporting if test doesn't pass.
	   *
	   * @name assert
	   * @param {Philosophical} expression to be tested
	   * @param {String or Function} message or function that returns message to display if expression fails
	   * @param {String or Function} negatedMessage or function that returns negatedMessage to display if negated expression fails
	   * @param {Mixed} expected value (remember to check for negation)
	   * @param {Mixed} actual (optional) will default to `this.obj`
	   * @param {Boolean} showDiff (optional) when set to `true`, assert will display a diff in addition to the message if expression fails
	   * @api private
	   */
n.prototype.assert=function(t,n,a,s,u,c){var l=e.test(this,arguments);if(!0!==c&&(c=!1),!0!==r.showDiff&&(c=!1),!l){var n=e.getMessage(this,arguments),f=e.getActual(this,arguments);throw new i(n,{actual:f,expected:s,showDiff:c},r.includeStack?this.assert:o(this,"ssfi"))}},/*!
	   * ### ._obj
	   *
	   * Quick reference to stored `actual` value for plugin developers.
	   *
	   * @api private
	   */
Object.defineProperty(n.prototype,"_obj",{get:function(){return o(this,"object")},set:function(t){o(this,"object",t)}})}},function(t){/*!
	 * chai
	 * http://chaijs.com
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e){function n(t,n){n&&E(this,"message",n),t=t.toLowerCase();var r=E(this,"object"),i=~["a","e","i","o","u"].indexOf(t.charAt(0))?"an ":"a ";this.assert(t===e.type(r),"expected #{this} to be "+i+t,"expected #{this} not to be "+i+t)}function r(){E(this,"contains",!0)}function i(t,n){n&&E(this,"message",n);var r=E(this,"object"),i=!1;if("array"===e.type(r)&&"object"===e.type(t)){for(var o in r)if(e.eql(r[o],t)){i=!0;break}}else if("object"===e.type(t)){if(!E(this,"negate")){for(var a in t)new x(r).property(a,t[a]);return}var s={};for(var a in t)s[a]=r[a];i=e.eql(s,t)}else i=r&&~r.indexOf(t);this.assert(i,"expected #{this} to include "+e.inspect(t),"expected #{this} to not include "+e.inspect(t))}function o(){var t=E(this,"object"),e=Object.prototype.toString.call(t);this.assert("[object Arguments]"===e,"expected #{this} to be arguments but got "+e,"expected #{this} to not be arguments")}function a(t,e){e&&E(this,"message",e);var n=E(this,"object");return E(this,"deep")?this.eql(t):void this.assert(t===n,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",t,this._obj,!0)}function s(t,n){n&&E(this,"message",n),this.assert(e.eql(t,E(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",t,this._obj,!0)}function u(t,e){e&&E(this,"message",e);var n=E(this,"object");if(E(this,"doLength")){new x(n,e).to.have.property("length");var r=n.length;this.assert(r>t,"expected #{this} to have a length above #{exp} but got #{act}","expected #{this} to not have a length above #{exp}",t,r)}else this.assert(n>t,"expected #{this} to be above "+t,"expected #{this} to be at most "+t)}function c(t,e){e&&E(this,"message",e);var n=E(this,"object");if(E(this,"doLength")){new x(n,e).to.have.property("length");var r=n.length;this.assert(r>=t,"expected #{this} to have a length at least #{exp} but got #{act}","expected #{this} to have a length below #{exp}",t,r)}else this.assert(n>=t,"expected #{this} to be at least "+t,"expected #{this} to be below "+t)}function l(t,e){e&&E(this,"message",e);var n=E(this,"object");if(E(this,"doLength")){new x(n,e).to.have.property("length");var r=n.length;this.assert(t>r,"expected #{this} to have a length below #{exp} but got #{act}","expected #{this} to not have a length below #{exp}",t,r)}else this.assert(t>n,"expected #{this} to be below "+t,"expected #{this} to be at least "+t)}function f(t,e){e&&E(this,"message",e);var n=E(this,"object");if(E(this,"doLength")){new x(n,e).to.have.property("length");var r=n.length;this.assert(t>=r,"expected #{this} to have a length at most #{exp} but got #{act}","expected #{this} to have a length above #{exp}",t,r)}else this.assert(t>=n,"expected #{this} to be at most "+t,"expected #{this} to be above "+t)}function h(t,n){n&&E(this,"message",n);var r=e.getName(t);this.assert(E(this,"object")instanceof t,"expected #{this} to be an instance of "+r,"expected #{this} to not be an instance of "+r)}function p(t,n){n&&E(this,"message",n);var r=E(this,"object");this.assert(r.hasOwnProperty(t),"expected #{this} to have own property "+e.inspect(t),"expected #{this} to not have own property "+e.inspect(t))}function d(){E(this,"doLength",!0)}function m(t,e){e&&E(this,"message",e);var n=E(this,"object");new x(n,e).to.have.property("length");var r=n.length;this.assert(r==t,"expected #{this} to have a length of #{exp} but got #{act}","expected #{this} to not have a length of #{act}",t,r)}function v(t){var n,r=E(this,"object"),i=!0,o="keys must be given single argument of Array|Object|String, or multiple String arguments";switch(e.type(t)){case"array":if(arguments.length>1)throw new Error(o);break;case"object":if(arguments.length>1)throw new Error(o);t=Object.keys(t);break;default:t=Array.prototype.slice.call(arguments)}if(!t.length)throw new Error("keys required");var a=Object.keys(r),s=t,u=t.length,c=E(this,"any"),l=E(this,"all");if(c||l||(l=!0),c){var f=s.filter(function(t){return~a.indexOf(t)});i=f.length>0}if(l&&(i=t.every(function(t){return~a.indexOf(t)}),E(this,"negate")||E(this,"contains")||(i=i&&t.length==a.length)),u>1){t=t.map(function(t){return e.inspect(t)});var h=t.pop();l&&(n=t.join(", ")+", and "+h),c&&(n=t.join(", ")+", or "+h)}else n=e.inspect(t[0]);n=(u>1?"keys ":"key ")+n,n=(E(this,"contains")?"contain ":"have ")+n,this.assert(i,"expected #{this} to "+n,"expected #{this} to not "+n,s.slice(0).sort(),a.sort(),!0)}function g(t,n,r){r&&E(this,"message",r);var i=E(this,"object");new x(i,r).is.a("function");var o=!1,a=null,s=null,u=null;0===arguments.length?(n=null,t=null):t&&(t instanceof RegExp||"string"==typeof t)?(n=t,t=null):t&&t instanceof Error?(a=t,t=null,n=null):"function"==typeof t?(s=t.prototype.name||t.name,"Error"===s&&t!==Error&&(s=(new t).name)):t=null;try{i()}catch(c){if(a)return this.assert(c===a,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}",a instanceof Error?a.toString():a,c instanceof Error?c.toString():c),E(this,"object",c),this;if(t&&(this.assert(c instanceof t,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp} but #{act} was thrown",s,c instanceof Error?c.toString():c),!n))return E(this,"object",c),this;var l="object"===e.type(c)&&"message"in c?c.message:""+c;if(null!=l&&n&&n instanceof RegExp)return this.assert(n.exec(l),"expected #{this} to throw error matching #{exp} but got #{act}","expected #{this} to throw error not matching #{exp}",n,l),E(this,"object",c),this;if(null!=l&&n&&"string"==typeof n)return this.assert(~l.indexOf(n),"expected #{this} to throw error including #{exp} but got #{act}","expected #{this} to throw error not including #{act}",n,l),E(this,"object",c),this;o=!0,u=c}var f="",h=null!==s?s:a?"#{exp}":"an error";o&&(f=" but #{act} was thrown"),this.assert(o===!0,"expected #{this} to throw "+h+f,"expected #{this} to not throw "+h+f,a instanceof Error?a.toString():a,u instanceof Error?u.toString():u),E(this,"object",u)}function y(t,e,n){return t.every(function(t){return n?e.some(function(e){return n(t,e)}):-1!==e.indexOf(t)})}function b(t,e,n){n&&E(this,"message",n);var r=E(this,"object");new x(t,n).to.have.property(e),new x(r).is.a("function");var i=t[e];r(),this.assert(i!==t[e],"expected ."+e+" to change","expected ."+e+" to not change")}function _(t,e,n){n&&E(this,"message",n);var r=E(this,"object");new x(t,n).to.have.property(e),new x(r).is.a("function");var i=t[e];r(),this.assert(t[e]-i>0,"expected ."+e+" to increase","expected ."+e+" to not increase")}function w(t,e,n){n&&E(this,"message",n);var r=E(this,"object");new x(t,n).to.have.property(e),new x(r).is.a("function");var i=t[e];r(),this.assert(t[e]-i<0,"expected ."+e+" to decrease","expected ."+e+" to not decrease")}var x=t.Assertion,E=(Object.prototype.toString,e.flag);["to","be","been","is","and","has","have","with","that","which","at","of","same"].forEach(function(t){x.addProperty(t,function(){return this})}),x.addProperty("not",function(){E(this,"negate",!0)}),x.addProperty("deep",function(){E(this,"deep",!0)}),x.addProperty("any",function(){E(this,"any",!0),E(this,"all",!1)}),x.addProperty("all",function(){E(this,"all",!0),E(this,"any",!1)}),x.addChainableMethod("an",n),x.addChainableMethod("a",n),x.addChainableMethod("include",i,r),x.addChainableMethod("contain",i,r),x.addChainableMethod("contains",i,r),x.addChainableMethod("includes",i,r),x.addProperty("ok",function(){this.assert(E(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")}),x.addProperty("true",function(){this.assert(!0===E(this,"object"),"expected #{this} to be true","expected #{this} to be false",this.negate?!1:!0)}),x.addProperty("false",function(){this.assert(!1===E(this,"object"),"expected #{this} to be false","expected #{this} to be true",this.negate?!0:!1)}),x.addProperty("null",function(){this.assert(null===E(this,"object"),"expected #{this} to be null","expected #{this} not to be null")}),x.addProperty("undefined",function(){this.assert(void 0===E(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")}),x.addProperty("exist",function(){this.assert(null!=E(this,"object"),"expected #{this} to exist","expected #{this} to not exist")}),x.addProperty("empty",function(){var t=E(this,"object"),e=t;Array.isArray(t)||"string"==typeof object?e=t.length:"object"==typeof t&&(e=Object.keys(t).length),this.assert(!e,"expected #{this} to be empty","expected #{this} not to be empty")}),x.addProperty("arguments",o),x.addProperty("Arguments",o),x.addMethod("equal",a),x.addMethod("equals",a),x.addMethod("eq",a),x.addMethod("eql",s),x.addMethod("eqls",s),x.addMethod("above",u),x.addMethod("gt",u),x.addMethod("greaterThan",u),x.addMethod("least",c),x.addMethod("gte",c),x.addMethod("below",l),x.addMethod("lt",l),x.addMethod("lessThan",l),x.addMethod("most",f),x.addMethod("lte",f),x.addMethod("within",function(t,e,n){n&&E(this,"message",n);var r=E(this,"object"),i=t+".."+e;if(E(this,"doLength")){new x(r,n).to.have.property("length");var o=r.length;this.assert(o>=t&&e>=o,"expected #{this} to have a length within "+i,"expected #{this} to not have a length within "+i)}else this.assert(r>=t&&e>=r,"expected #{this} to be within "+i,"expected #{this} to not be within "+i)}),x.addMethod("instanceof",h),x.addMethod("instanceOf",h),x.addMethod("property",function(t,n,r){r&&E(this,"message",r);var i=!!E(this,"deep"),o=i?"deep property ":"property ",a=E(this,"negate"),s=E(this,"object"),u=i?e.getPathInfo(t,s):null,c=i?u.exists:e.hasProperty(t,s),l=i?u.value:s[t];if(a&&void 0!==n){if(void 0===l)throw r=null!=r?r+": ":"",new Error(r+e.inspect(s)+" has no "+o+e.inspect(t))}else this.assert(c,"expected #{this} to have a "+o+e.inspect(t),"expected #{this} to not have "+o+e.inspect(t));void 0!==n&&this.assert(n===l,"expected #{this} to have a "+o+e.inspect(t)+" of #{exp}, but got #{act}","expected #{this} to not have a "+o+e.inspect(t)+" of #{act}",n,l),E(this,"object",l)}),x.addMethod("ownProperty",p),x.addMethod("haveOwnProperty",p),x.addChainableMethod("length",m,d),x.addMethod("lengthOf",m),x.addMethod("match",function(t,e){e&&E(this,"message",e);var n=E(this,"object");this.assert(t.exec(n),"expected #{this} to match "+t,"expected #{this} not to match "+t)}),x.addMethod("string",function(t,n){n&&E(this,"message",n);var r=E(this,"object");new x(r,n).is.a("string"),this.assert(~r.indexOf(t),"expected #{this} to contain "+e.inspect(t),"expected #{this} to not contain "+e.inspect(t))}),x.addMethod("keys",v),x.addMethod("key",v),x.addMethod("throw",g),x.addMethod("throws",g),x.addMethod("Throw",g),x.addMethod("respondTo",function(t,n){n&&E(this,"message",n);var r=E(this,"object"),i=E(this,"itself"),o="function"!==e.type(r)||i?r[t]:r.prototype[t];this.assert("function"==typeof o,"expected #{this} to respond to "+e.inspect(t),"expected #{this} to not respond to "+e.inspect(t))}),x.addProperty("itself",function(){E(this,"itself",!0)}),x.addMethod("satisfy",function(t,n){n&&E(this,"message",n);var r=E(this,"object"),i=t(r);this.assert(i,"expected #{this} to satisfy "+e.objDisplay(t),"expected #{this} to not satisfy"+e.objDisplay(t),this.negate?!1:!0,i)}),x.addMethod("closeTo",function(t,n,r){r&&E(this,"message",r);var i=E(this,"object");if(new x(i,r).is.a("number"),"number"!==e.type(t)||"number"!==e.type(n))throw new Error("the arguments to closeTo must be numbers");this.assert(Math.abs(i-t)<=n,"expected #{this} to be close to "+t+" +/- "+n,"expected #{this} not to be close to "+t+" +/- "+n)}),x.addMethod("members",function(t,n){n&&E(this,"message",n);var r=E(this,"object");new x(r).to.be.an("array"),new x(t).to.be.an("array");var i=E(this,"deep")?e.eql:void 0;return E(this,"contains")?this.assert(y(t,r,i),"expected #{this} to be a superset of #{act}","expected #{this} to not be a superset of #{act}",r,t):void this.assert(y(r,t,i)&&y(t,r,i),"expected #{this} to have the same members as #{act}","expected #{this} to not have the same members as #{act}",r,t)}),x.addChainableMethod("change",b),x.addChainableMethod("changes",b),x.addChainableMethod("increase",_),x.addChainableMethod("increases",_),x.addChainableMethod("decrease",w),x.addChainableMethod("decreases",w)}},function(t){/*!
	 * chai
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e){/*!
	   * Chai dependencies.
	   */
var n=t.Assertion,r=e.flag,i=t.assert=function(e,r){var i=new n(null,null,t.assert);i.assert(e,r,"[ negation message unavailable ]")};i.fail=function(e,n,r,o){throw r=r||"assert.fail()",new t.AssertionError(r,{actual:e,expected:n,operator:o},i.fail)},i.ok=function(t,e){new n(t,e).is.ok},i.notOk=function(t,e){new n(t,e).is.not.ok},i.equal=function(t,e,o){var a=new n(t,o,i.equal);a.assert(e==r(a,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",e,t)},i.notEqual=function(t,e,o){var a=new n(t,o,i.notEqual);a.assert(e!=r(a,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",e,t)},i.strictEqual=function(t,e,r){new n(t,r).to.equal(e)},i.notStrictEqual=function(t,e,r){new n(t,r).to.not.equal(e)},i.deepEqual=function(t,e,r){new n(t,r).to.eql(e)},i.notDeepEqual=function(t,e,r){new n(t,r).to.not.eql(e)},i.isAbove=function(t,e,r){new n(t,r).to.be.above(e)},i.isBelow=function(t,e,r){new n(t,r).to.be.below(e)},i.isTrue=function(t,e){new n(t,e).is["true"]},i.isFalse=function(t,e){new n(t,e).is["false"]},i.isNull=function(t,e){new n(t,e).to.equal(null)},i.isNotNull=function(t,e){new n(t,e).to.not.equal(null)},i.isUndefined=function(t,e){new n(t,e).to.equal(void 0)},i.isDefined=function(t,e){new n(t,e).to.not.equal(void 0)},i.isFunction=function(t,e){new n(t,e).to.be.a("function")},i.isNotFunction=function(t,e){new n(t,e).to.not.be.a("function")},i.isObject=function(t,e){new n(t,e).to.be.a("object")},i.isNotObject=function(t,e){new n(t,e).to.not.be.a("object")},i.isArray=function(t,e){new n(t,e).to.be.an("array")},i.isNotArray=function(t,e){new n(t,e).to.not.be.an("array")},i.isString=function(t,e){new n(t,e).to.be.a("string")},i.isNotString=function(t,e){new n(t,e).to.not.be.a("string")},i.isNumber=function(t,e){new n(t,e).to.be.a("number")},i.isNotNumber=function(t,e){new n(t,e).to.not.be.a("number")},i.isBoolean=function(t,e){new n(t,e).to.be.a("boolean")},i.isNotBoolean=function(t,e){new n(t,e).to.not.be.a("boolean")},i.typeOf=function(t,e,r){new n(t,r).to.be.a(e)},i.notTypeOf=function(t,e,r){new n(t,r).to.not.be.a(e)},i.instanceOf=function(t,e,r){new n(t,r).to.be.instanceOf(e)},i.notInstanceOf=function(t,e,r){new n(t,r).to.not.be.instanceOf(e)},i.include=function(t,e,r){new n(t,r,i.include).include(e)},i.notInclude=function(t,e,r){new n(t,r,i.notInclude).not.include(e)},i.match=function(t,e,r){new n(t,r).to.match(e)},i.notMatch=function(t,e,r){new n(t,r).to.not.match(e)},i.property=function(t,e,r){new n(t,r).to.have.property(e)},i.notProperty=function(t,e,r){new n(t,r).to.not.have.property(e)},i.deepProperty=function(t,e,r){new n(t,r).to.have.deep.property(e)},i.notDeepProperty=function(t,e,r){new n(t,r).to.not.have.deep.property(e)},i.propertyVal=function(t,e,r,i){new n(t,i).to.have.property(e,r)},i.propertyNotVal=function(t,e,r,i){new n(t,i).to.not.have.property(e,r)},i.deepPropertyVal=function(t,e,r,i){new n(t,i).to.have.deep.property(e,r)},i.deepPropertyNotVal=function(t,e,r,i){new n(t,i).to.not.have.deep.property(e,r)},i.lengthOf=function(t,e,r){new n(t,r).to.have.length(e)},i.Throw=function(t,e,i,o){("string"==typeof e||e instanceof RegExp)&&(i=e,e=null);var a=new n(t,o).to.Throw(e,i);return r(a,"object")},i.doesNotThrow=function(t,e,r){"string"==typeof e&&(r=e,e=null),new n(t,r).to.not.Throw(e)},i.operator=function(t,i,o,a){var s;switch(i){case"==":s=t==o;break;case"===":s=t===o;break;case">":s=t>o;break;case">=":s=t>=o;break;case"<":s=o>t;break;case"<=":s=o>=t;break;case"!=":s=t!=o;break;case"!==":s=t!==o;break;default:throw new Error('Invalid operator "'+i+'"')}var u=new n(s,a);u.assert(!0===r(u,"object"),"expected "+e.inspect(t)+" to be "+i+" "+e.inspect(o),"expected "+e.inspect(t)+" to not be "+i+" "+e.inspect(o))},i.closeTo=function(t,e,r,i){new n(t,i).to.be.closeTo(e,r)},i.sameMembers=function(t,e,r){new n(t,r).to.have.same.members(e)},i.sameDeepMembers=function(t,e,r){new n(t,r).to.have.same.deep.members(e)},i.includeMembers=function(t,e,r){new n(t,r).to.include.members(e)},i.changes=function(t,e,r){new n(t).to.change(e,r)},i.doesNotChange=function(t,e,r){new n(t).to.not.change(e,r)},i.increases=function(t,e,r){new n(t).to.increase(e,r)},i.doesNotIncrease=function(t,e,r){new n(t).to.not.increase(e,r)},i.decreases=function(t,e,r){new n(t).to.decrease(e,r)},i.doesNotDecrease=function(t,e,r){new n(t).to.not.decrease(e,r)},/*!
	   * Undocumented / untested
	   */
i.ifError=function(t,e){new n(t,e).to.not.be.ok},/*!
	   * Aliases.
	   */
function o(t,e){return i[e]=i[t],o}("Throw","throw")("Throw","throws")}},function(t){/*!
	 * chai
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t){t.expect=function(e,n){return new t.Assertion(e,n)},t.expect.fail=function(e,n,r,i){throw r=r||"expect.fail()",new t.AssertionError(r,{actual:e,expected:n,operator:i},t.expect.fail)}}},function(t){/*!
	 * chai
	 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t){function e(){function e(){return this instanceof String||this instanceof Number||this instanceof Boolean?new n(this.valueOf(),null,e):new n(this,null,e)}function r(t){Object.defineProperty(this,"should",{value:t,enumerable:!0,configurable:!0,writable:!0})}Object.defineProperty(Object.prototype,"should",{set:r,get:e,configurable:!0});var i={};return i.fail=function(e,n,r,o){throw r=r||"should.fail()",new t.AssertionError(r,{actual:e,expected:n,operator:o},i.fail)},i.equal=function(t,e,r){new n(t,r).to.equal(e)},i.Throw=function(t,e,r,i){new n(t,i).to.Throw(e,r)},i.exist=function(t,e){new n(t,e).to.exist},i.not={},i.not.equal=function(t,e,r){new n(t,r).to.not.equal(e)},i.not.Throw=function(t,e,r,i){new n(t,i).to.not.Throw(e,r)},i.not.exist=function(t,e){new n(t,e).to.not.exist},i["throw"]=i.Throw,i.not["throw"]=i.not.Throw,i}var n=t.Assertion;t.should=e,t.Should=e}},function(t,e,n){/*!
	 * Chai - addChainingMethod utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependencies
	 */
var r=n(373),i=n(185),o=n(184),a="__proto__"in Object,s=/^(?:length|name|arguments|caller)$/,u=Function.prototype.call,c=Function.prototype.apply;t.exports=function(t,e,n,l){"function"!=typeof l&&(l=function(){});var f={method:n,chainingBehavior:l};t.__methods||(t.__methods={}),t.__methods[e]=f,Object.defineProperty(t,e,{get:function(){f.chainingBehavior.call(this);var e=function h(){var t=i(this,"ssfi");t&&o.includeStack===!1&&i(this,"ssfi",h);var e=f.method.apply(this,arguments);return void 0===e?this:e};if(a){var n=e.__proto__=Object.create(this);n.call=u,n.apply=c}else{var l=Object.getOwnPropertyNames(t);l.forEach(function(n){if(!s.test(n)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r)}})}return r(this,e),e},configurable:!0})}},function(t,e,n){/*!
	 * Chai - addMethod utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
var r=n(184),i=n(185);t.exports=function(t,e,n){t[e]=function(){var o=i(this,"ssfi");o&&r.includeStack===!1&&i(this,"ssfi",t[e]);var a=n.apply(this,arguments);return void 0===a?this:a}}},function(t){/*!
	 * Chai - addProperty utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){Object.defineProperty(t,e,{get:function(){var t=n.call(this);return void 0===t?this:t},configurable:!0})}},function(t){/*!
	 * Chai - getEnumerableProperties utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t){var e=[];for(var n in t)e.push(n);return e}},function(t,e,n){/*!
	 * Chai - message composition utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependancies
	 */
var r=n(185),i=n(368),o=(n(340),n(372));t.exports=function(t,e){var n=r(t,"negate"),a=r(t,"object"),s=e[3],u=i(t,e),c=n?e[2]:e[1],l=r(t,"message");return"function"==typeof c&&(c=c()),c=c||"",c=c.replace(/#{this}/g,o(a)).replace(/#{act}/g,o(u)).replace(/#{exp}/g,o(s)),l?l+": "+c:c}},function(t,e,n){/*!
	 * Chai - getPathValue utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * @see https://github.com/logicalparadox/filtr
	 * MIT Licensed
	 */
var r=n(370);t.exports=function(t,e){var n=r(t,e);return n.value}},function(t){/*!
	 * Chai - getProperties utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(){function t(t){-1===e.indexOf(t)&&e.push(t)}for(var e=Object.getOwnPropertyNames(subject),n=Object.getPrototypeOf(subject);null!==n;)Object.getOwnPropertyNames(n).forEach(t),n=Object.getPrototypeOf(n);return e}},function(t,e,n){/*!
	 * chai
	 * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Main exports
	 */
var e=t.exports={};/*!
	 * test utility
	 */
e.test=n(462),/*!
	 * type utility
	 */
e.type=n(374),/*!
	 * message utility
	 */
e.getMessage=n(455),/*!
	 * actual utility
	 */
e.getActual=n(368),/*!
	 * Inspect util
	 */
e.inspect=n(340),/*!
	 * Object Display util
	 */
e.objDisplay=n(372),/*!
	 * Flag utility
	 */
e.flag=n(185),/*!
	 * Flag transferring utility
	 */
e.transferFlags=n(373),/*!
	 * Deep equal utility
	 */
e.eql=n(464),/*!
	 * Deep path value
	 */
e.getPathValue=n(456),/*!
	 * Deep path info
	 */
e.getPathInfo=n(370),/*!
	 * Check if a property exists
	 */
e.hasProperty=n(371),/*!
	 * Function name
	 */
e.getName=n(369),/*!
	 * add Property
	 */
e.addProperty=n(453),/*!
	 * add Method
	 */
e.addMethod=n(452),/*!
	 * overwrite Property
	 */
e.overwriteProperty=n(461),/*!
	 * overwrite Method
	 */
e.overwriteMethod=n(460),/*!
	 * Add a chainable method
	 */
e.addChainableMethod=n(451),/*!
	 * Overwrite chainable method
	 */
e.overwriteChainableMethod=n(459)},function(t){/*!
	 * Chai - overwriteChainableMethod utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n,r){var i=t.__methods[e],o=i.chainingBehavior;i.chainingBehavior=function(){var t=r(o).call(this);return void 0===t?this:t};var a=i.method;i.method=function(){var t=n(a).apply(this,arguments);return void 0===t?this:t}}},function(t){/*!
	 * Chai - overwriteMethod utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){var r=t[e],i=function(){return this};r&&"function"==typeof r&&(i=r),t[e]=function(){var t=n(i).apply(this,arguments);return void 0===t?this:t}}},function(t){/*!
	 * Chai - overwriteProperty utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
t.exports=function(t,e,n){var r=Object.getOwnPropertyDescriptor(t,e),i=function(){};r&&"function"==typeof r.get&&(i=r.get),Object.defineProperty(t,e,{get:function(){var t=n(i).call(this);return void 0===t?this:t},configurable:!0})}},function(t,e,n){/*!
	 * Chai - test utility
	 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependancies
	 */
var r=n(185);t.exports=function(t,e){var n=r(t,"negate"),i=e[0];return n?!i:i}},function(t){/*!
	 * assertion-error
	 * Copyright(c) 2013 Jake Luer <jake@qualiancy.com>
	 * MIT Licensed
	 */
/*!
	 * Return a function that will copy properties from
	 * one object to another excluding any originally
	 * listed. Returned function will create a new `{}`.
	 *
	 * @param {String} excluded properties ...
	 * @return {Function}
	 */
function e(){function t(t,n){Object.keys(n).forEach(function(r){~e.indexOf(r)||(t[r]=n[r])})}var e=[].slice.call(arguments);return function(){for(var e=[].slice.call(arguments),n=0,r={};n<e.length;n++)t(r,e[n]);return r}}function n(t,n,r){var i=e("name","message","stack","constructor","toJSON"),o=i(n||{});this.message=t||"Unspecified AssertionError",this.showDiff=!1;for(var a in o)this[a]=o[a];r=r||arguments.callee,r&&Error.captureStackTrace&&Error.captureStackTrace(this,r)}/*!
	 * Primary Exports
	 */
t.exports=n,/*!
	 * Inherit from Error.prototype
	 */
n.prototype=Object.create(Error.prototype),/*!
	 * Statically set name
	 */
n.prototype.name="AssertionError",/*!
	 * Ensure correct constructor
	 */
n.prototype.constructor=n,n.prototype.toJSON=function(t){var n=e("constructor","toJSON","stack"),r=n({name:this.name},this);return!1!==t&&this.stack&&(r.stack=this.stack),r}},function(t,e,n){t.exports=n(465)},function(t,e,n){function r(t,e,n){return i(t,e)?!0:"date"===m(t)?a(t,e):"regexp"===m(t)?s(t,e):d.isBuffer(t)?f(t,e):"arguments"===m(t)?u(t,e,n):o(t,e)?"object"!==m(t)&&"object"!==m(e)&&"array"!==m(t)&&"array"!==m(e)?i(t,e):p(t,e,n):!1}/*!
	 * Strict (egal) equality test. Ensures that NaN always
	 * equals NaN and `-0` does not equal `+0`.
	 *
	 * @param {Mixed} a
	 * @param {Mixed} b
	 * @return {Boolean} equal match
	 */
function i(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}/*!
	 * Compare the types of two given objects and
	 * return if they are equal. Note that an Array
	 * has a type of `array` (not `object`) and arguments
	 * have a type of `arguments` (not `array`/`object`).
	 *
	 * @param {Mixed} a
	 * @param {Mixed} b
	 * @return {Boolean} result
	 */
function o(t,e){return m(t)===m(e)}/*!
	 * Compare two Date objects by asserting that
	 * the time values are equal using `saveValue`.
	 *
	 * @param {Date} a
	 * @param {Date} b
	 * @return {Boolean} result
	 */
function a(t,e){return"date"!==m(e)?!1:i(t.getTime(),e.getTime())}/*!
	 * Compare two regular expressions by converting them
	 * to string and checking for `sameValue`.
	 *
	 * @param {RegExp} a
	 * @param {RegExp} b
	 * @return {Boolean} result
	 */
function s(t,e){return"regexp"!==m(e)?!1:i(t.toString(),e.toString())}/*!
	 * Assert deep equality of two `arguments` objects.
	 * Unfortunately, these must be sliced to arrays
	 * prior to test to ensure no bad behavior.
	 *
	 * @param {Arguments} a
	 * @param {Arguments} b
	 * @param {Array} memoize (optional)
	 * @return {Boolean} result
	 */
function u(t,e,n){return"arguments"!==m(e)?!1:(t=[].slice.call(t),e=[].slice.call(e),r(t,e,n))}/*!
	 * Get enumerable properties of a given object.
	 *
	 * @param {Object} a
	 * @return {Array} property names
	 */
function c(t){var e=[];for(var n in t)e.push(n);return e}/*!
	 * Simple equality for flat iterable objects
	 * such as Arrays or Node.js buffers.
	 *
	 * @param {Iterable} a
	 * @param {Iterable} b
	 * @return {Boolean} result
	 */
function l(t,e){if(t.length!==e.length)return!1;for(var n=0,r=!0;n<t.length;n++)if(t[n]!==e[n]){r=!1;break}return r}/*!
	 * Extension to `iterableEqual` specifically
	 * for Node.js Buffers.
	 *
	 * @param {Buffer} a
	 * @param {Mixed} b
	 * @return {Boolean} result
	 */
function f(t,e){return d.isBuffer(e)?l(t,e):!1}/*!
	 * Block for `objectEqual` ensuring non-existing
	 * values don't get in.
	 *
	 * @param {Mixed} object
	 * @return {Boolean} result
	 */
function h(t){return null!==t&&void 0!==t}/*!
	 * Recursively check the equality of two objects.
	 * Once basic sameness has been established it will
	 * defer to `deepEqual` for each enumerable key
	 * in the object.
	 *
	 * @param {Mixed} a
	 * @param {Mixed} b
	 * @return {Boolean} result
	 */
function p(t,e,n){if(!h(t)||!h(e))return!1;if(t.prototype!==e.prototype)return!1;var i;if(n){for(i=0;i<n.length;i++)if(n[i][0]===t&&n[i][1]===e||n[i][0]===e&&n[i][1]===t)return!0}else n=[];try{var o=c(t),a=c(e)}catch(s){return!1}if(o.sort(),a.sort(),!l(o,a))return!1;n.push([t,e]);var u;for(i=o.length-1;i>=0;i--)if(u=o[i],!r(t[u],e[u],n))return!1;return!0}/*!
	 * deep-eql
	 * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Module dependencies
	 */
var d,m=n(466);try{d=n(57).Buffer}catch(v){d={},d.isBuffer=function(){return!1}}/*!
	 * Primary Export
	 */
t.exports=r},function(t,e,n){t.exports=n(467)},function(t,e){function n(t){var e=Object.prototype.toString.call(t);return i[e]?i[e]:null===t?"null":void 0===t?"undefined":t===Object(t)?"object":typeof t}function r(){this.tests={}}/*!
	 * type-detect
	 * Copyright(c) 2013 jake luer <jake@alogicalparadox.com>
	 * MIT Licensed
	 */
/*!
	 * Primary Exports
	 */
var e=t.exports=n,i={"[object Array]":"array","[object RegExp]":"regexp","[object Function]":"function","[object Arguments]":"arguments","[object Date]":"date"};e.Library=r,r.prototype.of=n,r.prototype.define=function(t,e){return 1===arguments.length?this.tests[t]:(this.tests[t]=e,this)},r.prototype.test=function(t,e){if(e===n(t))return!0;var r=this.tests[e];if(r&&"regexp"===n(r))return r.test(t);if(r&&"function"===n(r))return r(t);throw new ReferenceError('Type test "'+e+'" not defined or invalid.')}},,function(t,e,n){e=t.exports=n(17)(),e.push([t.id,"@charset \"utf-8\";body{margin:0}#mocha{font:20px/1.5 \"Helvetica Neue\",Helvetica,Arial,sans-serif;margin:60px 50px}#mocha ul,#mocha li{margin:0;padding:0}#mocha ul{list-style:none}#mocha h2{margin:0}#mocha h1{margin:15px 0 0;font-size:1em;font-weight:200}#mocha h1 a{text-decoration:none;color:inherit}#mocha h1 a:hover{text-decoration:underline}#mocha .suite .suite h1{margin-top:0;font-size:.8em}#mocha .hidden{display:none}#mocha h2{font-size:12px;font-weight:400;cursor:pointer}#mocha .suite,#mocha .test{margin-left:15px}#mocha .test{overflow:hidden}#mocha .test.pending:hover h2::after{content:'(pending)';font-family:arial,sans-serif}#mocha .test.pass.medium .duration{background:#c09853}#mocha .test.pass.slow .duration{background:#b94a48}#mocha .test.pass::before{content:'✓';font-size:12px;display:block;float:left;margin-right:5px;color:#00d6b2}#mocha .test.pass .duration{font-size:9px;margin-left:5px;padding:2px 5px;color:#fff;box-shadow:inset 0 1px 1px rgba(0,0,0,.2);border-radius:5px}#mocha .test.pass.fast .duration{display:none}#mocha .test.pending{color:#0b97c4}#mocha .test.pending::before{content:'◦';color:#0b97c4}#mocha .test.fail{color:#c00}#mocha .test.fail pre{color:#000}#mocha .test.fail::before{content:'✖';font-size:12px;display:block;float:left;margin-right:5px;color:#c00}#mocha .test pre.error{color:#c00;max-height:300px;overflow:auto}#mocha .test pre{display:block;float:left;clear:left;font:12px/1.5 monaco,monospace;margin:5px;padding:15px;border:1px solid #eee;max-width:calc(100% - 42px);word-wrap:break-word;border-bottom-color:#ddd;-webkit-border-radius:3px;-webkit-box-shadow:0 1px 3px #eee;-moz-border-radius:3px;-moz-box-shadow:0 1px 3px #eee;border-radius:3px}#mocha .test h2{position:relative}#mocha .test a.replay{position:absolute;top:3px;right:0;text-decoration:none;vertical-align:middle;display:block;width:15px;height:15px;line-height:15px;text-align:center;background:#eee;font-size:15px;border-radius:15px;transition:opacity 200ms;opacity:.3;color:#888}#mocha .test:hover a.replay{opacity:1}#mocha-report.pass .test.fail,#mocha-report.fail .test.pass,#mocha-report.pending .test.pass,#mocha-report.pending .test.fail{display:none}#mocha-report.pending .test.pass.pending{display:block}#mocha-error{color:#c00;font-size:1.5em;font-weight:100;letter-spacing:1px}#mocha-stats{position:fixed;top:15px;right:10px;font-size:12px;margin:0;color:#888;z-index:1}#mocha-stats .progress{float:right;padding-top:0}#mocha-stats em{color:#000}#mocha-stats a{text-decoration:none;color:inherit}#mocha-stats a:hover{border-bottom:1px solid #eee}#mocha-stats li{display:inline-block;margin:0 5px;list-style:none;padding-top:11px}#mocha-stats canvas{width:40px;height:40px}#mocha code .comment{color:#ddd}#mocha code .init{color:#2f6fad}#mocha code .string{color:#5890ad}#mocha code .keyword{color:#8a6343}#mocha code .number{color:#2f6fad}@media screen and (max-device-width:480px){#mocha{margin:60px 0}#mocha #stats{position:absolute}}",""])},,,,,,,,,,,,,,,,,,,,function(t,e,n){e=t.exports=n(17)(),e.push([t.id,"#mocha-stats em{color:#fff}",""])},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t){t.exports=function(t){"function"==typeof execScript?execScript(t):eval.call(null,t)}},function(t,e,n){n(559)(n(561))},function(t){t.exports=";(function(){\n\n// CommonJS require()\n\nfunction require(p){\n    var path = require.resolve(p)\n      , mod = require.modules[path];\n    if (!mod) throw new Error('failed to require \"' + p + '\"');\n    if (!mod.exports) {\n      mod.exports = {};\n      mod.call(mod.exports, mod, mod.exports, require.relative(path));\n    }\n    return mod.exports;\n  }\n\nrequire.modules = {};\n\nrequire.resolve = function (path){\n    var orig = path\n      , reg = path + '.js'\n      , index = path + '/index.js';\n    return require.modules[reg] && reg\n      || require.modules[index] && index\n      || orig;\n  };\n\nrequire.register = function (path, fn){\n    require.modules[path] = fn;\n  };\n\nrequire.relative = function (parent) {\n    return function(p){\n      if ('.' != p.charAt(0)) return require(p);\n\n      var path = parent.split('/')\n        , segs = p.split('/');\n      path.pop();\n\n      for (var i = 0; i < segs.length; i++) {\n        var seg = segs[i];\n        if ('..' == seg) path.pop();\n        else if ('.' != seg) path.push(seg);\n      }\n\n      return require(path.join('/'));\n    };\n  };\n\n\nrequire.register(\"browser/debug.js\", function(module, exports, require){\nmodule.exports = function(type){\n  return function(){\n  }\n};\n\n}); // module: browser/debug.js\n\nrequire.register(\"browser/diff.js\", function(module, exports, require){\n/* See LICENSE file for terms of use */\n\n/*\n * Text diff implementation.\n *\n * This library supports the following APIS:\n * JsDiff.diffChars: Character by character diff\n * JsDiff.diffWords: Word (as defined by \\b regex) diff which ignores whitespace\n * JsDiff.diffLines: Line based diff\n *\n * JsDiff.diffCss: Diff targeted at CSS content\n *\n * These methods are based on the implementation proposed in\n * \"An O(ND) Difference Algorithm and its Variations\" (Myers, 1986).\n * http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.4.6927\n */\nvar JsDiff = (function() {\n  /*jshint maxparams: 5*/\n  function clonePath(path) {\n    return { newPos: path.newPos, components: path.components.slice(0) };\n  }\n  function removeEmpty(array) {\n    var ret = [];\n    for (var i = 0; i < array.length; i++) {\n      if (array[i]) {\n        ret.push(array[i]);\n      }\n    }\n    return ret;\n  }\n  function escapeHTML(s) {\n    var n = s;\n    n = n.replace(/&/g, '&amp;');\n    n = n.replace(/</g, '&lt;');\n    n = n.replace(/>/g, '&gt;');\n    n = n.replace(/\"/g, '&quot;');\n\n    return n;\n  }\n\n  var Diff = function(ignoreWhitespace) {\n    this.ignoreWhitespace = ignoreWhitespace;\n  };\n  Diff.prototype = {\n      diff: function(oldString, newString) {\n        // Handle the identity case (this is due to unrolling editLength == 0\n        if (newString === oldString) {\n          return [{ value: newString }];\n        }\n        if (!newString) {\n          return [{ value: oldString, removed: true }];\n        }\n        if (!oldString) {\n          return [{ value: newString, added: true }];\n        }\n\n        newString = this.tokenize(newString);\n        oldString = this.tokenize(oldString);\n\n        var newLen = newString.length, oldLen = oldString.length;\n        var maxEditLength = newLen + oldLen;\n        var bestPath = [{ newPos: -1, components: [] }];\n\n        // Seed editLength = 0\n        var oldPos = this.extractCommon(bestPath[0], newString, oldString, 0);\n        if (bestPath[0].newPos+1 >= newLen && oldPos+1 >= oldLen) {\n          return bestPath[0].components;\n        }\n\n        for (var editLength = 1; editLength <= maxEditLength; editLength++) {\n          for (var diagonalPath = -1*editLength; diagonalPath <= editLength; diagonalPath+=2) {\n            var basePath;\n            var addPath = bestPath[diagonalPath-1],\n                removePath = bestPath[diagonalPath+1];\n            oldPos = (removePath ? removePath.newPos : 0) - diagonalPath;\n            if (addPath) {\n              // No one else is going to attempt to use this value, clear it\n              bestPath[diagonalPath-1] = undefined;\n            }\n\n            var canAdd = addPath && addPath.newPos+1 < newLen;\n            var canRemove = removePath && 0 <= oldPos && oldPos < oldLen;\n            if (!canAdd && !canRemove) {\n              bestPath[diagonalPath] = undefined;\n              continue;\n            }\n\n            // Select the diagonal that we want to branch from. We select the prior\n            // path whose position in the new string is the farthest from the origin\n            // and does not pass the bounds of the diff graph\n            if (!canAdd || (canRemove && addPath.newPos < removePath.newPos)) {\n              basePath = clonePath(removePath);\n              this.pushComponent(basePath.components, oldString[oldPos], undefined, true);\n            } else {\n              basePath = clonePath(addPath);\n              basePath.newPos++;\n              this.pushComponent(basePath.components, newString[basePath.newPos], true, undefined);\n            }\n\n            var oldPos = this.extractCommon(basePath, newString, oldString, diagonalPath);\n\n            if (basePath.newPos+1 >= newLen && oldPos+1 >= oldLen) {\n              return basePath.components;\n            } else {\n              bestPath[diagonalPath] = basePath;\n            }\n          }\n        }\n      },\n\n      pushComponent: function(components, value, added, removed) {\n        var last = components[components.length-1];\n        if (last && last.added === added && last.removed === removed) {\n          // We need to clone here as the component clone operation is just\n          // as shallow array clone\n          components[components.length-1] =\n            {value: this.join(last.value, value), added: added, removed: removed };\n        } else {\n          components.push({value: value, added: added, removed: removed });\n        }\n      },\n      extractCommon: function(basePath, newString, oldString, diagonalPath) {\n        var newLen = newString.length,\n            oldLen = oldString.length,\n            newPos = basePath.newPos,\n            oldPos = newPos - diagonalPath;\n        while (newPos+1 < newLen && oldPos+1 < oldLen && this.equals(newString[newPos+1], oldString[oldPos+1])) {\n          newPos++;\n          oldPos++;\n\n          this.pushComponent(basePath.components, newString[newPos], undefined, undefined);\n        }\n        basePath.newPos = newPos;\n        return oldPos;\n      },\n\n      equals: function(left, right) {\n        var reWhitespace = /\\S/;\n        if (this.ignoreWhitespace && !reWhitespace.test(left) && !reWhitespace.test(right)) {\n          return true;\n        } else {\n          return left === right;\n        }\n      },\n      join: function(left, right) {\n        return left + right;\n      },\n      tokenize: function(value) {\n        return value;\n      }\n  };\n\n  var CharDiff = new Diff();\n\n  var WordDiff = new Diff(true);\n  var WordWithSpaceDiff = new Diff();\n  WordDiff.tokenize = WordWithSpaceDiff.tokenize = function(value) {\n    return removeEmpty(value.split(/(\\s+|\\b)/));\n  };\n\n  var CssDiff = new Diff(true);\n  CssDiff.tokenize = function(value) {\n    return removeEmpty(value.split(/([{}:;,]|\\s+)/));\n  };\n\n  var LineDiff = new Diff();\n  LineDiff.tokenize = function(value) {\n    var retLines = [],\n        lines = value.split(/^/m);\n\n    for(var i = 0; i < lines.length; i++) {\n      var line = lines[i],\n          lastLine = lines[i - 1];\n\n      // Merge lines that may contain windows new lines\n      if (line == '\\n' && lastLine && lastLine[lastLine.length - 1] === '\\r') {\n        retLines[retLines.length - 1] += '\\n';\n      } else if (line) {\n        retLines.push(line);\n      }\n    }\n\n    return retLines;\n  };\n\n  return {\n    Diff: Diff,\n\n    diffChars: function(oldStr, newStr) { return CharDiff.diff(oldStr, newStr); },\n    diffWords: function(oldStr, newStr) { return WordDiff.diff(oldStr, newStr); },\n    diffWordsWithSpace: function(oldStr, newStr) { return WordWithSpaceDiff.diff(oldStr, newStr); },\n    diffLines: function(oldStr, newStr) { return LineDiff.diff(oldStr, newStr); },\n\n    diffCss: function(oldStr, newStr) { return CssDiff.diff(oldStr, newStr); },\n\n    createPatch: function(fileName, oldStr, newStr, oldHeader, newHeader) {\n      var ret = [];\n\n      ret.push('Index: ' + fileName);\n      ret.push('===================================================================');\n      ret.push('--- ' + fileName + (typeof oldHeader === 'undefined' ? '' : '\\t' + oldHeader));\n      ret.push('+++ ' + fileName + (typeof newHeader === 'undefined' ? '' : '\\t' + newHeader));\n\n      var diff = LineDiff.diff(oldStr, newStr);\n      if (!diff[diff.length-1].value) {\n        diff.pop();   // Remove trailing newline add\n      }\n      diff.push({value: '', lines: []});   // Append an empty value to make cleanup easier\n\n      function contextLines(lines) {\n        return lines.map(function(entry) { return ' ' + entry; });\n      }\n      function eofNL(curRange, i, current) {\n        var last = diff[diff.length-2],\n            isLast = i === diff.length-2,\n            isLastOfType = i === diff.length-3 && (current.added !== last.added || current.removed !== last.removed);\n\n        // Figure out if this is the last line for the given file and missing NL\n        if (!/\\n$/.test(current.value) && (isLast || isLastOfType)) {\n          curRange.push('\\\\ No newline at end of file');\n        }\n      }\n\n      var oldRangeStart = 0, newRangeStart = 0, curRange = [],\n          oldLine = 1, newLine = 1;\n      for (var i = 0; i < diff.length; i++) {\n        var current = diff[i],\n            lines = current.lines || current.value.replace(/\\n$/, '').split('\\n');\n        current.lines = lines;\n\n        if (current.added || current.removed) {\n          if (!oldRangeStart) {\n            var prev = diff[i-1];\n            oldRangeStart = oldLine;\n            newRangeStart = newLine;\n\n            if (prev) {\n              curRange = contextLines(prev.lines.slice(-4));\n              oldRangeStart -= curRange.length;\n              newRangeStart -= curRange.length;\n            }\n          }\n          curRange.push.apply(curRange, lines.map(function(entry) { return (current.added?'+':'-') + entry; }));\n          eofNL(curRange, i, current);\n\n          if (current.added) {\n            newLine += lines.length;\n          } else {\n            oldLine += lines.length;\n          }\n        } else {\n          if (oldRangeStart) {\n            // Close out any changes that have been output (or join overlapping)\n            if (lines.length <= 8 && i < diff.length-2) {\n              // Overlapping\n              curRange.push.apply(curRange, contextLines(lines));\n            } else {\n              // end the range and output\n              var contextSize = Math.min(lines.length, 4);\n              ret.push(\n                  '@@ -' + oldRangeStart + ',' + (oldLine-oldRangeStart+contextSize)\n                  + ' +' + newRangeStart + ',' + (newLine-newRangeStart+contextSize)\n                  + ' @@');\n              ret.push.apply(ret, curRange);\n              ret.push.apply(ret, contextLines(lines.slice(0, contextSize)));\n              if (lines.length <= 4) {\n                eofNL(ret, i, current);\n              }\n\n              oldRangeStart = 0;  newRangeStart = 0; curRange = [];\n            }\n          }\n          oldLine += lines.length;\n          newLine += lines.length;\n        }\n      }\n\n      return ret.join('\\n') + '\\n';\n    },\n\n    applyPatch: function(oldStr, uniDiff) {\n      var diffstr = uniDiff.split('\\n');\n      var diff = [];\n      var remEOFNL = false,\n          addEOFNL = false;\n\n      for (var i = (diffstr[0][0]==='I'?4:0); i < diffstr.length; i++) {\n        if(diffstr[i][0] === '@') {\n          var meh = diffstr[i].split(/@@ -(\\d+),(\\d+) \\+(\\d+),(\\d+) @@/);\n          diff.unshift({\n            start:meh[3],\n            oldlength:meh[2],\n            oldlines:[],\n            newlength:meh[4],\n            newlines:[]\n          });\n        } else if(diffstr[i][0] === '+') {\n          diff[0].newlines.push(diffstr[i].substr(1));\n        } else if(diffstr[i][0] === '-') {\n          diff[0].oldlines.push(diffstr[i].substr(1));\n        } else if(diffstr[i][0] === ' ') {\n          diff[0].newlines.push(diffstr[i].substr(1));\n          diff[0].oldlines.push(diffstr[i].substr(1));\n        } else if(diffstr[i][0] === '\\\\') {\n          if (diffstr[i-1][0] === '+') {\n            remEOFNL = true;\n          } else if(diffstr[i-1][0] === '-') {\n            addEOFNL = true;\n          }\n        }\n      }\n\n      var str = oldStr.split('\\n');\n      for (var i = diff.length - 1; i >= 0; i--) {\n        var d = diff[i];\n        for (var j = 0; j < d.oldlength; j++) {\n          if(str[d.start-1+j] !== d.oldlines[j]) {\n            return false;\n          }\n        }\n        Array.prototype.splice.apply(str,[d.start-1,+d.oldlength].concat(d.newlines));\n      }\n\n      if (remEOFNL) {\n        while (!str[str.length-1]) {\n          str.pop();\n        }\n      } else if (addEOFNL) {\n        str.push('');\n      }\n      return str.join('\\n');\n    },\n\n    convertChangesToXML: function(changes){\n      var ret = [];\n      for ( var i = 0; i < changes.length; i++) {\n        var change = changes[i];\n        if (change.added) {\n          ret.push('<ins>');\n        } else if (change.removed) {\n          ret.push('<del>');\n        }\n\n        ret.push(escapeHTML(change.value));\n\n        if (change.added) {\n          ret.push('</ins>');\n        } else if (change.removed) {\n          ret.push('</del>');\n        }\n      }\n      return ret.join('');\n    },\n\n    // See: http://code.google.com/p/google-diff-match-patch/wiki/API\n    convertChangesToDMP: function(changes){\n      var ret = [], change;\n      for ( var i = 0; i < changes.length; i++) {\n        change = changes[i];\n        ret.push([(change.added ? 1 : change.removed ? -1 : 0), change.value]);\n      }\n      return ret;\n    }\n  };\n})();\n\nif (typeof module !== 'undefined') {\n    module.exports = JsDiff;\n}\n\n}); // module: browser/diff.js\n\nrequire.register(\"browser/escape-string-regexp.js\", function(module, exports, require){\n'use strict';\n\nvar matchOperatorsRe = /[|\\\\{}()[\\]^$+*?.]/g;\n\nmodule.exports = function (str) {\n  if (typeof str !== 'string') {\n    throw new TypeError('Expected a string');\n  }\n\n  return str.replace(matchOperatorsRe,  '\\\\$&');\n};\n\n}); // module: browser/escape-string-regexp.js\n\nrequire.register(\"browser/events.js\", function(module, exports, require){\n/**\n * Module exports.\n */\n\nexports.EventEmitter = EventEmitter;\n\n/**\n * Check if `obj` is an array.\n */\n\nfunction isArray(obj) {\n  return '[object Array]' == {}.toString.call(obj);\n}\n\n/**\n * Event emitter constructor.\n *\n * @api public\n */\n\nfunction EventEmitter(){};\n\n/**\n * Adds a listener.\n *\n * @api public\n */\n\nEventEmitter.prototype.on = function (name, fn) {\n  if (!this.$events) {\n    this.$events = {};\n  }\n\n  if (!this.$events[name]) {\n    this.$events[name] = fn;\n  } else if (isArray(this.$events[name])) {\n    this.$events[name].push(fn);\n  } else {\n    this.$events[name] = [this.$events[name], fn];\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n/**\n * Adds a volatile listener.\n *\n * @api public\n */\n\nEventEmitter.prototype.once = function (name, fn) {\n  var self = this;\n\n  function on () {\n    self.removeListener(name, on);\n    fn.apply(this, arguments);\n  };\n\n  on.listener = fn;\n  this.on(name, on);\n\n  return this;\n};\n\n/**\n * Removes a listener.\n *\n * @api public\n */\n\nEventEmitter.prototype.removeListener = function (name, fn) {\n  if (this.$events && this.$events[name]) {\n    var list = this.$events[name];\n\n    if (isArray(list)) {\n      var pos = -1;\n\n      for (var i = 0, l = list.length; i < l; i++) {\n        if (list[i] === fn || (list[i].listener && list[i].listener === fn)) {\n          pos = i;\n          break;\n        }\n      }\n\n      if (pos < 0) {\n        return this;\n      }\n\n      list.splice(pos, 1);\n\n      if (!list.length) {\n        delete this.$events[name];\n      }\n    } else if (list === fn || (list.listener && list.listener === fn)) {\n      delete this.$events[name];\n    }\n  }\n\n  return this;\n};\n\n/**\n * Removes all listeners for an event.\n *\n * @api public\n */\n\nEventEmitter.prototype.removeAllListeners = function (name) {\n  if (name === undefined) {\n    this.$events = {};\n    return this;\n  }\n\n  if (this.$events && this.$events[name]) {\n    this.$events[name] = null;\n  }\n\n  return this;\n};\n\n/**\n * Gets all listeners for a certain event.\n *\n * @api public\n */\n\nEventEmitter.prototype.listeners = function (name) {\n  if (!this.$events) {\n    this.$events = {};\n  }\n\n  if (!this.$events[name]) {\n    this.$events[name] = [];\n  }\n\n  if (!isArray(this.$events[name])) {\n    this.$events[name] = [this.$events[name]];\n  }\n\n  return this.$events[name];\n};\n\n/**\n * Emits an event.\n *\n * @api public\n */\n\nEventEmitter.prototype.emit = function (name) {\n  if (!this.$events) {\n    return false;\n  }\n\n  var handler = this.$events[name];\n\n  if (!handler) {\n    return false;\n  }\n\n  var args = [].slice.call(arguments, 1);\n\n  if ('function' == typeof handler) {\n    handler.apply(this, args);\n  } else if (isArray(handler)) {\n    var listeners = handler.slice();\n\n    for (var i = 0, l = listeners.length; i < l; i++) {\n      listeners[i].apply(this, args);\n    }\n  } else {\n    return false;\n  }\n\n  return true;\n};\n\n}); // module: browser/events.js\n\nrequire.register(\"browser/fs.js\", function(module, exports, require){\n\n}); // module: browser/fs.js\n\nrequire.register(\"browser/glob.js\", function(module, exports, require){\n\n}); // module: browser/glob.js\n\nrequire.register(\"browser/path.js\", function(module, exports, require){\n\n}); // module: browser/path.js\n\nrequire.register(\"browser/progress.js\", function(module, exports, require){\n/**\n * Expose `Progress`.\n */\n\nmodule.exports = Progress;\n\n/**\n * Initialize a new `Progress` indicator.\n */\n\nfunction Progress() {\n  this.percent = 0;\n  this.size(0);\n  this.fontSize(11);\n  this.font('helvetica, arial, sans-serif');\n}\n\n/**\n * Set progress size to `n`.\n *\n * @param {Number} n\n * @return {Progress} for chaining\n * @api public\n */\n\nProgress.prototype.size = function(n){\n  this._size = n;\n  return this;\n};\n\n/**\n * Set text to `str`.\n *\n * @param {String} str\n * @return {Progress} for chaining\n * @api public\n */\n\nProgress.prototype.text = function(str){\n  this._text = str;\n  return this;\n};\n\n/**\n * Set font size to `n`.\n *\n * @param {Number} n\n * @return {Progress} for chaining\n * @api public\n */\n\nProgress.prototype.fontSize = function(n){\n  this._fontSize = n;\n  return this;\n};\n\n/**\n * Set font `family`.\n *\n * @param {String} family\n * @return {Progress} for chaining\n */\n\nProgress.prototype.font = function(family){\n  this._font = family;\n  return this;\n};\n\n/**\n * Update percentage to `n`.\n *\n * @param {Number} n\n * @return {Progress} for chaining\n */\n\nProgress.prototype.update = function(n){\n  this.percent = n;\n  return this;\n};\n\n/**\n * Draw on `ctx`.\n *\n * @param {CanvasRenderingContext2d} ctx\n * @return {Progress} for chaining\n */\n\nProgress.prototype.draw = function(ctx){\n  try {\n    var percent = Math.min(this.percent, 100)\n      , size = this._size\n      , half = size / 2\n      , x = half\n      , y = half\n      , rad = half - 1\n      , fontSize = this._fontSize;\n\n    ctx.font = fontSize + 'px ' + this._font;\n\n    var angle = Math.PI * 2 * (percent / 100);\n    ctx.clearRect(0, 0, size, size);\n\n    // outer circle\n    ctx.strokeStyle = '#9f9f9f';\n    ctx.beginPath();\n    ctx.arc(x, y, rad, 0, angle, false);\n    ctx.stroke();\n\n    // inner circle\n    ctx.strokeStyle = '#eee';\n    ctx.beginPath();\n    ctx.arc(x, y, rad - 1, 0, angle, true);\n    ctx.stroke();\n\n    // text\n    var text = this._text || (percent | 0) + '%'\n      , w = ctx.measureText(text).width;\n\n    ctx.fillText(\n        text\n      , x - w / 2 + 1\n      , y + fontSize / 2 - 1);\n  } catch (ex) {} //don't fail if we can't render progress\n  return this;\n};\n\n}); // module: browser/progress.js\n\nrequire.register(\"browser/tty.js\", function(module, exports, require){\nexports.isatty = function(){\n  return true;\n};\n\nexports.getWindowSize = function(){\n  if ('innerHeight' in global) {\n    return [global.innerHeight, global.innerWidth];\n  } else {\n    // In a Web Worker, the DOM Window is not available.\n    return [640, 480];\n  }\n};\n\n}); // module: browser/tty.js\n\nrequire.register(\"context.js\", function(module, exports, require){\n/**\n * Expose `Context`.\n */\n\nmodule.exports = Context;\n\n/**\n * Initialize a new `Context`.\n *\n * @api private\n */\n\nfunction Context(){}\n\n/**\n * Set or get the context `Runnable` to `runnable`.\n *\n * @param {Runnable} runnable\n * @return {Context}\n * @api private\n */\n\nContext.prototype.runnable = function(runnable){\n  if (0 == arguments.length) return this._runnable;\n  this.test = this._runnable = runnable;\n  return this;\n};\n\n/**\n * Set test timeout `ms`.\n *\n * @param {Number} ms\n * @return {Context} self\n * @api private\n */\n\nContext.prototype.timeout = function(ms){\n  if (arguments.length === 0) return this.runnable().timeout();\n  this.runnable().timeout(ms);\n  return this;\n};\n\n/**\n * Set test timeout `enabled`.\n *\n * @param {Boolean} enabled\n * @return {Context} self\n * @api private\n */\n\nContext.prototype.enableTimeouts = function (enabled) {\n  this.runnable().enableTimeouts(enabled);\n  return this;\n};\n\n\n/**\n * Set test slowness threshold `ms`.\n *\n * @param {Number} ms\n * @return {Context} self\n * @api private\n */\n\nContext.prototype.slow = function(ms){\n  this.runnable().slow(ms);\n  return this;\n};\n\n/**\n * Mark a test as skipped.\n *\n * @return {Context} self\n * @api private\n */\n\nContext.prototype.skip = function(){\n    this.runnable().skip();\n    return this;\n};\n\n/**\n * Inspect the context void of `._runnable`.\n *\n * @return {String}\n * @api private\n */\n\nContext.prototype.inspect = function(){\n  return JSON.stringify(this, function(key, val){\n    if ('_runnable' == key) return;\n    if ('test' == key) return;\n    return val;\n  }, 2);\n};\n\n}); // module: context.js\n\nrequire.register(\"hook.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Runnable = require('./runnable');\n\n/**\n * Expose `Hook`.\n */\n\nmodule.exports = Hook;\n\n/**\n * Initialize a new `Hook` with the given `title` and callback `fn`.\n *\n * @param {String} title\n * @param {Function} fn\n * @api private\n */\n\nfunction Hook(title, fn) {\n  Runnable.call(this, title, fn);\n  this.type = 'hook';\n}\n\n/**\n * Inherit from `Runnable.prototype`.\n */\n\nfunction F(){};\nF.prototype = Runnable.prototype;\nHook.prototype = new F;\nHook.prototype.constructor = Hook;\n\n\n/**\n * Get or set the test `err`.\n *\n * @param {Error} err\n * @return {Error}\n * @api public\n */\n\nHook.prototype.error = function(err){\n  if (0 == arguments.length) {\n    var err = this._error;\n    this._error = null;\n    return err;\n  }\n\n  this._error = err;\n};\n\n}); // module: hook.js\n\nrequire.register(\"interfaces/bdd.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Suite = require('../suite')\n  , Test = require('../test')\n  , utils = require('../utils')\n  , escapeRe = require('browser/escape-string-regexp');\n\n/**\n * BDD-style interface:\n *\n *      describe('Array', function(){\n *        describe('#indexOf()', function(){\n *          it('should return -1 when not present', function(){\n *\n *          });\n *\n *          it('should return the index when present', function(){\n *\n *          });\n *        });\n *      });\n *\n */\n\nmodule.exports = function(suite){\n  var suites = [suite];\n\n  suite.on('pre-require', function(context, file, mocha){\n\n    var common = require('./common')(suites, context);\n\n    context.before = common.before;\n    context.after = common.after;\n    context.beforeEach = common.beforeEach;\n    context.afterEach = common.afterEach;\n    context.run = mocha.options.delay && common.runWithSuite(suite);\n    /**\n     * Describe a \"suite\" with the given `title`\n     * and callback `fn` containing nested suites\n     * and/or tests.\n     */\n\n    context.describe = context.context = function(title, fn){\n      var suite = Suite.create(suites[0], title);\n      suite.file = file;\n      suites.unshift(suite);\n      fn.call(suite);\n      suites.shift();\n      return suite;\n    };\n\n    /**\n     * Pending describe.\n     */\n\n    context.xdescribe =\n    context.xcontext =\n    context.describe.skip = function(title, fn){\n      var suite = Suite.create(suites[0], title);\n      suite.pending = true;\n      suites.unshift(suite);\n      fn.call(suite);\n      suites.shift();\n    };\n\n    /**\n     * Exclusive suite.\n     */\n\n    context.describe.only = function(title, fn){\n      var suite = context.describe(title, fn);\n      mocha.grep(suite.fullTitle());\n      return suite;\n    };\n\n    /**\n     * Describe a specification or test-case\n     * with the given `title` and callback `fn`\n     * acting as a thunk.\n     */\n\n    context.it = context.specify = function(title, fn){\n      var suite = suites[0];\n      if (suite.pending) fn = null;\n      var test = new Test(title, fn);\n      test.file = file;\n      suite.addTest(test);\n      return test;\n    };\n\n    /**\n     * Exclusive test-case.\n     */\n\n    context.it.only = function(title, fn){\n      var test = context.it(title, fn);\n      var reString = '^' + escapeRe(test.fullTitle()) + '$';\n      mocha.grep(new RegExp(reString));\n      return test;\n    };\n\n    /**\n     * Pending test case.\n     */\n\n    context.xit =\n    context.xspecify =\n    context.it.skip = function(title){\n      context.it(title);\n    };\n\n  });\n};\n\n}); // module: interfaces/bdd.js\n\nrequire.register(\"interfaces/common.js\", function(module, exports, require){\n/**\n * Functions common to more than one interface\n * @module lib/interfaces/common\n */\n\n'use strict';\n\nmodule.exports = function (suites, context) {\n\n  return {\n    /**\n     * This is only present if flag --delay is passed into Mocha.  It triggers\n     * root suite execution.  Returns a function which runs the root suite.\n     */\n    runWithSuite: function runWithSuite(suite) {\n      return function run() {\n        suite.run();\n      };\n    },\n\n    /**\n     * Execute before running tests.\n     */\n    before: function (name, fn) {\n      suites[0].beforeAll(name, fn);\n    },\n\n    /**\n     * Execute after running tests.\n     */\n    after: function (name, fn) {\n      suites[0].afterAll(name, fn);\n    },\n\n    /**\n     * Execute before each test case.\n     */\n    beforeEach: function (name, fn) {\n      suites[0].beforeEach(name, fn);\n    },\n\n    /**\n     * Execute after each test case.\n     */\n    afterEach: function (name, fn) {\n      suites[0].afterEach(name, fn);\n    },\n\n    test: {\n      /**\n       * Pending test case.\n       */\n      skip: function (title) {\n        context.test(title);\n      }\n    }\n  }\n};\n\n}); // module: interfaces/common.js\n\nrequire.register(\"interfaces/exports.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Suite = require('../suite')\n  , Test = require('../test');\n\n/**\n * TDD-style interface:\n *\n *     exports.Array = {\n *       '#indexOf()': {\n *         'should return -1 when the value is not present': function(){\n *\n *         },\n *\n *         'should return the correct index when the value is present': function(){\n *\n *         }\n *       }\n *     };\n *\n */\n\nmodule.exports = function(suite){\n  var suites = [suite];\n\n  suite.on('require', visit);\n\n  function visit(obj, file) {\n    var suite;\n    for (var key in obj) {\n      if ('function' == typeof obj[key]) {\n        var fn = obj[key];\n        switch (key) {\n          case 'before':\n            suites[0].beforeAll(fn);\n            break;\n          case 'after':\n            suites[0].afterAll(fn);\n            break;\n          case 'beforeEach':\n            suites[0].beforeEach(fn);\n            break;\n          case 'afterEach':\n            suites[0].afterEach(fn);\n            break;\n          default:\n            var test = new Test(key, fn);\n            test.file = file;\n            suites[0].addTest(test);\n        }\n      } else {\n        suite = Suite.create(suites[0], key);\n        suites.unshift(suite);\n        visit(obj[key]);\n        suites.shift();\n      }\n    }\n  }\n};\n\n}); // module: interfaces/exports.js\n\nrequire.register(\"interfaces/index.js\", function(module, exports, require){\nexports.bdd = require('./bdd');\nexports.tdd = require('./tdd');\nexports.qunit = require('./qunit');\nexports.exports = require('./exports');\n\n}); // module: interfaces/index.js\n\nrequire.register(\"interfaces/qunit.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Suite = require('../suite')\n  , Test = require('../test')\n  , escapeRe = require('browser/escape-string-regexp')\n  , utils = require('../utils');\n\n/**\n * QUnit-style interface:\n *\n *     suite('Array');\n *\n *     test('#length', function(){\n *       var arr = [1,2,3];\n *       ok(arr.length == 3);\n *     });\n *\n *     test('#indexOf()', function(){\n *       var arr = [1,2,3];\n *       ok(arr.indexOf(1) == 0);\n *       ok(arr.indexOf(2) == 1);\n *       ok(arr.indexOf(3) == 2);\n *     });\n *\n *     suite('String');\n *\n *     test('#length', function(){\n *       ok('foo'.length == 3);\n *     });\n *\n */\n\nmodule.exports = function(suite){\n  var suites = [suite];\n\n  suite.on('pre-require', function(context, file, mocha){\n\n    var common = require('./common')(suites, context);\n\n    context.before = common.before;\n    context.after = common.after;\n    context.beforeEach = common.beforeEach;\n    context.afterEach = common.afterEach;\n    context.run = mocha.options.delay && common.runWithSuite(suite);\n    /**\n     * Describe a \"suite\" with the given `title`.\n     */\n\n    context.suite = function(title){\n      if (suites.length > 1) suites.shift();\n      var suite = Suite.create(suites[0], title);\n      suite.file = file;\n      suites.unshift(suite);\n      return suite;\n    };\n\n    /**\n     * Exclusive test-case.\n     */\n\n    context.suite.only = function(title, fn){\n      var suite = context.suite(title, fn);\n      mocha.grep(suite.fullTitle());\n    };\n\n    /**\n     * Describe a specification or test-case\n     * with the given `title` and callback `fn`\n     * acting as a thunk.\n     */\n\n    context.test = function(title, fn){\n      var test = new Test(title, fn);\n      test.file = file;\n      suites[0].addTest(test);\n      return test;\n    };\n\n    /**\n     * Exclusive test-case.\n     */\n\n    context.test.only = function(title, fn){\n      var test = context.test(title, fn);\n      var reString = '^' + escapeRe(test.fullTitle()) + '$';\n      mocha.grep(new RegExp(reString));\n    };\n\n    context.test.skip = common.test.skip;\n\n  });\n};\n\n}); // module: interfaces/qunit.js\n\nrequire.register(\"interfaces/tdd.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Suite = require('../suite')\n  , Test = require('../test')\n  , escapeRe = require('browser/escape-string-regexp')\n  , utils = require('../utils');\n\n/**\n * TDD-style interface:\n *\n *      suite('Array', function(){\n *        suite('#indexOf()', function(){\n *          suiteSetup(function(){\n *\n *          });\n *\n *          test('should return -1 when not present', function(){\n *\n *          });\n *\n *          test('should return the index when present', function(){\n *\n *          });\n *\n *          suiteTeardown(function(){\n *\n *          });\n *        });\n *      });\n *\n */\n\nmodule.exports = function(suite){\n  var suites = [suite];\n\n  suite.on('pre-require', function(context, file, mocha){\n\n    var common = require('./common')(suites, context);\n\n    context.setup = common.beforeEach;\n    context.teardown = common.afterEach;\n    context.suiteSetup = common.before;\n    context.suiteTeardown = common.after;\n    context.run = mocha.options.delay && common.runWithSuite(suite);\n    /**\n     * Describe a \"suite\" with the given `title`\n     * and callback `fn` containing nested suites\n     * and/or tests.\n     */\n\n    context.suite = function(title, fn){\n      var suite = Suite.create(suites[0], title);\n      suite.file = file;\n      suites.unshift(suite);\n      fn.call(suite);\n      suites.shift();\n      return suite;\n    };\n\n    /**\n     * Pending suite.\n     */\n    context.suite.skip = function(title, fn) {\n      var suite = Suite.create(suites[0], title);\n      suite.pending = true;\n      suites.unshift(suite);\n      fn.call(suite);\n      suites.shift();\n    };\n\n    /**\n     * Exclusive test-case.\n     */\n\n    context.suite.only = function(title, fn){\n      var suite = context.suite(title, fn);\n      mocha.grep(suite.fullTitle());\n    };\n\n    /**\n     * Describe a specification or test-case\n     * with the given `title` and callback `fn`\n     * acting as a thunk.\n     */\n\n    context.test = function(title, fn){\n      var suite = suites[0];\n      if (suite.pending) fn = null;\n      var test = new Test(title, fn);\n      test.file = file;\n      suite.addTest(test);\n      return test;\n    };\n\n    /**\n     * Exclusive test-case.\n     */\n\n    context.test.only = function(title, fn){\n      var test = context.test(title, fn);\n      var reString = '^' + escapeRe(test.fullTitle()) + '$';\n      mocha.grep(new RegExp(reString));\n    };\n\n    context.test.skip = common.test.skip;\n  });\n};\n\n}); // module: interfaces/tdd.js\n\nrequire.register(\"mocha.js\", function(module, exports, require){\n/*!\n * mocha\n * Copyright(c) 2011 TJ Holowaychuk <tj@vision-media.ca>\n * MIT Licensed\n */\n\n/**\n * Module dependencies.\n */\n\nvar path = require('browser/path')\n  , escapeRe = require('browser/escape-string-regexp')\n  , utils = require('./utils');\n\n/**\n * Expose `Mocha`.\n */\n\nexports = module.exports = Mocha;\n\n/**\n * To require local UIs and reporters when running in node.\n */\n\nif (typeof process !== 'undefined' && typeof process.cwd === 'function') {\n  var join = path.join\n    , cwd = process.cwd();\n  module.paths.push(cwd, join(cwd, 'node_modules'));\n}\n\n/**\n * Expose internals.\n */\n\nexports.utils = utils;\nexports.interfaces = require('./interfaces');\nexports.reporters = require('./reporters');\nexports.Runnable = require('./runnable');\nexports.Context = require('./context');\nexports.Runner = require('./runner');\nexports.Suite = require('./suite');\nexports.Hook = require('./hook');\nexports.Test = require('./test');\n\n/**\n * Return image `name` path.\n *\n * @param {String} name\n * @return {String}\n * @api private\n */\n\nfunction image(name) {\n  return __dirname + '/../images/' + name + '.png';\n}\n\n/**\n * Setup mocha with `options`.\n *\n * Options:\n *\n *   - `ui` name \"bdd\", \"tdd\", \"exports\" etc\n *   - `reporter` reporter instance, defaults to `mocha.reporters.spec`\n *   - `globals` array of accepted globals\n *   - `timeout` timeout in milliseconds\n *   - `bail` bail on the first test failure\n *   - `slow` milliseconds to wait before considering a test slow\n *   - `ignoreLeaks` ignore global leaks\n *   - `grep` string or regexp to filter tests with\n *\n * @param {Object} options\n * @api public\n */\n\nfunction Mocha(options) {\n  options = options || {};\n  this.files = [];\n  this.options = options;\n  if (options.grep) this.grep(new RegExp(options.grep));\n  if (options.fgrep) this.grep(options.fgrep);\n  this.suite = new exports.Suite('', new exports.Context);\n  this.ui(options.ui);\n  this.bail(options.bail);\n  this.reporter(options.reporter, options.reporterOptions);\n  if (null != options.timeout) this.timeout(options.timeout);\n  this.useColors(options.useColors)\n  if (options.enableTimeouts !== null) this.enableTimeouts(options.enableTimeouts);\n  if (options.slow) this.slow(options.slow);\n\n  this.suite.on('pre-require', function (context) {\n    exports.afterEach = context.afterEach || context.teardown;\n    exports.after = context.after || context.suiteTeardown;\n    exports.beforeEach = context.beforeEach || context.setup;\n    exports.before = context.before || context.suiteSetup;\n    exports.describe = context.describe || context.suite;\n    exports.it = context.it || context.test;\n    exports.setup = context.setup || context.beforeEach;\n    exports.suiteSetup = context.suiteSetup || context.before;\n    exports.suiteTeardown = context.suiteTeardown || context.after;\n    exports.suite = context.suite || context.describe;\n    exports.teardown = context.teardown || context.afterEach;\n    exports.test = context.test || context.it;\n    exports.run = context.run;\n  });\n}\n\n/**\n * Enable or disable bailing on the first failure.\n *\n * @param {Boolean} [bail]\n * @api public\n */\n\nMocha.prototype.bail = function(bail){\n  if (0 == arguments.length) bail = true;\n  this.suite.bail(bail);\n  return this;\n};\n\n/**\n * Add test `file`.\n *\n * @param {String} file\n * @api public\n */\n\nMocha.prototype.addFile = function(file){\n  this.files.push(file);\n  return this;\n};\n\n/**\n * Set reporter to `reporter`, defaults to \"spec\".\n *\n * @param {String|Function} reporter name or constructor\n * @param {Object} reporterOptions optional options\n * @api public\n */\nMocha.prototype.reporter = function(reporter, reporterOptions){\n  if ('function' == typeof reporter) {\n    this._reporter = reporter;\n  } else {\n    reporter = reporter || 'spec';\n    var _reporter;\n    try { _reporter = require('./reporters/' + reporter); } catch (err) {};\n    if (!_reporter) try { _reporter = require(reporter); } catch (err) {};\n    if (!_reporter && reporter === 'teamcity')\n      console.warn('The Teamcity reporter was moved to a package named ' +\n        'mocha-teamcity-reporter ' +\n        '(https://npmjs.org/package/mocha-teamcity-reporter).');\n    if (!_reporter) throw new Error('invalid reporter \"' + reporter + '\"');\n    this._reporter = _reporter;\n  }\n  this.options.reporterOptions = reporterOptions;\n  return this;\n};\n\n/**\n * Set test UI `name`, defaults to \"bdd\".\n *\n * @param {String} bdd\n * @api public\n */\n\nMocha.prototype.ui = function(name){\n  name = name || 'bdd';\n  this._ui = exports.interfaces[name];\n  if (!this._ui) try { this._ui = require(name); } catch (err) {};\n  if (!this._ui) throw new Error('invalid interface \"' + name + '\"');\n  this._ui = this._ui(this.suite);\n  return this;\n};\n\n/**\n * Load registered files.\n *\n * @api private\n */\n\nMocha.prototype.loadFiles = function(fn){\n  var self = this;\n  var suite = this.suite;\n  var pending = this.files.length;\n  this.files.forEach(function(file){\n    file = path.resolve(file);\n    suite.emit('pre-require', global, file, self);\n    suite.emit('require', require(file), file, self);\n    suite.emit('post-require', global, file, self);\n    --pending || (fn && fn());\n  });\n};\n\n/**\n * Enable growl support.\n *\n * @api private\n */\n\nMocha.prototype._growl = function(runner, reporter) {\n  var notify = require('growl');\n\n  runner.on('end', function(){\n    var stats = reporter.stats;\n    if (stats.failures) {\n      var msg = stats.failures + ' of ' + runner.total + ' tests failed';\n      notify(msg, { name: 'mocha', title: 'Failed', image: image('error') });\n    } else {\n      notify(stats.passes + ' tests passed in ' + stats.duration + 'ms', {\n          name: 'mocha'\n        , title: 'Passed'\n        , image: image('ok')\n      });\n    }\n  });\n};\n\n/**\n * Add regexp to grep, if `re` is a string it is escaped.\n *\n * @param {RegExp|String} re\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.grep = function(re){\n  this.options.grep = 'string' == typeof re\n    ? new RegExp(escapeRe(re))\n    : re;\n  return this;\n};\n\n/**\n * Invert `.grep()` matches.\n *\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.invert = function(){\n  this.options.invert = true;\n  return this;\n};\n\n/**\n * Ignore global leaks.\n *\n * @param {Boolean} ignore\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.ignoreLeaks = function(ignore){\n  this.options.ignoreLeaks = !!ignore;\n  return this;\n};\n\n/**\n * Enable global leak checking.\n *\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.checkLeaks = function(){\n  this.options.ignoreLeaks = false;\n  return this;\n};\n\n/**\n * Enable growl support.\n *\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.growl = function(){\n  this.options.growl = true;\n  return this;\n};\n\n/**\n * Ignore `globals` array or string.\n *\n * @param {Array|String} globals\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.globals = function(globals){\n  this.options.globals = (this.options.globals || []).concat(globals);\n  return this;\n};\n\n/**\n * Emit color output.\n *\n * @param {Boolean} colors\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.useColors = function(colors){\n  if (colors !== undefined) {\n    this.options.useColors = colors;\n  }\n  return this;\n};\n\n/**\n * Use inline diffs rather than +/-.\n *\n * @param {Boolean} inlineDiffs\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.useInlineDiffs = function(inlineDiffs) {\n  this.options.useInlineDiffs = arguments.length && inlineDiffs != undefined\n  ? inlineDiffs\n  : false;\n  return this;\n};\n\n/**\n * Set the timeout in milliseconds.\n *\n * @param {Number} timeout\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.timeout = function(timeout){\n  this.suite.timeout(timeout);\n  return this;\n};\n\n/**\n * Set slowness threshold in milliseconds.\n *\n * @param {Number} slow\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.slow = function(slow){\n  this.suite.slow(slow);\n  return this;\n};\n\n/**\n * Enable timeouts.\n *\n * @param {Boolean} enabled\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.enableTimeouts = function(enabled) {\n  this.suite.enableTimeouts(arguments.length && enabled !== undefined\n    ? enabled\n    : true);\n  return this\n};\n\n/**\n * Makes all tests async (accepting a callback)\n *\n * @return {Mocha}\n * @api public\n */\n\nMocha.prototype.asyncOnly = function(){\n  this.options.asyncOnly = true;\n  return this;\n};\n\n/**\n * Disable syntax highlighting (in browser).\n * @returns {Mocha}\n * @api public\n */\nMocha.prototype.noHighlighting = function() {\n  this.options.noHighlighting = true;\n  return this;\n};\n\n/**\n * Delay root suite execution.\n * @returns {Mocha}\n * @api public\n */\nMocha.prototype.delay = function delay() {\n  this.options.delay = true;\n  return this;\n};\n\n/**\n * Run tests and invoke `fn()` when complete.\n *\n * @param {Function} fn\n * @return {Runner}\n * @api public\n */\nMocha.prototype.run = function(fn){\n  if (this.files.length) this.loadFiles();\n  var suite = this.suite;\n  var options = this.options;\n  options.files = this.files;\n  var runner = new exports.Runner(suite, options.delay);\n  var reporter = new this._reporter(runner, options);\n  runner.ignoreLeaks = false !== options.ignoreLeaks;\n  runner.asyncOnly = options.asyncOnly;\n  if (options.grep) runner.grep(options.grep, options.invert);\n  if (options.globals) runner.globals(options.globals);\n  if (options.growl) this._growl(runner, reporter);\n  if (options.useColors !== undefined) {\n    exports.reporters.Base.useColors = options.useColors;\n  }\n  exports.reporters.Base.inlineDiffs = options.useInlineDiffs;\n\n  function done(failures) {\n      if (reporter.done) {\n          reporter.done(failures, fn);\n      } else fn && fn(failures);\n  }\n\n  return runner.run(done);\n};\n\n}); // module: mocha.js\n\nrequire.register(\"ms.js\", function(module, exports, require){\n/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} options\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options){\n  options = options || {};\n  if ('string' == typeof val) return parse(val);\n  return options['long'] ? longFormat(val) : shortFormat(val);\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  var match = /^((?:\\d+)?\\.?\\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(str);\n  if (!match) return;\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 's':\n      return n * s;\n    case 'ms':\n      return n;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction shortFormat(ms) {\n  if (ms >= d) return Math.round(ms / d) + 'd';\n  if (ms >= h) return Math.round(ms / h) + 'h';\n  if (ms >= m) return Math.round(ms / m) + 'm';\n  if (ms >= s) return Math.round(ms / s) + 's';\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction longFormat(ms) {\n  return plural(ms, d, 'day')\n    || plural(ms, h, 'hour')\n    || plural(ms, m, 'minute')\n    || plural(ms, s, 'second')\n    || ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) return;\n  if (ms < n * 1.5) return Math.floor(ms / n) + ' ' + name;\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n\n}); // module: ms.js\n\nrequire.register(\"pending.js\", function(module, exports, require){\n\n/**\n * Expose `Pending`.\n */\n\nmodule.exports = Pending;\n\n/**\n * Initialize a new `Pending` error with the given message.\n *\n * @param {String} message\n */\n\nfunction Pending(message) {\n    this.message = message;\n}\n\n}); // module: pending.js\n\nrequire.register(\"reporters/base.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar tty = require('browser/tty')\n  , diff = require('browser/diff')\n  , ms = require('../ms')\n  , utils = require('../utils')\n  , supportsColor = process.env ? require('supports-color') : null;\n\n/**\n * Save timer references to avoid Sinon interfering (see GH-237).\n */\n\nvar Date = global.Date\n  , setTimeout = global.setTimeout\n  , setInterval = global.setInterval\n  , clearTimeout = global.clearTimeout\n  , clearInterval = global.clearInterval;\n\n/**\n * Check if both stdio streams are associated with a tty.\n */\n\nvar isatty = tty.isatty(1) && tty.isatty(2);\n\n/**\n * Expose `Base`.\n */\n\nexports = module.exports = Base;\n\n/**\n * Enable coloring by default, except in the browser interface.\n */\n\nexports.useColors = process.env\n  ? (supportsColor || (process.env.MOCHA_COLORS !== undefined))\n  : false;\n\n/**\n * Inline diffs instead of +/-\n */\n\nexports.inlineDiffs = false;\n\n/**\n * Default color map.\n */\n\nexports.colors = {\n    'pass': 90\n  , 'fail': 31\n  , 'bright pass': 92\n  , 'bright fail': 91\n  , 'bright yellow': 93\n  , 'pending': 36\n  , 'suite': 0\n  , 'error title': 0\n  , 'error message': 31\n  , 'error stack': 90\n  , 'checkmark': 32\n  , 'fast': 90\n  , 'medium': 33\n  , 'slow': 31\n  , 'green': 32\n  , 'light': 90\n  , 'diff gutter': 90\n  , 'diff added': 42\n  , 'diff removed': 41\n};\n\n/**\n * Default symbol map.\n */\n\nexports.symbols = {\n  ok: '✓',\n  err: '✖',\n  dot: '․'\n};\n\n// With node.js on Windows: use symbols available in terminal default fonts\nif ('win32' == process.platform) {\n  exports.symbols.ok = '\\u221A';\n  exports.symbols.err = '\\u00D7';\n  exports.symbols.dot = '.';\n}\n\n/**\n * Color `str` with the given `type`,\n * allowing colors to be disabled,\n * as well as user-defined color\n * schemes.\n *\n * @param {String} type\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nvar color = exports.color = function(type, str) {\n  if (!exports.useColors) return String(str);\n  return '\\u001b[' + exports.colors[type] + 'm' + str + '\\u001b[0m';\n};\n\n/**\n * Expose term window size, with some\n * defaults for when stderr is not a tty.\n */\n\nexports.window = {\n  width: isatty\n    ? process.stdout.getWindowSize\n      ? process.stdout.getWindowSize(1)[0]\n      : tty.getWindowSize()[1]\n    : 75\n};\n\n/**\n * Expose some basic cursor interactions\n * that are common among reporters.\n */\n\nexports.cursor = {\n  hide: function(){\n    isatty && process.stdout.write('\\u001b[?25l');\n  },\n\n  show: function(){\n    isatty && process.stdout.write('\\u001b[?25h');\n  },\n\n  deleteLine: function(){\n    isatty && process.stdout.write('\\u001b[2K');\n  },\n\n  beginningOfLine: function(){\n    isatty && process.stdout.write('\\u001b[0G');\n  },\n\n  CR: function(){\n    if (isatty) {\n      exports.cursor.deleteLine();\n      exports.cursor.beginningOfLine();\n    } else {\n      process.stdout.write('\\r');\n    }\n  }\n};\n\n/**\n * Outut the given `failures` as a list.\n *\n * @param {Array} failures\n * @api public\n */\n\nexports.list = function(failures){\n  console.log();\n  failures.forEach(function(test, i){\n    // format\n    var fmt = color('error title', '  %s) %s:\\n')\n      + color('error message', '     %s')\n      + color('error stack', '\\n%s\\n');\n\n    // msg\n    var err = test.err\n      , message = err.message || ''\n      , stack = err.stack || message\n      , index = stack.indexOf(message) + message.length\n      , msg = stack.slice(0, index)\n      , actual = err.actual\n      , expected = err.expected\n      , escape = true;\n\n    // uncaught\n    if (err.uncaught) {\n      msg = 'Uncaught ' + msg;\n    }\n    // explicitly show diff\n    if (err.showDiff && sameType(actual, expected)) {\n\n      if ('string' !== typeof actual) {\n        escape = false;\n        err.actual = actual = utils.stringify(actual);\n        err.expected = expected = utils.stringify(expected);\n      }\n\n      fmt = color('error title', '  %s) %s:\\n%s') + color('error stack', '\\n%s\\n');\n      var match = message.match(/^([^:]+): expected/);\n      msg = '\\n      ' + color('error message', match ? match[1] : msg);\n\n      if (exports.inlineDiffs) {\n        msg += inlineDiff(err, escape);\n      } else {\n        msg += unifiedDiff(err, escape);\n      }\n    }\n\n    // indent stack trace without msg\n    stack = stack.slice(index ? index + 1 : index)\n      .replace(/^/gm, '  ');\n\n    console.log(fmt, (i + 1), test.fullTitle(), msg, stack);\n  });\n};\n\n/**\n * Initialize a new `Base` reporter.\n *\n * All other reporters generally\n * inherit from this reporter, providing\n * stats such as test duration, number\n * of tests passed / failed etc.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction Base(runner) {\n  var self = this\n    , stats = this.stats = { suites: 0, tests: 0, passes: 0, pending: 0, failures: 0 }\n    , failures = this.failures = [];\n\n  if (!runner) return;\n  this.runner = runner;\n\n  runner.stats = stats;\n\n  runner.on('start', function(){\n    stats.start = new Date;\n  });\n\n  runner.on('suite', function(suite){\n    stats.suites = stats.suites || 0;\n    suite.root || stats.suites++;\n  });\n\n  runner.on('test end', function(test){\n    stats.tests = stats.tests || 0;\n    stats.tests++;\n  });\n\n  runner.on('pass', function(test){\n    stats.passes = stats.passes || 0;\n\n    var medium = test.slow() / 2;\n    test.speed = test.duration > test.slow()\n      ? 'slow'\n      : test.duration > medium\n        ? 'medium'\n        : 'fast';\n\n    stats.passes++;\n  });\n\n  runner.on('fail', function(test, err){\n    stats.failures = stats.failures || 0;\n    stats.failures++;\n    test.err = err;\n    failures.push(test);\n  });\n\n  runner.on('end', function(){\n    stats.end = new Date;\n    stats.duration = new Date - stats.start;\n  });\n\n  runner.on('pending', function(){\n    stats.pending++;\n  });\n}\n\n/**\n * Output common epilogue used by many of\n * the bundled reporters.\n *\n * @api public\n */\n\nBase.prototype.epilogue = function(){\n  var stats = this.stats;\n  var tests;\n  var fmt;\n\n  console.log();\n\n  // passes\n  fmt = color('bright pass', ' ')\n    + color('green', ' %d passing')\n    + color('light', ' (%s)');\n\n  console.log(fmt,\n    stats.passes || 0,\n    ms(stats.duration));\n\n  // pending\n  if (stats.pending) {\n    fmt = color('pending', ' ')\n      + color('pending', ' %d pending');\n\n    console.log(fmt, stats.pending);\n  }\n\n  // failures\n  if (stats.failures) {\n    fmt = color('fail', '  %d failing');\n\n    console.log(fmt, stats.failures);\n\n    Base.list(this.failures);\n    console.log();\n  }\n\n  console.log();\n};\n\n/**\n * Pad the given `str` to `len`.\n *\n * @param {String} str\n * @param {String} len\n * @return {String}\n * @api private\n */\n\nfunction pad(str, len) {\n  str = String(str);\n  return Array(len - str.length + 1).join(' ') + str;\n}\n\n\n/**\n * Returns an inline diff between 2 strings with coloured ANSI output\n *\n * @param {Error} Error with actual/expected\n * @return {String} Diff\n * @api private\n */\n\nfunction inlineDiff(err, escape) {\n  var msg = errorDiff(err, 'WordsWithSpace', escape);\n\n  // linenos\n  var lines = msg.split('\\n');\n  if (lines.length > 4) {\n    var width = String(lines.length).length;\n    msg = lines.map(function(str, i){\n      return pad(++i, width) + ' |' + ' ' + str;\n    }).join('\\n');\n  }\n\n  // legend\n  msg = '\\n'\n    + color('diff removed', 'actual')\n    + ' '\n    + color('diff added', 'expected')\n    + '\\n\\n'\n    + msg\n    + '\\n';\n\n  // indent\n  msg = msg.replace(/^/gm, '      ');\n  return msg;\n}\n\n/**\n * Returns a unified diff between 2 strings\n *\n * @param {Error} Error with actual/expected\n * @return {String} Diff\n * @api private\n */\n\nfunction unifiedDiff(err, escape) {\n  var indent = '      ';\n  function cleanUp(line) {\n    if (escape) {\n      line = escapeInvisibles(line);\n    }\n    if (line[0] === '+') return indent + colorLines('diff added', line);\n    if (line[0] === '-') return indent + colorLines('diff removed', line);\n    if (line.match(/\\@\\@/)) return null;\n    if (line.match(/\\\\ No newline/)) return null;\n    else return indent + line;\n  }\n  function notBlank(line) {\n    return line != null;\n  }\n  var msg = diff.createPatch('string', err.actual, err.expected);\n  var lines = msg.split('\\n').splice(4);\n  return '\\n      '\n         + colorLines('diff added',   '+ expected') + ' '\n         + colorLines('diff removed', '- actual')\n         + '\\n\\n'\n         + lines.map(cleanUp).filter(notBlank).join('\\n');\n}\n\n/**\n * Return a character diff for `err`.\n *\n * @param {Error} err\n * @return {String}\n * @api private\n */\n\nfunction errorDiff(err, type, escape) {\n  var actual   = escape ? escapeInvisibles(err.actual)   : err.actual;\n  var expected = escape ? escapeInvisibles(err.expected) : err.expected;\n  return diff['diff' + type](actual, expected).map(function(str){\n    if (str.added) return colorLines('diff added', str.value);\n    if (str.removed) return colorLines('diff removed', str.value);\n    return str.value;\n  }).join('');\n}\n\n/**\n * Returns a string with all invisible characters in plain text\n *\n * @param {String} line\n * @return {String}\n * @api private\n */\nfunction escapeInvisibles(line) {\n    return line.replace(/\\t/g, '<tab>')\n               .replace(/\\r/g, '<CR>')\n               .replace(/\\n/g, '<LF>\\n');\n}\n\n/**\n * Color lines for `str`, using the color `name`.\n *\n * @param {String} name\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nfunction colorLines(name, str) {\n  return str.split('\\n').map(function(str){\n    return color(name, str);\n  }).join('\\n');\n}\n\n/**\n * Check that a / b have the same type.\n *\n * @param {Object} a\n * @param {Object} b\n * @return {Boolean}\n * @api private\n */\n\nfunction sameType(a, b) {\n  a = Object.prototype.toString.call(a);\n  b = Object.prototype.toString.call(b);\n  return a == b;\n}\n\n}); // module: reporters/base.js\n\nrequire.register(\"reporters/doc.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , utils = require('../utils');\n\n/**\n * Expose `Doc`.\n */\n\nexports = module.exports = Doc;\n\n/**\n * Initialize a new `Doc` reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction Doc(runner) {\n  Base.call(this, runner);\n\n  var self = this\n    , stats = this.stats\n    , total = runner.total\n    , indents = 2;\n\n  function indent() {\n    return Array(indents).join('  ');\n  }\n\n  runner.on('suite', function(suite){\n    if (suite.root) return;\n    ++indents;\n    console.log('%s<section class=\"suite\">', indent());\n    ++indents;\n    console.log('%s<h1>%s</h1>', indent(), utils.escape(suite.title));\n    console.log('%s<dl>', indent());\n  });\n\n  runner.on('suite end', function(suite){\n    if (suite.root) return;\n    console.log('%s</dl>', indent());\n    --indents;\n    console.log('%s</section>', indent());\n    --indents;\n  });\n\n  runner.on('pass', function(test){\n    console.log('%s  <dt>%s</dt>', indent(), utils.escape(test.title));\n    var code = utils.escape(utils.clean(test.fn.toString()));\n    console.log('%s  <dd><pre><code>%s</code></pre></dd>', indent(), code);\n  });\n\n  runner.on('fail', function(test, err){\n    console.log('%s  <dt class=\"error\">%s</dt>', indent(), utils.escape(test.title));\n    var code = utils.escape(utils.clean(test.fn.toString()));\n    console.log('%s  <dd class=\"error\"><pre><code>%s</code></pre></dd>', indent(), code);\n    console.log('%s  <dd class=\"error\">%s</dd>', indent(), utils.escape(err));\n  });\n}\n\n}); // module: reporters/doc.js\n\nrequire.register(\"reporters/dot.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , color = Base.color;\n\n/**\n * Expose `Dot`.\n */\n\nexports = module.exports = Dot;\n\n/**\n * Initialize a new `Dot` matrix test reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction Dot(runner) {\n  Base.call(this, runner);\n\n  var self = this\n    , stats = this.stats\n    , width = Base.window.width * .75 | 0\n    , n = -1;\n\n  runner.on('start', function(){\n    process.stdout.write('\\n  ');\n  });\n\n  runner.on('pending', function(test){\n    if (++n % width == 0) process.stdout.write('\\n  ');\n    process.stdout.write(color('pending', Base.symbols.dot));\n  });\n\n  runner.on('pass', function(test){\n    if (++n % width == 0) process.stdout.write('\\n  ');\n    if ('slow' == test.speed) {\n      process.stdout.write(color('bright yellow', Base.symbols.dot));\n    } else {\n      process.stdout.write(color(test.speed, Base.symbols.dot));\n    }\n  });\n\n  runner.on('fail', function(test, err){\n    if (++n % width == 0) process.stdout.write('\\n  ');\n    process.stdout.write(color('fail', Base.symbols.dot));\n  });\n\n  runner.on('end', function(){\n    console.log();\n    self.epilogue();\n  });\n}\n\n/**\n * Inherit from `Base.prototype`.\n */\n\nfunction F(){};\nF.prototype = Base.prototype;\nDot.prototype = new F;\nDot.prototype.constructor = Dot;\n\n\n}); // module: reporters/dot.js\n\nrequire.register(\"reporters/html-cov.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar JSONCov = require('./json-cov')\n  , fs = require('browser/fs');\n\n/**\n * Expose `HTMLCov`.\n */\n\nexports = module.exports = HTMLCov;\n\n/**\n * Initialize a new `JsCoverage` reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction HTMLCov(runner) {\n  var jade = require('jade')\n    , file = __dirname + '/templates/coverage.jade'\n    , str = fs.readFileSync(file, 'utf8')\n    , fn = jade.compile(str, { filename: file })\n    , self = this;\n\n  JSONCov.call(this, runner, false);\n\n  runner.on('end', function(){\n    process.stdout.write(fn({\n        cov: self.cov\n      , coverageClass: coverageClass\n    }));\n  });\n}\n\n/**\n * Return coverage class for `n`.\n *\n * @return {String}\n * @api private\n */\n\nfunction coverageClass(n) {\n  if (n >= 75) return 'high';\n  if (n >= 50) return 'medium';\n  if (n >= 25) return 'low';\n  return 'terrible';\n}\n\n}); // module: reporters/html-cov.js\n\nrequire.register(\"reporters/html.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , utils = require('../utils')\n  , Progress = require('../browser/progress')\n  , escape = utils.escape;\n\n/**\n * Save timer references to avoid Sinon interfering (see GH-237).\n */\n\nvar Date = global.Date\n  , setTimeout = global.setTimeout\n  , setInterval = global.setInterval\n  , clearTimeout = global.clearTimeout\n  , clearInterval = global.clearInterval;\n\n/**\n * Expose `HTML`.\n */\n\nexports = module.exports = HTML;\n\n/**\n * Stats template.\n */\n\nvar statsTemplate = '<ul id=\"mocha-stats\">'\n  + '<li class=\"progress\"><canvas width=\"40\" height=\"40\"></canvas></li>'\n  + '<li class=\"passes\"><a href=\"#\">passes:</a> <em>0</em></li>'\n  + '<li class=\"failures\"><a href=\"#\">failures:</a> <em>0</em></li>'\n  + '<li class=\"duration\">duration: <em>0</em>s</li>'\n  + '</ul>';\n\n/**\n * Initialize a new `HTML` reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction HTML(runner) {\n  Base.call(this, runner);\n\n  var self = this\n    , stats = this.stats\n    , total = runner.total\n    , stat = fragment(statsTemplate)\n    , items = stat.getElementsByTagName('li')\n    , passes = items[1].getElementsByTagName('em')[0]\n    , passesLink = items[1].getElementsByTagName('a')[0]\n    , failures = items[2].getElementsByTagName('em')[0]\n    , failuresLink = items[2].getElementsByTagName('a')[0]\n    , duration = items[3].getElementsByTagName('em')[0]\n    , canvas = stat.getElementsByTagName('canvas')[0]\n    , report = fragment('<ul id=\"mocha-report\"></ul>')\n    , stack = [report]\n    , progress\n    , ctx\n    , root = document.getElementById('mocha');\n\n  if (canvas.getContext) {\n    var ratio = window.devicePixelRatio || 1;\n    canvas.style.width = canvas.width;\n    canvas.style.height = canvas.height;\n    canvas.width *= ratio;\n    canvas.height *= ratio;\n    ctx = canvas.getContext('2d');\n    ctx.scale(ratio, ratio);\n    progress = new Progress;\n  }\n\n  if (!root) return error('#mocha div missing, add it to your document');\n\n  // pass toggle\n  on(passesLink, 'click', function(){\n    unhide();\n    var name = /pass/.test(report.className) ? '' : ' pass';\n    report.className = report.className.replace(/fail|pass/g, '') + name;\n    if (report.className.trim()) hideSuitesWithout('test pass');\n  });\n\n  // failure toggle\n  on(failuresLink, 'click', function(){\n    unhide();\n    var name = /fail/.test(report.className) ? '' : ' fail';\n    report.className = report.className.replace(/fail|pass/g, '') + name;\n    if (report.className.trim()) hideSuitesWithout('test fail');\n  });\n\n  root.appendChild(stat);\n  root.appendChild(report);\n\n  if (progress) progress.size(40);\n\n  runner.on('suite', function(suite){\n    if (suite.root) return;\n\n    // suite\n    var url = self.suiteURL(suite);\n    var el = fragment('<li class=\"suite\"><h1><a href=\"%s\">%s</a></h1></li>', url, escape(suite.title));\n\n    // container\n    stack[0].appendChild(el);\n    stack.unshift(document.createElement('ul'));\n    el.appendChild(stack[0]);\n  });\n\n  runner.on('suite end', function(suite){\n    if (suite.root) return;\n    stack.shift();\n  });\n\n  runner.on('fail', function(test, err){\n    if ('hook' == test.type) runner.emit('test end', test);\n  });\n\n  runner.on('test end', function(test){\n    // TODO: add to stats\n    var percent = stats.tests / this.total * 100 | 0;\n    if (progress) progress.update(percent).draw(ctx);\n\n    // update stats\n    var ms = new Date - stats.start;\n    text(passes, stats.passes);\n    text(failures, stats.failures);\n    text(duration, (ms / 1000).toFixed(2));\n\n    // test\n    if ('passed' == test.state) {\n      var url = self.testURL(test);\n      var el = fragment('<li class=\"test pass %e\"><h2>%e<span class=\"duration\">%ems</span> <a href=\"%s\" class=\"replay\">‣</a></h2></li>', test.speed, test.title, test.duration, url);\n    } else if (test.pending) {\n      var el = fragment('<li class=\"test pass pending\"><h2>%e</h2></li>', test.title);\n    } else {\n      var el = fragment('<li class=\"test fail\"><h2>%e <a href=\"%e\" class=\"replay\">‣</a></h2></li>', test.title, self.testURL(test));\n      var str = test.err.stack || test.err.toString();\n\n      // FF / Opera do not add the message\n      if (!~str.indexOf(test.err.message)) {\n        str = test.err.message + '\\n' + str;\n      }\n\n      // <=IE7 stringifies to [Object Error]. Since it can be overloaded, we\n      // check for the result of the stringifying.\n      if ('[object Error]' == str) str = test.err.message;\n\n      // Safari doesn't give you a stack. Let's at least provide a source line.\n      if (!test.err.stack && test.err.sourceURL && test.err.line !== undefined) {\n        str += \"\\n(\" + test.err.sourceURL + \":\" + test.err.line + \")\";\n      }\n\n      el.appendChild(fragment('<pre class=\"error\">%e</pre>', str));\n    }\n\n    // toggle code\n    // TODO: defer\n    if (!test.pending) {\n      var h2 = el.getElementsByTagName('h2')[0];\n\n      on(h2, 'click', function(){\n        pre.style.display = 'none' == pre.style.display\n          ? 'block'\n          : 'none';\n      });\n\n      var pre = fragment('<pre><code>%e</code></pre>', utils.clean(test.fn.toString()));\n      el.appendChild(pre);\n      pre.style.display = 'none';\n    }\n\n    // Don't call .appendChild if #mocha-report was already .shift()'ed off the stack.\n    if (stack[0]) stack[0].appendChild(el);\n  });\n}\n\n/**\n * Makes a URL, preserving querystring (\"search\") parameters.\n * @param {string} s\n * @returns {string} your new URL\n */\nvar makeUrl = function makeUrl(s) {\n  var search = window.location.search;\n\n  // Remove previous grep query parameter if present\n  if (search) {\n    search = search.replace(/[?&]grep=[^&\\s]*/g, '').replace(/^&/, '?');\n  }\n\n  return window.location.pathname + (search ? search + '&' : '?' ) + 'grep=' + encodeURIComponent(s);\n};\n\n/**\n * Provide suite URL\n *\n * @param {Object} [suite]\n */\nHTML.prototype.suiteURL = function(suite){\n  return makeUrl(suite.fullTitle());\n};\n\n/**\n * Provide test URL\n *\n * @param {Object} [test]\n */\n\nHTML.prototype.testURL = function(test){\n  return makeUrl(test.fullTitle());\n};\n\n/**\n * Display error `msg`.\n */\n\nfunction error(msg) {\n  document.body.appendChild(fragment('<div id=\"mocha-error\">%s</div>', msg));\n}\n\n/**\n * Return a DOM fragment from `html`.\n */\n\nfunction fragment(html) {\n  var args = arguments\n    , div = document.createElement('div')\n    , i = 1;\n\n  div.innerHTML = html.replace(/%([se])/g, function(_, type){\n    switch (type) {\n      case 's': return String(args[i++]);\n      case 'e': return escape(args[i++]);\n    }\n  });\n\n  return div.firstChild;\n}\n\n/**\n * Check for suites that do not have elements\n * with `classname`, and hide them.\n */\n\nfunction hideSuitesWithout(classname) {\n  var suites = document.getElementsByClassName('suite');\n  for (var i = 0; i < suites.length; i++) {\n    var els = suites[i].getElementsByClassName(classname);\n    if (0 == els.length) suites[i].className += ' hidden';\n  }\n}\n\n/**\n * Unhide .hidden suites.\n */\n\nfunction unhide() {\n  var els = document.getElementsByClassName('suite hidden');\n  for (var i = 0; i < els.length; ++i) {\n    els[i].className = els[i].className.replace('suite hidden', 'suite');\n  }\n}\n\n/**\n * Set `el` text to `str`.\n */\n\nfunction text(el, str) {\n  if (el.textContent) {\n    el.textContent = str;\n  } else {\n    el.innerText = str;\n  }\n}\n\n/**\n * Listen on `event` with callback `fn`.\n */\n\nfunction on(el, event, fn) {\n  if (el.addEventListener) {\n    el.addEventListener(event, fn, false);\n  } else {\n    el.attachEvent('on' + event, fn);\n  }\n}\n\n}); // module: reporters/html.js\n\nrequire.register(\"reporters/index.js\", function(module, exports, require){\nexports.Base = require('./base');\nexports.Dot = require('./dot');\nexports.Doc = require('./doc');\nexports.TAP = require('./tap');\nexports.JSON = require('./json');\nexports.HTML = require('./html');\nexports.List = require('./list');\nexports.Min = require('./min');\nexports.Spec = require('./spec');\nexports.Nyan = require('./nyan');\nexports.XUnit = require('./xunit');\nexports.Markdown = require('./markdown');\nexports.Progress = require('./progress');\nexports.Landing = require('./landing');\nexports.JSONCov = require('./json-cov');\nexports.HTMLCov = require('./html-cov');\nexports.JSONStream = require('./json-stream');\n\n}); // module: reporters/index.js\n\nrequire.register(\"reporters/json-cov.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base');\n\n/**\n * Expose `JSONCov`.\n */\n\nexports = module.exports = JSONCov;\n\n/**\n * Initialize a new `JsCoverage` reporter.\n *\n * @param {Runner} runner\n * @param {Boolean} output\n * @api public\n */\n\nfunction JSONCov(runner, output) {\n  var self = this\n    , output = 1 == arguments.length ? true : output;\n\n  Base.call(this, runner);\n\n  var tests = []\n    , failures = []\n    , passes = [];\n\n  runner.on('test end', function(test){\n    tests.push(test);\n  });\n\n  runner.on('pass', function(test){\n    passes.push(test);\n  });\n\n  runner.on('fail', function(test){\n    failures.push(test);\n  });\n\n  runner.on('end', function(){\n    var cov = global._$jscoverage || {};\n    var result = self.cov = map(cov);\n    result.stats = self.stats;\n    result.tests = tests.map(clean);\n    result.failures = failures.map(clean);\n    result.passes = passes.map(clean);\n    if (!output) return;\n    process.stdout.write(JSON.stringify(result, null, 2 ));\n  });\n}\n\n/**\n * Map jscoverage data to a JSON structure\n * suitable for reporting.\n *\n * @param {Object} cov\n * @return {Object}\n * @api private\n */\n\nfunction map(cov) {\n  var ret = {\n      instrumentation: 'node-jscoverage'\n    , sloc: 0\n    , hits: 0\n    , misses: 0\n    , coverage: 0\n    , files: []\n  };\n\n  for (var filename in cov) {\n    var data = coverage(filename, cov[filename]);\n    ret.files.push(data);\n    ret.hits += data.hits;\n    ret.misses += data.misses;\n    ret.sloc += data.sloc;\n  }\n\n  ret.files.sort(function(a, b) {\n    return a.filename.localeCompare(b.filename);\n  });\n\n  if (ret.sloc > 0) {\n    ret.coverage = (ret.hits / ret.sloc) * 100;\n  }\n\n  return ret;\n}\n\n/**\n * Map jscoverage data for a single source file\n * to a JSON structure suitable for reporting.\n *\n * @param {String} filename name of the source file\n * @param {Object} data jscoverage coverage data\n * @return {Object}\n * @api private\n */\n\nfunction coverage(filename, data) {\n  var ret = {\n    filename: filename,\n    coverage: 0,\n    hits: 0,\n    misses: 0,\n    sloc: 0,\n    source: {}\n  };\n\n  data.source.forEach(function(line, num){\n    num++;\n\n    if (data[num] === 0) {\n      ret.misses++;\n      ret.sloc++;\n    } else if (data[num] !== undefined) {\n      ret.hits++;\n      ret.sloc++;\n    }\n\n    ret.source[num] = {\n        source: line\n      , coverage: data[num] === undefined\n        ? ''\n        : data[num]\n    };\n  });\n\n  ret.coverage = ret.hits / ret.sloc * 100;\n\n  return ret;\n}\n\n/**\n * Return a plain-object representation of `test`\n * free of cyclic properties etc.\n *\n * @param {Object} test\n * @return {Object}\n * @api private\n */\n\nfunction clean(test) {\n  return {\n      title: test.title\n    , fullTitle: test.fullTitle()\n    , duration: test.duration\n  }\n}\n\n}); // module: reporters/json-cov.js\n\nrequire.register(\"reporters/json-stream.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , color = Base.color;\n\n/**\n * Expose `List`.\n */\n\nexports = module.exports = List;\n\n/**\n * Initialize a new `List` test reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction List(runner) {\n  Base.call(this, runner);\n\n  var self = this\n    , stats = this.stats\n    , total = runner.total;\n\n  runner.on('start', function(){\n    console.log(JSON.stringify(['start', { total: total }]));\n  });\n\n  runner.on('pass', function(test){\n    console.log(JSON.stringify(['pass', clean(test)]));\n  });\n\n  runner.on('fail', function(test, err){\n    test = clean(test);\n    test.err = err.message;\n    console.log(JSON.stringify(['fail', test]));\n  });\n\n  runner.on('end', function(){\n    process.stdout.write(JSON.stringify(['end', self.stats]));\n  });\n}\n\n/**\n * Return a plain-object representation of `test`\n * free of cyclic properties etc.\n *\n * @param {Object} test\n * @return {Object}\n * @api private\n */\n\nfunction clean(test) {\n  return {\n      title: test.title\n    , fullTitle: test.fullTitle()\n    , duration: test.duration\n  }\n}\n\n}); // module: reporters/json-stream.js\n\nrequire.register(\"reporters/json.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , cursor = Base.cursor\n  , color = Base.color;\n\n/**\n * Expose `JSON`.\n */\n\nexports = module.exports = JSONReporter;\n\n/**\n * Initialize a new `JSON` reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction JSONReporter(runner) {\n  var self = this;\n  Base.call(this, runner);\n\n  var tests = []\n    , pending = []\n    , failures = []\n    , passes = [];\n\n  runner.on('test end', function(test){\n    tests.push(test);\n  });\n\n  runner.on('pass', function(test){\n    passes.push(test);\n  });\n\n  runner.on('fail', function(test){\n    failures.push(test);\n  });\n\n  runner.on('pending', function(test){\n    pending.push(test);\n  });\n\n  runner.on('end', function(){\n    var obj = {\n      stats: self.stats,\n      tests: tests.map(clean),\n      pending: pending.map(clean),\n      failures: failures.map(clean),\n      passes: passes.map(clean)\n    };\n\n    runner.testResults = obj;\n\n    process.stdout.write(JSON.stringify(obj, null, 2));\n  });\n}\n\n/**\n * Return a plain-object representation of `test`\n * free of cyclic properties etc.\n *\n * @param {Object} test\n * @return {Object}\n * @api private\n */\n\nfunction clean(test) {\n  return {\n    title: test.title,\n    fullTitle: test.fullTitle(),\n    duration: test.duration,\n    err: errorJSON(test.err || {})\n  }\n}\n\n/**\n * Transform `error` into a JSON object.\n * @param {Error} err\n * @return {Object}\n */\n\nfunction errorJSON(err) {\n  var res = {};\n  Object.getOwnPropertyNames(err).forEach(function(key) {\n    res[key] = err[key];\n  }, err);\n  return res;\n}\n\n}); // module: reporters/json.js\n\nrequire.register(\"reporters/landing.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , cursor = Base.cursor\n  , color = Base.color;\n\n/**\n * Expose `Landing`.\n */\n\nexports = module.exports = Landing;\n\n/**\n * Airplane color.\n */\n\nBase.colors.plane = 0;\n\n/**\n * Airplane crash color.\n */\n\nBase.colors['plane crash'] = 31;\n\n/**\n * Runway color.\n */\n\nBase.colors.runway = 90;\n\n/**\n * Initialize a new `Landing` reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction Landing(runner) {\n  Base.call(this, runner);\n\n  var self = this\n    , stats = this.stats\n    , width = Base.window.width * .75 | 0\n    , total = runner.total\n    , stream = process.stdout\n    , plane = color('plane', '✈')\n    , crashed = -1\n    , n = 0;\n\n  function runway() {\n    var buf = Array(width).join('-');\n    return '  ' + color('runway', buf);\n  }\n\n  runner.on('start', function(){\n    stream.write('\\n\\n\\n  ');\n    cursor.hide();\n  });\n\n  runner.on('test end', function(test){\n    // check if the plane crashed\n    var col = -1 == crashed\n      ? width * ++n / total | 0\n      : crashed;\n\n    // show the crash\n    if ('failed' == test.state) {\n      plane = color('plane crash', '✈');\n      crashed = col;\n    }\n\n    // render landing strip\n    stream.write('\\u001b['+(width+1)+'D\\u001b[2A');\n    stream.write(runway());\n    stream.write('\\n  ');\n    stream.write(color('runway', Array(col).join('⋅')));\n    stream.write(plane)\n    stream.write(color('runway', Array(width - col).join('⋅') + '\\n'));\n    stream.write(runway());\n    stream.write('\\u001b[0m');\n  });\n\n  runner.on('end', function(){\n    cursor.show();\n    console.log();\n    self.epilogue();\n  });\n}\n\n/**\n * Inherit from `Base.prototype`.\n */\n\nfunction F(){};\nF.prototype = Base.prototype;\nLanding.prototype = new F;\nLanding.prototype.constructor = Landing;\n\n\n}); // module: reporters/landing.js\n\nrequire.register(\"reporters/list.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , cursor = Base.cursor\n  , color = Base.color;\n\n/**\n * Expose `List`.\n */\n\nexports = module.exports = List;\n\n/**\n * Initialize a new `List` test reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction List(runner) {\n  Base.call(this, runner);\n\n  var self = this\n    , stats = this.stats\n    , n = 0;\n\n  runner.on('start', function(){\n    console.log();\n  });\n\n  runner.on('test', function(test){\n    process.stdout.write(color('pass', '    ' + test.fullTitle() + ': '));\n  });\n\n  runner.on('pending', function(test){\n    var fmt = color('checkmark', '  -')\n      + color('pending', ' %s');\n    console.log(fmt, test.fullTitle());\n  });\n\n  runner.on('pass', function(test){\n    var fmt = color('checkmark', '  '+Base.symbols.dot)\n      + color('pass', ' %s: ')\n      + color(test.speed, '%dms');\n    cursor.CR();\n    console.log(fmt, test.fullTitle(), test.duration);\n  });\n\n  runner.on('fail', function(test, err){\n    cursor.CR();\n    console.log(color('fail', '  %d) %s'), ++n, test.fullTitle());\n  });\n\n  runner.on('end', self.epilogue.bind(self));\n}\n\n/**\n * Inherit from `Base.prototype`.\n */\n\nfunction F(){};\nF.prototype = Base.prototype;\nList.prototype = new F;\nList.prototype.constructor = List;\n\n\n}); // module: reporters/list.js\n\nrequire.register(\"reporters/markdown.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , utils = require('../utils');\n\n/**\n * Constants\n */\n\nvar SUITE_PREFIX = '$';\n\n/**\n * Expose `Markdown`.\n */\n\nexports = module.exports = Markdown;\n\n/**\n * Initialize a new `Markdown` reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction Markdown(runner) {\n  Base.call(this, runner);\n\n  var self = this\n    , stats = this.stats\n    , level = 0\n    , buf = '';\n\n  function title(str) {\n    return Array(level).join('#') + ' ' + str;\n  }\n\n  function indent() {\n    return Array(level).join('  ');\n  }\n\n  function mapTOC(suite, obj) {\n    var ret = obj,\n        key = SUITE_PREFIX + suite.title;\n    obj = obj[key] = obj[key] || { suite: suite };\n    suite.suites.forEach(function(suite){\n      mapTOC(suite, obj);\n    });\n    return ret;\n  }\n\n  function stringifyTOC(obj, level) {\n    ++level;\n    var buf = '';\n    var link;\n    for (var key in obj) {\n      if ('suite' == key) continue;\n      if (key !== SUITE_PREFIX) {\n        link = ' - [' + key.substring(1) + ']';\n        link += '(#' + utils.slug(obj[key].suite.fullTitle()) + ')\\n';\n        buf += Array(level).join('  ') + link;\n      }\n      buf += stringifyTOC(obj[key], level);\n    }\n    return buf;\n  }\n\n  function generateTOC(suite) {\n    var obj = mapTOC(suite, {});\n    return stringifyTOC(obj, 0);\n  }\n\n  generateTOC(runner.suite);\n\n  runner.on('suite', function(suite){\n    ++level;\n    var slug = utils.slug(suite.fullTitle());\n    buf += '<a name=\"' + slug + '\"></a>' + '\\n';\n    buf += title(suite.title) + '\\n';\n  });\n\n  runner.on('suite end', function(suite){\n    --level;\n  });\n\n  runner.on('pass', function(test){\n    var code = utils.clean(test.fn.toString());\n    buf += test.title + '.\\n';\n    buf += '\\n```js\\n';\n    buf += code + '\\n';\n    buf += '```\\n\\n';\n  });\n\n  runner.on('end', function(){\n    process.stdout.write('# TOC\\n');\n    process.stdout.write(generateTOC(runner.suite));\n    process.stdout.write(buf);\n  });\n}\n\n}); // module: reporters/markdown.js\n\nrequire.register(\"reporters/min.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base');\n\n/**\n * Expose `Min`.\n */\n\nexports = module.exports = Min;\n\n/**\n * Initialize a new `Min` minimal test reporter (best used with --watch).\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction Min(runner) {\n  Base.call(this, runner);\n\n  runner.on('start', function(){\n    // clear screen\n    process.stdout.write('\\u001b[2J');\n    // set cursor position\n    process.stdout.write('\\u001b[1;3H');\n  });\n\n  runner.on('end', this.epilogue.bind(this));\n}\n\n/**\n * Inherit from `Base.prototype`.\n */\n\nfunction F(){};\nF.prototype = Base.prototype;\nMin.prototype = new F;\nMin.prototype.constructor = Min;\n\n\n}); // module: reporters/min.js\n\nrequire.register(\"reporters/nyan.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base');\n\n/**\n * Expose `Dot`.\n */\n\nexports = module.exports = NyanCat;\n\n/**\n * Initialize a new `Dot` matrix test reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction NyanCat(runner) {\n  Base.call(this, runner);\n  var self = this\n    , stats = this.stats\n    , width = Base.window.width * .75 | 0\n    , rainbowColors = this.rainbowColors = self.generateColors()\n    , colorIndex = this.colorIndex = 0\n    , numerOfLines = this.numberOfLines = 4\n    , trajectories = this.trajectories = [[], [], [], []]\n    , nyanCatWidth = this.nyanCatWidth = 11\n    , trajectoryWidthMax = this.trajectoryWidthMax = (width - nyanCatWidth)\n    , scoreboardWidth = this.scoreboardWidth = 5\n    , tick = this.tick = 0\n    , n = 0;\n\n  runner.on('start', function(){\n    Base.cursor.hide();\n    self.draw();\n  });\n\n  runner.on('pending', function(test){\n    self.draw();\n  });\n\n  runner.on('pass', function(test){\n    self.draw();\n  });\n\n  runner.on('fail', function(test, err){\n    self.draw();\n  });\n\n  runner.on('end', function(){\n    Base.cursor.show();\n    for (var i = 0; i < self.numberOfLines; i++) write('\\n');\n    self.epilogue();\n  });\n}\n\n/**\n * Draw the nyan cat\n *\n * @api private\n */\n\nNyanCat.prototype.draw = function(){\n  this.appendRainbow();\n  this.drawScoreboard();\n  this.drawRainbow();\n  this.drawNyanCat();\n  this.tick = !this.tick;\n};\n\n/**\n * Draw the \"scoreboard\" showing the number\n * of passes, failures and pending tests.\n *\n * @api private\n */\n\nNyanCat.prototype.drawScoreboard = function(){\n  var stats = this.stats;\n\n  function draw(type, n) {\n    write(' ');\n    write(Base.color(type, n));\n    write('\\n');\n  }\n\n  draw('green', stats.passes);\n  draw('fail', stats.failures);\n  draw('pending', stats.pending);\n  write('\\n');\n\n  this.cursorUp(this.numberOfLines);\n};\n\n/**\n * Append the rainbow.\n *\n * @api private\n */\n\nNyanCat.prototype.appendRainbow = function(){\n  var segment = this.tick ? '_' : '-';\n  var rainbowified = this.rainbowify(segment);\n\n  for (var index = 0; index < this.numberOfLines; index++) {\n    var trajectory = this.trajectories[index];\n    if (trajectory.length >= this.trajectoryWidthMax) trajectory.shift();\n    trajectory.push(rainbowified);\n  }\n};\n\n/**\n * Draw the rainbow.\n *\n * @api private\n */\n\nNyanCat.prototype.drawRainbow = function(){\n  var self = this;\n\n  this.trajectories.forEach(function(line, index) {\n    write('\\u001b[' + self.scoreboardWidth + 'C');\n    write(line.join(''));\n    write('\\n');\n  });\n\n  this.cursorUp(this.numberOfLines);\n};\n\n/**\n * Draw the nyan cat\n *\n * @api private\n */\n\nNyanCat.prototype.drawNyanCat = function() {\n  var self = this;\n  var startWidth = this.scoreboardWidth + this.trajectories[0].length;\n  var dist = '\\u001b[' + startWidth + 'C';\n  var padding = '';\n\n  write(dist);\n  write('_,------,');\n  write('\\n');\n\n  write(dist);\n  padding = self.tick ? '  ' : '   ';\n  write('_|' + padding + '/\\\\_/\\\\ ');\n  write('\\n');\n\n  write(dist);\n  padding = self.tick ? '_' : '__';\n  var tail = self.tick ? '~' : '^';\n  var face;\n  write(tail + '|' + padding + this.face() + ' ');\n  write('\\n');\n\n  write(dist);\n  padding = self.tick ? ' ' : '  ';\n  write(padding + '\"\"  \"\" ');\n  write('\\n');\n\n  this.cursorUp(this.numberOfLines);\n};\n\n/**\n * Draw nyan cat face.\n *\n * @return {String}\n * @api private\n */\n\nNyanCat.prototype.face = function() {\n  var stats = this.stats;\n  if (stats.failures) {\n    return '( x .x)';\n  } else if (stats.pending) {\n    return '( o .o)';\n  } else if(stats.passes) {\n    return '( ^ .^)';\n  } else {\n    return '( - .-)';\n  }\n};\n\n/**\n * Move cursor up `n`.\n *\n * @param {Number} n\n * @api private\n */\n\nNyanCat.prototype.cursorUp = function(n) {\n  write('\\u001b[' + n + 'A');\n};\n\n/**\n * Move cursor down `n`.\n *\n * @param {Number} n\n * @api private\n */\n\nNyanCat.prototype.cursorDown = function(n) {\n  write('\\u001b[' + n + 'B');\n};\n\n/**\n * Generate rainbow colors.\n *\n * @return {Array}\n * @api private\n */\n\nNyanCat.prototype.generateColors = function(){\n  var colors = [];\n\n  for (var i = 0; i < (6 * 7); i++) {\n    var pi3 = Math.floor(Math.PI / 3);\n    var n = (i * (1.0 / 6));\n    var r = Math.floor(3 * Math.sin(n) + 3);\n    var g = Math.floor(3 * Math.sin(n + 2 * pi3) + 3);\n    var b = Math.floor(3 * Math.sin(n + 4 * pi3) + 3);\n    colors.push(36 * r + 6 * g + b + 16);\n  }\n\n  return colors;\n};\n\n/**\n * Apply rainbow to the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nNyanCat.prototype.rainbowify = function(str){\n  if (!Base.useColors)\n    return str;\n  var color = this.rainbowColors[this.colorIndex % this.rainbowColors.length];\n  this.colorIndex += 1;\n  return '\\u001b[38;5;' + color + 'm' + str + '\\u001b[0m';\n};\n\n/**\n * Stdout helper.\n */\n\nfunction write(string) {\n  process.stdout.write(string);\n}\n\n/**\n * Inherit from `Base.prototype`.\n */\n\nfunction F(){};\nF.prototype = Base.prototype;\nNyanCat.prototype = new F;\nNyanCat.prototype.constructor = NyanCat;\n\n\n}); // module: reporters/nyan.js\n\nrequire.register(\"reporters/progress.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , cursor = Base.cursor\n  , color = Base.color;\n\n/**\n * Expose `Progress`.\n */\n\nexports = module.exports = Progress;\n\n/**\n * General progress bar color.\n */\n\nBase.colors.progress = 90;\n\n/**\n * Initialize a new `Progress` bar test reporter.\n *\n * @param {Runner} runner\n * @param {Object} options\n * @api public\n */\n\nfunction Progress(runner, options) {\n  Base.call(this, runner);\n\n  var self = this\n    , options = options || {}\n    , stats = this.stats\n    , width = Base.window.width * .50 | 0\n    , total = runner.total\n    , complete = 0\n    , max = Math.max\n    , lastN = -1;\n\n  // default chars\n  options.open = options.open || '[';\n  options.complete = options.complete || '▬';\n  options.incomplete = options.incomplete || Base.symbols.dot;\n  options.close = options.close || ']';\n  options.verbose = false;\n\n  // tests started\n  runner.on('start', function(){\n    console.log();\n    cursor.hide();\n  });\n\n  // tests complete\n  runner.on('test end', function(){\n    complete++;\n    var incomplete = total - complete\n      , percent = complete / total\n      , n = width * percent | 0\n      , i = width - n;\n\n    if (lastN === n && !options.verbose) {\n      // Don't re-render the line if it hasn't changed\n      return;\n    }\n    lastN = n;\n\n    cursor.CR();\n    process.stdout.write('\\u001b[J');\n    process.stdout.write(color('progress', '  ' + options.open));\n    process.stdout.write(Array(n).join(options.complete));\n    process.stdout.write(Array(i).join(options.incomplete));\n    process.stdout.write(color('progress', options.close));\n    if (options.verbose) {\n      process.stdout.write(color('progress', ' ' + complete + ' of ' + total));\n    }\n  });\n\n  // tests are complete, output some stats\n  // and the failures if any\n  runner.on('end', function(){\n    cursor.show();\n    console.log();\n    self.epilogue();\n  });\n}\n\n/**\n * Inherit from `Base.prototype`.\n */\n\nfunction F(){};\nF.prototype = Base.prototype;\nProgress.prototype = new F;\nProgress.prototype.constructor = Progress;\n\n\n}); // module: reporters/progress.js\n\nrequire.register(\"reporters/spec.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , cursor = Base.cursor\n  , color = Base.color;\n\n/**\n * Expose `Spec`.\n */\n\nexports = module.exports = Spec;\n\n/**\n * Initialize a new `Spec` test reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction Spec(runner) {\n  Base.call(this, runner);\n\n  var self = this\n    , stats = this.stats\n    , indents = 0\n    , n = 0;\n\n  function indent() {\n    return Array(indents).join('  ')\n  }\n\n  runner.on('start', function(){\n    console.log();\n  });\n\n  runner.on('suite', function(suite){\n    ++indents;\n    console.log(color('suite', '%s%s'), indent(), suite.title);\n  });\n\n  runner.on('suite end', function(suite){\n    --indents;\n    if (1 == indents) console.log();\n  });\n\n  runner.on('pending', function(test){\n    var fmt = indent() + color('pending', '  - %s');\n    console.log(fmt, test.title);\n  });\n\n  runner.on('pass', function(test){\n    if ('fast' == test.speed) {\n      var fmt = indent()\n        + color('checkmark', '  ' + Base.symbols.ok)\n        + color('pass', ' %s ');\n      cursor.CR();\n      console.log(fmt, test.title);\n    } else {\n      var fmt = indent()\n        + color('checkmark', '  ' + Base.symbols.ok)\n        + color('pass', ' %s ')\n        + color(test.speed, '(%dms)');\n      cursor.CR();\n      console.log(fmt, test.title, test.duration);\n    }\n  });\n\n  runner.on('fail', function(test, err){\n    cursor.CR();\n    console.log(indent() + color('fail', '  %d) %s'), ++n, test.title);\n  });\n\n  runner.on('end', self.epilogue.bind(self));\n}\n\n/**\n * Inherit from `Base.prototype`.\n */\n\nfunction F(){};\nF.prototype = Base.prototype;\nSpec.prototype = new F;\nSpec.prototype.constructor = Spec;\n\n\n}); // module: reporters/spec.js\n\nrequire.register(\"reporters/tap.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , cursor = Base.cursor\n  , color = Base.color;\n\n/**\n * Expose `TAP`.\n */\n\nexports = module.exports = TAP;\n\n/**\n * Initialize a new `TAP` reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction TAP(runner) {\n  Base.call(this, runner);\n\n  var self = this\n    , stats = this.stats\n    , n = 1\n    , passes = 0\n    , failures = 0;\n\n  runner.on('start', function(){\n    var total = runner.grepTotal(runner.suite);\n    console.log('%d..%d', 1, total);\n  });\n\n  runner.on('test end', function(){\n    ++n;\n  });\n\n  runner.on('pending', function(test){\n    console.log('ok %d %s # SKIP -', n, title(test));\n  });\n\n  runner.on('pass', function(test){\n    passes++;\n    console.log('ok %d %s', n, title(test));\n  });\n\n  runner.on('fail', function(test, err){\n    failures++;\n    console.log('not ok %d %s', n, title(test));\n    if (err.stack) console.log(err.stack.replace(/^/gm, '  '));\n  });\n\n  runner.on('end', function(){\n    console.log('# tests ' + (passes + failures));\n    console.log('# pass ' + passes);\n    console.log('# fail ' + failures);\n  });\n}\n\n/**\n * Return a TAP-safe title of `test`\n *\n * @param {Object} test\n * @return {String}\n * @api private\n */\n\nfunction title(test) {\n  return test.fullTitle().replace(/#/g, '');\n}\n\n}); // module: reporters/tap.js\n\nrequire.register(\"reporters/xunit.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Base = require('./base')\n  , utils = require('../utils')\n  , fs = require('browser/fs')\n  , escape = utils.escape;\n\n/**\n * Save timer references to avoid Sinon interfering (see GH-237).\n */\n\nvar Date = global.Date\n  , setTimeout = global.setTimeout\n  , setInterval = global.setInterval\n  , clearTimeout = global.clearTimeout\n  , clearInterval = global.clearInterval;\n\n/**\n * Expose `XUnit`.\n */\n\nexports = module.exports = XUnit;\n\n/**\n * Initialize a new `XUnit` reporter.\n *\n * @param {Runner} runner\n * @api public\n */\n\nfunction XUnit(runner, options) {\n  Base.call(this, runner);\n  var stats = this.stats\n    , tests = []\n    , self = this;\n\n  if (options.reporterOptions && options.reporterOptions.output) {\n      if (! fs.createWriteStream) {\n          throw new Error('file output not supported in browser');\n      }\n      self.fileStream = fs.createWriteStream(options.reporterOptions.output);\n  }\n\n  runner.on('pending', function(test){\n    tests.push(test);\n  });\n\n  runner.on('pass', function(test){\n    tests.push(test);\n  });\n\n  runner.on('fail', function(test){\n    tests.push(test);\n  });\n\n  runner.on('end', function(){\n    self.write(tag('testsuite', {\n        name: 'Mocha Tests'\n      , tests: stats.tests\n      , failures: stats.failures\n      , errors: stats.failures\n      , skipped: stats.tests - stats.failures - stats.passes\n      , timestamp: (new Date).toUTCString()\n      , time: (stats.duration / 1000) || 0\n    }, false));\n\n    tests.forEach(function(t) { self.test(t); });\n    self.write('</testsuite>');\n  });\n}\n\n/**\n * Override done to close the stream (if it's a file).\n */\nXUnit.prototype.done = function(failures, fn) {\n    if (this.fileStream) {\n        this.fileStream.end(function() {\n            fn(failures);\n        });\n    } else {\n        fn(failures);\n    }\n};\n\n/**\n * Inherit from `Base.prototype`.\n */\n\nfunction F(){};\nF.prototype = Base.prototype;\nXUnit.prototype = new F;\nXUnit.prototype.constructor = XUnit;\n\n\n/**\n * Write out the given line\n */\nXUnit.prototype.write = function(line) {\n    if (this.fileStream) {\n        this.fileStream.write(line + '\\n');\n    } else {\n        console.log(line);\n    }\n};\n\n/**\n * Output tag for the given `test.`\n */\n\nXUnit.prototype.test = function(test, ostream) {\n  var attrs = {\n      classname: test.parent.fullTitle()\n    , name: test.title\n    , time: (test.duration / 1000) || 0\n  };\n\n  if ('failed' == test.state) {\n    var err = test.err;\n    this.write(tag('testcase', attrs, false, tag('failure', {}, false, cdata(escape(err.message) + \"\\n\" + err.stack))));\n  } else if (test.pending) {\n    this.write(tag('testcase', attrs, false, tag('skipped', {}, true)));\n  } else {\n    this.write(tag('testcase', attrs, true) );\n  }\n};\n\n/**\n * HTML tag helper.\n */\n\nfunction tag(name, attrs, close, content) {\n  var end = close ? '/>' : '>'\n    , pairs = []\n    , tag;\n\n  for (var key in attrs) {\n    pairs.push(key + '=\"' + escape(attrs[key]) + '\"');\n  }\n\n  tag = '<' + name + (pairs.length ? ' ' + pairs.join(' ') : '') + end;\n  if (content) tag += content + '</' + name + end;\n  return tag;\n}\n\n/**\n * Return cdata escaped CDATA `str`.\n */\n\nfunction cdata(str) {\n  return '<![CDATA[' + escape(str) + ']]>';\n}\n\n}); // module: reporters/xunit.js\n\nrequire.register(\"runnable.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar EventEmitter = require('browser/events').EventEmitter\n  , debug = require('browser/debug')('mocha:runnable')\n  , Pending = require('./pending')\n  , milliseconds = require('./ms')\n  , utils = require('./utils');\n\n/**\n * Save timer references to avoid Sinon interfering (see GH-237).\n */\n\nvar Date = global.Date\n  , setTimeout = global.setTimeout\n  , setInterval = global.setInterval\n  , clearTimeout = global.clearTimeout\n  , clearInterval = global.clearInterval;\n\n/**\n * Object#toString().\n */\n\nvar toString = Object.prototype.toString;\n\n/**\n * Expose `Runnable`.\n */\n\nmodule.exports = Runnable;\n\n/**\n * Initialize a new `Runnable` with the given `title` and callback `fn`.\n *\n * @param {String} title\n * @param {Function} fn\n * @api private\n */\n\nfunction Runnable(title, fn) {\n  this.title = title;\n  this.fn = fn;\n  this.async = fn && fn.length;\n  this.sync = ! this.async;\n  this._timeout = 2000;\n  this._slow = 75;\n  this._enableTimeouts = true;\n  this.timedOut = false;\n  this._trace = new Error('done() called multiple times')\n}\n\n/**\n * Inherit from `EventEmitter.prototype`.\n */\n\nfunction F(){};\nF.prototype = EventEmitter.prototype;\nRunnable.prototype = new F;\nRunnable.prototype.constructor = Runnable;\n\n\n/**\n * Set & get timeout `ms`.\n *\n * @param {Number|String} ms\n * @return {Runnable|Number} ms or self\n * @api private\n */\n\nRunnable.prototype.timeout = function(ms){\n  if (0 == arguments.length) return this._timeout;\n  if (ms === 0) this._enableTimeouts = false;\n  if ('string' == typeof ms) ms = milliseconds(ms);\n  debug('timeout %d', ms);\n  this._timeout = ms;\n  if (this.timer) this.resetTimeout();\n  return this;\n};\n\n/**\n * Set & get slow `ms`.\n *\n * @param {Number|String} ms\n * @return {Runnable|Number} ms or self\n * @api private\n */\n\nRunnable.prototype.slow = function(ms){\n  if (0 === arguments.length) return this._slow;\n  if ('string' == typeof ms) ms = milliseconds(ms);\n  debug('timeout %d', ms);\n  this._slow = ms;\n  return this;\n};\n\n/**\n * Set and & get timeout `enabled`.\n *\n * @param {Boolean} enabled\n * @return {Runnable|Boolean} enabled or self\n * @api private\n */\n\nRunnable.prototype.enableTimeouts = function(enabled){\n  if (arguments.length === 0) return this._enableTimeouts;\n  debug('enableTimeouts %s', enabled);\n  this._enableTimeouts = enabled;\n  return this;\n};\n\n/**\n * Halt and mark as pending.\n *\n * @api private\n */\n\nRunnable.prototype.skip = function(){\n    throw new Pending();\n};\n\n/**\n * Return the full title generated by recursively\n * concatenating the parent's full title.\n *\n * @return {String}\n * @api public\n */\n\nRunnable.prototype.fullTitle = function(){\n  return this.parent.fullTitle() + ' ' + this.title;\n};\n\n/**\n * Clear the timeout.\n *\n * @api private\n */\n\nRunnable.prototype.clearTimeout = function(){\n  clearTimeout(this.timer);\n};\n\n/**\n * Inspect the runnable void of private properties.\n *\n * @return {String}\n * @api private\n */\n\nRunnable.prototype.inspect = function(){\n  return JSON.stringify(this, function(key, val){\n    if ('_' == key[0]) return;\n    if ('parent' == key) return '#<Suite>';\n    if ('ctx' == key) return '#<Context>';\n    return val;\n  }, 2);\n};\n\n/**\n * Reset the timeout.\n *\n * @api private\n */\n\nRunnable.prototype.resetTimeout = function(){\n  var self = this;\n  var ms = this.timeout() || 1e9;\n\n  if (!this._enableTimeouts) return;\n  this.clearTimeout();\n  this.timer = setTimeout(function(){\n    if (!self._enableTimeouts) return;\n    self.callback(new Error('timeout of ' + ms + 'ms exceeded. Ensure the done() callback is being called in this test.'));\n    self.timedOut = true;\n  }, ms);\n};\n\n/**\n * Whitelist these globals for this test run\n *\n * @api private\n */\nRunnable.prototype.globals = function(arr){\n  var self = this;\n  this._allowedGlobals = arr;\n};\n\n/**\n * Run the test and invoke `fn(err)`.\n *\n * @param {Function} fn\n * @api private\n */\n\nRunnable.prototype.run = function(fn){\n  var self = this\n    , start = new Date\n    , ctx = this.ctx\n    , finished\n    , emitted;\n\n  // Some times the ctx exists but it is not runnable\n  if (ctx && ctx.runnable) ctx.runnable(this);\n\n  // called multiple times\n  function multiple(err) {\n    if (emitted) return;\n    emitted = true;\n    self.emit('error', err || new Error('done() called multiple times; stacktrace may be inaccurate'));\n  }\n\n  // finished\n  function done(err) {\n    var ms = self.timeout();\n    if (self.timedOut) return;\n    if (finished) return multiple(err || self._trace);\n\n    // Discard the resolution if this test has already failed asynchronously\n    if (self.state) return;\n\n    self.clearTimeout();\n    self.duration = new Date - start;\n    finished = true;\n    if (!err && self.duration > ms && self._enableTimeouts) err = new Error('timeout of ' + ms + 'ms exceeded. Ensure the done() callback is being called in this test.');\n    fn(err);\n  }\n\n  // for .resetTimeout()\n  this.callback = done;\n\n  // explicit async with `done` argument\n  if (this.async) {\n    this.resetTimeout();\n\n    try {\n      this.fn.call(ctx, function(err){\n        if (err instanceof Error || toString.call(err) === \"[object Error]\") return done(err);\n        if (null != err) {\n          if (Object.prototype.toString.call(err) === '[object Object]') {\n            return done(new Error('done() invoked with non-Error: ' + JSON.stringify(err)));\n          } else {\n            return done(new Error('done() invoked with non-Error: ' + err));\n          }\n        }\n        done();\n      });\n    } catch (err) {\n      done(utils.getError(err));\n    }\n    return;\n  }\n\n  if (this.asyncOnly) {\n    return done(new Error('--async-only option in use without declaring `done()`'));\n  }\n\n  // sync or promise-returning\n  try {\n    if (this.pending) {\n      done();\n    } else {\n      callFn(this.fn);\n    }\n  } catch (err) {\n    done(utils.getError(err));\n  }\n\n  function callFn(fn) {\n    var result = fn.call(ctx);\n    if (result && typeof result.then === 'function') {\n      self.resetTimeout();\n      result\n        .then(function() {\n          done()\n        },\n        function(reason) {\n          done(reason || new Error('Promise rejected with no or falsy reason'))\n        });\n    } else {\n      done();\n    }\n  }\n};\n\n}); // module: runnable.js\n\nrequire.register(\"runner.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar EventEmitter = require('browser/events').EventEmitter\n  , debug = require('browser/debug')('mocha:runner')\n  , Pending = require('./pending')\n  , Test = require('./test')\n  , utils = require('./utils')\n  , filter = utils.filter\n  , keys = utils.keys\n  , type = utils.type\n  , stringify = utils.stringify;\n\n/**\n * Non-enumerable globals.\n */\n\nvar globals = [\n  'setTimeout',\n  'clearTimeout',\n  'setInterval',\n  'clearInterval',\n  'XMLHttpRequest',\n  'Date',\n  'setImmediate',\n  'clearImmediate'\n];\n\n/**\n * Expose `Runner`.\n */\n\nmodule.exports = Runner;\n\n/**\n * Initialize a `Runner` for the given `suite`.\n *\n * Events:\n *\n *   - `start`  execution started\n *   - `end`  execution complete\n *   - `suite`  (suite) test suite execution started\n *   - `suite end`  (suite) all tests (and sub-suites) have finished\n *   - `test`  (test) test execution started\n *   - `test end`  (test) test completed\n *   - `hook`  (hook) hook execution started\n *   - `hook end`  (hook) hook complete\n *   - `pass`  (test) test passed\n *   - `fail`  (test, err) test failed\n *   - `pending`  (test) test pending\n *\n * @param {Suite} suite Root suite\n * @param {boolean} [delay] Whether or not to delay execution of root suite\n *   until ready.\n * @api public\n */\n\nfunction Runner(suite, delay) {\n  var self = this;\n  this._globals = [];\n  this._abort = false;\n  this._delay = delay;\n  this.suite = suite;\n  this.total = suite.total();\n  this.failures = 0;\n  this.on('test end', function(test){ self.checkGlobals(test); });\n  this.on('hook end', function(hook){ self.checkGlobals(hook); });\n  this.grep(/.*/);\n  this.globals(this.globalProps().concat(extraGlobals()));\n}\n\n/**\n * Wrapper for setImmediate, process.nextTick, or browser polyfill.\n *\n * @param {Function} fn\n * @api private\n */\n\nRunner.immediately = global.setImmediate || process.nextTick;\n\n/**\n * Inherit from `EventEmitter.prototype`.\n */\n\nfunction F(){};\nF.prototype = EventEmitter.prototype;\nRunner.prototype = new F;\nRunner.prototype.constructor = Runner;\n\n\n/**\n * Run tests with full titles matching `re`. Updates runner.total\n * with number of tests matched.\n *\n * @param {RegExp} re\n * @param {Boolean} invert\n * @return {Runner} for chaining\n * @api public\n */\n\nRunner.prototype.grep = function(re, invert){\n  debug('grep %s', re);\n  this._grep = re;\n  this._invert = invert;\n  this.total = this.grepTotal(this.suite);\n  return this;\n};\n\n/**\n * Returns the number of tests matching the grep search for the\n * given suite.\n *\n * @param {Suite} suite\n * @return {Number}\n * @api public\n */\n\nRunner.prototype.grepTotal = function(suite) {\n  var self = this;\n  var total = 0;\n\n  suite.eachTest(function(test){\n    var match = self._grep.test(test.fullTitle());\n    if (self._invert) match = !match;\n    if (match) total++;\n  });\n\n  return total;\n};\n\n/**\n * Return a list of global properties.\n *\n * @return {Array}\n * @api private\n */\n\nRunner.prototype.globalProps = function() {\n  var props = utils.keys(global);\n\n  // non-enumerables\n  for (var i = 0; i < globals.length; ++i) {\n    if (~utils.indexOf(props, globals[i])) continue;\n    props.push(globals[i]);\n  }\n\n  return props;\n};\n\n/**\n * Allow the given `arr` of globals.\n *\n * @param {Array} arr\n * @return {Runner} for chaining\n * @api public\n */\n\nRunner.prototype.globals = function(arr){\n  if (0 == arguments.length) return this._globals;\n  debug('globals %j', arr);\n  this._globals = this._globals.concat(arr);\n  return this;\n};\n\n/**\n * Check for global variable leaks.\n *\n * @api private\n */\n\nRunner.prototype.checkGlobals = function(test){\n  if (this.ignoreLeaks) return;\n  var ok = this._globals;\n\n  var globals = this.globalProps();\n  var leaks;\n\n  if (test) {\n    ok = ok.concat(test._allowedGlobals || []);\n  }\n\n  if(this.prevGlobalsLength == globals.length) return;\n  this.prevGlobalsLength = globals.length;\n\n  leaks = filterLeaks(ok, globals);\n  this._globals = this._globals.concat(leaks);\n\n  if (leaks.length > 1) {\n    this.fail(test, new Error('global leaks detected: ' + leaks.join(', ') + ''));\n  } else if (leaks.length) {\n    this.fail(test, new Error('global leak detected: ' + leaks[0]));\n  }\n};\n\n/**\n * Fail the given `test`.\n *\n * @param {Test} test\n * @param {Error} err\n * @api private\n */\n\nRunner.prototype.fail = function(test, err){\n  ++this.failures;\n  test.state = 'failed';\n\n  if ('string' == typeof err) {\n    err = new Error('the string \"' + err + '\" was thrown, throw an Error :)');\n  } else if (!(err instanceof Error)) {\n    err = new Error('the ' + type(err) + ' ' + stringify(err) + ' was thrown, throw an Error :)');\n  }\n\n  this.emit('fail', test, err);\n};\n\n/**\n * Fail the given `hook` with `err`.\n *\n * Hook failures work in the following pattern:\n * - If bail, then exit\n * - Failed `before` hook skips all tests in a suite and subsuites,\n *   but jumps to corresponding `after` hook\n * - Failed `before each` hook skips remaining tests in a\n *   suite and jumps to corresponding `after each` hook,\n *   which is run only once\n * - Failed `after` hook does not alter\n *   execution order\n * - Failed `after each` hook skips remaining tests in a\n *   suite and subsuites, but executes other `after each`\n *   hooks\n *\n * @param {Hook} hook\n * @param {Error} err\n * @api private\n */\n\nRunner.prototype.failHook = function(hook, err){\n  this.fail(hook, err);\n  if (this.suite.bail()) {\n    this.emit('end');\n  }\n};\n\n/**\n * Run hook `name` callbacks and then invoke `fn()`.\n *\n * @param {String} name\n * @param {Function} function\n * @api private\n */\n\nRunner.prototype.hook = function(name, fn){\n  var suite = this.suite\n    , hooks = suite['_' + name]\n    , self = this\n    , timer;\n\n  function next(i) {\n    var hook = hooks[i];\n    if (!hook) return fn();\n    self.currentRunnable = hook;\n\n    hook.ctx.currentTest = self.test;\n\n    self.emit('hook', hook);\n\n    hook.on('error', function(err){\n      self.failHook(hook, err);\n    });\n\n    hook.run(function(err){\n      hook.removeAllListeners('error');\n      var testError = hook.error();\n      if (testError) self.fail(self.test, testError);\n      if (err) {\n        if (err instanceof Pending) {\n          suite.pending = true;\n        } else {\n          self.failHook(hook, err);\n\n          // stop executing hooks, notify callee of hook err\n          return fn(err);\n        }\n      }\n      self.emit('hook end', hook);\n      delete hook.ctx.currentTest;\n      next(++i);\n    });\n  }\n\n  Runner.immediately(function(){\n    next(0);\n  });\n};\n\n/**\n * Run hook `name` for the given array of `suites`\n * in order, and callback `fn(err, errSuite)`.\n *\n * @param {String} name\n * @param {Array} suites\n * @param {Function} fn\n * @api private\n */\n\nRunner.prototype.hooks = function(name, suites, fn){\n  var self = this\n    , orig = this.suite;\n\n  function next(suite) {\n    self.suite = suite;\n\n    if (!suite) {\n      self.suite = orig;\n      return fn();\n    }\n\n    self.hook(name, function(err){\n      if (err) {\n        var errSuite = self.suite;\n        self.suite = orig;\n        return fn(err, errSuite);\n      }\n\n      next(suites.pop());\n    });\n  }\n\n  next(suites.pop());\n};\n\n/**\n * Run hooks from the top level down.\n *\n * @param {String} name\n * @param {Function} fn\n * @api private\n */\n\nRunner.prototype.hookUp = function(name, fn){\n  var suites = [this.suite].concat(this.parents()).reverse();\n  this.hooks(name, suites, fn);\n};\n\n/**\n * Run hooks from the bottom up.\n *\n * @param {String} name\n * @param {Function} fn\n * @api private\n */\n\nRunner.prototype.hookDown = function(name, fn){\n  var suites = [this.suite].concat(this.parents());\n  this.hooks(name, suites, fn);\n};\n\n/**\n * Return an array of parent Suites from\n * closest to furthest.\n *\n * @return {Array}\n * @api private\n */\n\nRunner.prototype.parents = function(){\n  var suite = this.suite\n    , suites = [];\n  while (suite = suite.parent) suites.push(suite);\n  return suites;\n};\n\n/**\n * Run the current test and callback `fn(err)`.\n *\n * @param {Function} fn\n * @api private\n */\n\nRunner.prototype.runTest = function(fn){\n  var test = this.test\n    , self = this;\n\n  if (this.asyncOnly) test.asyncOnly = true;\n\n  try {\n    test.on('error', function(err){\n      self.fail(test, err);\n    });\n    test.run(fn);\n  } catch (err) {\n    fn(err);\n  }\n};\n\n/**\n * Run tests in the given `suite` and invoke\n * the callback `fn()` when complete.\n *\n * @param {Suite} suite\n * @param {Function} fn\n * @api private\n */\n\nRunner.prototype.runTests = function(suite, fn){\n  var self = this\n    , tests = suite.tests.slice()\n    , test;\n\n\n  function hookErr(err, errSuite, after) {\n    // before/after Each hook for errSuite failed:\n    var orig = self.suite;\n\n    // for failed 'after each' hook start from errSuite parent,\n    // otherwise start from errSuite itself\n    self.suite = after ? errSuite.parent : errSuite;\n\n    if (self.suite) {\n      // call hookUp afterEach\n      self.hookUp('afterEach', function(err2, errSuite2) {\n        self.suite = orig;\n        // some hooks may fail even now\n        if (err2) return hookErr(err2, errSuite2, true);\n        // report error suite\n        fn(errSuite);\n      });\n    } else {\n      // there is no need calling other 'after each' hooks\n      self.suite = orig;\n      fn(errSuite);\n    }\n  }\n\n  function next(err, errSuite) {\n    // if we bail after first err\n    if (self.failures && suite._bail) return fn();\n\n    if (self._abort) return fn();\n\n    if (err) return hookErr(err, errSuite, true);\n\n    // next test\n    test = tests.shift();\n\n    // all done\n    if (!test) return fn();\n\n    // grep\n    var match = self._grep.test(test.fullTitle());\n    if (self._invert) match = !match;\n    if (!match) return next();\n\n    // pending\n    if (test.pending) {\n      self.emit('pending', test);\n      self.emit('test end', test);\n      return next();\n    }\n\n    // execute test and hook(s)\n    self.emit('test', self.test = test);\n    self.hookDown('beforeEach', function(err, errSuite){\n\n      if (suite.pending) {\n        self.emit('pending', test);\n        self.emit('test end', test);\n        return next();\n      }\n      if (err) return hookErr(err, errSuite, false);\n\n      self.currentRunnable = self.test;\n      self.runTest(function(err){\n        test = self.test;\n\n        if (err) {\n          if (err instanceof Pending) {\n            self.emit('pending', test);\n          } else {\n            self.fail(test, err);\n          }\n          self.emit('test end', test);\n\n          if (err instanceof Pending) {\n            return next();\n          }\n\n          return self.hookUp('afterEach', next);\n        }\n\n        test.state = 'passed';\n        self.emit('pass', test);\n        self.emit('test end', test);\n        self.hookUp('afterEach', next);\n      });\n    });\n  }\n\n  this.next = next;\n  next();\n};\n\n/**\n * Run the given `suite` and invoke the\n * callback `fn()` when complete.\n *\n * @param {Suite} suite\n * @param {Function} fn\n * @api private\n */\n\nRunner.prototype.runSuite = function(suite, fn){\n  var total = this.grepTotal(suite)\n    , self = this\n    , i = 0;\n\n  debug('run suite %s', suite.fullTitle());\n\n  if (!total) return fn();\n\n  this.emit('suite', this.suite = suite);\n\n  function next(errSuite) {\n    if (errSuite) {\n      // current suite failed on a hook from errSuite\n      if (errSuite == suite) {\n        // if errSuite is current suite\n        // continue to the next sibling suite\n        return done();\n      } else {\n        // errSuite is among the parents of current suite\n        // stop execution of errSuite and all sub-suites\n        return done(errSuite);\n      }\n    }\n\n    if (self._abort) return done();\n\n    var curr = suite.suites[i++];\n    if (!curr) return done();\n    self.runSuite(curr, next);\n  }\n\n  function done(errSuite) {\n    self.suite = suite;\n    self.hook('afterAll', function(){\n      self.emit('suite end', suite);\n      fn(errSuite);\n    });\n  }\n\n  this.hook('beforeAll', function(err){\n    if (err) return done();\n    self.runTests(suite, next);\n  });\n};\n\n/**\n * Handle uncaught exceptions.\n *\n * @param {Error} err\n * @api private\n */\n\nRunner.prototype.uncaught = function(err){\n  if (err) {\n    debug('uncaught exception %s', err !== function () {\n      return this;\n    }.call(err) ? err : ( err.message || err ));\n  } else {\n    debug('uncaught undefined exception');\n    err = utils.undefinedError();\n  }\n  err.uncaught = true;\n\n  var runnable = this.currentRunnable;\n  if (!runnable) return;\n\n  runnable.clearTimeout();\n\n  // Ignore errors if complete\n  if (runnable.state) return;\n  this.fail(runnable, err);\n\n  // recover from test\n  if ('test' == runnable.type) {\n    this.emit('test end', runnable);\n    this.hookUp('afterEach', this.next);\n    return;\n  }\n\n  // bail on hooks\n  this.emit('end');\n};\n\n/**\n * Run the root suite and invoke `fn(failures)`\n * on completion.\n *\n * @param {Function} fn\n * @return {Runner} for chaining\n * @api public\n */\n\nRunner.prototype.run = function(fn){\n  var self = this,\n    rootSuite = this.suite;\n\n  fn = fn || function(){};\n\n  function uncaught(err){\n    self.uncaught(err);\n  }\n\n  function start() {\n    self.emit('start');\n    self.runSuite(rootSuite, function(){\n      debug('finished running');\n      self.emit('end');\n    });\n  }\n\n  debug('start');\n\n  // callback\n  this.on('end', function(){\n    debug('end');\n    process.removeListener('uncaughtException', uncaught);\n    fn(self.failures);\n  });\n\n  // uncaught exception\n  process.on('uncaughtException', uncaught);\n\n  if (this._delay) {\n    // for reporters, I guess.\n    // might be nice to debounce some dots while we wait.\n    this.emit('waiting', rootSuite);\n    rootSuite.once('run', start);\n  }\n  else {\n    start();\n  }\n\n  return this;\n};\n\n/**\n * Cleanly abort execution\n *\n * @return {Runner} for chaining\n * @api public\n */\nRunner.prototype.abort = function(){\n  debug('aborting');\n  this._abort = true;\n};\n\n/**\n * Filter leaks with the given globals flagged as `ok`.\n *\n * @param {Array} ok\n * @param {Array} globals\n * @return {Array}\n * @api private\n */\n\nfunction filterLeaks(ok, globals) {\n  return filter(globals, function(key){\n    // Firefox and Chrome exposes iframes as index inside the window object\n    if (/^d+/.test(key)) return false;\n\n    // in firefox\n    // if runner runs in an iframe, this iframe's window.getInterface method not init at first\n    // it is assigned in some seconds\n    if (global.navigator && /^getInterface/.test(key)) return false;\n\n    // an iframe could be approached by window[iframeIndex]\n    // in ie6,7,8 and opera, iframeIndex is enumerable, this could cause leak\n    if (global.navigator && /^\\d+/.test(key)) return false;\n\n    // Opera and IE expose global variables for HTML element IDs (issue #243)\n    if (/^mocha-/.test(key)) return false;\n\n    var matched = filter(ok, function(ok){\n      if (~ok.indexOf('*')) return 0 == key.indexOf(ok.split('*')[0]);\n      return key == ok;\n    });\n    return matched.length == 0 && (!global.navigator || 'onerror' !== key);\n  });\n}\n\n/**\n * Array of globals dependent on the environment.\n *\n * @return {Array}\n * @api private\n */\n\n function extraGlobals() {\n  if (typeof(process) === 'object' &&\n      typeof(process.version) === 'string') {\n\n    var nodeVersion = process.version.split('.').reduce(function(a, v) {\n      return a << 8 | v;\n    });\n\n    // 'errno' was renamed to process._errno in v0.9.11.\n\n    if (nodeVersion < 0x00090B) {\n      return ['errno'];\n    }\n  }\n\n  return [];\n }\n\n}); // module: runner.js\n\nrequire.register(\"suite.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar EventEmitter = require('browser/events').EventEmitter\n  , debug = require('browser/debug')('mocha:suite')\n  , milliseconds = require('./ms')\n  , utils = require('./utils')\n  , Hook = require('./hook');\n\n/**\n * Expose `Suite`.\n */\n\nexports = module.exports = Suite;\n\n/**\n * Create a new `Suite` with the given `title`\n * and parent `Suite`. When a suite with the\n * same title is already present, that suite\n * is returned to provide nicer reporter\n * and more flexible meta-testing.\n *\n * @param {Suite} parent\n * @param {String} title\n * @return {Suite}\n * @api public\n */\n\nexports.create = function(parent, title){\n  var suite = new Suite(title, parent.ctx);\n  suite.parent = parent;\n  if (parent.pending) suite.pending = true;\n  title = suite.fullTitle();\n  parent.addSuite(suite);\n  return suite;\n};\n\n/**\n * Initialize a new `Suite` with the given\n * `title` and `ctx`.\n *\n * @param {String} title\n * @param {Context} ctx\n * @api private\n */\n\nfunction Suite(title, parentContext) {\n  this.title = title;\n  var context = function() {};\n  context.prototype = parentContext;\n  this.ctx = new context();\n  this.suites = [];\n  this.tests = [];\n  this.pending = false;\n  this._beforeEach = [];\n  this._beforeAll = [];\n  this._afterEach = [];\n  this._afterAll = [];\n  this.root = !title;\n  this._timeout = 2000;\n  this._enableTimeouts = true;\n  this._slow = 75;\n  this._bail = false;\n  this.delayed = false;\n}\n\n/**\n * Inherit from `EventEmitter.prototype`.\n */\n\nfunction F(){};\nF.prototype = EventEmitter.prototype;\nSuite.prototype = new F;\nSuite.prototype.constructor = Suite;\n\n\n/**\n * Return a clone of this `Suite`.\n *\n * @return {Suite}\n * @api private\n */\n\nSuite.prototype.clone = function(){\n  var suite = new Suite(this.title);\n  debug('clone');\n  suite.ctx = this.ctx;\n  suite.timeout(this.timeout());\n  suite.enableTimeouts(this.enableTimeouts());\n  suite.slow(this.slow());\n  suite.bail(this.bail());\n  return suite;\n};\n\n/**\n * Set timeout `ms` or short-hand such as \"2s\".\n *\n * @param {Number|String} ms\n * @return {Suite|Number} for chaining\n * @api private\n */\n\nSuite.prototype.timeout = function(ms){\n  if (0 == arguments.length) return this._timeout;\n  if (ms.toString() === '0') this._enableTimeouts = false;\n  if ('string' == typeof ms) ms = milliseconds(ms);\n  debug('timeout %d', ms);\n  this._timeout = parseInt(ms, 10);\n  return this;\n};\n\n/**\n  * Set timeout `enabled`.\n  *\n  * @param {Boolean} enabled\n  * @return {Suite|Boolean} self or enabled\n  * @api private\n  */\n\nSuite.prototype.enableTimeouts = function(enabled){\n  if (arguments.length === 0) return this._enableTimeouts;\n  debug('enableTimeouts %s', enabled);\n  this._enableTimeouts = enabled;\n  return this;\n};\n\n/**\n * Set slow `ms` or short-hand such as \"2s\".\n *\n * @param {Number|String} ms\n * @return {Suite|Number} for chaining\n * @api private\n */\n\nSuite.prototype.slow = function(ms){\n  if (0 === arguments.length) return this._slow;\n  if ('string' == typeof ms) ms = milliseconds(ms);\n  debug('slow %d', ms);\n  this._slow = ms;\n  return this;\n};\n\n/**\n * Sets whether to bail after first error.\n *\n * @param {Boolean} bail\n * @return {Suite|Number} for chaining\n * @api private\n */\n\nSuite.prototype.bail = function(bail){\n  if (0 == arguments.length) return this._bail;\n  debug('bail %s', bail);\n  this._bail = bail;\n  return this;\n};\n\n/**\n * Run `fn(test[, done])` before running tests.\n *\n * @param {Function} fn\n * @return {Suite} for chaining\n * @api private\n */\n\nSuite.prototype.beforeAll = function(title, fn){\n  if (this.pending) return this;\n  if ('function' === typeof title) {\n    fn = title;\n    title = fn.name;\n  }\n  title = '\"before all\" hook' + (title ? ': ' + title : '');\n\n  var hook = new Hook(title, fn);\n  hook.parent = this;\n  hook.timeout(this.timeout());\n  hook.enableTimeouts(this.enableTimeouts());\n  hook.slow(this.slow());\n  hook.ctx = this.ctx;\n  this._beforeAll.push(hook);\n  this.emit('beforeAll', hook);\n  return this;\n};\n\n/**\n * Run `fn(test[, done])` after running tests.\n *\n * @param {Function} fn\n * @return {Suite} for chaining\n * @api private\n */\n\nSuite.prototype.afterAll = function(title, fn){\n  if (this.pending) return this;\n  if ('function' === typeof title) {\n    fn = title;\n    title = fn.name;\n  }\n  title = '\"after all\" hook' + (title ? ': ' + title : '');\n\n  var hook = new Hook(title, fn);\n  hook.parent = this;\n  hook.timeout(this.timeout());\n  hook.enableTimeouts(this.enableTimeouts());\n  hook.slow(this.slow());\n  hook.ctx = this.ctx;\n  this._afterAll.push(hook);\n  this.emit('afterAll', hook);\n  return this;\n};\n\n/**\n * Run `fn(test[, done])` before each test case.\n *\n * @param {Function} fn\n * @return {Suite} for chaining\n * @api private\n */\n\nSuite.prototype.beforeEach = function(title, fn){\n  if (this.pending) return this;\n  if ('function' === typeof title) {\n    fn = title;\n    title = fn.name;\n  }\n  title = '\"before each\" hook' + (title ? ': ' + title : '');\n\n  var hook = new Hook(title, fn);\n  hook.parent = this;\n  hook.timeout(this.timeout());\n  hook.enableTimeouts(this.enableTimeouts());\n  hook.slow(this.slow());\n  hook.ctx = this.ctx;\n  this._beforeEach.push(hook);\n  this.emit('beforeEach', hook);\n  return this;\n};\n\n/**\n * Run `fn(test[, done])` after each test case.\n *\n * @param {Function} fn\n * @return {Suite} for chaining\n * @api private\n */\n\nSuite.prototype.afterEach = function(title, fn){\n  if (this.pending) return this;\n  if ('function' === typeof title) {\n    fn = title;\n    title = fn.name;\n  }\n  title = '\"after each\" hook' + (title ? ': ' + title : '');\n\n  var hook = new Hook(title, fn);\n  hook.parent = this;\n  hook.timeout(this.timeout());\n  hook.enableTimeouts(this.enableTimeouts());\n  hook.slow(this.slow());\n  hook.ctx = this.ctx;\n  this._afterEach.push(hook);\n  this.emit('afterEach', hook);\n  return this;\n};\n\n/**\n * Add a test `suite`.\n *\n * @param {Suite} suite\n * @return {Suite} for chaining\n * @api private\n */\n\nSuite.prototype.addSuite = function(suite){\n  suite.parent = this;\n  suite.timeout(this.timeout());\n  suite.enableTimeouts(this.enableTimeouts());\n  suite.slow(this.slow());\n  suite.bail(this.bail());\n  this.suites.push(suite);\n  this.emit('suite', suite);\n  return this;\n};\n\n/**\n * Add a `test` to this suite.\n *\n * @param {Test} test\n * @return {Suite} for chaining\n * @api private\n */\n\nSuite.prototype.addTest = function(test){\n  test.parent = this;\n  test.timeout(this.timeout());\n  test.enableTimeouts(this.enableTimeouts());\n  test.slow(this.slow());\n  test.ctx = this.ctx;\n  this.tests.push(test);\n  this.emit('test', test);\n  return this;\n};\n\n/**\n * Return the full title generated by recursively\n * concatenating the parent's full title.\n *\n * @return {String}\n * @api public\n */\n\nSuite.prototype.fullTitle = function(){\n  if (this.parent) {\n    var full = this.parent.fullTitle();\n    if (full) return full + ' ' + this.title;\n  }\n  return this.title;\n};\n\n/**\n * Return the total number of tests.\n *\n * @return {Number}\n * @api public\n */\n\nSuite.prototype.total = function(){\n  return utils.reduce(this.suites, function(sum, suite){\n    return sum + suite.total();\n  }, 0) + this.tests.length;\n};\n\n/**\n * Iterates through each suite recursively to find\n * all tests. Applies a function in the format\n * `fn(test)`.\n *\n * @param {Function} fn\n * @return {Suite}\n * @api private\n */\n\nSuite.prototype.eachTest = function(fn){\n  utils.forEach(this.tests, fn);\n  utils.forEach(this.suites, function(suite){\n    suite.eachTest(fn);\n  });\n  return this;\n};\n\n/**\n * This will run the root suite if we happen to be running in delayed mode.\n */\nSuite.prototype.run = function run() {\n  if (this.root) {\n    this.emit('run');\n  }\n};\n\n}); // module: suite.js\n\nrequire.register(\"test.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar Runnable = require('./runnable');\n\n/**\n * Expose `Test`.\n */\n\nmodule.exports = Test;\n\n/**\n * Initialize a new `Test` with the given `title` and callback `fn`.\n *\n * @param {String} title\n * @param {Function} fn\n * @api private\n */\n\nfunction Test(title, fn) {\n  Runnable.call(this, title, fn);\n  this.pending = !fn;\n  this.type = 'test';\n}\n\n/**\n * Inherit from `Runnable.prototype`.\n */\n\nfunction F(){};\nF.prototype = Runnable.prototype;\nTest.prototype = new F;\nTest.prototype.constructor = Test;\n\n\n}); // module: test.js\n\nrequire.register(\"utils.js\", function(module, exports, require){\n/**\n * Module dependencies.\n */\n\nvar fs = require('browser/fs')\n  , path = require('browser/path')\n  , basename = path.basename\n  , exists = fs.existsSync || path.existsSync\n  , glob = require('browser/glob')\n  , join = path.join\n  , debug = require('browser/debug')('mocha:watch');\n\n/**\n * Ignored directories.\n */\n\nvar ignore = ['node_modules', '.git'];\n\n/**\n * Escape special characters in the given string of html.\n *\n * @param  {String} html\n * @return {String}\n * @api private\n */\n\nexports.escape = function(html){\n  return String(html)\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;');\n};\n\n/**\n * Array#forEach (<=IE8)\n *\n * @param {Array} array\n * @param {Function} fn\n * @param {Object} scope\n * @api private\n */\n\nexports.forEach = function(arr, fn, scope){\n  for (var i = 0, l = arr.length; i < l; i++)\n    fn.call(scope, arr[i], i);\n};\n\n/**\n * Array#map (<=IE8)\n *\n * @param {Array} array\n * @param {Function} fn\n * @param {Object} scope\n * @api private\n */\n\nexports.map = function(arr, fn, scope){\n  var result = [];\n  for (var i = 0, l = arr.length; i < l; i++)\n    result.push(fn.call(scope, arr[i], i, arr));\n  return result;\n};\n\n/**\n * Array#indexOf (<=IE8)\n *\n * @parma {Array} arr\n * @param {Object} obj to find index of\n * @param {Number} start\n * @api private\n */\n\nexports.indexOf = function(arr, obj, start){\n  for (var i = start || 0, l = arr.length; i < l; i++) {\n    if (arr[i] === obj)\n      return i;\n  }\n  return -1;\n};\n\n/**\n * Array#reduce (<=IE8)\n *\n * @param {Array} array\n * @param {Function} fn\n * @param {Object} initial value\n * @api private\n */\n\nexports.reduce = function(arr, fn, val){\n  var rval = val;\n\n  for (var i = 0, l = arr.length; i < l; i++) {\n    rval = fn(rval, arr[i], i, arr);\n  }\n\n  return rval;\n};\n\n/**\n * Array#filter (<=IE8)\n *\n * @param {Array} array\n * @param {Function} fn\n * @api private\n */\n\nexports.filter = function(arr, fn){\n  var ret = [];\n\n  for (var i = 0, l = arr.length; i < l; i++) {\n    var val = arr[i];\n    if (fn(val, i, arr)) ret.push(val);\n  }\n\n  return ret;\n};\n\n/**\n * Object.keys (<=IE8)\n *\n * @param {Object} obj\n * @return {Array} keys\n * @api private\n */\n\nexports.keys = Object.keys || function(obj) {\n  var keys = []\n    , has = Object.prototype.hasOwnProperty; // for `window` on <=IE8\n\n  for (var key in obj) {\n    if (has.call(obj, key)) {\n      keys.push(key);\n    }\n  }\n\n  return keys;\n};\n\n/**\n * Watch the given `files` for changes\n * and invoke `fn(file)` on modification.\n *\n * @param {Array} files\n * @param {Function} fn\n * @api private\n */\n\nexports.watch = function(files, fn){\n  var options = { interval: 100 };\n  files.forEach(function(file){\n    debug('file %s', file);\n    fs.watchFile(file, options, function(curr, prev){\n      if (prev.mtime < curr.mtime) fn(file);\n    });\n  });\n};\n\n/**\n * Array.isArray (<=IE8)\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\nvar isArray = Array.isArray || function (obj) {\n  return '[object Array]' == {}.toString.call(obj);\n};\n\n/**\n * @description\n * Buffer.prototype.toJSON polyfill\n * @type {Function}\n */\nif(typeof Buffer !== 'undefined' && Buffer.prototype) {\n  Buffer.prototype.toJSON = Buffer.prototype.toJSON || function () {\n    return Array.prototype.slice.call(this, 0);\n  };\n}\n\n/**\n * Ignored files.\n */\n\nfunction ignored(path){\n  return !~ignore.indexOf(path);\n}\n\n/**\n * Lookup files in the given `dir`.\n *\n * @return {Array}\n * @api private\n */\n\nexports.files = function(dir, ext, ret){\n  ret = ret || [];\n  ext = ext || ['js'];\n\n  var re = new RegExp('\\\\.(' + ext.join('|') + ')$');\n\n  fs.readdirSync(dir)\n    .filter(ignored)\n    .forEach(function(path){\n      path = join(dir, path);\n      if (fs.statSync(path).isDirectory()) {\n        exports.files(path, ext, ret);\n      } else if (path.match(re)) {\n        ret.push(path);\n      }\n    });\n\n  return ret;\n};\n\n/**\n * Compute a slug from the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nexports.slug = function(str){\n  return str\n    .toLowerCase()\n    .replace(/ +/g, '-')\n    .replace(/[^-\\w]/g, '');\n};\n\n/**\n * Strip the function definition from `str`,\n * and re-indent for pre whitespace.\n */\n\nexports.clean = function(str) {\n  str = str\n    .replace(/\\r\\n?|[\\n\\u2028\\u2029]/g, \"\\n\").replace(/^\\uFEFF/, '')\n    .replace(/^function *\\(.*\\) *{|\\(.*\\) *=> *{?/, '')\n    .replace(/\\s+\\}$/, '');\n\n  var spaces = str.match(/^\\n?( *)/)[1].length\n    , tabs = str.match(/^\\n?(\\t*)/)[1].length\n    , re = new RegExp('^\\n?' + (tabs ? '\\t' : ' ') + '{' + (tabs ? tabs : spaces) + '}', 'gm');\n\n  str = str.replace(re, '');\n\n  return exports.trim(str);\n};\n\n/**\n * Trim the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nexports.trim = function(str){\n  return str.replace(/^\\s+|\\s+$/g, '');\n};\n\n/**\n * Parse the given `qs`.\n *\n * @param {String} qs\n * @return {Object}\n * @api private\n */\n\nexports.parseQuery = function(qs){\n  return exports.reduce(qs.replace('?', '').split('&'), function(obj, pair){\n    var i = pair.indexOf('=')\n      , key = pair.slice(0, i)\n      , val = pair.slice(++i);\n\n    obj[key] = decodeURIComponent(val);\n    return obj;\n  }, {});\n};\n\n/**\n * Highlight the given string of `js`.\n *\n * @param {String} js\n * @return {String}\n * @api private\n */\n\nfunction highlight(js) {\n  return js\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\\/\\/(.*)/gm, '<span class=\"comment\">//$1</span>')\n    .replace(/('.*?')/gm, '<span class=\"string\">$1</span>')\n    .replace(/(\\d+\\.\\d+)/gm, '<span class=\"number\">$1</span>')\n    .replace(/(\\d+)/gm, '<span class=\"number\">$1</span>')\n    .replace(/\\bnew[ \\t]+(\\w+)/gm, '<span class=\"keyword\">new</span> <span class=\"init\">$1</span>')\n    .replace(/\\b(function|new|throw|return|var|if|else)\\b/gm, '<span class=\"keyword\">$1</span>')\n}\n\n/**\n * Highlight the contents of tag `name`.\n *\n * @param {String} name\n * @api private\n */\n\nexports.highlightTags = function(name) {\n  var code = document.getElementById('mocha').getElementsByTagName(name);\n  for (var i = 0, len = code.length; i < len; ++i) {\n    code[i].innerHTML = highlight(code[i].innerHTML);\n  }\n};\n\n/**\n * If a value could have properties, and has none, this function is called, which returns\n * a string representation of the empty value.\n *\n * Functions w/ no properties return `'[Function]'`\n * Arrays w/ length === 0 return `'[]'`\n * Objects w/ no properties return `'{}'`\n * All else: return result of `value.toString()`\n *\n * @param {*} value Value to inspect\n * @param {string} [type] The type of the value, if known.\n * @returns {string}\n */\nvar emptyRepresentation = function emptyRepresentation(value, type) {\n  type = type || exports.type(value);\n\n  switch(type) {\n    case 'function':\n      return '[Function]';\n    case 'object':\n      return '{}';\n    case 'array':\n      return '[]';\n    default:\n      return value.toString();\n  }\n};\n\n/**\n * Takes some variable and asks `{}.toString()` what it thinks it is.\n * @param {*} value Anything\n * @example\n * type({}) // 'object'\n * type([]) // 'array'\n * type(1) // 'number'\n * type(false) // 'boolean'\n * type(Infinity) // 'number'\n * type(null) // 'null'\n * type(new Date()) // 'date'\n * type(/foo/) // 'regexp'\n * type('type') // 'string'\n * type(global) // 'global'\n * @api private\n * @see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toString\n * @returns {string}\n */\nexports.type = function type(value) {\n  if (typeof Buffer !== 'undefined' && Buffer.isBuffer(value)) {\n    return 'buffer';\n  }\n  return Object.prototype.toString.call(value)\n    .replace(/^\\[.+\\s(.+?)\\]$/, '$1')\n    .toLowerCase();\n};\n\n/**\n * @summary Stringify `value`.\n * @description Different behavior depending on type of value.\n * - If `value` is undefined or null, return `'[undefined]'` or `'[null]'`, respectively.\n * - If `value` is not an object, function or array, return result of `value.toString()` wrapped in double-quotes.\n * - If `value` is an *empty* object, function, or array, return result of function\n *   {@link emptyRepresentation}.\n * - If `value` has properties, call {@link exports.canonicalize} on it, then return result of\n *   JSON.stringify().\n *\n * @see exports.type\n * @param {*} value\n * @return {string}\n * @api private\n */\n\nexports.stringify = function(value) {\n  var type = exports.type(value);\n\n  if (!~exports.indexOf(['object', 'array', 'function'], type)) {\n    if(type != 'buffer') {\n      return jsonStringify(value);\n    }\n    var json = value.toJSON();\n    // Based on the toJSON result\n    return jsonStringify(json.data && json.type ? json.data : json, 2)\n      .replace(/,(\\n|$)/g, '$1');\n  }\n\n  for (var prop in value) {\n    if (Object.prototype.hasOwnProperty.call(value, prop)) {\n      return jsonStringify(exports.canonicalize(value), 2).replace(/,(\\n|$)/g, '$1');\n    }\n  }\n\n  return emptyRepresentation(value, type);\n};\n\n/**\n * @description\n * like JSON.stringify but more sense.\n * @param {Object}  object\n * @param {Number=} spaces\n * @param {number=} depth\n * @returns {*}\n * @private\n */\nfunction jsonStringify(object, spaces, depth) {\n  if(typeof spaces == 'undefined') return _stringify(object);  // primitive types\n\n  depth = depth || 1;\n  var space = spaces * depth\n    , str = isArray(object) ? '[' : '{'\n    , end = isArray(object) ? ']' : '}'\n    , length = object.length || exports.keys(object).length\n    , repeat = function(s, n) { return new Array(n).join(s); }; // `.repeat()` polyfill\n\n  function _stringify(val) {\n    switch (exports.type(val)) {\n      case 'null':\n      case 'undefined':\n        val = '[' + val + ']';\n        break;\n      case 'array':\n      case 'object':\n        val = jsonStringify(val, spaces, depth + 1);\n        break;\n      case 'boolean':\n      case 'regexp':\n      case 'number':\n        val = val === 0 && (1/val) === -Infinity // `-0`\n          ? '-0'\n          : val.toString();\n        break;\n      case 'date':\n        val = '[Date: ' + val.toISOString() + ']';\n        break;\n      case 'buffer':\n        var json = val.toJSON();\n        // Based on the toJSON result\n        json = json.data && json.type ? json.data : json;\n        val = '[Buffer: ' + jsonStringify(json, 2, depth + 1) + ']';\n        break;\n      default:\n        val = (val == '[Function]' || val == '[Circular]')\n          ? val\n          : '\"' + val + '\"'; //string\n    }\n    return val;\n  }\n\n  for(var i in object) {\n    if(!object.hasOwnProperty(i)) continue;        // not my business\n    --length;\n    str += '\\n ' + repeat(' ', space)\n      + (isArray(object) ? '' : '\"' + i + '\": ') // key\n      +  _stringify(object[i])                   // value\n      + (length ? ',' : '');                     // comma\n  }\n\n  return str + (str.length != 1                    // [], {}\n    ? '\\n' + repeat(' ', --space) + end\n    : end);\n}\n\n/**\n * Return if obj is a Buffer\n * @param {Object} arg\n * @return {Boolean}\n * @api private\n */\nexports.isBuffer = function (arg) {\n  return typeof Buffer !== 'undefined' && Buffer.isBuffer(arg);\n};\n\n/**\n * @summary Return a new Thing that has the keys in sorted order.  Recursive.\n * @description If the Thing...\n * - has already been seen, return string `'[Circular]'`\n * - is `undefined`, return string `'[undefined]'`\n * - is `null`, return value `null`\n * - is some other primitive, return the value\n * - is not a primitive or an `Array`, `Object`, or `Function`, return the value of the Thing's `toString()` method\n * - is a non-empty `Array`, `Object`, or `Function`, return the result of calling this function again.\n * - is an empty `Array`, `Object`, or `Function`, return the result of calling `emptyRepresentation()`\n *\n * @param {*} value Thing to inspect.  May or may not have properties.\n * @param {Array} [stack=[]] Stack of seen values\n * @return {(Object|Array|Function|string|undefined)}\n * @see {@link exports.stringify}\n * @api private\n */\n\nexports.canonicalize = function(value, stack) {\n  var canonicalizedObj,\n    type = exports.type(value),\n    prop,\n    withStack = function withStack(value, fn) {\n      stack.push(value);\n      fn();\n      stack.pop();\n    };\n\n  stack = stack || [];\n\n  if (exports.indexOf(stack, value) !== -1) {\n    return '[Circular]';\n  }\n\n  switch(type) {\n    case 'undefined':\n    case 'buffer':\n    case 'null':\n      canonicalizedObj = value;\n      break;\n    case 'array':\n      withStack(value, function () {\n        canonicalizedObj = exports.map(value, function (item) {\n          return exports.canonicalize(item, stack);\n        });\n      });\n      break;\n    case 'function':\n      for (prop in value) {\n        canonicalizedObj = {};\n        break;\n      }\n      if (!canonicalizedObj) {\n        canonicalizedObj = emptyRepresentation(value, type);\n        break;\n      }\n    /* falls through */\n    case 'object':\n      canonicalizedObj = canonicalizedObj || {};\n      withStack(value, function () {\n        exports.forEach(exports.keys(value).sort(), function (key) {\n          canonicalizedObj[key] = exports.canonicalize(value[key], stack);\n        });\n      });\n      break;\n    case 'date':\n    case 'number':\n    case 'regexp':\n    case 'boolean':\n      canonicalizedObj = value;\n      break;\n    default:\n      canonicalizedObj = value.toString();\n  }\n\n  return canonicalizedObj;\n};\n\n/**\n * Lookup file names at the given `path`.\n */\nexports.lookupFiles = function lookupFiles(path, extensions, recursive) {\n  var files = [];\n  var re = new RegExp('\\\\.(' + extensions.join('|') + ')$');\n\n  if (!exists(path)) {\n    if (exists(path + '.js')) {\n      path += '.js';\n    } else {\n      files = glob.sync(path);\n      if (!files.length) throw new Error(\"cannot resolve path (or pattern) '\" + path + \"'\");\n      return files;\n    }\n  }\n\n  try {\n    var stat = fs.statSync(path);\n    if (stat.isFile()) return path;\n  }\n  catch (ignored) {\n    return;\n  }\n\n  fs.readdirSync(path).forEach(function(file) {\n    file = join(path, file);\n    try {\n      var stat = fs.statSync(file);\n      if (stat.isDirectory()) {\n        if (recursive) {\n          files = files.concat(lookupFiles(file, extensions, recursive));\n        }\n        return;\n      }\n    }\n    catch (ignored) {\n      return;\n    }\n    if (!stat.isFile() || !re.test(file) || basename(file)[0] === '.') return;\n    files.push(file);\n  });\n\n  return files;\n};\n\n/**\n * Generate an undefined error with a message warning the user.\n *\n * @return {Error}\n */\n\nexports.undefinedError = function() {\n  return new Error('Caught undefined error, did you throw without specifying what?');\n};\n\n/**\n * Generate an undefined error if `err` is not defined.\n *\n * @param {Error} err\n * @return {Error}\n */\n\nexports.getError = function(err) {\n  return err || exports.undefinedError();\n};\n\n\n}); // module: utils.js\n// The global object is \"self\" in Web Workers.\nvar global = (function() { return this; })();\n\n/**\n * Save timer references to avoid Sinon interfering (see GH-237).\n */\n\nvar Date = global.Date;\nvar setTimeout = global.setTimeout;\nvar setInterval = global.setInterval;\nvar clearTimeout = global.clearTimeout;\nvar clearInterval = global.clearInterval;\n\n/**\n * Node shims.\n *\n * These are meant only to allow\n * mocha.js to run untouched, not\n * to allow running node code in\n * the browser.\n */\n\nvar process = {};\nprocess.exit = function(status){};\nprocess.stdout = {};\n\nvar uncaughtExceptionHandlers = [];\n\nvar originalOnerrorHandler = global.onerror;\n\n/**\n * Remove uncaughtException listener.\n * Revert to original onerror handler if previously defined.\n */\n\nprocess.removeListener = function(e, fn){\n  if ('uncaughtException' == e) {\n    if (originalOnerrorHandler) {\n      global.onerror = originalOnerrorHandler;\n    } else {\n      global.onerror = function() {};\n    }\n    var i = Mocha.utils.indexOf(uncaughtExceptionHandlers, fn);\n    if (i != -1) { uncaughtExceptionHandlers.splice(i, 1); }\n  }\n};\n\n/**\n * Implements uncaughtException listener.\n */\n\nprocess.on = function(e, fn){\n  if ('uncaughtException' == e) {\n    global.onerror = function(err, url, line){\n      fn(new Error(err + ' (' + url + ':' + line + ')'));\n      return true;\n    };\n    uncaughtExceptionHandlers.push(fn);\n  }\n};\n\n/**\n * Expose mocha.\n */\n\nvar Mocha = global.Mocha = require('mocha'),\n    mocha = global.mocha = new Mocha({ reporter: 'html' });\n\n// The BDD UI is registered by default, but no UI will be functional in the\n// browser without an explicit call to the overridden `mocha.ui` (see below).\n// Ensure that this default UI does not expose its methods to the global scope.\nmocha.suite.removeAllListeners('pre-require');\n\nvar immediateQueue = []\n  , immediateTimeout;\n\nfunction timeslice() {\n  var immediateStart = new Date().getTime();\n  while (immediateQueue.length && (new Date().getTime() - immediateStart) < 100) {\n    immediateQueue.shift()();\n  }\n  if (immediateQueue.length) {\n    immediateTimeout = setTimeout(timeslice, 0);\n  } else {\n    immediateTimeout = null;\n  }\n}\n\n/**\n * High-performance override of Runner.immediately.\n */\n\nMocha.Runner.immediately = function(callback) {\n  immediateQueue.push(callback);\n  if (!immediateTimeout) {\n    immediateTimeout = setTimeout(timeslice, 0);\n  }\n};\n\n/**\n * Function to allow assertion libraries to throw errors directly into mocha.\n * This is useful when running tests in a browser because window.onerror will\n * only receive the 'message' attribute of the Error.\n */\nmocha.throwError = function(err) {\n  Mocha.utils.forEach(uncaughtExceptionHandlers, function (fn) {\n    fn(err);\n  });\n  throw err;\n};\n\n/**\n * Override ui to ensure that the ui functions are initialized.\n * Normally this would happen in Mocha.prototype.loadFiles.\n */\n\nmocha.ui = function(ui){\n  Mocha.prototype.ui.call(this, ui);\n  this.suite.emit('pre-require', global, null, this);\n  return this;\n};\n\n/**\n * Setup mocha with the given setting options.\n */\n\nmocha.setup = function(opts){\n  if ('string' == typeof opts) opts = { ui: opts };\n  for (var opt in opts) this[opt](opts[opt]);\n  return this;\n};\n\n/**\n * Run mocha, returning the Runner.\n */\n\nmocha.run = function(fn){\n  var options = mocha.options;\n  mocha.globals('location');\n\n  var query = Mocha.utils.parseQuery(global.location.search || '');\n  if (query.grep) mocha.grep(new RegExp(query.grep));\n  if (query.fgrep) mocha.grep(query.fgrep);\n  if (query.invert) mocha.invert();\n\n  return Mocha.prototype.run.call(mocha, function(err){\n    // The DOM Document is not available in Web Workers.\n    var document = global.document;\n    if (document && document.getElementById('mocha') && options.noHighlighting !== true) {\n      Mocha.utils.highlightTags('code');\n    }\n    if (fn) fn(err);\n  });\n};\n\n/**\n * Expose the process shim.\n */\n\nMocha.process = process;\n})();\n"
},function(t){!function(e){"use strict";t.exports=e}(function(t,e){"use strict";function n(t){return"function"==typeof t&&"function"==typeof t.getCall&&"function"==typeof t.calledWithExactly}function r(t){return 1===t?"once":2===t?"twice":3===t?"thrice":(t||0)+" times"}function i(t){return t&&n(t.proxy)}function o(t){if(!n(t._obj)&&!i(t._obj))throw new TypeError(e.inspect(t._obj)+" is not a spy or a call to a spy!")}function a(t,e,r,i,o){function a(e){return t.printf.apply(t,e)}var s=i?"always have ":"have ";return r=r||"",n(t.proxy)&&(t=t.proxy),{affirmative:function(){return a(["expected %n to "+s+e+r].concat(o))},negative:function(){return a(["expected %n to not "+s+e].concat(o))}}}function s(n,r,i){e.addProperty(t.Assertion.prototype,n,function(){o(this);var t=a(this._obj,r,i,!1);this.assert(this._obj[n],t.affirmative,t.negative)})}function u(n,i,s){e.addMethod(t.Assertion.prototype,n,function(t){o(this);var e=a(this._obj,i,s,!1,[r(t)]);this.assert(this._obj[n]===t,e.affirmative,e.negative)})}function c(t,n,r){return function(){o(this);var i="always"+t[0].toUpperCase()+t.substring(1),s=e.flag(this,"always")&&"function"==typeof this._obj[i],u=s?i:t,c=a(this._obj,n,r,s,p.call(arguments));this.assert(this._obj[u].apply(this._obj,arguments),c.affirmative,c.negative)}}function l(n,r,i){var o=c(n,r,i);e.addProperty(t.Assertion.prototype,n,o)}function f(n,r,i,o){var a=c(r,i,o);e.addMethod(t.Assertion.prototype,n,a)}function h(t,e,n){f(t,t,e,n)}var p=Array.prototype.slice;e.addProperty(t.Assertion.prototype,"always",function(){e.flag(this,"always",!0)}),s("called","been called"," at least once, but it was never called"),u("callCount","been called exactly %1",", but it was called %c%C"),s("calledOnce","been called exactly once",", but it was called %c%C"),s("calledTwice","been called exactly twice",", but it was called %c%C"),s("calledThrice","been called exactly thrice",", but it was called %c%C"),l("calledWithNew","been called with new"),h("calledBefore","been called before %1"),h("calledAfter","been called after %1"),h("calledOn","been called with %1 as this",", but it was called with %t instead"),h("calledWith","been called with arguments %*","%C"),h("calledWithExactly","been called with exact arguments %*","%C"),h("calledWithMatch","been called with arguments matching %*","%C"),h("returned","returned %1"),f("thrown","threw","thrown %1")})},function(t,e,n){"use strict";e.spy=n(316),e.stub=n(317),e.spyCall=n(315),e.mock=n(383),e.expectation=n(382),e.collection=n(380),e.sandbox=n(384),e.createStubInstance=n(566),e.match=n(160);var r=n(303);e.match.equal=r;var i=n(567);e.log=i.log,e.logError=i.logError,e.restore=n(568),e.format=n(304),e.assert=n(564),e.test=n(385),e.testCase=n(569);var o=n(130);e.wrapMethod=n(319),e.deepEqual=n(303),e.extend=n(146),e.functionToString=o.toString,e.create=o.create;var a=n(381);e.getConfig=a.getConfig,e.defaultConfig=a.defaultConfig,e.timesInWords=n(318),e.typeOf=n(386)},function(t,e,n){(function(e){"use strict";function r(t){for(var e=1,n=t.length;n>e;e++)if(!t[e-1].calledBefore(t[e])||!t[e].called)return!1;return!0}function i(t){return t.sort(function(t,e){var n=t.getCall(0),r=e.getCall(0),i=n&&n.callId||-1,o=r&&r.callId||-1;return o>i?-1:1})}function o(){for(var t,e=0,n=arguments.length;n>e;++e)t=arguments[e],t||c.fail("fake is not a spy"),"function"!=typeof t&&c.fail(t+" is not a function"),"function"!=typeof t.getCall&&c.fail(t+" is not stubbed")}function a(t,e){t=t||d;var n=t.fail||c.fail;n.call(t,e)}function s(t,e,n){2==arguments.length&&(n=e,e=t),c[t]=function(r){o(r);var i=p.call(arguments,1),s=!1;s="function"==typeof e?!e(r):"function"==typeof r[e]?!r[e].apply(r,i):!r[e],s?a(this,r.printf.apply(r,[n].concat(i))):c.pass(t)}}function u(t,e){return!t||/^fail/.test(e)?e:t+e.slice(0,1).toUpperCase()+e.slice(1)}var c,l=n(318),f=n(160),h=n(304),p=Array.prototype.slice,d="undefined"==typeof e?window:e;c={failException:"AssertError",fail:function(t){var e=new Error(t);throw e.name=this.failException||c.failException,e},pass:function(){},callOrder:function(){o.apply(null,arguments);var t="",e="";if(r(arguments))c.pass("callOrder");else{try{t=[].join.call(arguments,", ");for(var n=p.call(arguments),s=n.length;s;)n[--s].called||n.splice(s,1);e=i(n).join(", ")}catch(u){}a(this,"expected "+t+" to be called in order but were called as "+e)}},callCount:function(t,e){if(o(t),t.callCount!=e){var n="expected %n to be called "+l(e)+" but was called %c%C";a(this,t.printf(n))}else c.pass("callCount")},expose:function(t,e){if(!t)throw new TypeError("target is null or undefined");var n=e||{},r="undefined"==typeof n.prefix&&"assert"||n.prefix,i="undefined"==typeof n.includeFail||!!n.includeFail;for(var o in this)"expose"==o||!i&&/^(fail)/.test(o)||(t[u(r,o)]=this[o]);return t},match:function(t,e){var n=f(e);if(n.test(t))c.pass("match");else{var r=["expected value to match","    expected = "+h(e),"    actual = "+h(t)];a(this,r.join("\n"))}}},s("called","expected %n to have been called at least once but was never called"),s("notCalled",function(t){return!t.called},"expected %n to not have been called but was called %c%C"),s("calledOnce","expected %n to be called once but was called %c%C"),s("calledTwice","expected %n to be called twice but was called %c%C"),s("calledThrice","expected %n to be called thrice but was called %c%C"),s("calledOn","expected %n to be called with %1 as this but was called with %t"),s("alwaysCalledOn","expected %n to always be called with %1 as this but was called with %t"),s("calledWithNew","expected %n to be called with new"),s("alwaysCalledWithNew","expected %n to always be called with new"),s("calledWith","expected %n to be called with arguments %*%C"),s("calledWithMatch","expected %n to be called with match %*%C"),s("alwaysCalledWith","expected %n to always be called with arguments %*%C"),s("alwaysCalledWithMatch","expected %n to always be called with match %*%C"),s("calledWithExactly","expected %n to be called with exact arguments %*%C"),s("alwaysCalledWithExactly","expected %n to always be called with exact arguments %*%C"),s("neverCalledWith","expected %n to never be called with arguments %*%C"),s("neverCalledWithMatch","expected %n to never be called with match %*%C"),s("threw","%n did not throw exception%C"),s("alwaysThrew","%n did not always throw exception%C"),t.exports=c}).call(e,function(){return this}())},function(t,e,n){(function(e,r){"use strict";function i(t,e){return"string"==typeof t?(this.exception=new Error(e||""),this.exception.name=t):this.exception=t?t:new Error("Error"),this}function o(t,e){var n=t.callArgAt;if(0>n){for(var r=t.callArgProp,i=0,o=e.length;o>i;++i){if(!r&&"function"==typeof e[i])return e[i];if(r&&e[i]&&"function"==typeof e[i][r])return e[i][r]}return null}return e[n]}function a(t,e,n){if(t.callArgAt<0){var r;return r=t.callArgProp?u.getName(t.stub)+" expected to yield to '"+t.callArgProp+"', but no object with such a property was passed.":u.getName(t.stub)+" expected to yield, but no callback was passed.",n.length>0&&(r+=" Received ["+f.call(n,", ")+"]"),r}return"argument at index "+t.callArgAt+" is not a function: "+e}function s(t,e){if("number"==typeof t.callArgAt){var n=o(t,e);if("function"!=typeof n)throw new TypeError(a(t,n,e));t.callbackAsync?h(function(){n.apply(t.callbackContext,t.callbackArguments)}):n.apply(t.callbackContext,t.callbackArguments)}}var u=n(130),c=n(146),l=Array.prototype.slice,f=Array.prototype.join,h=function(){return"object"==typeof e&&"function"==typeof e.nextTick?e.nextTick:"function"==typeof r?r:function(t){setTimeout(t,0)}}(),p={create:function(t){var e=c({},p);return delete e.create,e.stub=t,e},isPresent:function(){return"number"==typeof this.callArgAt||this.exception||"number"==typeof this.returnArgAt||this.returnThis||this.returnValueDefined},invoke:function(t,e){if(s(this,e),this.exception)throw this.exception;return"number"==typeof this.returnArgAt?e[this.returnArgAt]:this.returnThis?t:this.returnValue},onCall:function(t){return this.stub.onCall(t)},onFirstCall:function(){return this.stub.onFirstCall()},onSecondCall:function(){return this.stub.onSecondCall()},onThirdCall:function(){return this.stub.onThirdCall()},withArgs:function(){throw new Error('Defining a stub by invoking "stub.onCall(...).withArgs(...)" is not supported. Use "stub.withArgs(...).onCall(...)" to define sequential behavior for calls with certain arguments.')},callsArg:function(t){if("number"!=typeof t)throw new TypeError("argument index is not number");return this.callArgAt=t,this.callbackArguments=[],this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOn:function(t,e){if("number"!=typeof t)throw new TypeError("argument index is not number");if("object"!=typeof e)throw new TypeError("argument context is not an object");return this.callArgAt=t,this.callbackArguments=[],this.callbackContext=e,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgWith:function(t){if("number"!=typeof t)throw new TypeError("argument index is not number");return this.callArgAt=t,this.callbackArguments=l.call(arguments,1),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOnWith:function(t,e){if("number"!=typeof t)throw new TypeError("argument index is not number");if("object"!=typeof e)throw new TypeError("argument context is not an object");return this.callArgAt=t,this.callbackArguments=l.call(arguments,2),this.callbackContext=e,this.callArgProp=void 0,this.callbackAsync=!1,this},yields:function(){return this.callArgAt=-1,this.callbackArguments=l.call(arguments,0),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsOn:function(t){if("object"!=typeof t)throw new TypeError("argument context is not an object");return this.callArgAt=-1,this.callbackArguments=l.call(arguments,1),this.callbackContext=t,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsTo:function(t){return this.callArgAt=-1,this.callbackArguments=l.call(arguments,1),this.callbackContext=void 0,this.callArgProp=t,this.callbackAsync=!1,this},yieldsToOn:function(t,e){if("object"!=typeof e)throw new TypeError("argument context is not an object");return this.callArgAt=-1,this.callbackArguments=l.call(arguments,2),this.callbackContext=e,this.callArgProp=t,this.callbackAsync=!1,this},"throws":i,throwsException:i,returns:function(t){return this.returnValue=t,this.returnValueDefined=!0,this},returnsArg:function(t){if("number"!=typeof t)throw new TypeError("argument index is not number");return this.returnArgAt=t,this},returnsThis:function(){return this.returnThis=!0,this}};for(var d in p)p.hasOwnProperty(d)&&d.match(/^(callsArg|yields)/)&&!d.match(/Async/)&&(p[d+"Async"]=function(t){return function(){var e=this[t].apply(this,arguments);return this.callbackAsync=!0,e}}(d));t.exports=p}).call(e,n(1),n(307).setImmediate)},function(t,e,n){"use strict";var r=n(130),i=n(317);t.exports=function(t){if("function"!=typeof t)throw new TypeError("The constructor should be a function.");return i(r.create(t.prototype))}},function(t,e){"use strict";function n(){}function r(t,e){var i=t+" threw exception: ";n(i+"["+e.name+"] "+e.message),e.stack&&n(e.stack),r.setTimeout(function(){throw e.message=i+e.message,e},0)}var i=setTimeout;r.setTimeout=function(t,e){i(t,e)},e.log=n,e.logError=r},function(t){"use strict";function e(t){return"function"==typeof t&&"function"==typeof t.restore&&t.restore.sinon}t.exports=function(t){if(null!==t&&"object"==typeof t)for(var n in t)e(t[n])&&t[n].restore();else e(t)&&t.restore()}},function(t,e,n){"use strict";function r(t,e,n){return function(){e&&e.apply(this,arguments);var r,i;try{i=t.apply(this,arguments)}catch(o){r=o}if(n&&n.apply(this,arguments),r)throw r;return i}}function i(t,e){if(!t||"object"!=typeof t)throw new TypeError("sinon.testCase needs an object with test functions");e=e||"test";var n,i,a,s=new RegExp("^"+e),u={},c=t.setUp,l=t.tearDown;for(n in t)if(t.hasOwnProperty(n)){if(i=t[n],/^(setUp|tearDown)$/.test(n))continue;"function"==typeof i&&s.test(n)?(a=i,(c||l)&&(a=r(i,c,l)),u[n]=o(a)):u[n]=t[n]}return u}var o=n(385);t.exports=i},function(t,e,n){"use strict";var r=n(572);t.exports=function(){var t,e=Array.prototype.slice.call(arguments);t="string"==typeof e[0]?0:e.shift();var n=r.install(t||0,e);return n.restore=n.uninstall,n}},function(t,e,n){var r,i,o;(function(a){(!0&&n(321)&&function(a){i=[n(387)],r=a,o="function"==typeof r?r.apply(e,i):r,!(void 0!==o&&(t.exports=o))}||"object"==typeof t&&function(e){t.exports=e(n(387))}||function(t){this.formatio=t(this.samsam)})(function(t){"use strict";function e(t){if(!t)return"";if(t.displayName)return t.displayName;if(t.name)return t.name;var e=t.toString().match(/function\s+([^\(]+)/m);return e&&e[1]||""}function n(t,n){var r,i,o=e(n&&n.constructor),a=t.excludeConstructors||s.excludeConstructors||[];for(r=0,i=a.length;i>r;++r){if("string"==typeof a[r]&&a[r]===o)return"";if(a[r].test&&a[r].test(o))return""}return o}function r(t,e){if("object"!=typeof t)return!1;var n,r;for(n=0,r=e.length;r>n;++n)if(e[n]===t)return!0;return!1}function i(e,n,o,a){if("string"==typeof n){if(0===n.length)return"(empty string)";var s=e.quoteStrings,c="boolean"!=typeof s||s;return o||c?'"'+n+'"':n}if("function"==typeof n&&!(n instanceof RegExp))return i.func(n);if(o=o||[],r(n,o))return"[Circular]";if("[object Array]"===Object.prototype.toString.call(n))return i.array.call(e,n,o);if(!n)return String(1/n===-1/0?"-0":n);if(t.isElement(n))return i.element(n);if("function"==typeof n.toString&&n.toString!==Object.prototype.toString)return n.toString();var l,f;for(l=0,f=u.length;f>l;l++)if(n===u[l].object)return u[l].value;return i.object.call(e,n,o,a)}function o(t){for(var e in t)this[e]=t[e]}var s={excludeConstructors:["Object",/^.$/],quoteStrings:!0,limitChildrenCount:0},u=(Object.prototype.hasOwnProperty,[]);return"undefined"!=typeof a&&u.push({object:a,value:"[object global]"}),"undefined"!=typeof document&&u.push({object:document,value:"[object HTMLDocument]"}),"undefined"!=typeof window&&u.push({object:window,value:"[object Window]"}),i.func=function(t){return"function "+e(t)+"() {}"},i.array=function(t,e){e=e||[],e.push(t);var n,r,o=[];for(r=this.limitChildrenCount>0?Math.min(this.limitChildrenCount,t.length):t.length,n=0;r>n;++n)o.push(i(this,t[n],e));return r<t.length&&o.push("[... "+(t.length-r)+" more elements]"),"["+o.join(", ")+"]"},i.object=function(e,o,a){o=o||[],o.push(e),a=a||0;var s,u,c,l,f,h,p=[],d=t.keys(e).sort(),m=3;for(h=this.limitChildrenCount>0?Math.min(this.limitChildrenCount,d.length):d.length,l=0;h>l;++l)s=d[l],c=e[s],u=r(c,o)?"[Circular]":i(this,c,o,a+2),u=(/\s/.test(s)?'"'+s+'"':s)+": "+u,m+=u.length,p.push(u);var v=n(this,e),g=v?"["+v+"] ":"",y="";for(l=0,f=a;f>l;++l)y+=" ";return h<d.length&&p.push("[... "+(d.length-h)+" more elements]"),m+a>80?g+"{\n  "+y+p.join(",\n  "+y)+"\n"+y+"}":g+"{ "+p.join(", ")+" }"},i.element=function(t){var e,n,r,i,o,a=t.tagName.toLowerCase(),s=t.attributes,u=[];for(r=0,i=s.length;i>r;++r)e=s.item(r),n=e.nodeName.toLowerCase().replace("html:",""),o=e.nodeValue,("contenteditable"!==n||"inherit"!==o)&&o&&u.push(n+'="'+o+'"');var c="<"+a+(u.length>0?" ":""),l=t.innerHTML||"";l.length>20&&(l=l.substr(0,20)+"[...]");var f=c+u.join(" ")+">"+l+"</"+a+">";return f.replace(/ contentEditable="inherit"/,"")},o.prototype={functionName:e,configure:function(t){return new o(t)},constructorName:function(t){return n(this,t)},ascii:function(t,e,n){return i(this,t,e,n)}},o.prototype})}).call(e,function(){return this}())},function(module,exports,__webpack_require__){(function(setImmediate,clearImmediate,global){/**
	 * @author Christian Johansen (christian@cjohansen.no) and contributors
	 * @license BSD
	 *
	 * Copyright (c) 2010-2014 Christian Johansen
	 */
"use strict";function parseTime(t){if(!t)return 0;var e,n=t.split(":"),r=n.length,i=r,o=0;if(r>3||!/^(\d\d:){0,2}\d\d?$/.test(t))throw new Error("tick only understands numbers and 'h:m:s'");for(;i--;){if(e=parseInt(n[i],10),e>=60)throw new Error("Invalid time "+t);o+=e*Math.pow(60,r-i-1)}return 1e3*o}function getEpoch(t){if(!t)return 0;if("function"==typeof t.getTime)return t.getTime();if("number"==typeof t)return t;throw new TypeError("now should be milliseconds since UNIX epoch")}function inRange(t,e,n){return n&&n.callAt>=t&&n.callAt<=e}function mirrorDateProperties(t,e){e.now?t.now=function(){return t.clock.now}:delete t.now,e.toSource?t.toSource=function(){return e.toSource()}:delete t.toSource,t.toString=function(){return e.toString()},t.prototype=e.prototype,t.parse=e.parse,t.UTC=e.UTC,t.prototype.toUTCString=e.prototype.toUTCString;for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function createDate(){function t(e,n,r,i,o,a,s){switch(arguments.length){case 0:return new NativeDate(t.clock.now);case 1:return new NativeDate(e);case 2:return new NativeDate(e,n);case 3:return new NativeDate(e,n,r);case 4:return new NativeDate(e,n,r,i);case 5:return new NativeDate(e,n,r,i,o);case 6:return new NativeDate(e,n,r,i,o,a);default:return new NativeDate(e,n,r,i,o,a,s)}}return mirrorDateProperties(t,NativeDate)}function addTimer(t,e){if("undefined"==typeof e.func)throw new Error("Callback must be provided to timer calls");return t.timers||(t.timers={}),e.id=id++,e.createdAt=t.now,e.callAt=t.now+(e.delay||0),t.timers[e.id]=e,addTimerReturnsObject?{id:e.id,ref:function(){},unref:function(){}}:e.id}function firstTimerInRange(t,e,n){var r=t.timers,i=null;for(var o in r)inRange(e,n,r[o])&&(!i||~compareTimers(i,r[o]))&&(i=r[o]);return i}function compareTimers(t,e){return t.callAt<e.callAt?-1:t.callAt>e.callAt?1:t.immediate&&!e.immediate?-1:!t.immediate&&e.immediate?1:t.createdAt<e.createdAt?-1:t.createdAt>e.createdAt?1:t.id<e.id?-1:t.id>e.id?1:void 0}function callTimer(clock,timer){"number"==typeof timer.interval?clock.timers[timer.id].callAt+=timer.interval:delete clock.timers[timer.id];try{"function"==typeof timer.func?timer.func.apply(null,timer.args):eval(timer.func)}catch(e){var exception=e}if(clock.timers[timer.id]){if(exception)throw exception}else if(exception)throw exception}function uninstall(t,e){for(var n,r=0,i=t.methods.length;i>r;r++)if(n=t.methods[r],e[n].hadOwnProperty)e[n]=t["_"+n];else try{delete e[n]}catch(o){}t.methods=[]}function hijackMethod(t,e,n){if(n[e].hadOwnProperty=Object.prototype.hasOwnProperty.call(t,e),n["_"+e]=t[e],"Date"==e){var r=mirrorDateProperties(n[e],t[e]);t[e]=r}else{t[e]=function(){return n[e].apply(n,arguments)};for(var i in n[e])n[e].hasOwnProperty(i)&&(t[e][i]=n[e][i])}t[e].clock=n}var timeoutResult=setTimeout(function(){},0),addTimerReturnsObject="object"==typeof timeoutResult;clearTimeout(timeoutResult);var NativeDate=Date,id=1,timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:"undefined"!=typeof setImmediate?setImmediate:void 0,clearImmediate:"undefined"!=typeof clearImmediate?clearImmediate:void 0,setInterval:setInterval,clearInterval:clearInterval,Date:Date},keys=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};exports.timers=timers;var createClock=exports.createClock=function(t){var e={now:getEpoch(t),timeouts:{},Date:createDate()};return e.Date.clock=e,e.setTimeout=function(t,n){return addTimer(e,{func:t,args:Array.prototype.slice.call(arguments,2),delay:n})},e.clearTimeout=function(t){t&&(e.timers||(e.timers=[]),"object"==typeof t&&(t=t.id),t in e.timers&&delete e.timers[t])},e.setInterval=function(t,n){return addTimer(e,{func:t,args:Array.prototype.slice.call(arguments,2),delay:n,interval:n})},e.clearInterval=function(t){e.clearTimeout(t)},e.setImmediate=function(t){return addTimer(e,{func:t,args:Array.prototype.slice.call(arguments,1),immediate:!0})},e.clearImmediate=function(t){e.clearTimeout(t)},e.tick=function(t){t="number"==typeof t?t:parseTime(t);for(var n,r=e.now,i=e.now+t,o=e.now,a=firstTimerInRange(e,r,i);a&&i>=r;){if(e.timers[a.id]){r=e.now=a.callAt;try{callTimer(e,a)}catch(s){n=n||s}}a=firstTimerInRange(e,o,i),o=r}if(e.now=i,n)throw n;return e.now},e.reset=function(){e.timers={}},e};exports.install=function(t,e,n){"number"==typeof t&&(n=e,e=t,t=null),t||(t=global);var r=createClock(e);r.uninstall=function(){uninstall(r,t)},r.methods=n||[],0===r.methods.length&&(r.methods=keys(timers));for(var i=0,o=r.methods.length;o>i;i++)hijackMethod(t,r.methods[i],r);return r}}).call(exports,__webpack_require__(307).setImmediate,__webpack_require__(307).clearImmediate,function(){return this}())},function(t,e,n){var r=n(469);"string"==typeof r&&(r=[[t.id,r,""]]);n(11)(r,{})},,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(489);"string"==typeof r&&(r=[[t.id,r,""]]);n(11)(r,{})},function(t,e,n){var r=n(573);"string"==typeof r&&(r=[[t.id,r,""]]);n(11)(r,{})},,function(t,e,n){var r=n(593);"string"==typeof r&&(r=[[t.id,r,""]]);n(11)(r,{})},,,function(t,e,n){n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420)},function(t,e,n){"use strict";function r(t){s.call(this,t,{name:"AnalyserNode",numberOfInputs:1,numberOfOutputs:1,channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers"});var e=2048,n=function(){return this.fftSize>>1},r=-100,o=30,a=.8;i.defineAttribute(this,"fftSize",u,e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"frequencyBinCount","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"minDecibels","number",r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"maxDecibels","number",o,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"smoothingTimeConstant","number",a,function(t){throw new TypeError(i.formatter.concat(this,t))})}var i=n(16),o=n(61),a=n(13),s=n(43),u="enum { 32, 64, 128, 256, 512, 1024, 2048 }",c=function(){throw new TypeError("Illegal constructor: use audioContext.createAnalyser()")};i.inherits(c,s),i.inherits(r,c),r.exports=c,r.jsonAttrs=["fftSize","minDecibels","maxDecibels","smoothingTimeConstant"],c.prototype.getFloatFrequencyData=function(){var t=new o(this,"getFloatFrequencyData",[{name:"array",type:"Float32Array"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},c.prototype.getByteFrequencyData=function(){var t=new o(this,"getByteFrequencyData",[{name:"array",type:"Uint8Array"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},c.prototype.getByteTimeDomainData=function(){var t=new o(this,"getByteTimeDomainData",[{name:"array",type:"Uint8Array"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},t.exports=a.AnalyserNode=r},function(t,e,n){"use strict";function r(t){s.call(this,t,{name:"AudioBufferSourceNode",numberOfInputs:0,numberOfOutputs:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"});var e=null,n=new u(this,"playbackRate",1,0,1024),r=!1,o=0,a=0,c=null;i.defineAttribute(this,"buffer","AudioBuffer|null",e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"playbackRate","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"loop","boolean",r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"loopStart","number",o,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"loopEnd","number",a,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"onended","function|null",c,function(t){throw new TypeError(i.formatter.concat(this,t))}),Object.defineProperties(this,{$state:{get:function(){return this.$stateAtTime(this.context.currentTime)}}}),this._startTime=1/0,this._stopTime=1/0,this._firedOnEnded=!1}var i=n(16),o=n(61),a=n(13),s=n(43),u=n(147),c=n(320),l=function(){throw new TypeError("Illegal constructor: use audioContext.createBufferSource()")};i.inherits(l,s),i.inherits(r,l),r.exports=l,r.jsonAttrs=["buffer","playbackRate","loop","loopStart","loopEnd"],l.prototype.start=function(t){var e=new o(this,"start",[{name:"when",type:"optional number"},{name:"offset",type:"optional number"},{name:"duration",type:"optional number"}]);e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),e.assert(1/0===this._startTime,function(){throw new Error(e.form+"; cannot start more than once")}),this._startTime=i.defaults(t,0)},l.prototype.stop=function(t){var e=new o(this,"stop",[{name:"when",type:"optional number"}]);e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),e.assert(1/0!==this._startTime,function(){throw new Error(e.form+"; cannot call stop without calling start first")}),e.assert(1/0===this._stopTime,function(){throw new Error(e.form+"; cannot stop more than once")}),this._stopTime=t},r.prototype.$stateAtTime=function(t){if(t=i.toSeconds(t),1/0===this._startTime)return"UNSCHEDULED";if(t<this._startTime)return"SCHEDULED";var e=this._stopTime;return!this.loop&&this.buffer&&(e=Math.min(e,this._startTime+this.buffer.duration)),e>t?"PLAYING":"FINISHED"},r.prototype._process=function(){this._firedOnEnded||"FINISHED"!==this.$stateAtTime(this.context.currentTime)||(this.dispatchEvent(new c("ended",this)),this._firedOnEnded=!0)},t.exports=a.AudioBufferSourceNode=r},function(t,e,n){"use strict";function r(t){a.call(this,"audioprocess",t),Object.defineProperties(this,{$name:{value:"AudioProcessingEvent"},$node:{value:t}})}var i=n(16),o=n(13),a=n(320),s=function(){throw new TypeError("Illegal constructor")};i.inherits(s,a),i.inherits(r,s),r.exports=s,t.exports=o.AudioProcessingEvent=r},function(t,e,n){"use strict";function r(t){s.call(this,t,{name:"BiquadFilterNode",numberOfInputs:1,numberOfOutputs:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"});var e="lowpass",n=new u(this,"frequency",350,10,t.sampleRate/2),r=new u(this,"detune",0,-4800,4800),o=new u(this,"Q",1,1e-4,1e3),a=new u(this,"gain",0,-40,40);i.defineAttribute(this,"type",c,e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"frequency","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"detune","readonly",r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"Q","readonly",o,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"gain","readonly",a,function(t){throw new TypeError(i.formatter.concat(this,t))})}var i=n(16),o=n(61),a=n(13),s=n(43),u=n(147),c="enum { lowpass, highpass, bandpass, lowshelf, highshelf, peaking, notch, allpass }",l=function(){throw new TypeError("Illegal constructor: use audioContext.createBiquadFilter()")};i.inherits(l,s),i.inherits(r,l),r.exports=l,r.jsonAttrs=["type","frequency","detune","Q","gain"],l.prototype.getFrequencyResponse=function(){var t=new o(this,"getFrequencyResponse",[{name:"frequencyHz",type:"Float32Array"},{name:"magResponse",type:"Float32Array"},{name:"phaseResponse",type:"Float32Array"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},t.exports=a.BiquadFilterNode=r},function(t,e,n){"use strict";function r(t,e){a.call(this,t,{name:"ChannelMergerNode",numberOfInputs:e,numberOfOutputs:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"})}var i=n(16),o=n(13),a=n(43),s=function(){throw new TypeError("Illegal constructor: use audioContext.createChannelMerger([numberOfInputs: number])")};i.inherits(s,a),i.inherits(r,s),r.exports=s,t.exports=o.ChannelMergerNode=r},function(t,e,n){"use strict";function r(t,e){a.call(this,t,{name:"ChannelSplitterNode",numberOfInputs:1,numberOfOutputs:e,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"})}var i=n(16),o=n(13),a=n(43),s=function(){throw new TypeError("Illegal constructor: use audioContext.createChannelSplitter([numberOfOutputs: number])")};i.inherits(s,a),i.inherits(r,s),r.exports=s,t.exports=o.ChannelSplitterNode=r},function(t,e,n){"use strict";function r(t){a.call(this,t,{name:"ConvolverNode",numberOfInputs:1,numberOfOutputs:1,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers"});var e=null,n=!0;i.defineAttribute(this,"buffer","AudioBuffer|null",e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"normalize","boolean",n,function(t){throw new TypeError(i.formatter.concat(this,t))})}var i=n(16),o=n(13),a=n(43),s=function(){throw new TypeError("Illegal constructor: use audioContext.createConvolver()")};i.inherits(s,a),i.inherits(r,s),r.exports=s,r.jsonAttrs=["normalize"],t.exports=o.ConvolverNode=r},function(t,e,n){"use strict";function r(t,e){a.call(this,t,{name:"DelayNode",numberOfInputs:1,numberOfOutputs:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"});var n=new s(this,"delayTime",0,0,e);i.defineAttribute(this,"delayTime","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),Object.defineProperties(this,{$maxDelayTime:{value:e}})}var i=n(16),o=n(13),a=n(43),s=n(147),u=function(){throw new TypeError("Illegal constructor: use audioContext.createDelay([maxDelayTime: number])")};i.inherits(u,a),i.inherits(r,u),r.exports=u,r.jsonAttrs=["delayTime"],t.exports=o.DelayNode=r},function(t,e,n){"use strict";function r(t){a.call(this,t,{name:"DynamicsCompressorNode",numberOfInputs:1,numberOfOutputs:1,channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"});var e=new s(this,"threshold",-24,-100,0),n=new s(this,"knee",30,0,40),r=new s(this,"ratio",12,1,20),o=new s(this,"reduction",0,-20,0),u=new s(this,"attack",.003,0,1),c=new s(this,"release",.25,0,1);i.defineAttribute(this,"threshold","readonly",e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"knee","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"ratio","readonly",r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"reduction","readonly",o,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"attack","readonly",u,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"release","readonly",c,function(t){throw new TypeError(i.formatter.concat(this,t))})}var i=n(16),o=n(13),a=n(43),s=n(147),u=function(){throw new TypeError("Illegal constructor: use audioContext.createDynamicsCompressor()")};i.inherits(u,a),i.inherits(r,u),r.exports=u,r.jsonAttrs=["threshold","knee","ratio","reduction","attack","release"],t.exports=o.DynamicsCompressorNode=r},function(t,e,n){(function(e){"use strict";function r(){}var i=n(16),o=n(13),a=n(306);"undefined"==typeof e.Element&&(e.Element=function(){throw new TypeError("Illegal constructor")},i.inherits(e.Element,a)),i.inherits(r,e.Element),t.exports=o.Element=r}).call(e,function(){return this}())},function(t,e,n){"use strict";function r(t){a.call(this,t,{name:"GainNode",numberOfInputs:1,numberOfOutputs:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"});var e=new s(this,"gain",1,0,1);i.defineAttribute(this,"gain","readonly",e,function(t){throw new TypeError(i.formatter.concat(this,t))})}var i=n(16),o=n(13),a=n(43),s=n(147),u=function(){throw new TypeError("Illegal constructor: use audioContext.createGain()")};i.inherits(u,a),i.inherits(r,u),r.exports=u,r.jsonAttrs=["gain"],t.exports=o.GainNode=r},function(t,e,n){(function(e){"use strict";function r(){}var i=n(16),o=n(13),a=n(609);"undefined"==typeof e.HTMLElement&&(e.HTMLElement=function(){throw new TypeError("Illegal constructor")},i.inherits(e.HTMLElement,a)),i.inherits(r,e.HTMLElement),t.exports=o.HTMLElement=r}).call(e,function(){return this}())},function(t,e,n){(function(e){"use strict";function r(){}var i=n(16),o=n(13),a=n(611);"undefined"==typeof e.HTMLMediaElement&&(e.HTMLMediaElement=function(){throw new TypeError("Illegal constructor")},i.inherits(e.HTMLMediaElement,a)),i.inherits(r,e.HTMLMediaElement),t.exports=o.HTMLMediaElement=r}).call(e,function(){return this}())},function(t,e,n){"use strict";function r(t){a.call(this,t,{name:"MediaElementAudioSourceNode",numberOfInputs:0,numberOfOutputs:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"})}var i=n(16),o=n(13),a=n(43),s=function(){throw new TypeError("Illegal constructor: use audioContext.createMediaElementSource(mediaElement: HTMLMediaElement)")};i.inherits(s,a),i.inherits(r,s),r.exports=s,t.exports=o.MediaElementAudioSourceNode=r},function(t,e,n){(function(e){"use strict";function r(){}var i=n(16),o=n(13),a=n(306);"undefined"==typeof e.MediaStream&&(e.MediaStream=function(){throw new TypeError("Illegal constructor")},i.inherits(e.MediaStream,a)),i.inherits(r,e.MediaStream),t.exports=o.MediaStream=r}).call(e,function(){return this}())},function(t,e,n){"use strict";function r(t){a.call(this,t,{name:"MediaStreamAudioDestinationNode",numberOfInputs:1,numberOfOutputs:0,channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"})}var i=n(16),o=n(13),a=n(43),s=function(){throw new TypeError("Illegal constructor: use audioContext.createMediaStreamDestination()")};i.inherits(s,a),i.inherits(r,s),r.exports=s,t.exports=o.MediaStreamAudioDestinationNode=r},function(t,e,n){"use strict";function r(t){a.call(this,t,{name:"MediaStreamAudioSourceNode",numberOfInputs:0,numberOfOutputs:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"})}var i=n(16),o=n(13),a=n(43),s=function(){throw new TypeError("Illegal constructor: use audioContext.createMediaStreamSource(mediaStream: MediaStream)")};i.inherits(s,a),i.inherits(r,s),r.exports=s,t.exports=o.MediaStreamAudioSourceNode=r},function(t,e,n){"use strict";function r(t){a.call(this,"complete",t),Object.defineProperties(this,{$name:{value:"OfflineAudioCompletionEvent"},$node:{value:t}})}var i=n(16),o=n(13),a=n(320),s=function(){throw new TypeError("Illegal constructor")};i.inherits(s,a),i.inherits(r,s),r.exports=s,t.exports=o.OfflineAudioCompletionEvent=r},function(t,e,n){"use strict";function r(t,e,n){if(!(this instanceof r))throw new TypeError("Failed to construct 'AudioContext': Please use the 'new' operator");f.call(this);var a=new o(this,null,[{name:"numberOfChannels",type:"number"},{name:"length",type:"number"},{name:"sampleRate",type:"number"}]);a.validateArguments(arguments,function(t){throw new TypeError(a.form+"; "+t)});var s=new c(this),u=function(){return this._microCurrentTime/1e6},h=new l(this),p=null;i.defineAttribute(this,"destination","readonly",s,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"sampleRate","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"currentTime","readonly",u,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"listener","readonly",h,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"oncomplete","function|null",p,function(t){throw new TypeError(i.formatter.concat(this,t))}),Object.defineProperties(this,{$name:{value:"OfflineAudioContext"},$context:{value:this}}),this._microCurrentTime=0,this._processedSamples=0,this._tick=0,this._numberOfChannels=t,this._length=e,this._rendering=!1}var i=n(16),o=n(61),a=n(13),s=n(389),u=n(352),c=n(390),l=n(391),f=n(306),h=n(617);i.inherits(r,s),r.prototype.startRendering=function(){var t=new o(this,"startRendering",[]);t.assert(!this._rendering,function(){throw Error(t.form+"; must only be called one time")}),this._rendering=!0},r.prototype._process=function(t){if(this._rendering&&!(this._length<=this._processedSamples)){for(var e=this._microCurrentTime+t;this._microCurrentTime<e;){var n=Math.min(this._microCurrentTime+1e3,e),r=Math.floor(n/1e6*this.sampleRate),i=r-this._processedSamples;if(this.destination.$process(i,++this._tick),this._microCurrentTime=n,this._processedSamples=r,this._length<=this._processedSamples)break}if(this._length<=this._processedSamples){var o=new h(this);o.renderedBuffer=new u(this,this._numberOfChannels,this._length,this.sampleRate),this.dispatchEvent(o)}}},t.exports=a.OfflineAudioContext=r},function(t,e,n){"use strict";function r(t){s.call(this,t,{name:"OscillatorNode",numberOfInputs:0,numberOfOutputs:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"});var e="sine",n=new u(this,"frequency",440,0,1e5),r=new u(this,"detune",0,-4800,4800),o=null;Object.defineProperty(this,"type",{get:function(){return this._custom?"custom":this._type},set:function(t){if(!i.typeCheck(t,l)){var e="";throw e+="type ",e+=i.formatter.shouldBeButGot(l,t),new TypeError(i.formatter.concat(this,e))}this._type=t},enumerable:!0}),i.defineAttribute(this,"frequency","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"detune","readonly",r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"onended","function|null",o,function(t){throw new TypeError(i.formatter.concat(this,t))}),Object.defineProperties(this,{$state:{get:function(){return this.$stateAtTime(this.context.currentTime)}},$custom:{get:function(){return this._custom}}}),this._type=e,this._custom=null,this._startTime=1/0,this._stopTime=1/0,this._firedOnEnded=!1}var i=n(16),o=n(61),a=n(13),s=n(43),u=n(147),c=n(320),l="enum { sine, square, sawtooth, triangle }",f=function(){throw new TypeError("Illegal constructor: use audioContext.createOscillator()")};i.inherits(f,s),i.inherits(r,f),r.exports=f,r.jsonAttrs=["type","frequency","detune"],f.prototype.start=function(t){var e=new o(this,"start",[{name:"when",type:"optional number"}]);e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),e.assert(1/0===this._startTime,function(){throw new Error(e.form+"; cannot start more than once")}),this._startTime=i.defaults(t,0)},f.prototype.stop=function(t){var e=new o(this,"stop",[{name:"when",type:"optional number"}]);e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),e.assert(1/0!==this._startTime,function(){throw new Error(e.form+"; cannot call stop without calling start first")}),e.assert(1/0===this._stopTime,function(){throw new Error(e.form+"; cannot stop more than once")}),this._stopTime=i.defaults(t,0)},f.prototype.setPeriodicWave=function(t){var e=new o(this,"setPeriodicWave",[{name:"periodicWave",type:"PeriodicWave"}]);e.validateArguments(arguments,function(t){throw new TypeError(e.form+"; "+t)}),this._type="custom",this._custom=t},r.prototype.$stateAtTime=function(t){return t=i.toSeconds(t),1/0===this._startTime?"UNSCHEDULED":t<this._startTime?"SCHEDULED":t<this._stopTime?"PLAYING":"FINISHED"},r.prototype._process=function(){this._firedOnEnded||"FINISHED"!==this.$stateAtTime(this.context.currentTime)||(this.dispatchEvent(new c("ended",this)),this._firedOnEnded=!0)},t.exports=a.OscillatorNode=r},function(t,e,n){"use strict";function r(t){s.call(this,t,{name:"PannerNode",numberOfInputs:1,numberOfOutputs:1,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers"});var e="HRTF",n="inverse",r=1,o=1e4,a=1,l=360,f=360,h=0;i.defineAttribute(this,"panningModel",u,e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"distanceModel",c,n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"refDistance","number",r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"maxDistance","number",o,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"rolloffFactor","number",a,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"coneInnerAngle","number",l,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"coneOuterAngle","number",f,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"coneOuterGain","number",h,function(t){throw new TypeError(i.formatter.concat(this,t))})}var i=n(16),o=n(61),a=n(13),s=n(43),u="enum { equalpower, HRTF }",c="enum { linear, inverse, exponential }",l=function(){throw new TypeError("Illegal constructor: use audioContext.createPanner()")};i.inherits(l,s),i.inherits(r,l),r.exports=l,r.jsonAttrs=["panningModel","distanceModel","refDistance","maxDistance","rolloffFactor","coneInnerAngle","coneOuterAngle","coneOuterGain"],l.prototype.setPosition=function(){var t=new o(this,"setPosition",[{name:"x",type:"number"},{name:"y",type:"number"},{name:"z",type:"number"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},l.prototype.setOrientation=function(){var t=new o(this,"setOrientation",[{name:"x",type:"number"},{name:"y",type:"number"},{name:"z",type:"number"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},l.prototype.setVelocity=function(){var t=new o(this,"setVelocity",[{name:"x",type:"number"},{name:"y",type:"number"},{name:"z",type:"number"}]);t.validateArguments(arguments,function(e){throw new TypeError(t.form+"; "+e)})},t.exports=a.PannerNode=r},function(t,e,n){"use strict";function r(t,e){Object.defineProperties(this,{$name:{value:"PeriodicWave"},$real:{value:t},$imag:{value:e}})}var i=n(16),o=n(13),a=function(){throw new TypeError("Illegal constructor")};i.inherits(r,a),r.exports=a,t.exports=o.PeriodicWave=r},function(t,e,n){"use strict";function r(t,e,n,r){a.call(this,t,{name:"ScriptProcessorNode",numberOfInputs:1,numberOfOutputs:1,channelCount:n,channelCountMode:"max",channelInterpretation:"speakers"});var o=null;i.defineAttribute(this,"numberOfInputChannels","readonly",n,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"numberOfOutputChannels","readonly",r,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"bufferSize","readonly",e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"onaudioprocess","function|null",o,function(t){throw new TypeError(i.formatter.concat(this,t))}),this._numSamples=0}var i=n(16),o=n(13),a=n(43),s=n(352),u=n(602),c=function(){throw new TypeError("Illegal constructor: use audioContext.createScriptProcessor(bufferSize: number, [numberOfInputChannels: number], [numberOfOutputChannels: number])")};i.inherits(c,a),i.inherits(r,c),r.exports=c,r.prototype._process=function(t){if(this._numSamples-=t,this._numSamples<=0){this._numSamples+=this.bufferSize;var e=new u(this);e.playbackTime=this.context.currentTime+this.bufferSize/this.context.sampleRate,e.inputBuffer=new s(this.context,this.numberOfInputChannels,this.bufferSize,this.context.sampleRate),e.outputBuffer=new s(this.context,this.numberOfOutputChannels,this.bufferSize,this.context.sampleRate),this.dispatchEvent(e)}},t.exports=o.ScriptProcessorNode=r},function(t,e,n){"use strict";function r(t){a.call(this,t,{name:"WaveShaperNode",numberOfInputs:1,numberOfOutputs:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"});var e=null,n="none";i.defineAttribute(this,"curve","Float32Array|null",e,function(t){throw new TypeError(i.formatter.concat(this,t))}),i.defineAttribute(this,"oversample",s,n,function(t){throw new TypeError(i.formatter.concat(this,t))})}var i=n(16),o=n(13),a=n(43),s="enum { none, 2x, 4x }",u=function(){throw new TypeError("Illegal constructor: use audioContext.createWaveShaper()")};i.inherits(u,a),i.inherits(r,u),r.exports=u,r.jsonAttrs=["oversample"],t.exports=o.WaveShaperNode=r},function(t,e){(function(e){"use strict";var n={};n.AnalyserNode=e.AnalyserNode,n.AudioBuffer=e.AudioBuffer,n.AudioBufferSourceNode=e.AudioBufferSourceNode,n.AudioContext=e.AudioContext||e.webkitAudioContext,n.AudioDestinationNode=e.AudioDestinationNode,n.AudioListener=e.AudioListener,n.AudioNode=e.AudioNode,n.AudioParam=e.AudioParam,n.AudioProcessingEvent=e.AudioProcessingEvent,n.BiquadFilterNode=e.BiquadFilterNode,n.ChannelMergerNode=e.ChannelMergerNode,n.ChannelSplitterNode=e.ChannelSplitterNode,n.ConvolverNode=e.ConvolverNode,n.DelayNode=e.DelayNode,n.DynamicsCompressorNode=e.DynamicsCompressorNode,n.GainNode=e.GainNode,n.MediaElementAudioSourceNode=e.MediaElementAudioSourceNode,n.MediaStreamAudioDestinationNode=e.MediaStreamAudioDestinationNode,n.MediaStreamAudioSourceNode=e.MediaStreamAudioSourceNode,n.OfflineAudioCompletionEvent=e.OfflineAudioCompletionEvent,n.OfflineAudioContext=e.OfflineAudioContext||e.webkitOfflineAudioContext,n.OscillatorNode=e.OscillatorNode,n.PannerNode=e.PannerNode,n.PeriodicWave=e.PeriodicWave,n.ScriptProcessorNode=e.ScriptProcessorNode,n.WaveShaperNode=e.WaveShaperNode,t.exports=n}).call(e,function(){return this}())},function(t,e,n){(function(e){"use strict";if(!e.WEB_AUDIO_TEST_API_IGNORE){n(389),n(618);var r=n(13);r.use(),t.exports=e.WebAudioTestAPI=r}}).call(e,function(){return this}())},function(t,e,n){"use strict";function r(t,e){e=e.filter(function(e,n){return!(/^optional/.test(e)&&t.length<=n)}),e=e.map(function(t){return t.replace(/^optional\s*/,"")});for(var n=0,r=e.length;r>n;n++)if(!i(t[n],e[n]))return n;return-1}var i=n(355);t.exports=r},function(t){"use strict";function e(t,e){return"undefined"!=typeof t?t:e}t.exports=e},function(t,e,n){"use strict";function r(t,e,n,r,a){var s={enumerable:!0};"function"==typeof r?(n="readonly",s.get=r):s.get=function(){return r},s.set="readonly"===n?function(){a.call(t,e+" is readonly")}:function(s){i(s,n)?r=s:a.call(t,e+" "+o.shouldBeButGot(n,s))},Object.defineProperty(t,e,s)}var i=n(355),o=n(354);t.exports=r},function(t){"use strict";function e(t,e){e&&(t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}t.exports=e},function(t){"use strict";function e(t){return t+=1,{1:"1st",2:"2nd",3:"3rd"}[t]||t+"th"}t.exports=e},function(t,e,n){"use strict";function r(t){if(!t)return String(t);var e=typeof t;if("number"===e||"boolean"===e)return String(t);if("string"===e)return"'"+t+"'";if(Array.isArray(t))return"[ "+t.map(r).join(", ")+" ]";if(t.constructor==={}.constructor)return"{ "+Object.keys(t).map(function(e){return e+": "+r(t[e])}).join(", ")+"}";var n=t.constructor.name||Object.prototype.toString.call(t).slice(8,-1);return i(n)+" "+n}var i=n(353);t.exports=r},function(t,e,n){"use strict";function r(t,e,n){var r;return n=n||[],-1!==n.indexOf(t)?"<circular:"+i(t)+">":(n.push(t),r=e(t,n),n.pop(),r)}var i=n(392);t.exports=r},function(t,e,n){"use strict";function r(t){return i(t)/1e6}var i=n(393);t.exports=r}]);