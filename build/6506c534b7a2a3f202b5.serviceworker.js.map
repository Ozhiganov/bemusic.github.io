{"version":3,"sources":["file://6506c534b7a2a3f202b5.serviceworker.js","file://webpack/bootstrap 6506c534b7a2a3f202b5","file:///home/ubuntu/bemuse/src/app/service-worker.js","file:///home/ubuntu/bemuse/src/utils/version.js","file:///home/ubuntu/bemuse/src/utils/version-loader.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","log","_console","_len","arguments","length","args","Array","_key","console","apply","concat","cacheForever","event","cacheName","respondWith","caches","open","then","cache","match","request","cached","fetch","response","url","put","clone","fetchThenCache","ok","staleWhileRevalidate","promise","_version","_version2","APP_CACHE_KEY","SITE_CACHE_KEY","RES_CACHE_KEY","SKIN_CACHE_KEY","SONG_CACHE_KEY","self","addEventListener","waitUntil","addAll","skipWaiting","clients","claim","build","location","origin","skin","res","site","startsWith"],"mappings":"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","file":"6506c534b7a2a3f202b5.serviceworker.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"build/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _version = __webpack_require__(1);\n\t\n\tvar _version2 = _interopRequireDefault(_version);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction log() {\n\t  var _console;\n\t\n\t  for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n\t    args[_key] = arguments[_key];\n\t  }\n\t\n\t  (_console = console).log.apply(_console, ['%c serviceworker %c', 'background:yellow;color:black', ''].concat(args));\n\t}\n\t/*global caches*/\n\t\n\tlog('I am a service worker! ' + _version2.default);\n\t\n\tvar APP_CACHE_KEY = 'app';\n\tvar SITE_CACHE_KEY = 'site-v' + _version2.default;\n\tvar RES_CACHE_KEY = 'site-v' + _version2.default;\n\tvar SKIN_CACHE_KEY = 'skin-v' + _version2.default;\n\tvar SONG_CACHE_KEY = 'songs';\n\t\n\tself.addEventListener('install', function (event) {\n\t  event.waitUntil(caches.open(SITE_CACHE_KEY).then(function (cache) {\n\t    return cache.addAll(['/']);\n\t  }).then(function () {\n\t    return self.skipWaiting();\n\t  }));\n\t});\n\t\n\tself.addEventListener('activate', function () {\n\t  log('Service worker activated! Claiming clients now!');\n\t  return self.clients.claim();\n\t});\n\t\n\tself.addEventListener('fetch', function (event) {\n\t  var build = location.origin + '/build/';\n\t  var skin = location.origin + '/skins/';\n\t  var res = location.origin + '/res/';\n\t  var site = location.origin;\n\t  var request = event.request;\n\t  if (request.url.startsWith(build)) {\n\t    if (request.url !== build + 'boot.js') {\n\t      return cacheForever(event, APP_CACHE_KEY);\n\t    }\n\t  }\n\t  if (request.url.match(/assets\\/[^\\/]+\\.bemuse$/)) {\n\t    return cacheForever(event, SONG_CACHE_KEY);\n\t  }\n\t  if (request.url.match(/\\.(bms|bme|bml)$/)) {\n\t    return fetchThenCache(event, SONG_CACHE_KEY);\n\t  }\n\t  if (request.url.match(/\\/index\\.json$/)) {\n\t    return fetchThenCache(event, SONG_CACHE_KEY);\n\t  }\n\t  if (request.url.match(/\\/assets\\/metadata\\.json$/)) {\n\t    return fetchThenCache(event, SONG_CACHE_KEY);\n\t  }\n\t  if (request.url.startsWith(skin)) {\n\t    return staleWhileRevalidate(event, SKIN_CACHE_KEY);\n\t  }\n\t  if (request.url.startsWith(res)) {\n\t    return staleWhileRevalidate(event, RES_CACHE_KEY);\n\t  }\n\t  if (request.url.startsWith(site)) {\n\t    return fetchThenCache(event, SITE_CACHE_KEY);\n\t  }\n\t  if (request.url.startsWith('https://fonts.googleapis.com/')) {\n\t    return staleWhileRevalidate(event, SKIN_CACHE_KEY);\n\t  }\n\t});\n\t\n\tfunction cacheForever(event, cacheName) {\n\t  event.respondWith(caches.open(cacheName).then(function (cache) {\n\t    return cache.match(event.request).then(function (cached) {\n\t      return cached || fetch(event.request).then(function (response) {\n\t        log('Cache forever:', event.request.url);\n\t        cache.put(event.request, response.clone());\n\t        return response;\n\t      });\n\t    });\n\t  }));\n\t}\n\t\n\tfunction fetchThenCache(event, cacheName) {\n\t  event.respondWith(caches.open(cacheName).then(function (cache) {\n\t    return fetch(event.request).then(function (response) {\n\t      if (response && response.ok) {\n\t        log('Fetch OK:', event.request.url);\n\t        cache.put(event.request, response.clone());\n\t        return response;\n\t      } else {\n\t        return cache.match(event.request);\n\t      }\n\t    }).catch(function () {\n\t      return cache.match(event.request);\n\t    });\n\t  }));\n\t}\n\t\n\tfunction staleWhileRevalidate(event, cacheName) {\n\t  event.respondWith(caches.open(cacheName).then(function (cache) {\n\t    return cache.match(event.request).then(function (cached) {\n\t      var promise = fetch(event.request).then(function (response) {\n\t        if (response && response.ok) {\n\t          log('Updated:', event.request.url);\n\t          cache.put(event.request, response.clone());\n\t        }\n\t        return response;\n\t      });\n\t      return cached || promise;\n\t    });\n\t  }));\n\t}\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tmodule.exports = __webpack_require__(2);\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\tmodule.exports=\"35\"\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** 6506c534b7a2a3f202b5.serviceworker.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"build/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 6506c534b7a2a3f202b5\n **/","\n/*global caches*/\n\nimport version from 'bemuse/utils/version'\n\nfunction log (...args) {\n  console.log('%c serviceworker %c', 'background:yellow;color:black', '', ...args)\n}\n\nlog('I am a service worker! ' + version)\n\nvar APP_CACHE_KEY = 'app'\nvar SITE_CACHE_KEY = 'site-v' + version\nvar RES_CACHE_KEY = 'site-v' + version\nvar SKIN_CACHE_KEY = 'skin-v' + version\nvar SONG_CACHE_KEY = 'songs'\n\nself.addEventListener('install', function (event) {\n  event.waitUntil(\n    caches.open(SITE_CACHE_KEY)\n    .then((cache) => cache.addAll([ '/' ]))\n    .then(() => self.skipWaiting())\n  )\n})\n\nself.addEventListener('activate', function () {\n  log('Service worker activated! Claiming clients now!')\n  return self.clients.claim()\n})\n\nself.addEventListener('fetch', function (event) {\n  var build = location.origin + '/build/'\n  var skin = location.origin + '/skins/'\n  var res = location.origin + '/res/'\n  var site = location.origin\n  var request = event.request\n  if (request.url.startsWith(build)) {\n    if (request.url !== build + 'boot.js') {\n      return cacheForever(event, APP_CACHE_KEY)\n    }\n  }\n  if (request.url.match(/assets\\/[^\\/]+\\.bemuse$/)) {\n    return cacheForever(event, SONG_CACHE_KEY)\n  }\n  if (request.url.match(/\\.(bms|bme|bml)$/)) {\n    return fetchThenCache(event, SONG_CACHE_KEY)\n  }\n  if (request.url.match(/\\/index\\.json$/)) {\n    return fetchThenCache(event, SONG_CACHE_KEY)\n  }\n  if (request.url.match(/\\/assets\\/metadata\\.json$/)) {\n    return fetchThenCache(event, SONG_CACHE_KEY)\n  }\n  if (request.url.startsWith(skin)) {\n    return staleWhileRevalidate(event, SKIN_CACHE_KEY)\n  }\n  if (request.url.startsWith(res)) {\n    return staleWhileRevalidate(event, RES_CACHE_KEY)\n  }\n  if (request.url.startsWith(site)) {\n    return fetchThenCache(event, SITE_CACHE_KEY)\n  }\n  if (request.url.startsWith('https://fonts.googleapis.com/')) {\n    return staleWhileRevalidate(event, SKIN_CACHE_KEY)\n  }\n})\n\nfunction cacheForever (event, cacheName) {\n  event.respondWith(\n    caches.open(cacheName).then(function (cache) {\n      return cache.match(event.request).then(function (cached) {\n        return cached || fetch(event.request).then(function (response) {\n          log('Cache forever:', event.request.url)\n          cache.put(event.request, response.clone())\n          return response\n        })\n      })\n    })\n  )\n}\n\nfunction fetchThenCache (event, cacheName) {\n  event.respondWith(\n    caches.open(cacheName).then(function (cache) {\n      return fetch(event.request).then(function (response) {\n        if (response && response.ok) {\n          log('Fetch OK:', event.request.url)\n          cache.put(event.request, response.clone())\n          return response\n        } else {\n          return cache.match(event.request)\n        }\n      }).catch(function () {\n        return cache.match(event.request)\n      })\n    })\n  )\n}\n\nfunction staleWhileRevalidate (event, cacheName) {\n  event.respondWith(\n    caches.open(cacheName).then(function (cache) {\n      return cache.match(event.request).then(function (cached) {\n        var promise = fetch(event.request).then(function (response) {\n          if (response && response.ok) {\n            log('Updated:', event.request.url)\n            cache.put(event.request, response.clone())\n          }\n          return response\n        })\n        return cached || promise\n      })\n    })\n  )\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./app/service-worker.js\n **/","\nmodule.exports = require('val!./version-loader')\n\n\n\n/** WEBPACK FOOTER **\n ** ./utils/version.js\n **/","module.exports=\"35\"\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../~/val-loader!./utils/version-loader.js\n ** module id = 2\n ** module chunks = 0\n **/"],"sourceRoot":""}